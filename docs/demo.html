<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spek — OpenSpec Viewer Demo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400..800&display=swap" rel="stylesheet" />
  </head>
  <body>
    <div id="root"></div>
    <script>window.__DEMO_DATA__ = {"overview":{"specsCount":25,"changesCount":{"active":1,"archived":23},"taskStats":{"total":274,"completed":271}},"specs":[{"topic":"api-adapter","path":"/home/kewang/git/spek/openspec/specs/api-adapter/spec.md"},{"topic":"change-browsing","path":"/home/kewang/git/spek/openspec/specs/change-browsing/spec.md"},{"topic":"core-module","path":"/home/kewang/git/spek/openspec/specs/core-module/spec.md"},{"topic":"dashboard-view","path":"/home/kewang/git/spek/openspec/specs/dashboard-view/spec.md"},{"topic":"filesystem-api","path":"/home/kewang/git/spek/openspec/specs/filesystem-api/spec.md"},{"topic":"frontend-design-skill","path":"/home/kewang/git/spek/openspec/specs/frontend-design-skill/spec.md"},{"topic":"git-timestamp-cache","path":"/home/kewang/git/spek/openspec/specs/git-timestamp-cache/spec.md"},{"topic":"markdown-renderer","path":"/home/kewang/git/spek/openspec/specs/markdown-renderer/spec.md"},{"topic":"openspec-api","path":"/home/kewang/git/spek/openspec/specs/openspec-api/spec.md"},{"topic":"openspec-scanner","path":"/home/kewang/git/spek/openspec/specs/openspec-scanner/spec.md"},{"topic":"repo-selection","path":"/home/kewang/git/spek/openspec/specs/repo-selection/spec.md"},{"topic":"responsive-layout","path":"/home/kewang/git/spek/openspec/specs/responsive-layout/spec.md"},{"topic":"search-api","path":"/home/kewang/git/spek/openspec/specs/search-api/spec.md"},{"topic":"search-ui","path":"/home/kewang/git/spek/openspec/specs/search-ui/spec.md"},{"topic":"shared-layout","path":"/home/kewang/git/spek/openspec/specs/shared-layout/spec.md"},{"topic":"sidebar-toggle","path":"/home/kewang/git/spek/openspec/specs/sidebar-toggle/spec.md"},{"topic":"spa-routing","path":"/home/kewang/git/spek/openspec/specs/spa-routing/spec.md"},{"topic":"spec-browsing","path":"/home/kewang/git/spek/openspec/specs/spec-browsing/spec.md"},{"topic":"spec-history","path":"/home/kewang/git/spek/openspec/specs/spec-history/spec.md"},{"topic":"task-parser","path":"/home/kewang/git/spek/openspec/specs/task-parser/spec.md"},{"topic":"theme-toggle","path":"/home/kewang/git/spek/openspec/specs/theme-toggle/spec.md"},{"topic":"vscode-cicd","path":"/home/kewang/git/spek/openspec/specs/vscode-cicd/spec.md"},{"topic":"vscode-extension-host","path":"/home/kewang/git/spek/openspec/specs/vscode-extension-host/spec.md"},{"topic":"vscode-marketplace-metadata","path":"/home/kewang/git/spek/openspec/specs/vscode-marketplace-metadata/spec.md"},{"topic":"webview-integration","path":"/home/kewang/git/spek/openspec/specs/webview-integration/spec.md"}],"specDetails":{"api-adapter":{"topic":"api-adapter","content":"## ADDED Requirements\r\n\r\n### Requirement: ApiAdapter interface\r\nThe frontend SHALL define an `ApiAdapter` interface that abstracts all API communication, allowing different implementations for web and VS Code environments.\r\n\r\n#### Scenario: Adapter interface contract\r\n- **WHEN** a component needs to fetch OpenSpec data\r\n- **THEN** it calls methods on the `ApiAdapter` interface (e.g., `getOverview()`, `getSpecs()`, `getChange(slug)`) which return Promises of typed data\r\n\r\n### Requirement: FetchAdapter for web\r\nThe web version SHALL use a `FetchAdapter` that calls the Express REST API via HTTP fetch.\r\n\r\n#### Scenario: Fetch adapter API call\r\n- **WHEN** `FetchAdapter.getOverview()` is called with repoPath set\r\n- **THEN** it performs `fetch('/api/openspec/overview?dir=...')` and returns the parsed JSON response\r\n\r\n#### Scenario: Fetch adapter error handling\r\n- **WHEN** a fetch request returns a non-OK HTTP status\r\n- **THEN** the adapter throws an error with the HTTP status code\r\n\r\n### Requirement: MessageAdapter for VS Code Webview\r\nThe VS Code version SHALL use a `MessageAdapter` that communicates with the extension host via `postMessage`.\r\n\r\n#### Scenario: Message adapter API call\r\n- **WHEN** `MessageAdapter.getOverview()` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getOverview' }` via `postMessage` and returns a Promise that resolves when the matching response arrives\r\n\r\n#### Scenario: Message adapter timeout\r\n- **WHEN** a message request does not receive a response within 10 seconds\r\n- **THEN** the adapter rejects the Promise with a timeout error\r\n\r\n#### Scenario: Message adapter error response\r\n- **WHEN** the extension host responds with `{ type: 'response', id, error: '...' }`\r\n- **THEN** the adapter rejects the Promise with the error message\r\n\r\n### Requirement: Adapter injection via React Context\r\nThe adapter SHALL be provided to the React component tree via a Context provider, allowing hooks to use the appropriate adapter without knowing the environment.\r\n\r\n#### Scenario: Web app initialization\r\n- **WHEN** the web app mounts\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `FetchAdapter`\r\n\r\n#### Scenario: Webview app initialization\r\n- **WHEN** the React app mounts inside a VS Code Webview\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `MessageAdapter`\r\n\r\n#### Scenario: Hook usage\r\n- **WHEN** a hook like `useOverview()` needs to fetch data\r\n- **THEN** it obtains the adapter from `useApiAdapter()` context and calls `adapter.getOverview()`\r\n\r\n### Requirement: StaticAdapter for demo\r\nThe demo version SHALL use a `StaticAdapter` that reads all data from a pre-embedded JSON object (`window.__DEMO_DATA__`) and implements the `ApiAdapter` interface.\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive substring matching across all spec topic names, spec content, change slugs, and change proposal/design content, returning matching results with context snippets\r\n\r\n#### Scenario: Search matches spec topic names\r\n- **WHEN** `search(\"dashboard\")` is called and a spec with topic `dashboard-view` exists\r\n- **THEN** the result includes `dashboard-view` as a match\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n","relatedChanges":["spec-diff-viewer","2026-02-13-vscode-extension","2026-02-16-ui-design-polish-p0-p1"],"history":[{"slug":"2026-02-16-ui-design-polish-p0-p1","date":"2026-02-16","timestamp":"2026-02-16T01:41:38+08:00","description":"ui design polish p0 p1","status":"archived"},{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"},{"slug":"spec-diff-viewer","date":null,"timestamp":null,"description":"spec diff viewer","status":"active"}]},"change-browsing":{"topic":"change-browsing","content":"## ADDED Requirements\r\n\r\n### Requirement: Change list with active/archived separation\r\nThe system SHALL display changes grouped into active and archived sections. Active changes SHALL be visually distinguished with a left accent color border (4px). Archived changes SHALL be sorted by date (most recent first).\r\n\r\n#### Scenario: Display active changes\r\n- **WHEN** user navigates to the ChangeList page and there are active changes\r\n- **THEN** active changes are listed in an \"Active\" section with a left accent color border, name, and task progress\r\n\r\n#### Scenario: Display archived changes\r\n- **WHEN** user navigates to the ChangeList page\r\n- **THEN** archived changes are listed in an \"Archived\" section sorted by date descending, without accent border\r\n\r\n#### Scenario: No changes\r\n- **WHEN** there are no changes in the repo\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Change detail with tab navigation\r\nThe system SHALL display change details using a tabbed interface with tabs in OpenSpec workflow order: Proposal, Design, Specs (delta specs), and Tasks. Tab content SHALL transition with a fade-in animation when switching.\r\n\r\n#### Scenario: View proposal tab\r\n- **WHEN** user views a change and clicks the Proposal tab\r\n- **THEN** the proposal.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View design tab\r\n- **WHEN** user clicks the Design tab\r\n- **THEN** the design.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View specs tab\r\n- **WHEN** user clicks the Specs tab and the change has delta specs\r\n- **THEN** the delta spec files are listed and their content displayed with a fade-in transition\r\n\r\n#### Scenario: View tasks tab\r\n- **WHEN** user clicks the Tasks tab\r\n- **THEN** the tasks.md content is displayed with a TaskProgress bar showing completion statistics, with a fade-in transition\r\n\r\n#### Scenario: Tab order\r\n- **WHEN** the ChangeDetail page is rendered\r\n- **THEN** the tabs are displayed in order: Proposal, Design, Specs, Tasks (matching the OpenSpec workflow sequence)\r\n\r\n#### Scenario: Missing artifact\r\n- **WHEN** a tab's corresponding artifact file does not exist\r\n- **THEN** the tab shows a \"No content\" placeholder\r\n\r\n### Requirement: Task progress display in change detail\r\nThe Tasks tab SHALL display a progress bar and statistics (completed/total) derived from the change's task data.\r\n\r\n#### Scenario: Show task progress\r\n- **WHEN** viewing the Tasks tab of a change with tasks\r\n- **THEN** a TaskProgress component shows a visual progress bar with \"X / Y completed\" text\r\n\r\n### Requirement: Capability ID linking in proposal\r\nThe system SHALL render inline code elements in proposal markdown as navigable links when the code text matches an existing spec topic name.\r\n\r\n#### Scenario: Capability ID matches existing spec\r\n- **WHEN** a proposal markdown contains an inline code element (e.g., `` `responsive-layout` ``)\r\n- **AND** a spec with the topic name `responsive-layout` exists\r\n- **THEN** the inline code SHALL be rendered as a clickable link navigating to `/specs/responsive-layout`\r\n\r\n#### Scenario: Inline code does not match any spec\r\n- **WHEN** a proposal markdown contains an inline code element that does not match any existing spec topic\r\n- **THEN** the inline code SHALL be rendered as a normal styled code element without a link\r\n\r\n#### Scenario: MarkdownRenderer receives spec topics list\r\n- **WHEN** MarkdownRenderer is used with a `specTopics` prop containing the list of available spec topic names\r\n- **THEN** inline code matching any topic in the list SHALL be rendered as navigable links\r\n\r\n### Requirement: Custom task checkbox styling\r\nThe system SHALL render task items in the Tasks tab using custom SVG icons instead of text-based `[x]`/`[ ]` markers. Completed tasks SHALL display a filled checkmark icon in green, and incomplete tasks SHALL display an empty circle icon. Completed task text SHALL have reduced opacity (0.6) in addition to the existing strikethrough styling.\r\n\r\n#### Scenario: Incomplete task display\r\n- **WHEN** a task item is not completed\r\n- **THEN** the task displays an empty circle SVG icon followed by the task text at full opacity\r\n\r\n#### Scenario: Completed task display\r\n- **WHEN** a task item is completed\r\n- **THEN** the task displays a green checkmark SVG icon followed by the task text with strikethrough and reduced opacity (0.6)\r\n","relatedChanges":["2026-02-13-fix-task-stats-and-capability-nav","2026-02-13-phase2-core-ui-pages","2026-02-16-ui-design-polish-p2"],"history":[{"slug":"2026-02-16-ui-design-polish-p2","date":"2026-02-16","timestamp":"2026-02-16T02:14:36+08:00","description":"ui design polish p2","status":"archived"},{"slug":"2026-02-13-fix-task-stats-and-capability-nav","date":"2026-02-13","timestamp":"2026-02-13T18:53:25+08:00","description":"fix task stats and capability nav","status":"archived"},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"core-module":{"topic":"core-module","content":"## ADDED Requirements\r\n\r\n### Requirement: Standalone core package\r\nThe core module SHALL be an independent npm package (`@spek/core`) with no framework dependencies, usable by both the web server and the VS Code extension host.\r\n\r\n#### Scenario: Import from web server\r\n- **WHEN** the Express server imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n#### Scenario: Import from extension host\r\n- **WHEN** the VS Code extension host imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n### Requirement: Scanner functions\r\nThe core module SHALL export scanner functions that accept a base path and return structured OpenSpec data.\r\n\r\n#### Scenario: Scan overview\r\n- **WHEN** `scanOverview(basePath)` is called with a valid repo path\r\n- **THEN** it returns `{ specsCount, changesCount: { active, archived }, taskStats: { total, completed } }`\r\n\r\n#### Scenario: List specs\r\n- **WHEN** `listSpecs(basePath)` is called\r\n- **THEN** it returns an array of `{ topic, path }` for each spec directory\r\n\r\n#### Scenario: Read single spec\r\n- **WHEN** `readSpec(basePath, topic)` is called with an existing topic\r\n- **THEN** it returns `{ topic, content, relatedChanges, history }`\r\n\r\n#### Scenario: List changes\r\n- **WHEN** `listChanges(basePath)` is called\r\n- **THEN** it returns `{ active: ChangeInfo[], archived: ChangeInfo[] }`\r\n\r\n#### Scenario: Read single change\r\n- **WHEN** `readChange(basePath, slug)` is called with an existing change slug\r\n- **THEN** it returns `{ slug, proposal, design, tasks, specs, metadata }`\r\n\r\n#### Scenario: Search content\r\n- **WHEN** `searchContent(basePath, query)` is called\r\n- **THEN** it returns matching results across specs and changes with context snippets\r\n\r\n### Requirement: Task parser functions\r\nThe core module SHALL export task parsing functions that operate on raw Markdown content strings.\r\n\r\n#### Scenario: Parse tasks from content\r\n- **WHEN** `parseTasks(content)` is called with Markdown containing `- [x]` and `- [ ]` checkboxes\r\n- **THEN** it returns `{ total, completed, sections }` with tasks grouped by `##` headings\r\n\r\n### Requirement: Shared type definitions\r\nThe core module SHALL export all TypeScript type definitions used by both the web app and the extension.\r\n\r\n#### Scenario: Type imports\r\n- **WHEN** the web app or extension imports types from `@spek/core`\r\n- **THEN** types such as `OverviewData`, `SpecInfo`, `SpecDetail`, `ChangeInfo`, `ChangeDetail`, `ParsedTasks`, `SearchResult` are available\r\n","relatedChanges":["2026-02-13-vscode-extension"],"history":[{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"}]},"dashboard-view":{"topic":"dashboard-view","content":"## ADDED Requirements\r\n\r\n### Requirement: Overview statistics display\r\nThe system SHALL display overview statistics from the overview API: total specs count, active changes count, archived changes count, and task completion rate (percentage). Statistics SHALL be displayed in stat cards with large numbers (text-4xl) and a staggered fade-in-up entry animation on page load.\r\n\r\n#### Scenario: Display statistics\r\n- **WHEN** user navigates to the Dashboard page\r\n- **THEN** system displays specs count, active changes count, archived changes count, and overall task completion percentage in stat cards with large accent-colored numbers\r\n\r\n#### Scenario: Staggered entry animation\r\n- **WHEN** the Dashboard page loads\r\n- **THEN** the four stat cards appear with a fade-in-up animation, each card delayed by an incremental amount (e.g., 0ms, 80ms, 160ms, 240ms) creating a staggered reveal effect\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** stat cards appear immediately without animation\r\n\r\n### Requirement: Active changes list\r\nThe system SHALL display a list of active changes with their names and task progress indicators.\r\n\r\n#### Scenario: Show active changes with progress\r\n- **WHEN** there are active changes in the repo\r\n- **THEN** each active change is displayed with its name and a TaskProgress bar showing completed/total tasks\r\n\r\n#### Scenario: No active changes\r\n- **WHEN** there are no active changes\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Recent archived changes\r\nThe system SHALL display the most recent 10 archived changes.\r\n\r\n#### Scenario: Show archived changes\r\n- **WHEN** user views the Dashboard\r\n- **THEN** the most recent 10 archived changes are listed with their names and dates\r\n\r\n### Requirement: Navigation cards\r\nThe system SHALL provide navigation cards/links to the Specs list and Changes list pages.\r\n\r\n#### Scenario: Navigate to specs\r\n- **WHEN** user clicks the Specs navigation card\r\n- **THEN** system navigates to `/specs`\r\n\r\n#### Scenario: Navigate to changes\r\n- **WHEN** user clicks the Changes navigation card\r\n- **THEN** system navigates to `/changes`\r\n","relatedChanges":["2026-02-13-phase2-core-ui-pages","2026-02-16-ui-design-polish-p0-p1"],"history":[{"slug":"2026-02-16-ui-design-polish-p0-p1","date":"2026-02-16","timestamp":"2026-02-16T01:41:38+08:00","description":"ui design polish p0 p1","status":"archived"},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"filesystem-api":{"topic":"filesystem-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Browse directories\r\nThe system SHALL provide an API endpoint `GET /api/fs/browse` that returns directory contents for a given path, allowing users to navigate the filesystem to find repos.\r\n\r\n#### Scenario: Browse valid directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/projects`\r\n- **THEN** system returns a JSON array of entries, each with `name`, `type` (\"file\" or \"directory\"), and `path`\r\n- **AND** entries are sorted with directories first, then alphabetically\r\n\r\n#### Scenario: Browse without path parameter\r\n- **WHEN** client sends `GET /api/fs/browse` without a `path` parameter\r\n- **THEN** system returns the contents of the user's home directory\r\n\r\n#### Scenario: Browse non-existent directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/nonexistent`\r\n- **THEN** system returns HTTP 400 with an error message\r\n\r\n### Requirement: Detect OpenSpec directory\r\nThe system SHALL provide an API endpoint `GET /api/fs/detect` that checks whether a given path contains an `openspec/` directory with a valid `config.yaml`.\r\n\r\n#### Scenario: Path contains valid OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/my-repo`\r\n- **AND** `/home/user/my-repo/openspec/config.yaml` exists\r\n- **THEN** system returns `{ \"hasOpenSpec\": true, \"schema\": \"<schema-value>\" }`\r\n\r\n#### Scenario: Path does not contain OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/empty-repo`\r\n- **AND** no `openspec/` directory exists at that path\r\n- **THEN** system returns `{ \"hasOpenSpec\": false }`\r\n\r\n### Requirement: Path traversal protection\r\nThe system SHALL reject any path that attempts directory traversal outside the specified root.\r\n\r\n#### Scenario: Path traversal attempt\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/../../../etc`\r\n- **THEN** system resolves the path and returns the directory contents of the resolved absolute path without exposing system files outside normal filesystem permissions\r\n","relatedChanges":["2026-02-13-phase1-skeleton-and-api"],"history":[{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","timestamp":"2026-02-13T17:37:45+08:00","description":"phase1 skeleton and api","status":"archived"}]},"frontend-design-skill":{"topic":"frontend-design-skill","content":"### Requirement: Skill 目錄結構\r\n\r\nfrontend-design skill SHALL 存放於 `.agents/skills/frontend-design/` 目錄下，包含 `SKILL.md` 和 `LICENSE.txt` 兩個檔案。\r\n\r\n#### Scenario: Skill 檔案存在\r\n\r\n- **WHEN** 檢查 `.agents/skills/frontend-design/` 目錄\r\n- **THEN** 目錄中 SHALL 包含 `SKILL.md` 和 `LICENSE.txt`\r\n\r\n### Requirement: Claude Code Skill 註冊\r\n\r\n`.claude/skills/frontend-design` SHALL 為一個 symlink，指向 `../../.agents/skills/frontend-design`，使 Claude Code 能自動偵測並載入此 skill。\r\n\r\n#### Scenario: Symlink 正確指向\r\n\r\n- **WHEN** Claude Code 掃描 `.claude/skills/` 目錄\r\n- **THEN** `frontend-design` symlink SHALL 解析至 `.agents/skills/frontend-design/`\r\n\r\n### Requirement: SKILL.md 包含設計指引\r\n\r\n`SKILL.md` SHALL 包含 frontmatter（name、description、license）以及設計指引內容，涵蓋 Design Thinking 流程和 Frontend Aesthetics Guidelines。\r\n\r\n#### Scenario: Skill 被觸發時提供指引\r\n\r\n- **WHEN** 使用者要求建立網頁元件、頁面、dashboard 或美化 web UI\r\n- **THEN** Claude Code SHALL 載入 SKILL.md 中的設計指引，引導產出高品質前端介面\r\n","relatedChanges":["2026-02-15-add-frontend-design-skill"],"history":[{"slug":"2026-02-15-add-frontend-design-skill","date":"2026-02-15","timestamp":"2026-02-15T23:40:22+08:00","description":"add frontend design skill","status":"archived"}]},"git-timestamp-cache":{"topic":"git-timestamp-cache","content":"## ADDED Requirements\r\n\r\n### Requirement: Build timestamp cache from git log\r\nThe system SHALL provide a function that executes a single `git log` command scoped to `openspec/changes/` and parses the output to build a Map of change slug to earliest commit timestamp (ISO 8601 format).\r\n\r\n#### Scenario: Build cache for repo with git history\r\n- **WHEN** the cache builder is invoked for a repo directory that is a git repository\r\n- **THEN** the system executes `git log --format=\"COMMIT %aI\" --name-only -- openspec/changes/` in the repo directory\r\n- **AND** parses the output to extract the earliest commit timestamp for each change slug\r\n- **AND** returns a `Map<string, string>` mapping slug to ISO 8601 timestamp\r\n\r\n#### Scenario: Build cache for non-git directory\r\n- **WHEN** the cache builder is invoked for a directory that is not a git repository\r\n- **THEN** the system returns an empty Map without throwing an error\r\n\r\n#### Scenario: Change exists in filesystem but not in git\r\n- **WHEN** a change directory exists but has no git commits (e.g., uncommitted new change)\r\n- **THEN** that change slug is not present in the returned Map\r\n\r\n### Requirement: In-memory cache keyed by repo path\r\nThe system SHALL maintain an in-memory cache (`Map<string, Map<string, string>>`) keyed by absolute repo directory path, storing the timestamp Map for each repo.\r\n\r\n#### Scenario: Cache hit\r\n- **WHEN** a timestamp lookup is requested for a repo that has been previously cached\r\n- **THEN** the system returns the cached Map without executing any git commands\r\n\r\n#### Scenario: Cache miss with lazy build\r\n- **WHEN** a timestamp lookup is requested for a repo that has not been cached\r\n- **THEN** the system automatically builds the cache by executing the git log command\r\n- **AND** stores the result for subsequent lookups\r\n\r\n### Requirement: Resync cache\r\nThe system SHALL provide a resync function that clears the cached timestamps for a given repo and immediately rebuilds the cache from git.\r\n\r\n#### Scenario: Resync after repo changes\r\n- **WHEN** the resync function is invoked for a repo directory\r\n- **THEN** the system clears the existing cache entry for that repo\r\n- **AND** rebuilds the cache by executing the git log command\r\n- **AND** returns the newly built timestamp Map\r\n","relatedChanges":["2026-02-13-spec-history-git-timestamp-cache"],"history":[{"slug":"2026-02-13-spec-history-git-timestamp-cache","date":"2026-02-13","timestamp":"2026-02-13T19:19:25+08:00","description":"spec history git timestamp cache","status":"archived"}]},"markdown-renderer":{"topic":"markdown-renderer","content":"### Requirement: Markdown content rendering\r\nThe system SHALL render Markdown content using react-markdown with remark-gfm plugin, supporting GFM features including tables, strikethrough, and task lists.\r\n\r\n#### Scenario: Standard Markdown rendering\r\n- **WHEN** MarkdownRenderer receives a string containing standard Markdown (headings, lists, bold, italic, links, code blocks)\r\n- **THEN** the content is rendered as formatted HTML with appropriate styling\r\n\r\n#### Scenario: GFM table rendering\r\n- **WHEN** MarkdownRenderer receives content containing a GFM pipe table\r\n- **THEN** the table is rendered as a styled HTML table with header row and data rows\r\n\r\n#### Scenario: GFM checkbox rendering\r\n- **WHEN** MarkdownRenderer receives content containing `- [x]` or `- [ ]` items\r\n- **THEN** the items are rendered as visual checkboxes (read-only)\r\n\r\n### Requirement: BDD keyword highlighting\r\nThe system SHALL visually highlight BDD keywords in rendered Markdown content to improve readability of spec documents.\r\n\r\n#### Scenario: WHEN/GIVEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `WHEN` or `GIVEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a blue background label style (blue text on blue-tinted background)\r\n\r\n#### Scenario: THEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `THEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a green background label style (green text on green-tinted background)\r\n\r\n#### Scenario: AND keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `AND` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a gray background label style (gray text on gray-tinted background)\r\n\r\n#### Scenario: MUST/SHALL keyword highlighting\r\n- **WHEN** rendered Markdown contains `MUST` or `SHALL` as standalone uppercase keywords\r\n- **THEN** the keywords are displayed in red bold text\r\n\r\n#### Scenario: ADDED/MODIFIED badge rendering\r\n- **WHEN** rendered Markdown contains `ADDED` or `MODIFIED` as standalone uppercase keywords\r\n- **THEN** `ADDED` is displayed as an orange badge and `MODIFIED` is displayed as a blue badge\r\n\r\n#### Scenario: Keywords inside code blocks are not highlighted\r\n- **WHEN** BDD keywords appear inside inline code or fenced code blocks\r\n- **THEN** the keywords are NOT highlighted and remain as plain code text\r\n\r\n#### Scenario: Case-sensitive matching\r\n- **WHEN** text contains lowercase or mixed-case variations like \"when\", \"Then\", \"must\"\r\n- **THEN** the keywords are NOT highlighted (only exact uppercase matches trigger highlighting)\r\n\r\n### Requirement: Dark theme styling\r\nThe system SHALL apply dark theme styles consistent with the application's design system (background #0a0c0f series, amber accent, text #e2e8f0).\r\n\r\n#### Scenario: Code block styling\r\n- **WHEN** MarkdownRenderer renders a fenced code block\r\n- **THEN** the code block uses a dark background with monospace font and appropriate padding\r\n\r\n#### Scenario: Link styling\r\n- **WHEN** MarkdownRenderer renders a hyperlink\r\n- **THEN** the link is displayed in accent color (amber) with hover effect\r\n\r\n#### Scenario: Heading styling\r\n- **WHEN** MarkdownRenderer renders headings (h1-h6)\r\n- **THEN** headings use appropriate font sizes and weights consistent with the dark theme\r\n","relatedChanges":["2026-02-13-phase3-markdown-and-search"],"history":[{"slug":"2026-02-13-phase3-markdown-and-search","date":"2026-02-13","timestamp":"2026-02-13T18:16:15+08:00","description":"phase3 markdown and search","status":"archived"}]},"openspec-api":{"topic":"openspec-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Overview endpoint\r\nThe system SHALL provide `GET /api/openspec/overview` that returns aggregate statistics for an OpenSpec repository.\r\n\r\n#### Scenario: Get overview of repo with specs and changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `specsCount`, `changesCount` (with `active` and `archived` breakdown), and `taskStats` (aggregate `total` and `completed` across all changes, including both active and archived)\r\n\r\n#### Scenario: Get overview with only archived changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** there are no active changes but archived changes have tasks\r\n- **THEN** system returns `taskStats` with correct `total` and `completed` counts from archived changes\r\n\r\n#### Scenario: Get overview of repo with no specs\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** the repo has no `openspec/specs/` directory\r\n- **THEN** system returns `specsCount: 0` with changes still counted correctly\r\n\r\n### Requirement: List specs\r\nThe system SHALL provide `GET /api/openspec/specs` that returns all spec topics.\r\n\r\n#### Scenario: List all specs\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **THEN** system returns a JSON array of spec topics, each with `topic` name and `path`\r\n- **AND** topics are sorted alphabetically\r\n\r\n#### Scenario: No specs directory\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **AND** `openspec/specs/` does not exist\r\n- **THEN** system returns an empty array\r\n\r\n### Requirement: Get single spec\r\nThe system SHALL provide `GET /api/openspec/specs/:topic` that returns the full content of a spec.\r\n\r\n#### Scenario: Get existing spec\r\n- **WHEN** client sends `GET /api/openspec/specs/simulation-engine?dir=/path/to/repo`\r\n- **AND** `openspec/specs/simulation-engine/spec.md` exists\r\n- **THEN** system returns JSON with `topic`, `content` (raw Markdown), and `relatedChanges` (list of changes that have delta specs for this topic)\r\n\r\n#### Scenario: Get non-existent spec\r\n- **WHEN** client sends `GET /api/openspec/specs/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: List changes\r\nThe system SHALL provide `GET /api/openspec/changes` that returns all changes grouped by status.\r\n\r\n#### Scenario: List changes with active and archived\r\n- **WHEN** client sends `GET /api/openspec/changes?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `active` array and `archived` array\r\n- **AND** each change includes `slug`, `date` (parsed from slug prefix), `description` (parsed from slug), `hasProposal`, `hasDesign`, `hasTasks`, `hasSpecs`, and `taskStats`\r\n- **AND** changes are sorted by date descending (newest first)\r\n\r\n### Requirement: Get single change\r\nThe system SHALL provide `GET /api/openspec/changes/:slug` that returns full change content.\r\n\r\n#### Scenario: Get existing change with all artifacts\r\n- **WHEN** client sends `GET /api/openspec/changes/2026-02-10-my-feature?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `slug`, `proposal` (Markdown content or null), `design` (Markdown content or null), `tasks` (parsed task structure or null), `specs` (array of delta spec contents), and `metadata` (from `.openspec.yaml` if present)\r\n\r\n#### Scenario: Get non-existent change\r\n- **WHEN** client sends `GET /api/openspec/changes/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: Missing dir parameter\r\nThe system SHALL require the `dir` query parameter on all openspec endpoints.\r\n\r\n#### Scenario: Request without dir parameter\r\n- **WHEN** client sends any `/api/openspec/*` request without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n\r\n### Requirement: Resync cache endpoint\r\nThe system SHALL provide `POST /api/openspec/resync` that clears and rebuilds the git timestamp cache for a given repo.\r\n\r\n#### Scenario: Successful resync\r\n- **WHEN** client sends `POST /api/openspec/resync?dir=/path/to/repo`\r\n- **THEN** the system clears the timestamp cache for that repo\r\n- **AND** rebuilds the cache from git history\r\n- **AND** returns HTTP 200 with `{ ok: true }`\r\n\r\n#### Scenario: Resync without dir parameter\r\n- **WHEN** client sends `POST /api/openspec/resync` without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n\r\n### Requirement: Resync UI control\r\nThe system SHALL display a resync button in the sidebar that triggers a cache rebuild. The button MUST show a loading state while the resync is in progress.\r\n\r\n#### Scenario: User triggers resync\r\n- **WHEN** the user clicks the resync button in the sidebar\r\n- **THEN** the system sends `POST /api/openspec/resync` with the current repo path\r\n- **AND** the button shows a loading/spinning state during the request\r\n- **AND** on success, the current page data is refreshed to reflect updated ordering\r\n\r\n#### Scenario: Resync with no repo selected\r\n- **WHEN** no repo is currently selected\r\n- **THEN** the resync button is not displayed or is disabled\r\n","relatedChanges":["2026-02-13-fix-task-stats-and-capability-nav","2026-02-13-phase1-skeleton-and-api","2026-02-13-spec-history-git-timestamp-cache"],"history":[{"slug":"2026-02-13-spec-history-git-timestamp-cache","date":"2026-02-13","timestamp":"2026-02-13T19:19:25+08:00","description":"spec history git timestamp cache","status":"archived"},{"slug":"2026-02-13-fix-task-stats-and-capability-nav","date":"2026-02-13","timestamp":"2026-02-13T18:53:25+08:00","description":"fix task stats and capability nav","status":"archived"},{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","timestamp":"2026-02-13T17:37:45+08:00","description":"phase1 skeleton and api","status":"archived"}]},"openspec-scanner":{"topic":"openspec-scanner","content":"## ADDED Requirements\r\n\r\n### Requirement: Scan OpenSpec directory structure\r\nThe scanner SHALL be a pure function in the `@spek/core` package that reads an OpenSpec directory and returns its complete structure including specs, active changes, and archived changes. It SHALL use Node.js `fs/promises` directly and have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Scan repo with full OpenSpec structure\r\n- **WHEN** scanner is given a repo path containing `openspec/specs/` and `openspec/changes/`\r\n- **THEN** it returns a structure with `specs` (list of topic names), `activeChanges` (changes directly under `openspec/changes/` excluding `archive/`), and `archivedChanges` (changes under `openspec/changes/archive/`)\r\n\r\n#### Scenario: Scan repo with empty OpenSpec directory\r\n- **WHEN** scanner is given a repo path where `openspec/` exists but contains only `config.yaml`\r\n- **THEN** it returns empty arrays for specs, activeChanges, and archivedChanges\r\n\r\n### Requirement: Parse change artifacts\r\nThe scanner SHALL read individual change directories and extract available artifacts.\r\n\r\n#### Scenario: Change with all artifacts\r\n- **WHEN** scanner reads a change directory containing proposal.md, design.md, tasks.md, and specs/\r\n- **THEN** it returns the raw Markdown content for each artifact and a list of delta spec files\r\n\r\n#### Scenario: Change with partial artifacts\r\n- **WHEN** scanner reads a change directory containing only proposal.md\r\n- **THEN** it returns proposal content and null for missing artifacts\r\n\r\n### Requirement: Read spec content\r\nThe scanner SHALL read spec files and return their Markdown content.\r\n\r\n#### Scenario: Read existing spec\r\n- **WHEN** scanner reads `openspec/specs/{topic}/spec.md`\r\n- **THEN** it returns the raw Markdown content of the spec file\r\n\r\n### Requirement: Detect related changes for a spec\r\nThe scanner SHALL identify which changes contain delta specs for a given spec topic.\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** scanner checks for changes related to spec topic \"simulation-engine\"\r\n- **THEN** it returns all change slugs that have a `specs/simulation-engine/spec.md` delta file\r\n","relatedChanges":["2026-02-13-phase1-skeleton-and-api","2026-02-13-vscode-extension"],"history":[{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"},{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","timestamp":"2026-02-13T17:37:45+08:00","description":"phase1 skeleton and api","status":"archived"}]},"repo-selection":{"topic":"repo-selection","content":"## ADDED Requirements\r\n\r\n### Requirement: Path input with auto-detection\r\nThe system SHALL provide a text input for entering a filesystem path. Upon input, the system SHALL call the detect API to check for an `openspec/` directory and display the detection result.\r\n\r\n#### Scenario: Valid path with openspec directory\r\n- **WHEN** user enters a path that contains an `openspec/` directory\r\n- **THEN** system displays a success indicator and a button to open the repo\r\n\r\n#### Scenario: Valid path without openspec directory\r\n- **WHEN** user enters a path that does not contain an `openspec/` directory\r\n- **THEN** system displays a warning message indicating no openspec directory found\r\n\r\n#### Scenario: Invalid path\r\n- **WHEN** user enters a path that does not exist\r\n- **THEN** system displays an error message\r\n\r\n### Requirement: Directory browsing\r\nThe system SHALL provide a directory browser that calls the browse API, allowing users to navigate the filesystem and select a repo path.\r\n\r\n#### Scenario: Browse directories\r\n- **WHEN** user clicks the browse button\r\n- **THEN** system displays a list of directories at the current path\r\n- **AND** user can click a directory to navigate into it\r\n- **AND** user can select the current directory as the repo path\r\n\r\n### Requirement: Recent paths persistence\r\nThe system SHALL persist the most recent 5 repo paths in localStorage. On page load, previously used paths SHALL be displayed for quick selection. Each recent path SHALL be validated asynchronously against the detect API to show its current status (valid, invalid, or checking).\r\n\r\n#### Scenario: Save path on successful detection\r\n- **WHEN** user successfully opens a repo (path with valid openspec/)\r\n- **THEN** the path is saved to localStorage recent paths list (max 5, most recent first)\r\n\r\n#### Scenario: Display recent paths on load\r\n- **WHEN** user visits the SelectRepo page\r\n- **THEN** previously saved paths are displayed as clickable options\r\n\r\n#### Scenario: Validate recent paths asynchronously\r\n- **WHEN** the SelectRepo page loads with saved recent paths\r\n- **THEN** the system calls the detect API for each path in parallel\r\n- **AND** each path displays a status indicator: spinner (checking), green checkmark (valid openspec/ found), or red indicator (path invalid or no openspec/)\r\n\r\n#### Scenario: Remove invalid path\r\n- **WHEN** a recent path is determined to be invalid\r\n- **THEN** a delete button appears next to the path allowing the user to remove it from the list\r\n\r\n### Requirement: Auto-navigate to dashboard\r\nThe system SHALL automatically navigate to the Dashboard page after the user selects a valid repo path.\r\n\r\n#### Scenario: Navigate after selection\r\n- **WHEN** user selects a valid repo path (via input, browse, or recent paths)\r\n- **THEN** system navigates to `/dashboard` with the repo path set in RepoContext\r\n","relatedChanges":["2026-02-13-phase2-core-ui-pages","2026-02-13-phase4-polish-and-enhancement"],"history":[{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","timestamp":"2026-02-13T18:36:04+08:00","description":"phase4 polish and enhancement","status":"archived"},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"responsive-layout":{"topic":"responsive-layout","content":"## ADDED Requirements\r\n\r\n### Requirement: Mobile breakpoint detection\r\nThe system SHALL detect whether the viewport width is below 768px and adapt the layout accordingly. The detection MUST use `window.matchMedia` and respond to runtime viewport changes (e.g., device rotation).\r\n\r\n#### Scenario: Viewport below 768px\r\n- **WHEN** the viewport width is less than 768px\r\n- **THEN** the sidebar is hidden by default and a hamburger menu button appears in the header\r\n\r\n#### Scenario: Viewport at or above 768px\r\n- **WHEN** the viewport width is 768px or greater\r\n- **THEN** the sidebar is displayed in its fixed position and the hamburger menu button is hidden\r\n\r\n#### Scenario: Viewport resize crossing breakpoint\r\n- **WHEN** the viewport is resized from below 768px to at or above 768px\r\n- **THEN** the sidebar transitions to fixed display and the hamburger menu button is hidden\r\n\r\n### Requirement: Mobile sidebar overlay\r\nThe system SHALL display the sidebar as a full-height overlay with a backdrop when opened on viewports below 768px.\r\n\r\n#### Scenario: Open mobile sidebar\r\n- **WHEN** the user taps the hamburger menu button on a mobile viewport\r\n- **THEN** the sidebar slides in from the left as an overlay with a semi-transparent backdrop behind it\r\n\r\n#### Scenario: Close mobile sidebar via backdrop\r\n- **WHEN** the mobile sidebar overlay is open and the user taps the backdrop area\r\n- **THEN** the sidebar closes and the backdrop disappears\r\n\r\n#### Scenario: Close mobile sidebar via navigation\r\n- **WHEN** the mobile sidebar overlay is open and the user taps a navigation link\r\n- **THEN** the system navigates to the selected route and the sidebar closes automatically\r\n\r\n### Requirement: Responsive content grids\r\nThe system SHALL adapt grid layouts for different viewport sizes. Dashboard stat cards MUST use 2 columns on mobile and 4 columns on desktop. Navigation cards MUST stack vertically on mobile.\r\n\r\n#### Scenario: Dashboard stat cards on mobile\r\n- **WHEN** the Dashboard page is rendered on a viewport below 768px\r\n- **THEN** the stat cards are displayed in a 2-column grid\r\n\r\n#### Scenario: Dashboard stat cards on desktop\r\n- **WHEN** the Dashboard page is rendered on a viewport at or above 768px\r\n- **THEN** the stat cards are displayed in a 4-column grid\r\n\r\n### Requirement: Responsive header\r\nThe system SHALL adapt the header layout for mobile viewports. The repo path display MUST be hidden on mobile to save space. The search button MUST remain accessible.\r\n\r\n#### Scenario: Header on mobile\r\n- **WHEN** the header is rendered on a viewport below 768px\r\n- **THEN** the hamburger button is shown on the left, the search button is centered, and the repo path is hidden\r\n\r\n#### Scenario: Header on desktop\r\n- **WHEN** the header is rendered on a viewport at or above 768px\r\n- **THEN** the layout shows the spek brand on the left, search button centered, and repo path on the right\r\n","relatedChanges":["2026-02-13-phase4-polish-and-enhancement"],"history":[{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","timestamp":"2026-02-13T18:36:04+08:00","description":"phase4 polish and enhancement","status":"archived"}]},"search-api":{"topic":"search-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Full-text search endpoint\r\nThe system SHALL provide `GET /api/openspec/search` that searches across all specs and changes content.\r\n\r\n#### Scenario: Search with matching results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=effectiveCurrent`\r\n- **THEN** system returns a JSON array of results, each with `type` (\"spec\" or \"change\"), `name` (topic or slug), `matches` (array of matching text with context), and `score`\r\n- **AND** results are sorted by relevance score (best match first)\r\n\r\n#### Scenario: Search with no results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=xyznonexistent`\r\n- **THEN** system returns an empty array\r\n\r\n#### Scenario: Search without query parameter\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo` without `q` parameter\r\n- **THEN** system returns HTTP 400 with error message\r\n\r\n### Requirement: Search context preview\r\nEach search result SHALL include surrounding context to help users identify the relevant content.\r\n\r\n#### Scenario: Result includes context\r\n- **WHEN** a search matches text within a Markdown file\r\n- **THEN** the match includes up to 100 characters before and after the matched text as context preview\r\n","relatedChanges":["2026-02-13-phase1-skeleton-and-api"],"history":[{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","timestamp":"2026-02-13T17:37:45+08:00","description":"phase1 skeleton and api","status":"archived"}]},"search-ui":{"topic":"search-ui","content":"### Requirement: Search dialog activation\r\nThe system SHALL provide a search dialog that can be opened via keyboard shortcut or UI interaction.\r\n\r\n#### Scenario: Open search with keyboard shortcut\r\n- **WHEN** user presses `Cmd+K` (macOS) or `Ctrl+K` (other platforms) anywhere in the application\r\n- **THEN** a search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Open search via header button\r\n- **WHEN** user clicks the search button in the application header\r\n- **THEN** the search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Close search with Escape\r\n- **WHEN** the search dialog is open and user presses `Escape`\r\n- **THEN** the search dialog closes\r\n\r\n#### Scenario: Close search by clicking backdrop\r\n- **WHEN** the search dialog is open and user clicks outside the dialog\r\n- **THEN** the search dialog closes\r\n\r\n### Requirement: Search query execution\r\nThe system SHALL search across all specs and changes content by calling the backend search API with debounced input. Search results SHALL highlight matching text fragments in the title and context preview.\r\n\r\n#### Scenario: Debounced search on input\r\n- **WHEN** user types a query in the search input\r\n- **THEN** the system waits 300ms after the last keystroke before sending the search request\r\n\r\n#### Scenario: Display search results with highlights\r\n- **WHEN** the search API returns results\r\n- **THEN** results are displayed grouped by type (Specs and Changes), with matching query text highlighted using a contrasting background color in both the title and context snippet\r\n\r\n#### Scenario: No results found\r\n- **WHEN** the search API returns an empty array\r\n- **THEN** the dialog displays a \"No results found\" message with a suggestion to try different keywords\r\n\r\n#### Scenario: Empty query\r\n- **WHEN** the search input is empty\r\n- **THEN** no search request is made and the results area shows a prompt to start typing\r\n\r\n### Requirement: Search type filter\r\nThe system SHALL provide a type filter in the search dialog allowing users to narrow results by category: All, Specs only, or Changes only.\r\n\r\n#### Scenario: Filter by type\r\n- **WHEN** user selects \"Specs\" filter while search results are displayed\r\n- **THEN** only spec-type results are shown, change-type results are hidden\r\n\r\n#### Scenario: Default filter\r\n- **WHEN** the search dialog opens\r\n- **THEN** the \"All\" filter is selected by default, showing both spec and change results\r\n\r\n#### Scenario: Filter with no matching results\r\n- **WHEN** user selects a type filter and no results match that type\r\n- **THEN** a \"No results found\" message is displayed for that category\r\n\r\n### Requirement: Search result navigation\r\nThe system SHALL allow users to navigate to search results using keyboard or mouse.\r\n\r\n#### Scenario: Click to navigate\r\n- **WHEN** user clicks on a search result\r\n- **THEN** the application navigates to the corresponding page (`/specs/:topic` for spec results, `/changes/:slug` for change results) and the search dialog closes\r\n\r\n#### Scenario: Keyboard navigation with arrow keys\r\n- **WHEN** user presses the down arrow key in the search dialog\r\n- **THEN** the next result item is highlighted\r\n- **AND** pressing the up arrow key highlights the previous result item\r\n\r\n#### Scenario: Confirm selection with Enter\r\n- **WHEN** user presses Enter with a result item highlighted\r\n- **THEN** the application navigates to that result's page and the search dialog closes\r\n","relatedChanges":["2026-02-13-phase3-markdown-and-search","2026-02-16-ui-design-polish-p2"],"history":[{"slug":"2026-02-16-ui-design-polish-p2","date":"2026-02-16","timestamp":"2026-02-16T02:14:36+08:00","description":"ui design polish p2","status":"archived"},{"slug":"2026-02-13-phase3-markdown-and-search","date":"2026-02-13","timestamp":"2026-02-13T18:16:15+08:00","description":"phase3 markdown and search","status":"archived"}]},"shared-layout":{"topic":"shared-layout","content":"## ADDED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: an inline SVG logomark (S-curve with diamond accents, 24x24) followed by the \"spek\" brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button with `aria-label=\"Open navigation menu\"` and hide the repo path. The header SHALL also include a theme toggle button. The logomark SVG SHALL use `currentColor` to follow the accent color, ensuring theme compatibility.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the SVG logomark alongside \"spek\" brand text, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button with `aria-label=\"Open navigation menu\"`, the SVG logomark alongside \"spek\" brand text, search button, and theme toggle, but hides the repo path\r\n\r\n#### Scenario: Logo theme compatibility\r\n- **WHEN** the user toggles between dark and light theme\r\n- **THEN** the logomark color adjusts automatically via the accent color CSS variable\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a sidebar with navigation links: Overview (Dashboard), Specs, and Changes. Each link SHALL have an associated icon (LayoutDashboard for Overview, FileText for Specs, GitBranch for Changes). The current route SHALL be visually highlighted. On viewports below 768px, the sidebar SHALL be hidden by default and displayed as an overlay when toggled. On viewports at or above 768px, the sidebar SHALL support two states: expanded (240px width, showing icons and labels) and collapsed (56px width, showing icons only). A toggle button at the bottom of the sidebar SHALL switch between states. The main content area left margin SHALL adjust to match the current sidebar width.\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes with corresponding icons\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n#### Scenario: Sidebar on mobile viewport\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar is hidden by default and only shown when the hamburger menu is activated\r\n\r\n#### Scenario: Sidebar expanded on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is expanded\r\n- **THEN** the sidebar is displayed at 240px width with icons and text labels, and main content has matching left margin\r\n\r\n#### Scenario: Sidebar collapsed on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is collapsed\r\n- **THEN** the sidebar is displayed at 56px width with icons only, and main content has matching left margin\r\n\r\n### Requirement: TaskProgress component\r\nThe system SHALL provide a reusable TaskProgress component that displays a progress bar with completed/total count. The progress bar color SHALL reflect completion status: amber/accent color when incomplete, green when all tasks are completed (completed equals total).\r\n\r\n#### Scenario: Display progress\r\n- **WHEN** TaskProgress is rendered with `completed=3` and `total=5`\r\n- **THEN** a progress bar at 60% width is shown in amber/accent color with text \"3 / 5\"\r\n\r\n#### Scenario: Display completed progress\r\n- **WHEN** TaskProgress is rendered with `completed=5` and `total=5`\r\n- **THEN** a progress bar at 100% width is shown in green color with text \"5 / 5\"\r\n\r\n#### Scenario: Zero tasks\r\n- **WHEN** TaskProgress is rendered with `total=0`\r\n- **THEN** component displays \"No tasks\" or an empty state\r\n\r\n### Requirement: TabView component\r\nThe system SHALL provide a reusable TabView component that renders tab headers and switches between tab content panels. When switching tabs, the new content panel SHALL fade in with a 150ms CSS animation.\r\n\r\n#### Scenario: Switch tabs\r\n- **WHEN** user clicks a tab header\r\n- **THEN** the corresponding tab content panel is displayed with a fade-in animation (150ms duration) and the previous panel is hidden\r\n\r\n#### Scenario: Default tab\r\n- **WHEN** TabView is first rendered\r\n- **THEN** the first tab is selected by default\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** tab content switches instantly without fade animation\r\n\r\n### Requirement: Custom typography\r\nThe system SHALL use \"Plus Jakarta Sans\" as the primary font family for all UI text, loaded via Google Fonts CDN. The font stack SHALL include `sans-serif` as fallback for offline environments. Code and monospace text SHALL continue to use \"JetBrains Mono\".\r\n\r\n#### Scenario: Font loading\r\n- **WHEN** the application loads in a browser with internet access\r\n- **THEN** \"Plus Jakarta Sans\" is loaded and applied to all non-code text elements\r\n\r\n#### Scenario: Font fallback\r\n- **WHEN** the application loads without internet access (or Google Fonts is blocked)\r\n- **THEN** the browser falls back to the system default sans-serif font\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** the user has `prefers-reduced-motion: reduce` set in their OS/browser\r\n- **THEN** all CSS entry animations are disabled\r\n\r\n### Requirement: Main content area top spacing\r\nThe system SHALL render the main content area with sufficient top spacing below the fixed header to provide visual breathing room between the navbar and page content. The top padding SHALL be at least 72px (header height 56px + 16px spacing).\r\n\r\n#### Scenario: Page title spacing\r\n- **WHEN** any page is rendered within the Layout\r\n- **THEN** the first content element (typically h1) has at least 16px of visual spacing below the header bar\r\n\r\n### Requirement: Back navigation link styling\r\nThe system SHALL render back navigation links (e.g., \"← Back to Specs\", \"← Back to Changes\") at base font size (16px) with medium font weight for adequate visibility and clickability.\r\n\r\n#### Scenario: Back link display\r\n- **WHEN** user views a detail page (SpecDetail or ChangeDetail)\r\n- **THEN** the back navigation link is displayed at 16px font size with medium weight, muted color, and accent color on hover\r\n","relatedChanges":["2026-02-13-apply-brand-logo","2026-02-13-phase2-core-ui-pages","2026-02-13-phase4-polish-and-enhancement","2026-02-14-add-sidebar-toggle","2026-02-16-ui-design-polish-p0-p1","2026-02-16-ui-design-polish-p2"],"history":[{"slug":"2026-02-16-ui-design-polish-p2","date":"2026-02-16","timestamp":"2026-02-16T02:14:36+08:00","description":"ui design polish p2","status":"archived"},{"slug":"2026-02-16-ui-design-polish-p0-p1","date":"2026-02-16","timestamp":"2026-02-16T01:41:38+08:00","description":"ui design polish p0 p1","status":"archived"},{"slug":"2026-02-14-add-sidebar-toggle","date":"2026-02-14","timestamp":"2026-02-14T12:25:29+08:00","description":"add sidebar toggle","status":"archived"},{"slug":"2026-02-13-apply-brand-logo","date":"2026-02-13","timestamp":"2026-02-13T22:23:07+08:00","description":"apply brand logo","status":"archived"},{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","timestamp":"2026-02-13T18:36:04+08:00","description":"phase4 polish and enhancement","status":"archived"},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"sidebar-toggle":{"topic":"sidebar-toggle","content":"## ADDED Requirements\r\n\r\n### Requirement: Sidebar collapse toggle button\r\nThe system SHALL display a toggle button at the bottom of the sidebar (above the Resync button) that collapses or expands the sidebar. The button SHALL display a left-pointing chevron (`«`) when the sidebar is expanded and a right-pointing chevron (`»`) when collapsed.\r\n\r\n#### Scenario: Toggle sidebar from expanded to collapsed\r\n- **WHEN** the sidebar is expanded and the user clicks the toggle button\r\n- **THEN** the sidebar collapses to 56px width showing only navigation icons\r\n\r\n#### Scenario: Toggle sidebar from collapsed to expanded\r\n- **WHEN** the sidebar is collapsed and the user clicks the toggle button\r\n- **THEN** the sidebar expands to the full 240px width showing icons and labels\r\n\r\n### Requirement: Collapsed sidebar icon-only navigation\r\nThe system SHALL display navigation items as icon-only buttons when the sidebar is collapsed. Each navigation link SHALL display a corresponding icon: LayoutDashboard icon for Overview, FileText icon for Specs, and GitBranch icon for Changes. Each icon button SHALL include a `title` attribute showing the full link label.\r\n\r\n#### Scenario: Display collapsed navigation with icons\r\n- **WHEN** the sidebar is in collapsed state\r\n- **THEN** navigation items display as icon-only buttons with tooltips\r\n\r\n#### Scenario: Navigate from collapsed sidebar\r\n- **WHEN** the user clicks a navigation icon in collapsed state\r\n- **THEN** the app navigates to the corresponding route\r\n\r\n#### Scenario: Active route indication in collapsed state\r\n- **WHEN** the user is on the Specs page and sidebar is collapsed\r\n- **THEN** the Specs icon is highlighted with the accent color\r\n\r\n### Requirement: Collapsed sidebar Resync button\r\nThe system SHALL display the Resync button as icon-only in collapsed state, without the text label, and with a `title` attribute for tooltip.\r\n\r\n#### Scenario: Resync button in collapsed state\r\n- **WHEN** the sidebar is collapsed\r\n- **THEN** the Resync button displays only the sync icon with a tooltip\r\n\r\n### Requirement: Sidebar collapse state persistence\r\nThe system SHALL persist the sidebar collapse state to localStorage (key: `spek-sidebar-collapsed`) in the web version. On page load, the sidebar SHALL restore the previously saved state. In VS Code webview, the state SHALL default to expanded and not persist across sessions.\r\n\r\n#### Scenario: Persist collapsed state in web version\r\n- **WHEN** the user collapses the sidebar and refreshes the page\r\n- **THEN** the sidebar remains collapsed after reload\r\n\r\n#### Scenario: Default state in VS Code webview\r\n- **WHEN** the webview is first opened\r\n- **THEN** the sidebar is in expanded state\r\n\r\n### Requirement: Sidebar transition animation\r\nThe system SHALL animate the sidebar width change and main content margin with a smooth CSS transition (200ms duration).\r\n\r\n#### Scenario: Smooth collapse animation\r\n- **WHEN** the user clicks the toggle button\r\n- **THEN** the sidebar width and main content margin animate smoothly over 200ms\r\n\r\n### Requirement: Mobile behavior unchanged\r\nThe sidebar toggle feature SHALL only apply to desktop viewports (768px and above). On mobile viewports, the existing overlay sidebar behavior SHALL remain unchanged.\r\n\r\n#### Scenario: Mobile viewport ignores collapse state\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar uses the existing overlay behavior regardless of collapse state\r\n","relatedChanges":["2026-02-14-add-sidebar-toggle"],"history":[{"slug":"2026-02-14-add-sidebar-toggle","date":"2026-02-14","timestamp":"2026-02-14T12:25:29+08:00","description":"add sidebar toggle","status":"archived"}]},"spa-routing":{"topic":"spa-routing","content":"## ADDED Requirements\r\n\r\n### Requirement: Client-side routing\r\nThe system SHALL use React Router v7 with `createBrowserRouter` to define the following routes:\r\n\r\n| Path | Page | Layout |\r\n|------|------|--------|\r\n| `/` | SelectRepo | None |\r\n| `/dashboard` | Dashboard | Layout |\r\n| `/specs` | SpecList | Layout |\r\n| `/specs/:topic` | SpecDetail | Layout |\r\n| `/changes` | ChangeList | Layout |\r\n| `/changes/:slug` | ChangeDetail | Layout |\r\n\r\n#### Scenario: Route to SelectRepo\r\n- **WHEN** user navigates to `/`\r\n- **THEN** the SelectRepo page is rendered without Layout wrapper\r\n\r\n#### Scenario: Route to Dashboard with Layout\r\n- **WHEN** user navigates to `/dashboard`\r\n- **THEN** the Dashboard page is rendered within the shared Layout (Header + Sidebar + Main)\r\n\r\n### Requirement: RepoContext state management\r\nThe system SHALL provide a React Context (`RepoContext`) that stores the current repo path. All API hooks SHALL read the repo path from this context.\r\n\r\n#### Scenario: Set repo path\r\n- **WHEN** user selects a repo on the SelectRepo page\r\n- **THEN** `RepoContext.repoPath` is updated and available to all child components\r\n\r\n#### Scenario: Redirect when no repo selected\r\n- **WHEN** user navigates to any page other than `/` without a repo path in context\r\n- **THEN** system redirects to `/`\r\n\r\n### Requirement: API hooks\r\nThe system SHALL provide custom React hooks in `useOpenSpec.ts` that encapsulate API calls. Each hook SHALL return `{ data, loading, error }` and automatically include the `dir` query parameter from RepoContext.\r\n\r\n#### Scenario: Hook returns loading state\r\n- **WHEN** an API hook is called and the request is in flight\r\n- **THEN** hook returns `{ data: null, loading: true, error: null }`\r\n\r\n#### Scenario: Hook returns data\r\n- **WHEN** the API request succeeds\r\n- **THEN** hook returns `{ data: <response>, loading: false, error: null }`\r\n\r\n#### Scenario: Hook returns error\r\n- **WHEN** the API request fails\r\n- **THEN** hook returns `{ data: null, loading: false, error: <error message> }`\r\n","relatedChanges":["2026-02-13-phase2-core-ui-pages"],"history":[{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"spec-browsing":{"topic":"spec-browsing","content":"## ADDED Requirements\r\n\r\n### Requirement: Spec list with filtering\r\nThe system SHALL display all specs sorted alphabetically with history count metadata. A filter input SHALL allow instant client-side filtering by spec topic name. Each spec item SHALL display the topic name and the number of related changes (history count) as secondary information.\r\n\r\n#### Scenario: Display all specs\r\n- **WHEN** user navigates to the SpecList page\r\n- **THEN** all spec topics are listed alphabetically, each showing the topic name and history change count\r\n\r\n#### Scenario: Filter specs\r\n- **WHEN** user types in the filter input\r\n- **THEN** the list is filtered in real-time to show only specs whose topic name contains the search text (case-insensitive)\r\n\r\n#### Scenario: Spec with no history\r\n- **WHEN** a spec has zero related changes\r\n- **THEN** the history count is not displayed (or shows \"No changes\")\r\n\r\n### Requirement: Spec detail display\r\nThe system SHALL display the full content of a spec when the user navigates to its detail page. The raw markdown content SHALL be shown (react-markdown rendering deferred to Phase 3).\r\n\r\n#### Scenario: View spec content\r\n- **WHEN** user navigates to `/specs/:topic`\r\n- **THEN** system displays the spec topic as title and the full spec.md content\r\n\r\n#### Scenario: Spec not found\r\n- **WHEN** user navigates to a spec topic that does not exist\r\n- **THEN** system displays a \"not found\" message\r\n\r\n### Requirement: Related changes display\r\nThe spec detail page SHALL display a list of changes that affect the spec (from the API's `relatedChanges` field). Each change SHALL be a link to its detail page.\r\n\r\n#### Scenario: Show related changes\r\n- **WHEN** viewing a spec that has related changes\r\n- **THEN** a \"Related Changes\" section lists each change as a clickable link to `/changes/:slug`\r\n\r\n#### Scenario: No related changes\r\n- **WHEN** viewing a spec with no related changes\r\n- **THEN** the \"Related Changes\" section shows an empty state message\r\n","relatedChanges":["2026-02-13-phase2-core-ui-pages","2026-02-16-ui-design-polish-p2"],"history":[{"slug":"2026-02-16-ui-design-polish-p2","date":"2026-02-16","timestamp":"2026-02-16T02:14:36+08:00","description":"ui design polish p2","status":"archived"},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","timestamp":"2026-02-13T18:00:19+08:00","description":"phase2 core ui pages","status":"archived"}]},"spec-history":{"topic":"spec-history","content":"## ADDED Requirements\r\n\r\n### Requirement: Spec history data in API response\r\nThe system SHALL include a `history` array in the `GET /api/openspec/specs/:topic` response. Each entry MUST contain the change slug, date (if parseable from slug), timestamp (ISO 8601 from git commit cache, or null if unavailable), description, and status (active or archived).\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** a spec has been affected by one or more changes (i.e., changes that contain a delta spec for this topic)\r\n- **THEN** the API response includes a `history` array with entries sorted by git commit timestamp descending (most recent first)\r\n- **AND** if two entries have the same date, the git commit timestamp determines their order\r\n- **AND** each entry contains `{ slug, date, timestamp, description, status }`\r\n\r\n#### Scenario: Spec with no related changes\r\n- **WHEN** a spec has no related changes\r\n- **THEN** the API response includes an empty `history` array\r\n\r\n#### Scenario: Fallback sorting when git timestamp unavailable\r\n- **WHEN** a history entry has no git commit timestamp (e.g., uncommitted change or non-git repo)\r\n- **THEN** the entry's `timestamp` field is null\r\n- **AND** sorting falls back to the date parsed from the slug\r\n\r\n### Requirement: Spec history timeline UI\r\nThe system SHALL display a visual timeline on the SpecDetail page showing all changes that affected the spec. Each timeline entry MUST display the date, change description, and a link to the change detail page.\r\n\r\n#### Scenario: Display history timeline\r\n- **WHEN** the SpecDetail page is rendered for a spec with related changes\r\n- **THEN** a \"History\" section is displayed with a vertical timeline showing each change chronologically\r\n\r\n#### Scenario: Timeline entry links to change\r\n- **WHEN** the user clicks on a timeline entry\r\n- **THEN** the system navigates to the corresponding change detail page\r\n\r\n#### Scenario: No history\r\n- **WHEN** the SpecDetail page is rendered for a spec with no related changes\r\n- **THEN** the \"History\" section displays a message indicating no changes have affected this spec\r\n","relatedChanges":["spec-diff-viewer","2026-02-13-phase4-polish-and-enhancement","2026-02-13-spec-history-git-timestamp-cache"],"history":[{"slug":"2026-02-13-spec-history-git-timestamp-cache","date":"2026-02-13","timestamp":"2026-02-13T19:19:25+08:00","description":"spec history git timestamp cache","status":"archived"},{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","timestamp":"2026-02-13T18:36:04+08:00","description":"phase4 polish and enhancement","status":"archived"},{"slug":"spec-diff-viewer","date":null,"timestamp":null,"description":"spec diff viewer","status":"active"}]},"task-parser":{"topic":"task-parser","content":"## ADDED Requirements\r\n\r\n### Requirement: Parse task checkboxes\r\nThe task parser SHALL be a pure function in the `@spek/core` package that reads a tasks.md content string and extracts checkbox items with their completion status. It SHALL have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Parse file with mixed checkboxes\r\n- **WHEN** parser receives a string containing `- [x] Done task` and `- [ ] Pending task`\r\n- **THEN** it returns each task with `text` and `completed` (boolean) fields\r\n\r\n### Requirement: Group tasks by section\r\nThe task parser SHALL group tasks under their `##` heading sections.\r\n\r\n#### Scenario: Tasks under multiple sections\r\n- **WHEN** parser receives a string with `## Phase 1` followed by tasks and `## Phase 2` followed by tasks\r\n- **THEN** it returns sections array, each with `title` and `tasks` array\r\n\r\n#### Scenario: Tasks without section headings\r\n- **WHEN** parser receives a string where tasks appear before any `##` heading\r\n- **THEN** those tasks are grouped under a default section with empty title\r\n\r\n### Requirement: Calculate task statistics\r\nThe task parser SHALL compute aggregate statistics from parsed tasks.\r\n\r\n#### Scenario: Calculate completion stats\r\n- **WHEN** parser processes a string with 10 total checkboxes where 7 are checked\r\n- **THEN** it returns `{ total: 10, completed: 7 }` along with the sections breakdown\r\n\r\n#### Scenario: Empty tasks file\r\n- **WHEN** parser processes an empty string or one with no checkboxes\r\n- **THEN** it returns `{ total: 0, completed: 0, sections: [] }`\r\n","relatedChanges":["2026-02-13-phase1-skeleton-and-api","2026-02-13-vscode-extension"],"history":[{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"},{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","timestamp":"2026-02-13T17:37:45+08:00","description":"phase1 skeleton and api","status":"archived"}]},"theme-toggle":{"topic":"theme-toggle","content":"## ADDED Requirements\r\n\r\n### Requirement: Theme state management\r\nThe system SHALL provide a ThemeContext that manages the current theme (\"dark\" or \"light\") and exposes a toggle function. The theme state MUST be persisted in localStorage under the key `spek:theme`.\r\n\r\n#### Scenario: Initialize from localStorage\r\n- **WHEN** the application loads and localStorage contains a saved theme preference\r\n- **THEN** the system applies the saved theme\r\n\r\n#### Scenario: Initialize from system preference\r\n- **WHEN** the application loads and no theme is saved in localStorage\r\n- **AND** the user's system preference is light mode (`prefers-color-scheme: light`)\r\n- **THEN** the system applies the light theme\r\n\r\n#### Scenario: Initialize default\r\n- **WHEN** the application loads and no theme is saved and no system preference is detected\r\n- **THEN** the system applies the dark theme as default\r\n\r\n#### Scenario: Toggle theme\r\n- **WHEN** the user triggers the theme toggle\r\n- **THEN** the current theme switches (dark → light or light → dark)\r\n- **AND** the new preference is saved to localStorage\r\n- **AND** the `data-theme` attribute on `<html>` is updated\r\n\r\n### Requirement: Light theme CSS variables\r\nThe system SHALL define a complete set of light theme CSS variables that override the dark theme defaults when `[data-theme=\"light\"]` is set on the `<html>` element.\r\n\r\n#### Scenario: Light theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"light\"`\r\n- **THEN** all color CSS variables (`--color-bg-primary`, `--color-bg-secondary`, `--color-bg-tertiary`, `--color-border`, `--color-text-primary`, `--color-text-secondary`, `--color-text-muted`, `--color-accent`, `--color-accent-hover`) are overridden with light-appropriate values\r\n\r\n#### Scenario: Dark theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"dark\"` or no `data-theme` attribute\r\n- **THEN** the default dark theme CSS variables are used\r\n\r\n### Requirement: Theme toggle button\r\nThe system SHALL display a theme toggle button in the header. The button MUST show a sun icon when in dark mode (indicating \"switch to light\") and a moon icon when in light mode (indicating \"switch to dark\").\r\n\r\n#### Scenario: Display toggle in header\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** a theme toggle button is visible in the header area\r\n\r\n#### Scenario: Icon reflects current theme\r\n- **WHEN** the current theme is dark\r\n- **THEN** the toggle button displays a sun icon\r\n- **WHEN** the current theme is light\r\n- **THEN** the toggle button displays a moon icon\r\n","relatedChanges":["2026-02-13-phase4-polish-and-enhancement"],"history":[{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","timestamp":"2026-02-13T18:36:04+08:00","description":"phase4 polish and enhancement","status":"archived"}]},"vscode-cicd":{"topic":"vscode-cicd","content":"### Requirement: Tag-triggered publish workflow\r\n系統 SHALL 提供 GitHub Actions workflow，於 push 符合 `v*` pattern 的 tag 時自動觸發 VS Code extension 的 build 與 publish 流程。\r\n\r\n#### Scenario: Push version tag triggers workflow\r\n- **WHEN** 開發者 push 一個 `v0.2.0` 格式的 tag\r\n- **THEN** GitHub Actions workflow 自動觸發並執行完整 build chain\r\n\r\n#### Scenario: Non-matching tag does not trigger\r\n- **WHEN** 開發者 push 一個 `release-0.2.0` 或 `feat/something` 格式的 ref\r\n- **THEN** 此 workflow 不被觸發\r\n\r\n### Requirement: Full build chain execution\r\nWorkflow SHALL 依序執行完整 build chain：install dependencies → build @spek/core → build webview assets → build VS Code extension。\r\n\r\n#### Scenario: Build chain completes successfully\r\n- **WHEN** workflow 被觸發且所有 build 步驟成功\r\n- **THEN** `packages/vscode/dist/extension.js` 和 webview assets 皆存在且為最新\r\n\r\n#### Scenario: Build failure stops pipeline\r\n- **WHEN** 任一 build 步驟失敗\r\n- **THEN** 後續步驟不執行，workflow 標記為失敗\r\n\r\n### Requirement: Marketplace publish\r\nWorkflow SHALL 使用 `VSCE_PAT` secret 透過 `vsce publish` 將 extension 發佈到 VS Code Marketplace。\r\n\r\n#### Scenario: Successful publish\r\n- **WHEN** build chain 完成且 `VSCE_PAT` secret 有效\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Missing PAT secret\r\n- **WHEN** `VSCE_PAT` secret 未設定或已過期\r\n- **THEN** publish 步驟失敗，workflow 標記為失敗\r\n\r\n### Requirement: Manual trigger support\r\nWorkflow SHALL 支援 `workflow_dispatch` 手動觸發，方便除錯和測試。\r\n\r\n#### Scenario: Manual trigger from Actions UI\r\n- **WHEN** 開發者在 GitHub Actions UI 手動觸發此 workflow\r\n- **THEN** workflow 執行完整 build + publish 流程\r\n\r\n### Requirement: Version consistency check\r\nWorkflow SHALL 在 publish 前驗證 tag 版號與 `packages/vscode/package.json` 中的 version 欄位一致。\r\n\r\n#### Scenario: Version matches\r\n- **WHEN** tag `v0.2.0` 且 package.json version 為 `0.2.0`\r\n- **THEN** 繼續執行 publish\r\n\r\n#### Scenario: Version mismatch\r\n- **WHEN** tag `v0.3.0` 但 package.json version 為 `0.2.0`\r\n- **THEN** workflow 失敗並輸出版號不一致的錯誤訊息\r\n","relatedChanges":["2026-02-14-vscode-cicd-publish"],"history":[{"slug":"2026-02-14-vscode-cicd-publish","date":"2026-02-14","timestamp":"2026-02-14T14:50:30+08:00","description":"vscode cicd publish","status":"archived"}]},"vscode-extension-host":{"topic":"vscode-extension-host","content":"## ADDED Requirements\r\n\r\n### Requirement: Extension activation\r\nThe extension SHALL activate when a workspace containing an `openspec/` directory is opened, or when the user explicitly invokes a spek command.\r\n\r\n#### Scenario: Workspace with openspec directory\r\n- **WHEN** VS Code opens a workspace where the first workspace folder contains an `openspec/` directory\r\n- **THEN** the extension activates and displays a spek icon in the status bar\r\n\r\n#### Scenario: Workspace without openspec directory\r\n- **WHEN** VS Code opens a workspace without an `openspec/` directory\r\n- **THEN** the extension remains inactive and no status bar icon is shown\r\n\r\n#### Scenario: Manual activation via command\r\n- **WHEN** the user invokes the `spek.open` command from the command palette\r\n- **THEN** the extension activates and opens the spek Webview Panel\r\n\r\n### Requirement: Webview Panel lifecycle\r\nThe extension SHALL manage a single Webview Panel instance for displaying the spek UI.\r\n\r\n#### Scenario: Open spek panel\r\n- **WHEN** the user invokes `spek.open` and no panel exists\r\n- **THEN** the extension creates a new Webview Panel in the active editor column with the title \"spek\"\r\n\r\n#### Scenario: Focus existing panel\r\n- **WHEN** the user invokes `spek.open` and a panel already exists\r\n- **THEN** the extension reveals (focuses) the existing panel instead of creating a new one\r\n\r\n#### Scenario: Panel disposal\r\n- **WHEN** the user closes the spek Webview Panel\r\n- **THEN** the extension cleans up the panel reference and associated message listeners\r\n\r\n### Requirement: Command registration\r\nThe extension SHALL register commands in the VS Code command palette.\r\n\r\n#### Scenario: Available commands\r\n- **WHEN** the extension is active\r\n- **THEN** the following commands are available: `spek.open` (Open spek) and `spek.search` (Search OpenSpec)\r\n\r\n#### Scenario: Search command\r\n- **WHEN** the user invokes `spek.search`\r\n- **THEN** the extension opens (or focuses) the spek panel and sends a message to trigger the search dialog\r\n\r\n### Requirement: Message handler for API requests\r\nThe extension host SHALL handle message-based API requests from the Webview and return responses using core module functions.\r\n\r\n#### Scenario: Handle API request\r\n- **WHEN** the Webview sends a message `{ type: 'request', id: 'req-1', method: 'getOverview' }`\r\n- **THEN** the extension host calls the corresponding core module function and replies with `{ type: 'response', id: 'req-1', data: <result> }`\r\n\r\n#### Scenario: Handle API error\r\n- **WHEN** the Webview sends a request and the core module function throws an error\r\n- **THEN** the extension host replies with `{ type: 'response', id: 'req-1', error: <error message> }`\r\n","relatedChanges":["2026-02-13-vscode-extension"],"history":[{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"}]},"vscode-marketplace-metadata":{"topic":"vscode-marketplace-metadata","content":"### Requirement: Marketplace-ready package.json\r\nExtension 的 `package.json` SHALL 包含所有 VS Code Marketplace 發佈所需的欄位。\r\n\r\n#### Scenario: Required fields present\r\n- **WHEN** 執行 `vsce package` 打包 extension\r\n- **THEN** package.json 包含以下欄位且無 validation 錯誤：`publisher`、`repository`、`license`、`icon`、`categories`、`keywords`\r\n\r\n#### Scenario: Private flag removed\r\n- **WHEN** package.json 被讀取\r\n- **THEN** `\"private\"` 欄位 SHALL 不存在或為 `false`\r\n\r\n#### Scenario: Icon file exists\r\n- **WHEN** package.json 指定 `\"icon\": \"icon.png\"`\r\n- **THEN** `packages/vscode/icon.png` 檔案存在且為 128x128 以上的 PNG 圖片\r\n\r\n### Requirement: Marketplace README\r\nExtension 目錄下 SHALL 有獨立的 `README.md` 作為 Marketplace 頁面內容。\r\n\r\n#### Scenario: README content\r\n- **WHEN** Marketplace 頁面載入\r\n- **THEN** 顯示 extension 的功能說明、安裝方式與使用說明\r\n\r\n#### Scenario: README exists in extension directory\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `packages/vscode/README.md` 被包含在 `.vsix` 中\r\n\r\n### Requirement: Extension version and changelog\r\nExtension SHALL 維護 CHANGELOG.md 記錄每個版本的功能異動，且 package.json version 欄位 SHALL 與最新 CHANGELOG entry 一致。\r\n\r\n#### Scenario: CHANGELOG content\r\n- **WHEN** 使用者在 Marketplace 或 VS Code 中檢視 extension 的 changelog\r\n- **THEN** 顯示按版本分組的變更記錄\r\n\r\n#### Scenario: Version bump with new feature\r\n- **WHEN** 新功能已實作完成\r\n- **THEN** package.json version 更新且 CHANGELOG.md 包含對應版本區塊描述新功能\r\n\r\n### Requirement: vscodeignore configuration\r\n`.vscodeignore` SHALL 排除不需要包含在 `.vsix` 中的檔案，減少套件大小。\r\n\r\n#### Scenario: Source files excluded\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `src/`、`node_modules/`、`tsconfig.json`、`.gitignore` 不被包含在 `.vsix` 中\r\n\r\n#### Scenario: Required files included\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `dist/`、`webview/`、`icon.png`、`README.md`、`CHANGELOG.md`、`LICENSE` 被包含在 `.vsix` 中\r\n\r\n### Requirement: Publish workflow\r\n使用者 SHALL 能透過 `vsce` CLI 將 extension 發佈到 Marketplace。\r\n\r\n#### Scenario: First-time publish\r\n- **WHEN** 使用者執行 `vsce login <publisher>` 並輸入有效的 PAT\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Version update publish\r\n- **WHEN** 使用者更新 package.json 版本號\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** Marketplace 上的 extension 更新到新版本\r\n","relatedChanges":["2026-02-13-vscode-marketplace-publish","2026-02-14-add-changelog-entry"],"history":[{"slug":"2026-02-14-add-changelog-entry","date":"2026-02-14","timestamp":"2026-02-14T12:39:38+08:00","description":"add changelog entry","status":"archived"},{"slug":"2026-02-13-vscode-marketplace-publish","date":"2026-02-13","timestamp":"2026-02-13T22:58:03+08:00","description":"vscode marketplace publish","status":"archived"}]},"webview-integration":{"topic":"webview-integration","content":"## ADDED Requirements\r\n\r\n### Requirement: Load React SPA in Webview\r\nThe Webview SHALL load the spek React application from the extension's bundled assets.\r\n\r\n#### Scenario: Webview HTML generation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** it generates an HTML document that loads the built React bundle with asset paths converted via `webview.asWebviewUri()`\r\n\r\n#### Scenario: Asset path resolution\r\n- **WHEN** the Webview HTML references JS or CSS files\r\n- **THEN** all asset paths SHALL use `webview.asWebviewUri()` to convert local file paths to Webview-safe URIs\r\n\r\n### Requirement: Content Security Policy\r\nThe Webview SHALL enforce a Content Security Policy that allows the React application to function while preventing unauthorized content.\r\n\r\n#### Scenario: CSP configuration\r\n- **WHEN** the Webview HTML is generated\r\n- **THEN** it includes a CSP meta tag that allows scripts and styles from the extension's webview URI origin with a unique nonce, and disallows inline scripts without the nonce\r\n\r\n#### Scenario: Tailwind CSS compatibility\r\n- **WHEN** Tailwind CSS styles are loaded in the Webview\r\n- **THEN** all styles SHALL be loaded from external CSS files (not inline style tags) to comply with CSP\r\n\r\n### Requirement: Workspace path injection\r\nThe Webview SHALL receive the workspace path from the extension host so the React app can skip the repo selection page.\r\n\r\n#### Scenario: Initial workspace path\r\n- **WHEN** the Webview is created in a workspace with an `openspec/` directory\r\n- **THEN** the extension host sends a `{ type: 'init', workspacePath: '/path/to/repo' }` message after the Webview is ready\r\n\r\n#### Scenario: Webview ready handshake\r\n- **WHEN** the React app finishes mounting in the Webview\r\n- **THEN** it sends a `{ type: 'ready' }` message to the extension host to signal it can receive the workspace path\r\n\r\n### Requirement: Theme synchronization\r\nThe Webview SHALL respect the VS Code color theme.\r\n\r\n#### Scenario: Dark theme active\r\n- **WHEN** VS Code is using a dark color theme\r\n- **THEN** the Webview renders the spek dark theme\r\n\r\n#### Scenario: Light theme active\r\n- **WHEN** VS Code is using a light color theme\r\n- **THEN** the Webview renders the spek light theme\r\n\r\n#### Scenario: Theme change\r\n- **WHEN** the user changes the VS Code color theme while the Webview is open\r\n- **THEN** the Webview updates its theme to match\r\n\r\n### Requirement: Tab icon display\r\nThe Webview Panel SHALL display the spek logo as the tab icon for visual identification.\r\n\r\n#### Scenario: Tab icon is set on panel creation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** the panel's `iconPath` SHALL be set to the `webview/favicon.svg` file from the extension's bundled assets\r\n\r\n#### Scenario: Icon visibility across themes\r\n- **WHEN** the tab icon is displayed in either light or dark VS Code theme\r\n- **THEN** the icon SHALL be visually distinguishable against the tab bar background\r\n","relatedChanges":["2026-02-13-vscode-extension","2026-02-17-add-vscode-tab-icon"],"history":[{"slug":"2026-02-17-add-vscode-tab-icon","date":"2026-02-17","timestamp":"2026-02-17T10:47:36+08:00","description":"add vscode tab icon","status":"archived"},{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","timestamp":"2026-02-13T22:10:22+08:00","description":"vscode extension","status":"archived"}]}},"changes":{"active":[{"slug":"spec-diff-viewer","date":null,"description":"spec diff viewer","status":"active","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":18,"completed":15}}],"archived":[{"slug":"2026-02-17-add-vscode-tab-icon","date":"2026-02-17","description":"add vscode tab icon","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":2,"completed":2}},{"slug":"2026-02-16-ui-design-polish-p0-p1","date":"2026-02-16","description":"ui design polish p0 p1","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":12,"completed":12}},{"slug":"2026-02-16-ui-design-polish-p2","date":"2026-02-16","description":"ui design polish p2","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":16,"completed":16}},{"slug":"2026-02-15-add-demo-link-to-readme","date":"2026-02-15","description":"add demo link to readme","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":2,"completed":2}},{"slug":"2026-02-15-add-demo-page","date":"2026-02-15","description":"add demo page","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":8,"completed":8}},{"slug":"2026-02-15-add-frontend-design-skill","date":"2026-02-15","description":"add frontend design skill","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":4,"completed":4}},{"slug":"2026-02-15-add-readme-acknowledgments","date":"2026-02-15","description":"add readme acknowledgments","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":2,"completed":2}},{"slug":"2026-02-14-add-changelog-entry","date":"2026-02-14","description":"add changelog entry","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":5,"completed":5}},{"slug":"2026-02-14-add-readme-screenshots","date":"2026-02-14","description":"add readme screenshots","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":12,"completed":12}},{"slug":"2026-02-14-add-sidebar-toggle","date":"2026-02-14","description":"add sidebar toggle","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":12,"completed":12}},{"slug":"2026-02-14-vscode-cicd-publish","date":"2026-02-14","description":"vscode cicd publish","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":9,"completed":9}},{"slug":"2026-02-13-add-readme","date":"2026-02-13","description":"add readme","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":6,"completed":6}},{"slug":"2026-02-13-apply-brand-logo","date":"2026-02-13","description":"apply brand logo","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":5,"completed":5}},{"slug":"2026-02-13-fix-task-stats-and-capability-nav","date":"2026-02-13","description":"fix task stats and capability nav","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":7,"completed":7}},{"slug":"2026-02-13-initial-implementation","date":"2026-02-13","description":"initial implementation","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":false,"taskStats":{"total":10,"completed":10}},{"slug":"2026-02-13-phase1-skeleton-and-api","date":"2026-02-13","description":"phase1 skeleton and api","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":25,"completed":25}},{"slug":"2026-02-13-phase2-core-ui-pages","date":"2026-02-13","description":"phase2 core ui pages","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":27,"completed":27}},{"slug":"2026-02-13-phase3-markdown-and-search","date":"2026-02-13","description":"phase3 markdown and search","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":13,"completed":13}},{"slug":"2026-02-13-phase4-polish-and-enhancement","date":"2026-02-13","description":"phase4 polish and enhancement","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":21,"completed":21}},{"slug":"2026-02-13-push-to-github","date":"2026-02-13","description":"push to github","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":4,"completed":4}},{"slug":"2026-02-13-spec-history-git-timestamp-cache","date":"2026-02-13","description":"spec history git timestamp cache","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":8,"completed":8}},{"slug":"2026-02-13-vscode-extension","date":"2026-02-13","description":"vscode extension","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":32,"completed":32}},{"slug":"2026-02-13-vscode-marketplace-publish","date":"2026-02-13","description":"vscode marketplace publish","status":"archived","hasProposal":true,"hasDesign":true,"hasTasks":true,"hasSpecs":true,"taskStats":{"total":14,"completed":14}}]},"changeDetails":{"spec-diff-viewer":{"slug":"spec-diff-viewer","proposal":"## Why\r\n\r\nspek 目前的 spec 頁面透過 history timeline 呈現 spec 的演進記錄，但使用者只能看到「哪些 change 影響了這個 spec」，卻無法比較不同版本之間的具體文字差異。加入 diff 檢視功能，讓使用者可以直觀看到每次變更新增、修改、刪除了哪些需求，將 spek 從「靜態檢視器」升級為「spec 演進追蹤工具」。\r\n\r\n## What Changes\r\n\r\n- 新增 core 函式 `readSpecAtChange`，讀取特定 change 中的 spec 歷史版本內容\r\n- 新增 API endpoint `GET /api/openspec/specs/:topic/at/:slug`，回傳某個 change 對 spec 的 delta 內容\r\n- 擴展 `ApiAdapter` 介面，增加 `getSpecAtChange` 方法（FetchAdapter、MessageAdapter、StaticAdapter 同步實作）\r\n- 在 SpecDetail 頁面新增 diff 檢視 UI，使用者可選取兩個版本進行比較\r\n- 引入前端 diff library，以 side-by-side 或 unified 模式渲染文字差異\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `spec-diff`: Spec 版本差異比較功能——包含 core 層讀取歷史版本、API 層端點、前端 diff 檢視元件\r\n\r\n### Modified Capabilities\r\n- `spec-history`: 在現有 history timeline 上新增「比較」互動，讓使用者可從 timeline 觸發 diff 檢視\r\n- `api-adapter`: 擴展 ApiAdapter 介面，新增 `getSpecAtChange` 方法\r\n\r\n## Impact\r\n\r\n- **Core**: `packages/core/src/scanner.ts` 新增 `readSpecAtChange` 函式，`types.ts` 新增回傳型別\r\n- **Web Server**: `packages/web/server/routes/openspec.ts` 新增 route\r\n- **Frontend**: `packages/web/src/api/` 下所有 adapter 新增方法，`SpecDetail.tsx` 新增 diff UI，新增 `SpecDiffViewer` 元件\r\n- **VS Code Extension**: `packages/vscode/src/handler.ts` 新增 message handler\r\n- **Dependencies**: 新增 diff 計算 library（如 `diff` npm package）\r\n- **Demo**: `StaticAdapter` 與 `build-demo.ts` 需支援歷史版本資料內嵌\r\n","design":"## Context\r\n\r\nspek 的 spec detail 頁面已有 history timeline，顯示哪些 change 影響了該 spec。歷史版本的 spec 內容實際上已存在於 `openspec/changes/<slug>/specs/<topic>/spec.md`（active 或 archive 目錄下），但目前沒有 API 或 UI 來讀取與比較這些歷史內容。\r\n\r\n現有的 `readSpec` 函式回傳當前 spec 內容與 `HistoryEntry[]`，每個 entry 有 slug、date、timestamp、description、status，但不包含歷史版本的實際文字內容。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 讓使用者能在 spec detail 頁面比較任意兩個版本的 spec 差異\r\n- 支援 unified diff 檢視模式\r\n- 在所有三種環境（Web、VS Code Webview、Demo）中可用\r\n- 保持架構一致性——遵循既有的 ApiAdapter pattern\r\n\r\n**Non-Goals:**\r\n- 不做 inline editing（spek 是唯讀檢視器）\r\n- 不做 side-by-side 模式（未來可擴展，目前先做 unified）\r\n- 不做 word-level diff（以行為單位即可）\r\n- 不做跨 spec 的比較\r\n- 不做 git blame 或 git log 直接整合（依賴 OpenSpec 目錄結構而非 git history）\r\n\r\n## Decisions\r\n\r\n### 1. 歷史版本讀取方式：從 change 目錄讀取\r\n\r\n**選擇**：新增 core 函式 `readSpecAtChange(repoDir, topic, slug)` 直接讀取 `openspec/changes/<slug>/specs/<topic>/spec.md` 或 `openspec/changes/archive/<slug>/specs/<topic>/spec.md`。\r\n\r\n**替代方案**：用 `git show <commit>:<path>` 從 git history 讀取。\r\n\r\n**理由**：OpenSpec 的設計已將歷史版本存在 change 目錄結構中，不需要額外依賴 git CLI。這讓非 git repo（或尚未 commit 的 change）也能運作。\r\n\r\n### 2. Diff 計算位置：前端計算\r\n\r\n**選擇**：前端使用 `diff` npm package 計算行級差異。\r\n\r\n**替代方案**：後端計算 diff 回傳結構化 diff 結果。\r\n\r\n**理由**：\r\n- Spec 文件通常不大（數百行以內），前端計算效能不是問題\r\n- 減少 API 複雜度——後端只需提供原始內容\r\n- `diff` 套件體積小（~10KB gzipped），適合前端引入\r\n- 不同環境（Web/Webview/Demo）都能統一處理\r\n\r\n### 3. Diff Library 選擇：`diff` (npm)\r\n\r\n**選擇**：使用 `diff` npm package（https://github.com/kpdecker/jsdiff）\r\n\r\n**理由**：\r\n- 成熟穩定，GitHub 5k+ stars\r\n- 提供 `diffLines` 等 API，回傳結構化 diff result\r\n- 純 JavaScript，無 native dependency\r\n- 體積小，適合 browser 和 webview 環境\r\n\r\n### 4. UI 整合方式：在 SpecDetail 頁面內 inline 顯示\r\n\r\n**選擇**：在 spec detail 頁面的 history timeline 區塊增加版本選取 UI，選取後在頁面內顯示 diff 結果，取代原本的 spec content 區域。\r\n\r\n**替代方案**：用 modal/dialog 顯示 diff，或開新路由頁面。\r\n\r\n**理由**：\r\n- 保持上下文——使用者在看 spec 時可以即時比較\r\n- 不需要額外的路由或 modal 複雜度\r\n- 使用者可以隨時切回原始 content 檢視\r\n\r\n### 5. 版本比較基準：current vs. change version\r\n\r\n**選擇**：預設比較「目前 spec 內容」與「某個 change 版本」。也支援兩個 change 版本之間的比較。\r\n\r\n**理由**：最常見的用例是「這個 change 改了什麼」，比較 current 與 change version 最直覺。\r\n\r\n### 6. API 設計：新增 `getSpecAtChange` 方法\r\n\r\n新增 endpoint `GET /api/openspec/specs/:topic/at/:slug?dir=...`，回傳 `{ content: string }`。\r\n\r\n`ApiAdapter` 介面新增：\r\n```typescript\r\ngetSpecAtChange(topic: string, slug: string): Promise<{ content: string }>\r\n```\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[Risk] Demo 資料膨脹**：StaticAdapter 需要內嵌所有 spec 的歷史版本 → 只嵌入有 delta spec 的版本，資料量可控\r\n- **[Risk] 大量 history entries 時效能**：每次 diff 都需要 API call 取得歷史版本 → spec 文件通常小，可接受。未來如需優化可加 cache\r\n- **[Trade-off] 只做 unified diff**：犧牲 side-by-side 的直覺性 → 減少初版複雜度，unified 在窄螢幕也能用\r\n\r\n## Open Questions\r\n\r\n- 無（初版範圍已明確）\r\n","tasks":{"total":18,"completed":15,"sections":[{"title":"1. Dependencies","tasks":[{"text":"1.1 安裝 `diff` npm package 至 `@spek/web` workspace","completed":true}]},{"title":"2. Core 層","tasks":[{"text":"2.1 在 `packages/core/src/scanner.ts` 新增 `readSpecAtChange(repoDir, topic, slug)` 函式，從 active 或 archive change 目錄讀取 delta spec 內容","completed":true},{"text":"2.2 在 `packages/core/src/types.ts` 新增 `SpecVersionContent` 型別（`{ content: string }`）","completed":true},{"text":"2.3 在 `packages/core/src/index.ts` export 新增的函式與型別","completed":true}]},{"title":"3. API 層（Web Server）","tasks":[{"text":"3.1 在 `packages/web/server/routes/openspec.ts` 新增 `GET /api/openspec/specs/:topic/at/:slug` route","completed":true}]},{"title":"4. API Adapter 層","tasks":[{"text":"4.1 在 `packages/web/src/api/types.ts` 的 `ApiAdapter` 介面新增 `getSpecAtChange(topic: string, slug: string)` 方法","completed":true},{"text":"4.2 在 `FetchAdapter` 實作 `getSpecAtChange`","completed":true},{"text":"4.3 在 `MessageAdapter` 實作 `getSpecAtChange`","completed":true},{"text":"4.4 在 `StaticAdapter` 實作 `getSpecAtChange`，擴展 `DemoData` 型別","completed":true}]},{"title":"5. VS Code Extension","tasks":[{"text":"5.1 在 `packages/vscode/src/handler.ts` 的 `MessageHandler` 新增 `getSpecAtChange` case","completed":true}]},{"title":"6. Frontend 元件","tasks":[{"text":"6.1 建立 `SpecDiffViewer` 元件，使用 `diffLines` 渲染 unified diff","completed":true},{"text":"6.2 在 `useOpenSpec.ts` 新增 `useSpecAtChange(topic, slug)` hook","completed":true},{"text":"6.3 修改 `SpecDetail.tsx`，在 history timeline entry 新增「Compare」按鈕","completed":true},{"text":"6.4 在 `SpecDetail.tsx` 加入 diff 模式狀態管理（選取版本、顯示 diff、退出 diff 模式）","completed":true}]},{"title":"7. Demo 支援","tasks":[{"text":"7.1 修改 `scripts/build-demo.ts`，將 spec 歷史版本內容嵌入 `specVersions` 欄位","completed":true}]},{"title":"8. Build 驗證","tasks":[{"text":"8.1 執行 `npm run build` 確認 core + web build 成功","completed":false},{"text":"8.2 執行 `npm run build:demo` 確認 demo build 成功","completed":false},{"text":"8.3 執行 `npm run type-check` 確認型別檢查通過","completed":false}]}]},"specs":[{"topic":"api-adapter","content":"## MODIFIED Requirements\r\n\r\n### Requirement: ApiAdapter interface\r\nThe frontend SHALL define an `ApiAdapter` interface that abstracts all API communication, allowing different implementations for web and VS Code environments. The interface SHALL include a `getSpecAtChange(topic: string, slug: string): Promise<{ content: string }>` method for fetching spec content at a specific change version.\r\n\r\n#### Scenario: Adapter interface contract\r\n- **WHEN** a component needs to fetch OpenSpec data\r\n- **THEN** it calls methods on the `ApiAdapter` interface (e.g., `getOverview()`, `getSpecs()`, `getChange(slug)`, `getSpecAtChange(topic, slug)`) which return Promises of typed data\r\n\r\n### Requirement: FetchAdapter for web\r\nThe web version SHALL use a `FetchAdapter` that calls the Express REST API via HTTP fetch.\r\n\r\n#### Scenario: Fetch adapter API call\r\n- **WHEN** `FetchAdapter.getOverview()` is called with repoPath set\r\n- **THEN** it performs `fetch('/api/openspec/overview?dir=...')` and returns the parsed JSON response\r\n\r\n#### Scenario: Fetch adapter error handling\r\n- **WHEN** a fetch request returns a non-OK HTTP status\r\n- **THEN** the adapter throws an error with the HTTP status code\r\n\r\n#### Scenario: Fetch adapter getSpecAtChange\r\n- **WHEN** `FetchAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it performs `fetch('/api/openspec/specs/user-auth/at/2026-01-15-add-oauth?dir=...')` and returns the parsed JSON response\r\n\r\n### Requirement: MessageAdapter for VS Code Webview\r\nThe VS Code version SHALL use a `MessageAdapter` that communicates with the extension host via `postMessage`.\r\n\r\n#### Scenario: Message adapter API call\r\n- **WHEN** `MessageAdapter.getOverview()` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getOverview' }` via `postMessage` and returns a Promise that resolves when the matching response arrives\r\n\r\n#### Scenario: Message adapter timeout\r\n- **WHEN** a message request does not receive a response within 10 seconds\r\n- **THEN** the adapter rejects the Promise with a timeout error\r\n\r\n#### Scenario: Message adapter error response\r\n- **WHEN** the extension host responds with `{ type: 'response', id, error: '...' }`\r\n- **THEN** the adapter rejects the Promise with the error message\r\n\r\n#### Scenario: Message adapter getSpecAtChange\r\n- **WHEN** `MessageAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getSpecAtChange', params: { topic: 'user-auth', slug: '2026-01-15-add-oauth' } }` via `postMessage`\r\n\r\n### Requirement: StaticAdapter for demo\r\nThe demo version SHALL use a `StaticAdapter` that reads all data from a pre-embedded JSON object (`window.__DEMO_DATA__`) and implements the `ApiAdapter` interface. The `DemoData` structure SHALL include a `specVersions` field mapping topic to slug to content.\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive substring matching across all spec topic names, spec content, change slugs, and change proposal/design content, returning matching results with context snippets\r\n\r\n#### Scenario: Search matches spec topic names\r\n- **WHEN** `search(\"dashboard\")` is called and a spec with topic `dashboard-view` exists\r\n- **THEN** the result includes `dashboard-view` as a match\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n\r\n#### Scenario: StaticAdapter getSpecAtChange\r\n- **WHEN** `StaticAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it reads from `window.__DEMO_DATA__.specVersions[\"user-auth\"][\"2026-01-15-add-oauth\"]` and returns `{ content: \"...\" }`\r\n\r\n#### Scenario: StaticAdapter getSpecAtChange not found\r\n- **WHEN** `StaticAdapter.getSpecAtChange(\"user-auth\", \"nonexistent\")` is called\r\n- **AND** no matching version exists in the embedded data\r\n- **THEN** it rejects with an error\r\n"},{"topic":"spec-diff","content":"## ADDED Requirements\r\n\r\n### Requirement: Read spec content at a specific change version\r\nThe system SHALL provide a core function `readSpecAtChange(repoDir, topic, slug)` that reads the spec content from a specific change's delta spec file. It SHALL check both active (`openspec/changes/<slug>/specs/<topic>/spec.md`) and archived (`openspec/changes/archive/<slug>/specs/<topic>/spec.md`) change directories.\r\n\r\n#### Scenario: Read spec from active change\r\n- **WHEN** `readSpecAtChange(repoDir, \"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **AND** `openspec/changes/2026-01-15-add-oauth/specs/user-auth/spec.md` exists\r\n- **THEN** it returns `{ content: \"<file contents>\" }`\r\n\r\n#### Scenario: Read spec from archived change\r\n- **WHEN** `readSpecAtChange(repoDir, \"user-auth\", \"2025-12-01-init\")` is called\r\n- **AND** the change is in the archive directory\r\n- **THEN** it returns `{ content: \"<file contents>\" }` from the archive path\r\n\r\n#### Scenario: Spec version not found\r\n- **WHEN** `readSpecAtChange(repoDir, \"user-auth\", \"nonexistent-slug\")` is called\r\n- **AND** no delta spec file exists for that topic in that change\r\n- **THEN** it returns `null`\r\n\r\n### Requirement: Spec version diff API endpoint\r\nThe system SHALL expose `GET /api/openspec/specs/:topic/at/:slug?dir=...` that returns the spec content at a specific change version. The VS Code extension host SHALL handle a `getSpecAtChange` message with the same semantics.\r\n\r\n#### Scenario: Fetch spec at change version via REST\r\n- **WHEN** client calls `GET /api/openspec/specs/user-auth/at/2026-01-15-add-oauth?dir=/repo`\r\n- **THEN** the server returns `{ \"content\": \"<delta spec content>\" }` with status 200\r\n\r\n#### Scenario: Spec version not found via REST\r\n- **WHEN** client calls `GET /api/openspec/specs/user-auth/at/nonexistent?dir=/repo`\r\n- **THEN** the server returns `{ \"error\": \"Spec version not found\" }` with status 404\r\n\r\n#### Scenario: VS Code extension handles getSpecAtChange\r\n- **WHEN** the webview sends `{ type: \"request\", method: \"getSpecAtChange\", params: { topic, slug } }`\r\n- **THEN** the extension host calls `readSpecAtChange` and returns the result\r\n\r\n### Requirement: Diff viewer UI component\r\nThe system SHALL provide a `SpecDiffViewer` component that renders a unified diff between two spec content strings. Diff computation SHALL be done client-side using the `diff` npm package's `diffLines` function.\r\n\r\n#### Scenario: Display unified diff\r\n- **WHEN** the component receives two content strings (old and new)\r\n- **THEN** it renders a unified diff view with added lines highlighted in green and removed lines highlighted in red\r\n\r\n#### Scenario: Identical content\r\n- **WHEN** both content strings are identical\r\n- **THEN** it displays a message indicating no differences found\r\n\r\n#### Scenario: Empty old content\r\n- **WHEN** the old content is empty (new spec)\r\n- **THEN** all lines in the new content are shown as added\r\n\r\n### Requirement: Version comparison interaction on SpecDetail page\r\nThe system SHALL add a comparison mode to the SpecDetail page. Users can select a history entry to compare against the current spec content, or select two history entries to compare against each other.\r\n\r\n#### Scenario: Compare current vs. history version\r\n- **WHEN** the user clicks a \"Compare\" action on a history timeline entry\r\n- **THEN** the system fetches the spec content at that change version\r\n- **AND** displays a diff view comparing the change version (old) against the current spec content (new)\r\n\r\n#### Scenario: Compare two history versions\r\n- **WHEN** the user selects two history entries for comparison\r\n- **THEN** the system fetches both change versions\r\n- **AND** displays a diff view with the earlier version as old and the later version as new\r\n\r\n#### Scenario: Exit diff mode\r\n- **WHEN** the user is viewing a diff and clicks \"Close\" or \"Back to spec\"\r\n- **THEN** the diff view is dismissed and the original spec content is shown again\r\n\r\n#### Scenario: No history available\r\n- **WHEN** a spec has no history entries\r\n- **THEN** no comparison UI is shown\r\n"},{"topic":"spec-history","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec history timeline UI\r\nThe system SHALL display a visual timeline on the SpecDetail page showing all changes that affected the spec. Each timeline entry MUST display the date, change description, and a link to the change detail page. Each timeline entry SHALL also include a \"Compare\" action that triggers diff comparison against the current spec content.\r\n\r\n#### Scenario: Display history timeline\r\n- **WHEN** the SpecDetail page is rendered for a spec with related changes\r\n- **THEN** a \"History\" section is displayed with a vertical timeline showing each change chronologically\r\n\r\n#### Scenario: Timeline entry links to change\r\n- **WHEN** the user clicks on a timeline entry's title or description\r\n- **THEN** the system navigates to the corresponding change detail page\r\n\r\n#### Scenario: No history\r\n- **WHEN** the SpecDetail page is rendered for a spec with no related changes\r\n- **THEN** the \"History\" section displays a message indicating no changes have affected this spec\r\n\r\n#### Scenario: Timeline entry compare action\r\n- **WHEN** the user clicks the \"Compare\" action on a timeline entry\r\n- **THEN** the system enters diff comparison mode showing the difference between that change version and the current spec content\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-17"}},"2026-02-17-add-vscode-tab-icon":{"slug":"2026-02-17-add-vscode-tab-icon","proposal":"## Why\r\n\r\nVS Code extension 的 webview panel tab 目前只顯示預設圖示，在多個 tab 中缺乏辨識度。既然 extension 已有 `webview/favicon.svg`（琥珀色 S 形 logo），應作為 tab icon 使用，讓使用者快速辨識 spek panel。\r\n\r\n## What Changes\r\n\r\n- 在 `SpekPanel` 建立 webview panel 後設定 `iconPath`，指向已有的 `webview/favicon.svg`\r\n- 不需要新增任何圖片資源，直接複用現有的 favicon\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n_無新增 capability — 此變更為現有 webview-integration 的增強。_\r\n\r\n### Modified Capabilities\r\n\r\n- `webview-integration`: 新增 tab icon 顯示的 requirement\r\n\r\n## Impact\r\n\r\n- 影響檔案：`packages/vscode/src/panel.ts`（加一行 `iconPath` 設定）\r\n- 無 API 變更、無依賴變更、無 breaking change\r\n","design":"## Context\r\n\r\nVS Code 的 `WebviewPanel` 支援 `iconPath` 屬性，可在 tab 上顯示自訂圖示。目前 `SpekPanel` 建立 panel 後未設定此屬性，導致 tab 只顯示預設圖示。\r\n\r\nExtension 已有 `webview/favicon.svg`（32x32，深色背景 + 琥珀色 S 形 logo），適合直接作為 tab icon。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 讓 spek webview panel 在 VS Code tab bar 上顯示專屬 icon\r\n\r\n**Non-Goals:**\r\n- 不區分 light/dark theme 的 icon 版本（現有 SVG 在兩種背景下都可辨識）\r\n- 不新增額外圖片資源\r\n\r\n## Decisions\r\n\r\n### 直接使用現有 favicon.svg\r\n\r\n**選擇**：複用 `webview/favicon.svg` 作為 tab icon\r\n\r\n**替代方案**：\r\n- 新建專用的 tab icon 圖片 — 不必要，現有 SVG 品質已足夠\r\n- 分別提供 light/dark 版本 — 現有 SVG 帶深色背景 `#0a0c0f`，在 light/dark theme 都有足夠對比度\r\n\r\n**理由**：零額外資源，一行程式碼完成。\r\n\r\n### 使用單一 URI 而非 light/dark 物件\r\n\r\n**選擇**：`panel.iconPath = vscode.Uri.joinPath(...)` 傳入單一 URI\r\n\r\n**替代方案**：傳入 `{ light: Uri, dark: Uri }` 物件分別指定\r\n\r\n**理由**：favicon.svg 的深色背景使其在兩種 theme 下都清晰可見，不需分別處理。\r\n\r\n## Risks / Trade-offs\r\n\r\n- [SVG 相容性] VS Code 的 tab icon 支援 SVG 格式 → 無風險，官方文件明確支援\r\n- [icon 尺寸] tab icon 顯示尺寸較小 → favicon.svg 已針對 32x32 小尺寸優化，無問題\r\n","tasks":{"total":2,"completed":2,"sections":[{"title":"1. Implementation","tasks":[{"text":"1.1 在 `packages/vscode/src/panel.ts` 的 `createWebviewPanel` 後加上 `this.panel.iconPath = vscode.Uri.joinPath(context.extensionUri, \"webview\", \"favicon.svg\")`","completed":true}]},{"title":"2. Verification","tasks":[{"text":"2.1 Build extension 並確認 tab icon 正確顯示","completed":true}]}]},"specs":[{"topic":"webview-integration","content":"## ADDED Requirements\r\n\r\n### Requirement: Tab icon display\r\nThe Webview Panel SHALL display the spek logo as the tab icon for visual identification.\r\n\r\n#### Scenario: Tab icon is set on panel creation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** the panel's `iconPath` SHALL be set to the `webview/favicon.svg` file from the extension's bundled assets\r\n\r\n#### Scenario: Icon visibility across themes\r\n- **WHEN** the tab icon is displayed in either light or dark VS Code theme\r\n- **THEN** the icon SHALL be visually distinguishable against the tab bar background\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-17"}},"2026-02-16-ui-design-polish-p0-p1":{"slug":"2026-02-16-ui-design-polish-p0-p1","proposal":"## Why\r\n\r\n經過前端設計審查，發現 spek 有數項影響功能正確性與使用體驗的問題：Demo 版搜尋功能無法正確搜尋（P0 bug）、行動版漢堡按鈕缺少 accessibility label（P0 a11y）、進度條未反映完成語意（P1）、Dashboard 統計數字視覺權重不足且缺少入場動畫（P1）、以及全站使用系統字體堆疊缺乏品牌識別（P1）。\r\n\r\n## What Changes\r\n\r\n- 修正 StaticAdapter 的 `search()` 實作，使其能正確搜尋 spec/change 的 title 和內容\r\n- 為行動版 hamburger 按鈕加入 `aria-label` 屬性\r\n- TaskProgress 進度條在全部完成時（100%）從琥珀色變為綠色\r\n- Dashboard stat cards 數字放大並加入 staggered fade-in 入場動畫\r\n- 引入特色字體（Google Fonts）取代系統字體堆疊，建立品牌識別\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無）\r\n\r\n### Modified Capabilities\r\n\r\n- `api-adapter`：新增 StaticAdapter 的 search 行為規格（目前 spec 未涵蓋 StaticAdapter）\r\n- `shared-layout`：hamburger 按鈕的 accessibility 需求、全站字體變更\r\n- `dashboard-view`：stat cards 數字樣式放大與入場動畫、進度條完成狀態色彩語意\r\n\r\n## Impact\r\n\r\n- **前端元件**：`StaticAdapter.ts`、`Layout.tsx`（header hamburger）、`Dashboard.tsx`（stat cards）、`TaskProgress.tsx`（進度條）、`global.css`（字體）\r\n- **依賴**：新增 Google Fonts CDN 引用（或 self-hosted）\r\n- **Demo**：修正後需重新 build demo.html\r\n- **VS Code Extension**：webview 字體同步變更，需確認 CSP 允許字體載入\r\n","design":"## Context\r\n\r\nspek 前端經過設計審查後，發現 P0（功能/a11y bug）和 P1（視覺體驗）的改進項目。目前前端使用 React 19 + Tailwind CSS v4 + Vite，所有元件用 Tailwind utility class 做樣式。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 修正 Demo 版 StaticAdapter 搜尋 bug（搜尋 \"dashboard\" 應找到 \"dashboard-view\"）\r\n- 為行動版 hamburger 按鈕加入 aria-label\r\n- TaskProgress 進度條在 100% 完成時顯示綠色\r\n- Dashboard stat cards 數字放大（text-4xl）並加入 staggered fade-in 動畫\r\n- 引入 Google Fonts 特色字體取代系統字體堆疊\r\n\r\n**Non-Goals:**\r\n- 不重新設計整體 layout 或色彩系統\r\n- 不新增 Specs 列表摘要預覽（P2）\r\n- 不做 Tab 切換動畫或 skeleton loading（P2/P3）\r\n- 不處理 VS Code extension 的字體 CSP 問題（另案處理）\r\n\r\n## Decisions\r\n\r\n### 1. StaticAdapter 搜尋修正策略\r\n\r\n**問題**：搜尋 \"dashboard\" 找不到 \"dashboard-view\" spec。原始碼中 `search()` 方法邏輯正確（`topic.toLowerCase().includes(q)` 應該匹配），但 `detail.content` 是 markdown 原始內容。經檢查，問題出在 `specDetails` 的 key 是 topic name（如 `dashboard-view`），`topic.toLowerCase().includes(\"dashboard\")` 理論上為 true。\r\n\r\n需進一步除錯確認是否為 demo build 時 `specDetails` 資料結構問題，或是 `SpecDetail` 的 `content` 欄位為空。\r\n\r\n**決策**：在 search 中加入 spec title（即 topic name）的匹配作為第一優先，同時也搜尋 `specs` 列表（不只 `specDetails`）。改用 Fuse.js 做 fuzzy matching 會過重，改為加強 substring matching 的覆蓋範圍即可。\r\n\r\n### 2. 進度條完成狀態色彩\r\n\r\n**決策**：在 `TaskProgress` 元件中，根據 `completed === total` 條件動態切換進度條顏色 class。\r\n- 未完成：維持 `bg-accent`（琥珀色）\r\n- 已完成：切換為 `bg-green-500`（綠色）\r\n\r\n選擇 Tailwind 內建的 `green-500` 而非自訂色，因為只有這一個語意用途，不需要擴充 theme。\r\n\r\n### 3. Stat Cards 動畫方案\r\n\r\n**決策**：使用純 CSS `@keyframes` + `animation-delay` 做 staggered fade-in，不引入 Motion library。理由：\r\n- 僅 Dashboard 頁面需要，不需要整個動畫框架\r\n- 4 張卡片的 stagger 效果用 CSS 即可實現\r\n- 在 `global.css` 中定義 `@keyframes fadeInUp`，Dashboard 中透過 inline style 設定不同的 `animation-delay`\r\n\r\n數字大小從 `text-2xl` 改為 `text-4xl`，增加視覺衝擊。\r\n\r\n### 4. 字體選擇\r\n\r\n**決策**：選用 **Plus Jakarta Sans** 作為主字體。理由：\r\n- 幾何風格、現代感，適合開發工具\r\n- 有 Variable Font 版本，檔案小效率高\r\n- 支援 400-800 字重，涵蓋 body 和 heading\r\n- 免費開源（OFL），可透過 Google Fonts CDN 載入\r\n\r\n**載入方式**：在 `index.html` 和 demo 的 HTML 中加入 Google Fonts `<link>` tag，再更新 `global.css` 的 `font-family`。不使用 self-hosted 方式以減少 build 複雜度。\r\n\r\n程式碼字體維持 JetBrains Mono 不變。\r\n\r\n### 5. Hamburger aria-label\r\n\r\n**決策**：在 `Layout.tsx` 的行動版 hamburger `<button>` 加入 `aria-label=\"Open navigation menu\"`（英文，因為是 HTML 屬性非使用者可見文字）。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **Google Fonts CDN 依賴**：離線環境（如部分企業內網）可能無法載入字體，需確保 fallback 字體堆疊仍可用 → 加入 `sans-serif` fallback\r\n- **CSS 動畫 prefers-reduced-motion**：部分使用者偏好減少動畫 → 加入 `@media (prefers-reduced-motion: reduce)` 取消動畫\r\n- **VS Code Webview 字體載入**：Webview CSP 預設不允許外部資源 → 此次不處理 VS Code 的字體，維持系統字體 fallback（已列為 Non-Goal）\r\n","tasks":{"total":12,"completed":12,"sections":[{"title":"1. P0: StaticAdapter 搜尋修正","tasks":[{"text":"1.1 除錯 `StaticAdapter.search()` — 確認 demo build 的 `specDetails` 資料結構中 key 與 content 是否正確填充","completed":true},{"text":"1.2 修正 `StaticAdapter.search()` — 確保 spec topic name 的 substring matching 正確運作，同時搜尋 `specs` 列表的 topic name","completed":true},{"text":"1.3 重新 build demo (`npm run build:demo`) 並驗證搜尋 \"dashboard\" 能找到 \"dashboard-view\"","completed":true}]},{"title":"2. P0: Hamburger 按鈕 Accessibility","tasks":[{"text":"2.1 在 `Layout.tsx` 的行動版 hamburger `<button>` 加入 `aria-label=\"Open navigation menu\"`","completed":true}]},{"title":"3. P1: 進度條完成狀態色彩","tasks":[{"text":"3.1 修改 `TaskProgress.tsx` — 根據 `completed === total && total > 0` 條件，將進度條 class 從 `bg-accent` 切換為 `bg-green-500`","completed":true}]},{"title":"4. P1: Stat Cards 視覺強化","tasks":[{"text":"4.1 在 `global.css` 新增 `@keyframes fadeInUp` 動畫定義，以及 `prefers-reduced-motion: reduce` 的取消規則","completed":true},{"text":"4.2 修改 `Dashboard.tsx` — stat card 數字從 `text-2xl` 改為 `text-4xl`，並為每張卡片加入 staggered `animation-delay` 的 fadeInUp 動畫","completed":true}]},{"title":"5. P1: 引入特色字體","tasks":[{"text":"5.1 在 `packages/web/index.html` 加入 Google Fonts `<link>` tag 載入 Plus Jakarta Sans（variable, 400-800）","completed":true},{"text":"5.2 在 `packages/web/src/styles/global.css` 更新 body `font-family` 為 `\"Plus Jakarta Sans\", sans-serif`","completed":true},{"text":"5.3 在 `scripts/build-demo.ts` 確認 demo build 也包含 Google Fonts link，或在 demo HTML template 中加入","completed":true}]},{"title":"6. 驗證","tasks":[{"text":"6.1 執行 `npm run type-check` 確認無型別錯誤","completed":true},{"text":"6.2 重新 build demo (`npm run build:demo`) 並用瀏覽器驗證所有改動","completed":true}]}]},"specs":[{"topic":"api-adapter","content":"## ADDED Requirements\r\n\r\n### Requirement: StaticAdapter for demo\r\nThe demo version SHALL use a `StaticAdapter` that reads all data from a pre-embedded JSON object (`window.__DEMO_DATA__`) and implements the `ApiAdapter` interface.\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive substring matching across all spec topic names, spec content, change slugs, and change proposal/design content, returning matching results with context snippets\r\n\r\n#### Scenario: Search matches spec topic names\r\n- **WHEN** `search(\"dashboard\")` is called and a spec with topic `dashboard-view` exists\r\n- **THEN** the result includes `dashboard-view` as a match\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n"},{"topic":"dashboard-view","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Overview statistics display\r\nThe system SHALL display overview statistics from the overview API: total specs count, active changes count, archived changes count, and task completion rate (percentage). Statistics SHALL be displayed in stat cards with large numbers (text-4xl) and a staggered fade-in-up entry animation on page load.\r\n\r\n#### Scenario: Display statistics\r\n- **WHEN** user navigates to the Dashboard page\r\n- **THEN** system displays specs count, active changes count, archived changes count, and overall task completion percentage in stat cards with large accent-colored numbers\r\n\r\n#### Scenario: Staggered entry animation\r\n- **WHEN** the Dashboard page loads\r\n- **THEN** the four stat cards appear with a fade-in-up animation, each card delayed by an incremental amount (e.g., 0ms, 80ms, 160ms, 240ms) creating a staggered reveal effect\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** stat cards appear immediately without animation\r\n"},{"topic":"shared-layout","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: an inline SVG logomark (S-curve with diamond accents, 24x24) followed by the \"spek\" brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button with `aria-label=\"Open navigation menu\"` and hide the repo path. The header SHALL also include a theme toggle button. The logomark SVG SHALL use `currentColor` to follow the accent color, ensuring theme compatibility.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the SVG logomark alongside \"spek\" brand text, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button with `aria-label=\"Open navigation menu\"`, the SVG logomark alongside \"spek\" brand text, search button, and theme toggle, but hides the repo path\r\n\r\n#### Scenario: Logo theme compatibility\r\n- **WHEN** the user toggles between dark and light theme\r\n- **THEN** the logomark color adjusts automatically via the accent color CSS variable\r\n\r\n### Requirement: TaskProgress component\r\nThe system SHALL provide a reusable TaskProgress component that displays a progress bar with completed/total count. The progress bar color SHALL reflect completion status: amber/accent color when incomplete, green when all tasks are completed (completed equals total).\r\n\r\n#### Scenario: Display progress\r\n- **WHEN** TaskProgress is rendered with `completed=3` and `total=5`\r\n- **THEN** a progress bar at 60% width is shown in amber/accent color with text \"3 / 5\"\r\n\r\n#### Scenario: Display completed progress\r\n- **WHEN** TaskProgress is rendered with `completed=5` and `total=5`\r\n- **THEN** a progress bar at 100% width is shown in green color with text \"5 / 5\"\r\n\r\n#### Scenario: Zero tasks\r\n- **WHEN** TaskProgress is rendered with `total=0`\r\n- **THEN** component displays \"No tasks\" or an empty state\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Custom typography\r\nThe system SHALL use \"Plus Jakarta Sans\" as the primary font family for all UI text, loaded via Google Fonts CDN. The font stack SHALL include `sans-serif` as fallback for offline environments. Code and monospace text SHALL continue to use \"JetBrains Mono\".\r\n\r\n#### Scenario: Font loading\r\n- **WHEN** the application loads in a browser with internet access\r\n- **THEN** \"Plus Jakarta Sans\" is loaded and applied to all non-code text elements\r\n\r\n#### Scenario: Font fallback\r\n- **WHEN** the application loads without internet access (or Google Fonts is blocked)\r\n- **THEN** the browser falls back to the system default sans-serif font\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** the user has `prefers-reduced-motion: reduce` set in their OS/browser\r\n- **THEN** all CSS entry animations are disabled\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-15"}},"2026-02-16-ui-design-polish-p2":{"slug":"2026-02-16-ui-design-polish-p2","proposal":"## Why\r\n\r\nP0+P1 設計修正後，仍有多項 P2 級別的 UI/UX 問題影響使用體驗：頁面標題緊貼 navbar 缺乏呼吸空間、Change Detail tab 順序與 OpenSpec 實際工作流程不符、返回導航字體偏小且缺乏層級感、各列表頁信息密度不足、tab 切換缺少過渡動畫等。這些改善將顯著提升瀏覽體驗的流暢度與專業感。\r\n\r\n## What Changes\r\n\r\n- 增加主內容區的頂部間距，讓 h1 不再緊貼 navbar\r\n- 修正 Change Detail tab 排列順序為 Proposal → Design → Specs → Tasks（符合 OpenSpec 工作流程）\r\n- 放大「← Back to Specs/Changes」返回連結字體，增強可點擊性\r\n- Change Detail tab 切換加入 fade 過渡動畫\r\n- Specs/Changes 列表加入內容摘要或副標題，提高信息密度\r\n- 搜尋結果加入匹配文字高亮、分類 filter、空狀態改善\r\n- Active/Archived changes 加入更明顯的視覺區隔\r\n- Tasks checkbox 使用自訂樣式取代原生外觀，已完成項加入淡化效果\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無）\r\n\r\n### Modified Capabilities\r\n\r\n- `shared-layout`: 增加主內容區頂部間距（h1 與 navbar 之間的空間）\r\n- `change-browsing`: 修正 tab 順序、加入 tab 切換動畫、改善返回連結樣式、Active/Archived 視覺區隔、tasks checkbox 自訂樣式\r\n- `spec-browsing`: 改善返回連結樣式、列表加入摘要預覽\r\n- `search-ui`: 搜尋結果匹配高亮、分類 filter、空狀態改善\r\n\r\n## Impact\r\n\r\n- 前端元件：Layout.tsx、ChangeDetail.tsx、SpecDetail.tsx、SpecList.tsx、ChangeList.tsx、TabView.tsx、SearchDialog.tsx\r\n- 無 API 變更、無 breaking changes\r\n- 可能需要新的 CSS 動畫 keyframes\r\n- Demo 頁面會自動受益（共用同一套元件）\r\n","design":"## Context\r\n\r\nP0+P1 修正（commit 91bc191）完成了關鍵 bug 修復與基礎視覺改善。目前殘餘的 P2 問題影響日常瀏覽體驗：h1 緊貼 navbar、tab 順序與工作流程不符、返回連結不夠顯眼、tab 切換生硬、列表信息密度低、搜尋缺乏高亮與 filter、changes 列表視覺單調、tasks checkbox 使用原生樣式。\r\n\r\n現有元件結構：\r\n- `Layout.tsx` — 主內容區 `<main>` 使用 `pt-14 p-6`（pt-14 = 56px 對應 header 高度，p-6 = 24px 全方位 padding）\r\n- `TabView.tsx` — 通用 tab 元件，無動畫\r\n- `ChangeDetail.tsx` — tab 順序為 Proposal → Design → Tasks → Specs；返回連結 `text-sm`\r\n- `SpecDetail.tsx` — 返回連結 `text-sm`\r\n- `SpecList.tsx` / `ChangeList.tsx` — 只顯示名稱，無摘要\r\n- `SearchDialog.tsx` — 無匹配高亮、無分類 filter\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 增加頁面標題與 navbar 之間的視覺間距\r\n- 修正 tab 順序符合 OpenSpec 工作流程（Proposal → Design → Specs → Tasks）\r\n- 放大返回連結字體提升可見性\r\n- Tab 切換加入 fade 過渡動畫\r\n- 列表頁增加信息密度（摘要/統計）\r\n- 搜尋結果高亮匹配文字、加入分類 filter\r\n- Active/Archived changes 視覺區隔更明顯\r\n- Tasks checkbox 自訂樣式\r\n\r\n**Non-Goals:**\r\n- Breadcrumb 導航（會增加複雜度且目前頁面層級只有 2 層，返回連結足夠）\r\n- Grid/list 雙模式切換（P3 再考慮）\r\n- 最近搜尋紀錄（P3）\r\n- Skeleton loading（P3）\r\n\r\n## Decisions\r\n\r\n### 1. H1 頂部間距：在 `<main>` 增加 padding-top\r\n\r\n**方案**：將 `pt-14` 改為 `pt-20`（從 56px → 80px），增加 24px 呼吸空間。\r\n\r\n**理由**：直接在 Layout 層修改最簡單，所有頁面統一受益，不需逐頁調整。相比在每個頁面 h1 加 `mt-*`，這個方案更一致。\r\n\r\n### 2. Tab 順序修正：調整 ChangeDetail tabs 陣列\r\n\r\n**方案**：將 `tabs` 陣列中 `tasks` 和 `specs` 互換位置，變為 Proposal → Design → Specs → Tasks。\r\n\r\n**理由**：符合 OpenSpec 工作流程（先寫 spec 才能產生 tasks）。改動極小，只調換陣列元素順序。\r\n\r\n### 3. 返回連結字體：從 `text-sm` 改為 `text-base`\r\n\r\n**方案**：SpecDetail 和 ChangeDetail 的返回連結從 `text-sm`（14px）改為 `text-base`（16px），並加入 `font-medium`。\r\n\r\n**理由**：`text-base` 提升可讀性但不會過大搶走標題視覺權重。加入 `font-medium` 增加存在感。\r\n\r\n### 4. Tab 切換動畫：CSS transition + key-based re-render\r\n\r\n**方案**：在 TabView 的內容區域加入 CSS `transition` + `opacity` fade 效果。使用 `key={activeId}` 觸發 re-mount 搭配 CSS `@keyframes fadeIn` 動畫。\r\n\r\n**理由**：純 CSS 方案最輕量。不需引入 animation library（如 framer-motion）。fade-in 效果簡潔且不影響效能。\r\n\r\n### 5. 列表摘要：Specs 顯示歷史數、Changes 顯示 proposal 摘要\r\n\r\n**方案**：\r\n- SpecList：在每個 spec 卡片加入歷史 change 數量（需 API 支援，但目前 `SpecInfo` 已有 `historyCount`）\r\n- ChangeList：Active changes 已有 TaskProgress；Archived changes 顯示描述即可（目前已有）\r\n\r\n**理由**：利用現有資料結構，不需新增 API。SpecInfo 中的 `historyCount` 可直接使用。\r\n\r\n### 6. 搜尋高亮：在 ResultItem 中 highlight 匹配片段\r\n\r\n**方案**：建立 `highlightMatch(text, query)` 工具函式，將匹配部分用 `<mark>` 標籤包裹（背景色 accent/20）。同時加入 type filter toggle（All / Specs / Changes）。\r\n\r\n**理由**：純前端實現，不需改 API。`<mark>` 語義正確且容易 style。\r\n\r\n### 7. Changes 視覺區隔：Active 加左側 accent 色條\r\n\r\n**方案**：Active changes 卡片加入左側 4px accent 色條（`border-l-4 border-accent`），Archived 保持現狀。\r\n\r\n**理由**：最小改動達到最大視覺區隔效果。左側色條是常見的狀態標示模式。\r\n\r\n### 8. Tasks checkbox 自訂樣式：CSS 自訂 checkbox 圖示\r\n\r\n**方案**：用 SVG icon 取代文字 `[x]`/`[ ]`，已完成項加入 `opacity-60` 淡化。使用 inline SVG checkmark（✓）和 empty circle。\r\n\r\n**理由**：比原生 checkbox 更一致的外觀。`opacity-60` 搭配既有的 `line-through` 讓已完成項視覺降級更自然。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[風險] `pt-20` 在 mobile 可能過大** → 可使用 responsive class `pt-16 md:pt-20`，但 mobile 的 pt-14 已經包含 header 高度，改為 pt-16 仍會有改善。使用 `pt-18`（72px）作為折衷。\r\n- **[風險] fade 動畫與快速連點 tab 衝突** → 動畫時間設短（150ms），即使快速切換也不會感覺遲鈍。\r\n- **[風險] 搜尋高亮在特殊字元 query 可能出錯** → 對 query 進行 regex escape 處理。\r\n- **[取捨] 不做 breadcrumb** → 目前頁面層級淺（最多 2 層），返回連結字體放大後已足夠。未來若加入更深層級再考慮。\r\n","tasks":{"total":16,"completed":16,"sections":[{"title":"1. Layout and Navigation","tasks":[{"text":"1.1 Increase main content top padding in Layout.tsx (pt-14 → pt-18) for h1 breathing room","completed":true},{"text":"1.2 Change back navigation links from text-sm to text-base font-medium in SpecDetail.tsx and ChangeDetail.tsx","completed":true}]},{"title":"2. Tab Fixes","tasks":[{"text":"2.1 Swap tab order in ChangeDetail.tsx: move Specs before Tasks (Proposal → Design → Specs → Tasks)","completed":true},{"text":"2.2 Add fade-in CSS animation to TabView.tsx content panel with key-based re-render (150ms)","completed":true},{"text":"2.3 Add prefers-reduced-motion media query to disable tab animation","completed":true}]},{"title":"3. List Enhancements","tasks":[{"text":"3.1 Add history count display to SpecList.tsx spec items (use existing historyCount from SpecInfo)","completed":true},{"text":"3.2 Add left accent border (border-l-4 border-accent) to active change cards in ChangeList.tsx","completed":true}]},{"title":"4. Search Improvements","tasks":[{"text":"4.1 Create highlightMatch utility function for marking matched text fragments","completed":true},{"text":"4.2 Apply highlight to search result titles and context in SearchDialog.tsx ResultItem","completed":true},{"text":"4.3 Add type filter toggle (All / Specs / Changes) to SearchDialog.tsx","completed":true},{"text":"4.4 Improve empty state message with search suggestions","completed":true}]},{"title":"5. Task Checkbox Styling","tasks":[{"text":"5.1 Replace text-based [x]/[ ] with custom SVG checkmark/circle icons in ChangeDetail.tsx Tasks tab","completed":true},{"text":"5.2 Add opacity-60 to completed task items","completed":true}]},{"title":"6. Verification","tasks":[{"text":"6.1 Visual test with agent-browser: verify h1 spacing, tab order, back links, animations across pages","completed":true},{"text":"6.2 Run type-check to ensure no TypeScript errors","completed":true},{"text":"6.3 Rebuild demo page and verify changes apply","completed":true}]}]},"specs":[{"topic":"change-browsing","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Change detail with tab navigation\r\nThe system SHALL display change details using a tabbed interface with tabs in OpenSpec workflow order: Proposal, Design, Specs (delta specs), and Tasks. Tab content SHALL transition with a fade-in animation when switching.\r\n\r\n#### Scenario: View proposal tab\r\n- **WHEN** user views a change and clicks the Proposal tab\r\n- **THEN** the proposal.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View design tab\r\n- **WHEN** user clicks the Design tab\r\n- **THEN** the design.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View specs tab\r\n- **WHEN** user clicks the Specs tab and the change has delta specs\r\n- **THEN** the delta spec files are listed and their content displayed with a fade-in transition\r\n\r\n#### Scenario: View tasks tab\r\n- **WHEN** user clicks the Tasks tab\r\n- **THEN** the tasks.md content is displayed with a TaskProgress bar showing completion statistics, with a fade-in transition\r\n\r\n#### Scenario: Tab order\r\n- **WHEN** the ChangeDetail page is rendered\r\n- **THEN** the tabs are displayed in order: Proposal, Design, Specs, Tasks (matching the OpenSpec workflow sequence)\r\n\r\n#### Scenario: Missing artifact\r\n- **WHEN** a tab's corresponding artifact file does not exist\r\n- **THEN** the tab shows a \"No content\" placeholder\r\n\r\n### Requirement: Change list with active/archived separation\r\nThe system SHALL display changes grouped into active and archived sections. Active changes SHALL be visually distinguished with a left accent color border (4px). Archived changes SHALL be sorted by date (most recent first).\r\n\r\n#### Scenario: Display active changes\r\n- **WHEN** user navigates to the ChangeList page and there are active changes\r\n- **THEN** active changes are listed in an \"Active\" section with a left accent color border, name, and task progress\r\n\r\n#### Scenario: Display archived changes\r\n- **WHEN** user navigates to the ChangeList page\r\n- **THEN** archived changes are listed in an \"Archived\" section sorted by date descending, without accent border\r\n\r\n#### Scenario: No changes\r\n- **WHEN** there are no changes in the repo\r\n- **THEN** system displays an empty state message\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Custom task checkbox styling\r\nThe system SHALL render task items in the Tasks tab using custom SVG icons instead of text-based `[x]`/`[ ]` markers. Completed tasks SHALL display a filled checkmark icon in green, and incomplete tasks SHALL display an empty circle icon. Completed task text SHALL have reduced opacity (0.6) in addition to the existing strikethrough styling.\r\n\r\n#### Scenario: Incomplete task display\r\n- **WHEN** a task item is not completed\r\n- **THEN** the task displays an empty circle SVG icon followed by the task text at full opacity\r\n\r\n#### Scenario: Completed task display\r\n- **WHEN** a task item is completed\r\n- **THEN** the task displays a green checkmark SVG icon followed by the task text with strikethrough and reduced opacity (0.6)\r\n"},{"topic":"search-ui","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Search query execution\r\nThe system SHALL search across all specs and changes content by calling the backend search API with debounced input. Search results SHALL highlight matching text fragments in the title and context preview.\r\n\r\n#### Scenario: Debounced search on input\r\n- **WHEN** user types a query in the search input\r\n- **THEN** the system waits 300ms after the last keystroke before sending the search request\r\n\r\n#### Scenario: Display search results with highlights\r\n- **WHEN** the search API returns results\r\n- **THEN** results are displayed grouped by type (Specs and Changes), with matching query text highlighted using a contrasting background color in both the title and context snippet\r\n\r\n#### Scenario: No results found\r\n- **WHEN** the search API returns an empty array\r\n- **THEN** the dialog displays a \"No results found\" message with a suggestion to try different keywords\r\n\r\n#### Scenario: Empty query\r\n- **WHEN** the search input is empty\r\n- **THEN** no search request is made and the results area shows a prompt to start typing\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Search type filter\r\nThe system SHALL provide a type filter in the search dialog allowing users to narrow results by category: All, Specs only, or Changes only.\r\n\r\n#### Scenario: Filter by type\r\n- **WHEN** user selects \"Specs\" filter while search results are displayed\r\n- **THEN** only spec-type results are shown, change-type results are hidden\r\n\r\n#### Scenario: Default filter\r\n- **WHEN** the search dialog opens\r\n- **THEN** the \"All\" filter is selected by default, showing both spec and change results\r\n\r\n#### Scenario: Filter with no matching results\r\n- **WHEN** user selects a type filter and no results match that type\r\n- **THEN** a \"No results found\" message is displayed for that category\r\n"},{"topic":"shared-layout","content":"## MODIFIED Requirements\r\n\r\n### Requirement: TabView component\r\nThe system SHALL provide a reusable TabView component that renders tab headers and switches between tab content panels. When switching tabs, the new content panel SHALL fade in with a 150ms CSS animation.\r\n\r\n#### Scenario: Switch tabs\r\n- **WHEN** user clicks a tab header\r\n- **THEN** the corresponding tab content panel is displayed with a fade-in animation (150ms duration) and the previous panel is hidden\r\n\r\n#### Scenario: Default tab\r\n- **WHEN** TabView is first rendered\r\n- **THEN** the first tab is selected by default\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** tab content switches instantly without fade animation\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Main content area top spacing\r\nThe system SHALL render the main content area with sufficient top spacing below the fixed header to provide visual breathing room between the navbar and page content. The top padding SHALL be at least 72px (header height 56px + 16px spacing).\r\n\r\n#### Scenario: Page title spacing\r\n- **WHEN** any page is rendered within the Layout\r\n- **THEN** the first content element (typically h1) has at least 16px of visual spacing below the header bar\r\n\r\n### Requirement: Back navigation link styling\r\nThe system SHALL render back navigation links (e.g., \"← Back to Specs\", \"← Back to Changes\") at base font size (16px) with medium font weight for adequate visibility and clickability.\r\n\r\n#### Scenario: Back link display\r\n- **WHEN** user views a detail page (SpecDetail or ChangeDetail)\r\n- **THEN** the back navigation link is displayed at 16px font size with medium weight, muted color, and accent color on hover\r\n"},{"topic":"spec-browsing","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec list with filtering\r\nThe system SHALL display all specs sorted alphabetically with history count metadata. A filter input SHALL allow instant client-side filtering by spec topic name. Each spec item SHALL display the topic name and the number of related changes (history count) as secondary information.\r\n\r\n#### Scenario: Display all specs\r\n- **WHEN** user navigates to the SpecList page\r\n- **THEN** all spec topics are listed alphabetically, each showing the topic name and history change count\r\n\r\n#### Scenario: Filter specs\r\n- **WHEN** user types in the filter input\r\n- **THEN** the list is filtered in real-time to show only specs whose topic name contains the search text (case-insensitive)\r\n\r\n#### Scenario: Spec with no history\r\n- **WHEN** a spec has zero related changes\r\n- **THEN** the history count is not displayed (or shows \"No changes\")\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-15"}},"2026-02-15-add-demo-link-to-readme":{"slug":"2026-02-15-add-demo-link-to-readme","proposal":"## Why\r\n\r\n剛完成 demo page 並部署到 GitHub Pages，但 README 沒有提及 demo 連結，潛在使用者無法從 repo 首頁直接找到線上體驗入口。\r\n\r\n## What Changes\r\n\r\n- 在 `README.md` 加上 Live Demo 連結（`https://kewang.github.io/spek/demo.html`）\r\n- 在 `README.zh-TW.md` 加上對應的中文版 Demo 連結\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n（無——僅文件更新）\r\n\r\n### Modified Capabilities\r\n（無）\r\n\r\n## Impact\r\n\r\n- 僅影響 `README.md` 和 `README.zh-TW.md`，不涉及程式碼變更\r\n","design":"## Context\r\n\r\nREADME 是使用者接觸 spek 的第一個入口。demo 連結應放在最顯眼的位置，讓人一眼就能找到。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 在兩份 README 的簡介段落加上 demo 連結\r\n\r\n**Non-Goals:**\r\n- 不修改其他文件內容\r\n\r\n## Decisions\r\n\r\n### 連結位置：放在「提供兩種使用方式」之前\r\n\r\n在 \"What is spek?\" 段落的描述文字後、使用方式列表前插入一行 demo 連結。這是使用者閱讀動線中最早遇到的位置，且不打斷既有段落結構。\r\n","tasks":{"total":2,"completed":2,"sections":[{"title":"1. README Updates","tasks":[{"text":"1.1 在 `README.md` 的 \"Available in two forms\" 之前加上 Live Demo 連結","completed":true},{"text":"1.2 在 `README.zh-TW.md` 的「提供兩種使用方式」之前加上線上 Demo 連結","completed":true}]}]},"specs":[],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-15-add-demo-page":{"slug":"2026-02-15-add-demo-page","proposal":"## Why\r\n\r\nspek 目前缺乏一個可以快速展示產品功能的方式。潛在使用者需要先安裝、設定並啟動服務才能看到效果。一個獨立的靜態 HTML demo 頁面，內嵌 spek 自身的 openspec/ 資料，讓任何人開啟瀏覽器就能直觀體驗 OpenSpec 內容檢視的效果。\r\n\r\n## What Changes\r\n\r\n- 新增一個 build script，將 spek 的 `openspec/` 目錄掃描結果序列化為 JSON，嵌入到一個自包含的靜態 HTML 檔案中\r\n- HTML 使用內嵌 CSS + JS，不依賴外部資源，單檔可直接用瀏覽器開啟\r\n- 展示 spek 的核心瀏覽體驗：specs 列表、spec 內容（含 BDD 語法高亮）、changes 列表、change 詳情（含 tasks 進度）\r\n- 視覺風格沿用 spek 深色主題（#0a0c0f 背景 + 琥珀色 accent）\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `demo-page`: 獨立靜態 HTML demo 頁面，內嵌 openspec 資料，展示 spek 的核心瀏覽功能\r\n\r\n### Modified Capabilities\r\n（無）\r\n\r\n## Impact\r\n\r\n- 新增 build script（`scripts/build-demo.ts` 或類似）用於產生 demo HTML\r\n- 新增 `demo/` 或 `docs/` 目錄存放產出的 HTML\r\n- 新增 npm script（如 `npm run build:demo`）\r\n- 不影響現有 web 版或 VS Code extension 功能\r\n- 可搭配 GitHub Pages 部署\r\n","design":"## Context\r\n\r\nspek 已有 ApiAdapter 抽象層（`FetchAdapter` 給 Web 版、`MessageAdapter` 給 VS Code Webview），以及 IIFE 單檔打包的 Webview 先例。要做 demo 頁面，只需新增第三個 adapter 實作 + 對應的 entry point 和 Vite config，完全複用現有 React 元件。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 產出單一 `docs/demo.html`，可在 GitHub Pages 直接瀏覽\r\n- UI / 功能與現有 Web 版完全一致（Dashboard、Specs、Changes、Search）\r\n- 複用所有現有 React 元件，不重寫\r\n\r\n**Non-Goals:**\r\n- 不需要 Repo 選擇頁（資料已內嵌，固定為 spek 自己的 openspec）\r\n- 不需要 resync / browse / detect 功能（靜態資料）\r\n\r\n## Decisions\r\n\r\n### 1. 新增 `StaticAdapter` 實作 `ApiAdapter`\r\n\r\n複用現有 adapter pattern，新增 `StaticAdapter`，從 build time 注入的全域 `window.__DEMO_DATA__` 讀取預先收集的 JSON 資料。所有方法直接 return Promise.resolve，不發 HTTP 也不 postMessage。search 用簡易字串比對實作。\r\n\r\n### 2. 新增 `DemoApp.tsx` + `main.demo.tsx` entry point\r\n\r\n仿照 `WebviewApp.tsx` 的結構，使用 `HashRouter`（`file://` 相容）+ `StaticAdapter`。路由與 Webview 版相同（跳過 SelectRepo）。\r\n\r\n### 3. 新增 `vite.demo.config.ts` — IIFE 打包\r\n\r\n仿照 `vite.webview.config.ts`，打包成 IIFE 格式，產出到暫存目錄。\r\n\r\n### 4. Build script 組裝最終 HTML\r\n\r\n`scripts/build-demo.ts`：\r\n1. 呼叫 `@spek/core` API 收集所有 openspec 資料\r\n2. 執行 `vite build --config vite.demo.config.ts`\r\n3. 讀取產出的 JS/CSS 檔案，inline 進單一 `docs/demo.html`\r\n\r\n### 5. 搜尋用簡易字串比對\r\n\r\n不引入 Fuse.js。`StaticAdapter.search()` 對所有 spec/change 的 markdown 內容做 case-insensitive includes 比對，回傳匹配段落作為 context。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **檔案大小**：React + 所有元件 + 嵌入資料，IIFE 單檔可能 ~300-500KB → 可接受，gzip 後會小很多\r\n- **資料即時性**：build time 快照 → 每次 release 前重新 `npm run build:demo`\r\n","tasks":{"total":8,"completed":8,"sections":[{"title":"1. StaticAdapter","tasks":[{"text":"1.1 Create `packages/web/src/api/StaticAdapter.ts` — 實作 `ApiAdapter`，從 `window.__DEMO_DATA__` 讀取資料，search 用字串比對","completed":true}]},{"title":"2. Demo Entry Point","tasks":[{"text":"2.1 Create `packages/web/src/DemoApp.tsx` — 仿 WebviewApp，使用 HashRouter + StaticAdapter","completed":true},{"text":"2.2 Create `packages/web/src/main.demo.tsx` — demo 進入點","completed":true},{"text":"2.3 Create `packages/web/index.demo.html` — demo HTML template","completed":true}]},{"title":"3. Vite Config","tasks":[{"text":"3.1 Create `packages/web/vite.demo.config.ts` — IIFE 打包，仿 vite.webview.config.ts","completed":true}]},{"title":"4. Build Script","tasks":[{"text":"4.1 Create `scripts/build-demo.ts` — 用 @spek/core 收集資料，執行 vite build，組裝 inline 單檔 HTML 到 `docs/demo.html`","completed":true},{"text":"4.2 在 root `package.json` 新增 `build:demo` script","completed":true}]},{"title":"5. Verification","tasks":[{"text":"5.1 執行 `npm run build:demo` 驗證產出正常，在瀏覽器開啟 `docs/demo.html` 確認功能完整","completed":true}]}]},"specs":[{"topic":"demo-page","content":"## ADDED Requirements\r\n\r\n### Requirement: StaticAdapter implements ApiAdapter\r\nThe system SHALL provide a `StaticAdapter` class that implements the `ApiAdapter` interface, reading all data from a pre-embedded JSON object (`window.__DEMO_DATA__`).\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive string matching across all spec and change content, returning matching results with context snippets\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n\r\n### Requirement: Demo entry point with HashRouter\r\nThe system SHALL provide a `DemoApp.tsx` entry point that uses `HashRouter` and `StaticAdapter`, with the same routes and components as the existing Webview app (Dashboard, Specs, Changes, Search).\r\n\r\n#### Scenario: Render demo app\r\n- **WHEN** user opens `demo.html`\r\n- **THEN** the app renders with Dashboard as the initial view, using all existing React components\r\n\r\n#### Scenario: Hash-based routing\r\n- **WHEN** user navigates between views\r\n- **THEN** the URL hash updates (e.g., `#/specs/api-adapter`) and the app works with `file://` protocol\r\n\r\n### Requirement: Build script generates self-contained demo.html\r\nThe system SHALL provide a build script that collects openspec data using `@spek/core`, runs Vite build, and assembles a single self-contained `docs/demo.html` with all JS, CSS, and data inlined.\r\n\r\n#### Scenario: Build demo\r\n- **WHEN** user runs `npm run build:demo`\r\n- **THEN** system generates `docs/demo.html` containing the complete React app with embedded openspec data\r\n\r\n#### Scenario: Self-contained output\r\n- **WHEN** `docs/demo.html` is generated\r\n- **THEN** the file has no external dependencies and can be opened directly in a browser or served via GitHub Pages\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-15-add-frontend-design-skill":{"slug":"2026-02-15-add-frontend-design-skill","proposal":"## Why\r\n\r\nspek 專案需要一個專門的前端設計 skill，讓 Claude Code 在建立網頁元件、頁面或應用程式時，能產出具有高設計品質的前端介面，避免千篇一律的 AI 生成風格。此 skill 已以 `.agents/skills/frontend-design/` 的形式加入專案，需正式納入 OpenSpec 記錄。\r\n\r\n## What Changes\r\n\r\n- 新增 `.agents/skills/frontend-design/` 目錄，包含 `SKILL.md`（skill 定義與設計指引）和 `LICENSE.txt`\r\n- 新增 `.claude/skills/frontend-design` symlink 指向 `.agents/skills/frontend-design`，讓 Claude Code 自動偵測並載入\r\n- Skill 觸發條件：使用者要求建立網頁元件、頁面、landing page、dashboard、React components、HTML/CSS layouts 或美化 web UI 時\r\n- Skill 內容涵蓋設計思維流程、前端美學指引（typography、color、motion、spatial composition、backgrounds）、避免 generic AI 風格的規範\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `frontend-design-skill`: Claude Code skill 的結構定義與設計指引，涵蓋 skill 目錄結構、symlink 設定、觸發條件、美學規範\r\n\r\n### Modified Capabilities\r\n\r\n（無）\r\n\r\n## Impact\r\n\r\n- 新增檔案：`.agents/skills/frontend-design/SKILL.md`、`.agents/skills/frontend-design/LICENSE.txt`\r\n- 新增 symlink：`.claude/skills/frontend-design`\r\n- 不影響 spek 核心程式碼、API 或 build 流程\r\n","design":"## Context\r\n\r\nspek 專案新增 frontend-design skill，讓 Claude Code 在處理前端設計相關任務時自動載入設計指引。檔案已放置於 `.agents/skills/frontend-design/`，並透過 `.claude/skills/frontend-design` symlink 讓 Claude Code 偵測。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 將 frontend-design skill 檔案正式納入專案版本控制\r\n- 建立 `.agents/skills/` 作為存放 skill 的標準目錄\r\n- 透過 `.claude/skills/` symlink 機制讓 Claude Code 自動載入\r\n\r\n**Non-Goals:**\r\n- 不修改 spek 的核心程式碼或 UI\r\n- 不建立 skill 的自動化測試或 CI 整合\r\n- 不變更現有 build 流程\r\n\r\n## Decisions\r\n\r\n### 1. Skill 存放於 `.agents/skills/` 而非 `.claude/skills/`\r\n\r\n**選擇**：skill 原始檔放在 `.agents/skills/frontend-design/`，`.claude/skills/frontend-design` 為 symlink。\r\n\r\n**理由**：`.claude/` 是 Claude Code 的設定目錄，放置 symlink 即可。實際 skill 內容存放在 `.agents/` 下，語意更清晰——`.agents/` 存放 agent 相關資源，`.claude/` 只做引用。\r\n\r\n### 2. Skill 內容為純靜態文件\r\n\r\n**選擇**：skill 僅包含 `SKILL.md`（指引）和 `LICENSE.txt`（授權），無程式碼。\r\n\r\n**理由**：frontend-design skill 是 prompt-level 的設計指引，不需要執行任何程式碼，純文件即可。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[Symlink 跨平台]** → Windows 可能需要額外設定才能正確建立 symlink；目前 spek 主要在 Linux/macOS 開發，影響有限\r\n- **[Skill 未自動驗證]** → 沒有機制驗證 SKILL.md 格式是否正確；目前依賴 Claude Code 自身的 skill loading 機制\r\n","tasks":{"total":4,"completed":4,"sections":[{"title":"1. Skill 檔案設置","tasks":[{"text":"1.1 確認 `.agents/skills/frontend-design/SKILL.md` 和 `LICENSE.txt` 已存在且內容正確","completed":true},{"text":"1.2 確認 `.claude/skills/frontend-design` symlink 正確指向 `../../.agents/skills/frontend-design`","completed":true}]},{"title":"2. 文件更新","tasks":[{"text":"2.1 更新 CLAUDE.md — 在 Project Structure 加入 `.agents/` 和 `.claude/skills/` 的說明","completed":true},{"text":"2.2 建立 git commit 記錄此變更","completed":true}]}]},"specs":[{"topic":"frontend-design-skill","content":"## ADDED Requirements\r\n\r\n### Requirement: Skill 目錄結構\r\n\r\nfrontend-design skill SHALL 存放於 `.agents/skills/frontend-design/` 目錄下，包含 `SKILL.md` 和 `LICENSE.txt` 兩個檔案。\r\n\r\n#### Scenario: Skill 檔案存在\r\n\r\n- **WHEN** 檢查 `.agents/skills/frontend-design/` 目錄\r\n- **THEN** 目錄中 SHALL 包含 `SKILL.md` 和 `LICENSE.txt`\r\n\r\n### Requirement: Claude Code Skill 註冊\r\n\r\n`.claude/skills/frontend-design` SHALL 為一個 symlink，指向 `../../.agents/skills/frontend-design`，使 Claude Code 能自動偵測並載入此 skill。\r\n\r\n#### Scenario: Symlink 正確指向\r\n\r\n- **WHEN** Claude Code 掃描 `.claude/skills/` 目錄\r\n- **THEN** `frontend-design` symlink SHALL 解析至 `.agents/skills/frontend-design/`\r\n\r\n### Requirement: SKILL.md 包含設計指引\r\n\r\n`SKILL.md` SHALL 包含 frontmatter（name、description、license）以及設計指引內容，涵蓋 Design Thinking 流程和 Frontend Aesthetics Guidelines。\r\n\r\n#### Scenario: Skill 被觸發時提供指引\r\n\r\n- **WHEN** 使用者要求建立網頁元件、頁面、dashboard 或美化 web UI\r\n- **THEN** Claude Code SHALL 載入 SKILL.md 中的設計指引，引導產出高品質前端介面\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-15"}},"2026-02-15-add-readme-acknowledgments":{"slug":"2026-02-15-add-readme-acknowledgments","proposal":"## Why\r\n\r\nspek 的誕生源自龍哥（高見龍）介紹 SDD（Spec Driven Development）的系列文章，以及 Spectra 目前沒有 Linux 版本的現實需求。應在 README 中記載這段緣由，向啟發者致謝。\r\n\r\n## What Changes\r\n\r\n- 在 README.md 末尾（License 之前）新增 `## Acknowledgments` 段落\r\n- 內容包含：\r\n  - 說明專案靈感來源（龍哥的 SDD 文章）\r\n  - 附上兩篇文章連結\r\n  - 說明因 Spectra 無 Linux 版本而催生本專案\r\n- 同步更新 `README.zh-TW.md`（若存在對應位置）\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無新功能）\r\n\r\n### Modified Capabilities\r\n\r\n（無規格變更，僅文件更新）\r\n\r\n## Impact\r\n\r\n- 僅影響 `README.md` 與 `README.zh-TW.md`\r\n- 無程式碼、API 或依賴變更\r\n","design":"## Context\r\n\r\nREADME.md 目前結構為：標題 → What is spek → Features → Screenshots → Quick Start → OpenSpec Directory Structure → Architecture → Development → License。需要在 License 前插入 Acknowledgments 段落。另有 README.zh-TW.md 需同步更新。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 在 README.md 新增 Acknowledgments 段落，致謝龍哥的 SDD 文章\r\n- 同步更新 README.zh-TW.md\r\n\r\n**Non-Goals:**\r\n- 不重構 README 的其他段落\r\n- 不新增其他文件\r\n\r\n## Decisions\r\n\r\n- **段落名稱使用 `Acknowledgments`**：GitHub 社群最廣泛採用的標準名稱\r\n- **放在 License 之前**：符合 GitHub README 慣例順序\r\n- **使用 bullet list + 超連結格式**：簡潔清楚，附上兩篇文章連結\r\n","tasks":{"total":2,"completed":2,"sections":[{"title":"1. README.md","tasks":[{"text":"1.1 在 `## License` 之前新增 `## Acknowledgments` 段落","completed":true}]},{"title":"2. README.zh-TW.md","tasks":[{"text":"2.1 在對應位置新增致謝段落（繁體中文版）","completed":true}]}]},"specs":[{"topic":"readme-acknowledgments","content":"## ADDED Requirements\r\n\r\n### Requirement: README Acknowledgments section\r\n\r\nREADME.md SHALL contain an `## Acknowledgments` section placed immediately before the `## License` section. The section SHALL credit the inspiration sources for the project.\r\n\r\n#### Scenario: Acknowledgments section exists in README.md\r\n- **WHEN** a user reads README.md\r\n- **THEN** an `## Acknowledgments` section appears before `## License`\r\n- **AND** it mentions 龍哥（高見龍）as the inspiration source\r\n- **AND** it links to `https://kaochenlong.com/sdd-spec-driven-development`\r\n- **AND** it links to `https://kaochenlong.com/spectra-with-openspec`\r\n- **AND** it mentions that spek was created because Spectra has no Linux version\r\n\r\n#### Scenario: README.zh-TW.md is in sync\r\n- **WHEN** a user reads README.zh-TW.md\r\n- **THEN** a corresponding acknowledgments section exists with the same content adapted to 繁體中文\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-14-add-changelog-entry":{"slug":"2026-02-14-add-changelog-entry","proposal":"## Why\r\n\r\nVS Code extension CHANGELOG 停留在 `0.1.0` 初始版本，但之後已新增 sidebar 收合/展開功能（來自使用者回饋）。使用者在 Marketplace 或 VS Code 的 extension 頁面看不到最新功能異動，不知道有新增什麼。需要更新 CHANGELOG 並 bump version 以反映新功能。\r\n\r\n## What Changes\r\n\r\n- 更新 `packages/vscode/CHANGELOG.md`，新增 `0.2.0` 版本紀錄，涵蓋 sidebar toggle 功能\r\n- Bump `packages/vscode/package.json` version 從 `0.1.0` 到 `0.2.0`\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無新 capability，僅更新文件與版號）\r\n\r\n### Modified Capabilities\r\n\r\n- `vscode-marketplace-metadata`: 更新 version 欄位與 CHANGELOG 內容\r\n\r\n## Impact\r\n\r\n- `packages/vscode/CHANGELOG.md`：新增版本紀錄\r\n- `packages/vscode/package.json`：version bump\r\n- 不影響任何程式碼邏輯或 runtime 行為\r\n","design":"## Context\r\n\r\nVS Code extension 目前版本為 `0.1.0`，CHANGELOG 只記錄初始發佈。自 0.1.0 之後新增了 sidebar collapse/expand toggle 功能，需要記錄到 CHANGELOG 並 bump 版號。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 新增 `0.2.0` CHANGELOG entry，記錄 sidebar toggle 功能\r\n- Bump package.json version 到 `0.2.0`\r\n\r\n**Non-Goals:**\r\n- 不回溯補齊 0.1.0 以來的所有中間變更（README screenshots 等非功能性變更不需記錄在 extension CHANGELOG）\r\n- 不處理發佈流程（由 `vscode-cicd-publish` change 處理）\r\n\r\n## Decisions\r\n\r\n### 1. 版號策略\r\n\r\n**選擇**: `0.2.0`（minor bump）\r\n**原因**: 新增了使用者可見的功能（sidebar toggle），符合 semver minor 語意。\r\n\r\n### 2. CHANGELOG 格式\r\n\r\n**選擇**: 沿用現有格式（`## version` + bullet list）\r\n**原因**: 保持一致性，簡潔明瞭。\r\n\r\n## Risks / Trade-offs\r\n\r\n- 無顯著風險，純文件變更\r\n","tasks":{"total":5,"completed":5,"sections":[{"title":"1. Version Bump","tasks":[{"text":"1.1 更新 `packages/vscode/package.json` version 從 `0.1.0` 到 `0.2.0`","completed":true}]},{"title":"2. CHANGELOG 更新","tasks":[{"text":"2.1 在 `packages/vscode/CHANGELOG.md` 新增 `0.2.0` 版本區塊，記錄 sidebar collapse toggle 功能","completed":true},{"text":"2.2 建立 root `CHANGELOG.md`，涵蓋專案完整發佈歷程（0.1.0 初始版本 + 0.2.0 sidebar toggle）","completed":true},{"text":"2.3 對齊 `packages/vscode/CHANGELOG.md` 與 root `CHANGELOG.md` 內容一致","completed":true},{"text":"2.4 在 `CLAUDE.md` Conventions 加入 CHANGELOG 同步規範","completed":true}]}]},"specs":[{"topic":"vscode-marketplace-metadata","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Extension version and changelog\r\nExtension SHALL 維護 CHANGELOG.md 記錄每個版本的功能異動，且 package.json version 欄位 SHALL 與最新 CHANGELOG entry 一致。\r\n\r\n#### Scenario: Version bump with new feature\r\n- **WHEN** 新功能（sidebar toggle）已實作完成\r\n- **THEN** package.json version 更新為 `0.2.0`，CHANGELOG.md 包含 `0.2.0` 區塊描述新功能\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-14-add-readme-screenshots":{"slug":"2026-02-14-add-readme-screenshots","proposal":"## Why\r\n\r\nREADME.md 與 README.zh-TW.md 目前只有文字說明，缺乏視覺化的截圖展示。對於初次接觸 spek 的使用者，截圖能快速傳達產品的外觀與功能，大幅提升 README 的可讀性與吸引力。\r\n\r\n## What Changes\r\n\r\n- 新增 `screenshots/` 目錄，存放 6 張深色主題截圖（dashboard、specs-list、spec-detail、changes-list、change-detail、search）\r\n- 在 README.md 的 Features 與 Quick Start 之間新增 \"Screenshots\" 區塊，依序展示各頁面截圖\r\n- 在 README.zh-TW.md 的功能特色與快速開始之間新增「截圖」區塊，內容對應英文版\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無新增功能性 capability，本次僅為文件內容變更）\r\n\r\n### Modified Capabilities\r\n\r\n（無 spec 層級的行為變更）\r\n\r\n## Impact\r\n\r\n- **文件**：README.md、README.zh-TW.md 新增截圖區塊\r\n- **靜態資源**：新增 `screenshots/` 目錄，包含 6 張 PNG 截圖（總計約 900KB）\r\n- **程式碼**：無影響\r\n","design":"## Context\r\n\r\nREADME.md 與 README.zh-TW.md 目前僅有文字描述，缺乏產品截圖。需要截取應用程式各主要頁面的畫面，並嵌入 README 中，讓使用者在 GitHub 上就能預覽 spek 的介面。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 截取 6 張深色主題截圖，涵蓋所有主要頁面\r\n- 在兩個 README 中新增截圖區塊，位於 Features 與 Quick Start 之間\r\n- 截圖使用合理的 viewport 尺寸（1280x800）\r\n\r\n**Non-Goals:**\r\n- 不截取淺色主題的截圖\r\n- 不建立自動化截圖流程\r\n- 不修改任何程式碼\r\n\r\n## Decisions\r\n\r\n1. **截圖存放位置**：使用 `screenshots/` 目錄於專案根目錄，以相對路徑引用。GitHub README 可直接渲染相對路徑的圖片。\r\n2. **深色主題為主**：spek 預設為深色主題，截圖使用深色主題更能代表產品的視覺風格。\r\n3. **截圖內容**：涵蓋 6 個關鍵頁面 — Dashboard、Specs 列表、Spec 詳細（含 BDD 高亮）、Changes 列表、Change 詳細（含分頁）、搜尋功能。\r\n4. **README 插入位置**：放在 Features 與 Quick Start 之間，讓使用者先了解功能，再看到實際畫面，接著是如何開始使用。\r\n\r\n## Risks / Trade-offs\r\n\r\n- [截圖過時] → 當 UI 有重大變更時需手動重新截圖。目前不建立自動化，因為 UI 變更頻率低。\r\n- [圖片大小] → 6 張 PNG 總計約 900KB，對 git repo 影響可接受。\r\n","tasks":{"total":12,"completed":12,"sections":[{"title":"1. 截圖準備","tasks":[{"text":"1.1 建立 `screenshots/` 目錄於專案根目錄","completed":true},{"text":"1.2 啟動 dev server（`npm run dev`）","completed":true},{"text":"1.3 使用瀏覽器以 1280x800 viewport 開啟 http://localhost:5173","completed":true}]},{"title":"2. 截取頁面截圖（深色主題）","tasks":[{"text":"2.1 截取 Dashboard 總覽頁面 → `screenshots/dashboard.png`","completed":true},{"text":"2.2 截取 Specs 列表頁面 → `screenshots/specs-list.png`","completed":true},{"text":"2.3 截取 Spec 詳細頁面（含 BDD 語法高亮）→ `screenshots/spec-detail.png`","completed":true},{"text":"2.4 截取 Changes 列表頁面 → `screenshots/changes-list.png`","completed":true},{"text":"2.5 截取 Change 詳細頁面（含分頁 tabs）→ `screenshots/change-detail.png`","completed":true},{"text":"2.6 截取搜尋對話框（含搜尋結果）→ `screenshots/search.png`","completed":true}]},{"title":"3. 更新 README","tasks":[{"text":"3.1 在 README.md 的 Features 與 Quick Start 之間新增 \"Screenshots\" 區塊","completed":true},{"text":"3.2 在 README.zh-TW.md 的功能特色與快速開始之間新增「截圖」區塊","completed":true},{"text":"3.3 確認 GitHub 可正確渲染所有截圖的相對路徑","completed":true}]}]},"specs":[],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-14-add-sidebar-toggle":{"slug":"2026-02-14-add-sidebar-toggle","proposal":"## Why\r\n\r\n來自 VS Code Marketplace 使用者回饋（Joshua Reed, 5 星）：「This is a very simple but useful extension. It would be even better if a sidebar toggle could be added.」目前 web 版與 VS Code webview 中的 sidebar 導覽列在桌面裝置永遠顯示（240px 寬），無法收合，佔用內容閱讀空間。需要新增 sidebar toggle 功能讓使用者可以折疊 sidebar 以獲得更大的內容區域。\r\n\r\n## What Changes\r\n\r\n- 在 Layout 的 sidebar 區域新增收合/展開 toggle 按鈕\r\n- 收合狀態下 sidebar 縮為窄條（僅顯示導覽 icon），hover 或點擊 icon 可直接導覽\r\n- 展開狀態維持現有完整導覽列\r\n- 主內容區域隨 sidebar 狀態動態調整左邊距\r\n- Web 版將收合狀態記憶到 localStorage，下次開啟時保持上次狀態\r\n- VS Code webview 版同樣支援收合/展開，狀態隨 webview 生命週期\r\n- 共用同一套 Layout 元件邏輯，Web 與 Webview 行為一致\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `sidebar-toggle`: Sidebar 收合/展開功能，包含 toggle 按鈕、收合態 icon-only UI、狀態持久化、與主內容區域自適應佈局\r\n\r\n### Modified Capabilities\r\n\r\n- `shared-layout`: Layout 元件需支援 sidebar collapsed/expanded 狀態，調整主內容區域的左邊距與 sidebar 寬度\r\n\r\n## Impact\r\n\r\n- `packages/web/src/components/Layout.tsx`：新增 sidebar toggle 狀態管理與收合態樣式\r\n- `packages/web/src/components/Sidebar.tsx`：支援收合模式（icon-only 顯示）\r\n- 可能新增 sidebar toggle 相關的 icon 或 SVG 元件\r\n- 不影響後端、API、core module 或 VS Code extension host\r\n","design":"## Context\r\n\r\n目前 Layout 元件在桌面模式下固定渲染 240px 寬的 sidebar（`w-60`），主內容區域用 `ml-60` 左移。行動裝置則用 overlay 模式。使用者反饋希望能折疊 sidebar 以獲得更多閱讀空間。\r\n\r\n現有 Sidebar 元件已接受 `open`、`isMobile`、`onClose` props，桌面模式下不使用 `open` 狀態。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 桌面模式下可收合/展開 sidebar\r\n- 收合態顯示 icon-only 窄條，仍可導覽\r\n- 收合狀態持久化（Web 用 localStorage）\r\n- 動畫過渡流暢\r\n- 行動裝置行為不變\r\n\r\n**Non-Goals:**\r\n- 不做拖曳調整 sidebar 寬度\r\n- 不做 hover 自動展開（僅點擊 toggle）\r\n- 不改變行動版 overlay sidebar 行為\r\n\r\n## Decisions\r\n\r\n### 1. 收合態寬度與 icon 設計\r\n\r\n收合態 sidebar 寬度為 56px（`w-14`），僅顯示導覽項目的 icon。每個導覽連結需新增對應 icon：\r\n- Overview → LayoutDashboard icon（田字格）\r\n- Specs → FileText icon（文件）\r\n- Changes → GitBranch icon（分支）\r\n\r\n**理由**：56px 與 header 高度一致，視覺對齊；icon-only 模式保留導覽功能同時大幅節省空間。\r\n\r\n### 2. Toggle 按鈕位置\r\n\r\n在 sidebar 底部、Resync 按鈕上方放置 toggle 按鈕，使用左右箭頭 chevron icon 指示方向（展開時向左 `«`，收合時向右 `»`）。\r\n\r\n**理由**：底部位置不干擾導覽操作，chevron 方向直覺提示操作結果。\r\n\r\n### 3. 狀態管理\r\n\r\n- Layout 元件新增 `collapsed` state\r\n- Web 版透過 localStorage key `spek-sidebar-collapsed` 持久化\r\n- Webview 版不做持久化（隨 webview 生命週期）\r\n- 傳遞 `collapsed` 和 `onToggle` props 給 Sidebar 元件\r\n\r\n**理由**：狀態提升到 Layout 層級讓主內容區域能同步調整邊距。localStorage 與現有 theme 儲存方式一致。\r\n\r\n### 4. CSS 過渡動畫\r\n\r\n使用 `transition-all duration-200` 讓 sidebar 寬度和主內容區域邊距平滑過渡。\r\n\r\n**理由**：200ms 是常見的 UI 過渡時間，不會讓人感覺拖沓。\r\n\r\n## Risks / Trade-offs\r\n\r\n- [收合態 icon 辨識度] → 使用 tooltip（title 屬性）顯示完整名稱\r\n- [Resync 按鈕在收合態] → 收合態只顯示 resync icon，不顯示文字\r\n- [VS Code webview 空間較小] → 收合態在小 viewport 下更有用，不需特殊處理\r\n","tasks":{"total":12,"completed":12,"sections":[{"title":"1. Sidebar 元件改造","tasks":[{"text":"1.1 為 Sidebar 導覽連結新增 icon（Overview: LayoutDashboard, Specs: FileText, Changes: GitBranch），使用 inline SVG","completed":true},{"text":"1.2 新增 `collapsed` 和 `onToggle` props 到 Sidebar 元件","completed":true},{"text":"1.3 實作收合態 UI：56px 寬度、icon-only 導覽、icon-only Resync 按鈕、各項目加 title tooltip","completed":true},{"text":"1.4 實作 toggle 按鈕：位於 sidebar 底部 Resync 上方，展開時顯示 `«`、收合時顯示 `»`","completed":true},{"text":"1.5 加入 sidebar 寬度與內容的 CSS transition 動畫（200ms）","completed":true}]},{"title":"2. Layout 整合","tasks":[{"text":"2.1 在 Layout 元件新增 `collapsed` state，Web 版從 localStorage 讀取初始值","completed":true},{"text":"2.2 傳遞 `collapsed` 和 `onToggle` props 給 Sidebar","completed":true},{"text":"2.3 主內容區域左邊距隨 collapsed 狀態動態切換（`ml-60` ↔ `ml-14`）","completed":true},{"text":"2.4 確認行動裝置行為不受影響（overlay sidebar 維持不變）","completed":true}]},{"title":"3. 驗證與收尾","tasks":[{"text":"3.1 Web 版測試：收合/展開動畫、狀態持久化、頁面重新整理後恢復","completed":true},{"text":"3.2 VS Code webview 測試：收合/展開功能、預設展開狀態","completed":true},{"text":"3.3 確認 type-check 通過","completed":true}]}]},"specs":[{"topic":"shared-layout","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a sidebar with navigation links: Overview (Dashboard), Specs, and Changes. Each link SHALL have an associated icon (LayoutDashboard for Overview, FileText for Specs, GitBranch for Changes). The current route SHALL be visually highlighted. On viewports below 768px, the sidebar SHALL be hidden by default and displayed as an overlay when toggled. On viewports at or above 768px, the sidebar SHALL support two states: expanded (240px width, showing icons and labels) and collapsed (56px width, showing icons only). A toggle button at the bottom of the sidebar SHALL switch between states. The main content area left margin SHALL adjust to match the current sidebar width.\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes with corresponding icons\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n#### Scenario: Sidebar on mobile viewport\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar is hidden by default and only shown when the hamburger menu is activated\r\n\r\n#### Scenario: Sidebar expanded on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is expanded\r\n- **THEN** the sidebar is displayed at 240px width with icons and text labels, and main content has matching left margin\r\n\r\n#### Scenario: Sidebar collapsed on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is collapsed\r\n- **THEN** the sidebar is displayed at 56px width with icons only, and main content has matching left margin\r\n"},{"topic":"sidebar-toggle","content":"## ADDED Requirements\r\n\r\n### Requirement: Sidebar collapse toggle button\r\nThe system SHALL display a toggle button at the bottom of the sidebar (above the Resync button) that collapses or expands the sidebar. The button SHALL display a left-pointing chevron (`«`) when the sidebar is expanded and a right-pointing chevron (`»`) when collapsed.\r\n\r\n#### Scenario: Toggle sidebar from expanded to collapsed\r\n- **WHEN** the sidebar is expanded and the user clicks the toggle button\r\n- **THEN** the sidebar collapses to 56px width showing only navigation icons\r\n\r\n#### Scenario: Toggle sidebar from collapsed to expanded\r\n- **WHEN** the sidebar is collapsed and the user clicks the toggle button\r\n- **THEN** the sidebar expands to the full 240px width showing icons and labels\r\n\r\n### Requirement: Collapsed sidebar icon-only navigation\r\nThe system SHALL display navigation items as icon-only buttons when the sidebar is collapsed. Each navigation link SHALL display a corresponding icon: LayoutDashboard icon for Overview, FileText icon for Specs, and GitBranch icon for Changes. Each icon button SHALL include a `title` attribute showing the full link label.\r\n\r\n#### Scenario: Display collapsed navigation with icons\r\n- **WHEN** the sidebar is in collapsed state\r\n- **THEN** navigation items display as icon-only buttons with tooltips\r\n\r\n#### Scenario: Navigate from collapsed sidebar\r\n- **WHEN** the user clicks a navigation icon in collapsed state\r\n- **THEN** the app navigates to the corresponding route\r\n\r\n#### Scenario: Active route indication in collapsed state\r\n- **WHEN** the user is on the Specs page and sidebar is collapsed\r\n- **THEN** the Specs icon is highlighted with the accent color\r\n\r\n### Requirement: Collapsed sidebar Resync button\r\nThe system SHALL display the Resync button as icon-only in collapsed state, without the text label, and with a `title` attribute for tooltip.\r\n\r\n#### Scenario: Resync button in collapsed state\r\n- **WHEN** the sidebar is collapsed\r\n- **THEN** the Resync button displays only the sync icon with a tooltip\r\n\r\n### Requirement: Sidebar collapse state persistence\r\nThe system SHALL persist the sidebar collapse state to localStorage (key: `spek-sidebar-collapsed`) in the web version. On page load, the sidebar SHALL restore the previously saved state. In VS Code webview, the state SHALL default to expanded and not persist across sessions.\r\n\r\n#### Scenario: Persist collapsed state in web version\r\n- **WHEN** the user collapses the sidebar and refreshes the page\r\n- **THEN** the sidebar remains collapsed after reload\r\n\r\n#### Scenario: Default state in VS Code webview\r\n- **WHEN** the webview is first opened\r\n- **THEN** the sidebar is in expanded state\r\n\r\n### Requirement: Sidebar transition animation\r\nThe system SHALL animate the sidebar width change and main content margin with a smooth CSS transition (200ms duration).\r\n\r\n#### Scenario: Smooth collapse animation\r\n- **WHEN** the user clicks the toggle button\r\n- **THEN** the sidebar width and main content margin animate smoothly over 200ms\r\n\r\n### Requirement: Mobile behavior unchanged\r\nThe sidebar toggle feature SHALL only apply to desktop viewports (768px and above). On mobile viewports, the existing overlay sidebar behavior SHALL remain unchanged.\r\n\r\n#### Scenario: Mobile viewport ignores collapse state\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar uses the existing overlay behavior regardless of collapse state\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-14-vscode-cicd-publish":{"slug":"2026-02-14-vscode-cicd-publish","proposal":"## Why\r\n\r\n目前發佈 VS Code extension 需要多步手動操作（build core → build webview → build extension → cd packages/vscode → vsce publish），無法從 repo root 一行完成，容易遺漏步驟或 build 順序錯誤。設定 CI/CD 讓 push tag 時自動完成整個 build + publish 流程。\r\n\r\n## What Changes\r\n\r\n- 新增 GitHub Actions workflow，於 push `v*` tag 時觸發\r\n- Workflow 自動執行完整 build chain（core → webview → extension）並發佈到 VS Code Marketplace\r\n- 需要在 GitHub repo 設定 `VSCE_PAT` secret（Personal Access Token）\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `vscode-cicd`: GitHub Actions workflow 定義，包含 tag 觸發條件、build 步驟、marketplace 發佈\r\n\r\n### Modified Capabilities\r\n\r\n（無既有 spec 需修改）\r\n\r\n## Impact\r\n\r\n- 新增 `.github/workflows/` 目錄及 workflow YAML 檔\r\n- 不影響現有程式碼或 runtime 行為\r\n- 需要 repo maintainer 在 GitHub Settings → Secrets 設定 `VSCE_PAT`\r\n","design":"## Context\r\n\r\n目前 VS Code extension 發佈需要手動在本機執行多步驟：build core → build webview → build extension → cd packages/vscode → vsce publish。這個流程容易遺漏步驟，且無法從 repo root 一行完成。專案目前沒有任何 GitHub Actions workflow。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- Push `v*` tag 時自動觸發 CI/CD pipeline\r\n- 自動完成完整 build chain 並發佈到 VS Code Marketplace\r\n- 支援手動觸發（workflow_dispatch）方便除錯\r\n\r\n**Non-Goals:**\r\n- 不處理 Web 版的 CI/CD（僅限 VS Code extension）\r\n- 不自動建立 GitHub Release\r\n- 不自動 bump version（version 由開發者手動更新 package.json 後 push tag）\r\n\r\n## Decisions\r\n\r\n### 1. Tag 命名採用 `v*` 格式\r\n\r\n**選擇**: 使用 `v*`（例如 `v0.2.0`）\r\n**原因**: 專案功能統一，Web 版與 VS Code extension 共用同一版號，不需要 prefix 區分。\r\n\r\n### 2. 使用 `VSCE_PAT` secret 認證\r\n\r\n**選擇**: Personal Access Token via GitHub Secret\r\n**原因**: 這是 `vsce publish` 的標準認證方式，簡單直接。替代方案如 Azure DevOps service connection 過於複雜。\r\n\r\n### 3. 單一 workflow 檔案，不拆分 build/publish jobs\r\n\r\n**選擇**: 單一 job 完成 build + publish\r\n**原因**: 步驟間有嚴格依賴關係（core → webview → extension → publish），拆分 jobs 需要 artifact 傳遞，增加複雜度但無實質好處。\r\n\r\n### 4. Node.js 版本策略\r\n\r\n**選擇**: 使用 Node.js 20（LTS）\r\n**原因**: 對齊本地開發環境，且 GitHub Actions runner 預裝此版本。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[PAT 過期]** → VSCE_PAT 過期時 publish 會失敗。Mitigation: 使用長效 token 並設 calendar reminder 更新。\r\n- **[Marketplace 發佈失敗]** → 網路問題或 Marketplace 暫時不可用。Mitigation: 可手動重新 trigger workflow。\r\n- **[Version 衝突]** → 忘記更新 version 就 push tag，Marketplace 會拒絕。Mitigation: Workflow 中加入 version check 步驟，從 tag 提取版號與 package.json 比對。\r\n","tasks":{"total":9,"completed":9,"sections":[{"title":"1. Workflow 建立","tasks":[{"text":"1.1 建立 `.github/workflows/vscode-publish.yml` workflow 檔案","completed":true},{"text":"1.2 設定觸發條件：push `v*` tag + workflow_dispatch","completed":true}]},{"title":"2. Build Chain","tasks":[{"text":"2.1 設定 Node.js 20 環境與 npm install","completed":true},{"text":"2.2 加入 build 步驟：build core → build webview → build extension","completed":true}]},{"title":"3. Version Check & Publish","tasks":[{"text":"3.1 加入 version consistency check（從 tag 提取版號與 package.json 比對）","completed":true},{"text":"3.2 加入 vsce publish 步驟，使用 `VSCE_PAT` secret","completed":true}]},{"title":"4. Version 同步","tasks":[{"text":"4.1 Root package.json 版號同步為 `0.2.0`","completed":true},{"text":"4.2 加入 `version` lifecycle script，`npm version` 時自動同步版號到 `packages/vscode/package.json` 並 stage","completed":true},{"text":"4.3 建立 `/release` skill 自動化發佈流程（CHANGELOG 更新 → npm version → push tag）","completed":true}]}]},"specs":[{"topic":"vscode-cicd","content":"## ADDED Requirements\r\n\r\n### Requirement: Tag-triggered publish workflow\r\n系統 SHALL 提供 GitHub Actions workflow，於 push 符合 `v*` pattern 的 tag 時自動觸發 VS Code extension 的 build 與 publish 流程。\r\n\r\n#### Scenario: Push version tag triggers workflow\r\n- **WHEN** 開發者 push 一個 `v0.2.0` 格式的 tag\r\n- **THEN** GitHub Actions workflow 自動觸發並執行完整 build chain\r\n\r\n#### Scenario: Non-matching tag does not trigger\r\n- **WHEN** 開發者 push 一個 `release-0.2.0` 或 `feat/something` 格式的 ref\r\n- **THEN** 此 workflow 不被觸發\r\n\r\n### Requirement: Full build chain execution\r\nWorkflow SHALL 依序執行完整 build chain：install dependencies → build @spek/core → build webview assets → build VS Code extension。\r\n\r\n#### Scenario: Build chain completes successfully\r\n- **WHEN** workflow 被觸發且所有 build 步驟成功\r\n- **THEN** `packages/vscode/dist/extension.js` 和 webview assets 皆存在且為最新\r\n\r\n#### Scenario: Build failure stops pipeline\r\n- **WHEN** 任一 build 步驟失敗\r\n- **THEN** 後續步驟不執行，workflow 標記為失敗\r\n\r\n### Requirement: Marketplace publish\r\nWorkflow SHALL 使用 `VSCE_PAT` secret 透過 `vsce publish` 將 extension 發佈到 VS Code Marketplace。\r\n\r\n#### Scenario: Successful publish\r\n- **WHEN** build chain 完成且 `VSCE_PAT` secret 有效\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Missing PAT secret\r\n- **WHEN** `VSCE_PAT` secret 未設定或已過期\r\n- **THEN** publish 步驟失敗，workflow 標記為失敗\r\n\r\n### Requirement: Manual trigger support\r\nWorkflow SHALL 支援 `workflow_dispatch` 手動觸發，方便除錯和測試。\r\n\r\n#### Scenario: Manual trigger from Actions UI\r\n- **WHEN** 開發者在 GitHub Actions UI 手動觸發此 workflow\r\n- **THEN** workflow 執行完整 build + publish 流程\r\n\r\n### Requirement: Version consistency check\r\nWorkflow SHALL 在 publish 前驗證 tag 版號與 `packages/vscode/package.json` 中的 version 欄位一致。\r\n\r\n#### Scenario: Version matches\r\n- **WHEN** tag `v0.2.0` 且 package.json version 為 `0.2.0`\r\n- **THEN** 繼續執行 publish\r\n\r\n#### Scenario: Version mismatch\r\n- **WHEN** tag `v0.3.0` 但 package.json version 為 `0.2.0`\r\n- **THEN** workflow 失敗並輸出版號不一致的錯誤訊息\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-14"}},"2026-02-13-add-readme":{"slug":"2026-02-13-add-readme","proposal":"## Why\r\n\r\n專案即將發佈到 GitHub，目前缺少 README 文件。沒有 README 的 repo 無法讓訪客快速了解專案用途、安裝方式和技術架構。\r\n\r\n## What Changes\r\n\r\n- 新增 `README.md`（英文版），包含專案介紹、功能特色、快速開始、架構說明、開發指令\r\n- 新增 `README.zh-TW.md`（繁體中文版），內容對應英文版，使用台灣用語\r\n- 兩份 README 互相連結，讀者可切換語言\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無 — 本次變更不涉及任何功能或行為變更，僅新增文件）\r\n\r\n### Modified Capabilities\r\n\r\n（無 — 不影響任何現有 spec）\r\n\r\n## Impact\r\n\r\n- 僅影響 repo 根目錄的文件檔案，不涉及程式碼、API、依賴或系統變更\r\n- GitHub repo 首頁將顯示 README.md 內容\r\n","design":"## Context\r\n\r\n專案即將發佈到 GitHub，需要 README 作為訪客的第一進入點。目前 repo 沒有 README 檔案，只有 `CLAUDE.md`（開發指引）和 `docs/prd.md`（產品需求文件），兩者都不適合作為公開的專案介紹。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 提供英文版 README.md 作為 GitHub 預設顯示\r\n- 提供繁體中文版 README.zh-TW.md 給台灣開發者\r\n- 涵蓋專案介紹、功能特色、快速開始、架構說明、開發指令\r\n\r\n**Non-Goals:**\r\n- 不撰寫 API 文件（已有 CLAUDE.md 涵蓋）\r\n- 不建立 GitHub Pages 或文件網站\r\n- 不新增截圖（可日後補充）\r\n\r\n## Decisions\r\n\r\n1. **雙語 README 以獨立檔案呈現**\r\n   - `README.md`（英文）+ `README.zh-TW.md`（繁中），頂部互相連結\r\n   - 替代方案：單一檔案雙語混排 → 排版混亂、不易維護\r\n   - 替代方案：只寫英文 → 專案以台灣開發者為主要受眾，需要中文版\r\n\r\n2. **引用 `logo/full-logo.svg` 作為頂部 Logo**\r\n   - SVG 格式在 GitHub 上直接渲染，不需額外處理\r\n   - 替代方案：使用 PNG → 需額外轉檔維護\r\n\r\n3. **README 內容結構**\r\n   - 參考 GitHub 上主流開源專案的 README 結構\r\n   - 包含：Logo → 一句話簡介 → 功能列表 → Quick Start → 架構 → 開發指令 → License\r\n\r\n## Risks / Trade-offs\r\n\r\n- SVG Logo 在某些 GitHub 客戶端可能不渲染 → 影響輕微，降級為純文字無礙閱讀\r\n- 中文版需與英文版同步維護 → 內容不多，維護成本低\r\n","tasks":{"total":6,"completed":6,"sections":[{"title":"1. README 英文版","tasks":[{"text":"1.1 建立 `README.md`，包含 Logo、專案簡介、功能特色、Quick Start（Web + VS Code Extension）、OpenSpec 目錄結構說明、架構（Monorepo + API Adapter + Tech Stack）、開發指令、License","completed":true},{"text":"1.2 確認 GitHub repo URL 為 `https://github.com/kewang/spek.git`","completed":true},{"text":"1.3 確認 OpenSpec 連結為 `https://github.com/Fission-AI/OpenSpec`","completed":true}]},{"title":"2. README 繁體中文版","tasks":[{"text":"2.1 建立 `README.zh-TW.md`，內容對應英文版，使用台灣用語","completed":true},{"text":"2.2 兩份 README 頂部互相加上語言切換連結","completed":true}]},{"title":"3. 驗證","tasks":[{"text":"3.1 確認兩份 README 的連結正確、結構完整","completed":true}]}]},"specs":[],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-apply-brand-logo":{"slug":"2026-02-13-apply-brand-logo","proposal":"## Why\r\n\r\nspek 目前僅使用純文字 \"S\" 作為 favicon，缺乏品牌識別度。已設計完成一套完整的 SVG logo 系統（logomark、full logo、favicon），需要套用到專案的 favicon 及 UI header 中，建立統一的品牌視覺。\r\n\r\n## What Changes\r\n\r\n- 替換所有 favicon.svg（web、vscode webview）為新設計的品牌 logo\r\n- 在 Layout header 中加入 SVG logomark，取代純文字 \"spek\"\r\n- 保留 `logo/` 目錄作為品牌素材來源\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無新 capability）\r\n\r\n### Modified Capabilities\r\n\r\n- `shared-layout`: Header component 的 brand 區域從純文字改為 SVG logomark + 文字組合\r\n\r\n## Impact\r\n\r\n- `packages/web/public/favicon.svg` — 替換為新 favicon\r\n- `packages/vscode/webview/favicon.svg` — 同步替換\r\n- `packages/web/src/components/Layout.tsx` — header brand 區域加入 SVG icon\r\n- 無 API 變更、無依賴變更\r\n","design":"## Context\r\n\r\nspek 目前使用純文字 \"S\" 作為 favicon（`<text>` 元素），header 中也僅顯示純文字 \"spek\"。已設計好一套 SVG logo 系統放在 `logo/` 目錄，包含 logomark、full logo、favicon，需要整合到專案中。\r\n\r\n現有 favicon 位置：\r\n- `packages/web/public/favicon.svg`（Web 版）\r\n- `packages/vscode/webview/favicon.svg`（VS Code Webview）\r\n- `public/favicon.svg`、`dist/favicon.svg`（舊檔案，可能未使用）\r\n\r\nHeader brand 區域在 `packages/web/src/components/Layout.tsx` 第 63 行：\r\n```tsx\r\n<span className=\"text-accent font-bold text-lg\">spek</span>\r\n```\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 將新設計的 favicon SVG 替換所有既有 favicon\r\n- 在 header brand 區域加入 inline SVG logomark（S 曲線 + 菱形光點）\r\n- 保持深色/淺色主題相容性\r\n\r\n**Non-Goals:**\r\n- 不修改 SelectRepo 頁面的大標題（那邊維持純文字即可）\r\n- 不新增 PNG/ICO 等其他格式\r\n- 不修改 VS Code extension 的 icon（那是 marketplace 用的，與 webview favicon 不同）\r\n\r\n## Decisions\r\n\r\n### 1. Favicon 直接使用 `logo/favicon.svg` 內容覆蓋\r\n\r\n直接將 `logo/favicon.svg` 的內容複製到各個 `favicon.svg` 位置，而非用 symlink 或 build step 引用。原因：webview 打包時需要實際檔案，symlink 在某些環境不可靠。\r\n\r\n### 2. Header logomark 使用 inline SVG 而非 `<img>`\r\n\r\n在 Layout.tsx 中直接內嵌 SVG 路徑（S 曲線 + 菱形），而非引用外部 SVG 檔案。原因：\r\n- 避免額外 HTTP 請求\r\n- 可直接使用 CSS 變數（`currentColor`）配合主題切換\r\n- Logo 很小（幾行 path），不會膨脹 bundle\r\n\r\n### 3. Header logo 使用 `currentColor` 搭配 accent 色\r\n\r\n不硬編碼 `#f59e0b`，而是使用 Tailwind 的 `text-accent` class 讓 SVG 的 `currentColor` 自動跟隨主題。這樣深色/淺色主題切換時 logo 顏色會自動調整。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[Risk]** Favicon 在某些瀏覽器快取後不更新 → 使用者清除快取即可，非阻塞問題\r\n- **[Trade-off]** Inline SVG vs 外部檔案：稍增 JSX 行數，但省去載入延遲和額外請求\r\n","tasks":{"total":5,"completed":5,"sections":[{"title":"1. Favicon 替換","tasks":[{"text":"1.1 將 `logo/favicon.svg` 內容複製到 `packages/web/public/favicon.svg`","completed":true},{"text":"1.2 將 `logo/favicon.svg` 內容複製到 `packages/vscode/webview/favicon.svg`","completed":true}]},{"title":"2. Header Logomark","tasks":[{"text":"2.1 在 `Layout.tsx` header 的 brand 區域加入 inline SVG logomark（S 曲線 + 菱形光點，使用 `currentColor`），放在 \"spek\" 文字左側","completed":true},{"text":"2.2 確認深色與淺色主題下 logo 顏色正確跟隨 accent 色","completed":true}]},{"title":"3. 清理","tasks":[{"text":"3.1 移除根目錄 `public/favicon.svg` 和 `dist/favicon.svg` 舊檔案（若為過時副本）","completed":true}]}]},"specs":[{"topic":"shared-layout","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: an inline SVG logomark (S-curve with diamond accents, 24x24) followed by the \"spek\" brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button and hide the repo path. The header SHALL also include a theme toggle button. The logomark SVG SHALL use `currentColor` to follow the accent color, ensuring theme compatibility.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the SVG logomark alongside \"spek\" brand text, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button, the SVG logomark alongside \"spek\" brand text, search button, and theme toggle, but hides the repo path\r\n\r\n#### Scenario: Logo theme compatibility\r\n- **WHEN** the user toggles between dark and light theme\r\n- **THEN** the logomark color adjusts automatically via the accent color CSS variable\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-fix-task-stats-and-capability-nav":{"slug":"2026-02-13-fix-task-stats-and-capability-nav","proposal":"## Why\r\n\r\nDashboard 的 task completion 永遠顯示 0%，因為 overview API 只統計 active changes 的 task stats，但實際上所有 changes 都已 archived。此外，Change detail 頁面的 Proposal tab 中 Capabilities 區塊列出的 capability ID 應該可以點擊導航到對應的 spec 頁面，目前只是純文字無法互動。\r\n\r\n## What Changes\r\n\r\n- 修正 overview API 的 taskStats 統計邏輯，將 archived changes 的 tasks 納入計算\r\n- 在 Change detail 的 Proposal tab 中，將 capability ID（反引號包裹的 kebab-case 識別碼）渲染為可點擊的連結，導航到對應的 `/specs/:topic` 頁面\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無）\r\n\r\n### Modified Capabilities\r\n\r\n- `openspec-api`: overview endpoint 的 taskStats 改為統計所有 changes（含 archived），而非僅 active changes\r\n- `change-browsing`: Proposal tab 中的 capability ID 應渲染為可導航至對應 spec 的連結\r\n\r\n## Impact\r\n\r\n- **後端**: `server/routes/openspec.ts` — overview endpoint 的 taskStats 聚合邏輯\r\n- **前端**: `src/components/MarkdownRenderer.tsx` 或 `src/pages/ChangeDetail.tsx` — capability ID 連結渲染\r\n- **Spec 更新**: `openspec-api` 與 `change-browsing` 的 spec 需更新以反映新行為\r\n","design":"## Context\r\n\r\nDashboard 的 task completion 永遠 0%，根因是 `server/routes/openspec.ts` 第 24 行 overview endpoint 只遍歷 `scan.activeChanges`，但目前所有 changes 皆已 archived。另外，Change detail 的 Proposal tab 中 Capabilities 區塊的 capability ID 以反引號包裹但僅渲染為靜態 `<code>`，無法導航至對應的 spec 頁面。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n\r\n- Overview endpoint 的 taskStats 統計所有 changes（active + archived）的任務完成度\r\n- Proposal markdown 中以反引號包裹的 capability ID（如 `` `responsive-layout` ``）在列表項中渲染為可點擊的連結，導航至 `/specs/:topic`\r\n\r\n**Non-Goals:**\r\n\r\n- 不改變 `/api/openspec/changes` 或 `/api/openspec/changes/:slug` 的回傳格式\r\n- 不新增 capability 專屬的 API endpoint\r\n- 不對所有 inline code 都做連結，僅處理 Capabilities 區塊下的列表項\r\n\r\n## Decisions\r\n\r\n### 1. Overview taskStats 聚合 active + archived\r\n\r\n在 `server/routes/openspec.ts` 的 overview handler 中，將遍歷對象從 `scan.activeChanges` 改為 `[...scan.activeChanges, ...scan.archivedChanges]`。\r\n\r\n**理由**: 最小改動，一行修正，且語義正確——Dashboard 應反映整個 repo 的任務進度。\r\n\r\n### 2. MarkdownRenderer inline code 連結化\r\n\r\n在 `src/components/MarkdownRenderer.tsx` 的 `code` component（inline code 分支）中，檢查 code 內容是否為 kebab-case 格式且對應到已知 spec topic。若符合，渲染為 React Router `<Link>` 導航至 `/specs/:topic`。\r\n\r\n需要的資訊：spec topics 清單。方案是讓 MarkdownRenderer 接受可選的 `specTopics?: string[]` prop，由 ChangeDetail 頁面傳入（從 `/api/openspec/specs` 取得）。\r\n\r\n**理由**:\r\n- 將連結邏輯放在 MarkdownRenderer 而非 ChangeDetail，因為 markdown 內容結構由 renderer 控制\r\n- 使用 prop 傳入 spec topics 而非在 renderer 中呼叫 API，保持元件純粹\r\n- 僅在 specTopics 有傳入且內容匹配時才連結化，避免誤連不存在的 spec\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[風險] inline code 誤判**: 有些 inline code 可能恰好符合 kebab-case 格式但不是 capability ID → 以 specTopics 白名單比對來避免，只有確實存在的 spec 才會連結化\r\n- **[風險] spec 清單多一次 API 呼叫**: ChangeDetail 頁面需額外 fetch spec 清單 → 此呼叫已在 useOpenSpec hook 中存在（`useSpecs`），可直接複用\r\n","tasks":{"total":7,"completed":7,"sections":[{"title":"1. Fix overview taskStats aggregation","tasks":[{"text":"1.1 修改 `server/routes/openspec.ts` overview endpoint，將 taskStats 遍歷對象從 `scan.activeChanges` 改為 `[...scan.activeChanges, ...scan.archivedChanges]`","completed":true},{"text":"1.2 更新 `openspec/specs/openspec-api/spec.md` 的 overview scenario 描述，反映新的聚合邏輯","completed":true}]},{"title":"2. Add capability ID linking in MarkdownRenderer","tasks":[{"text":"2.1 在 `src/components/MarkdownRenderer.tsx` 的 props 新增可選的 `specTopics?: string[]`","completed":true},{"text":"2.2 修改 inline `code` component，當 specTopics 包含該 code 文字時渲染為 React Router `<Link>` 至 `/specs/:topic`","completed":true},{"text":"2.3 在 `src/pages/ChangeDetail.tsx` 中取得 spec topics 清單並傳入 MarkdownRenderer","completed":true}]},{"title":"3. Verification","tasks":[{"text":"3.1 啟動 dev server，確認 Dashboard task completion 顯示正確百分比","completed":true},{"text":"3.2 確認 Change detail Proposal tab 中的 capability ID 可點擊導航至對應 spec 頁面","completed":true}]}]},"specs":[{"topic":"change-browsing","content":"## ADDED Requirements\r\n\r\n### Requirement: Capability ID linking in proposal\r\nThe system SHALL render inline code elements in proposal markdown as navigable links when the code text matches an existing spec topic name.\r\n\r\n#### Scenario: Capability ID matches existing spec\r\n- **WHEN** a proposal markdown contains an inline code element (e.g., `` `responsive-layout` ``)\r\n- **AND** a spec with the topic name `responsive-layout` exists\r\n- **THEN** the inline code SHALL be rendered as a clickable link navigating to `/specs/responsive-layout`\r\n\r\n#### Scenario: Inline code does not match any spec\r\n- **WHEN** a proposal markdown contains an inline code element that does not match any existing spec topic\r\n- **THEN** the inline code SHALL be rendered as a normal styled code element without a link\r\n\r\n#### Scenario: MarkdownRenderer receives spec topics list\r\n- **WHEN** MarkdownRenderer is used with a `specTopics` prop containing the list of available spec topic names\r\n- **THEN** inline code matching any topic in the list SHALL be rendered as navigable links\r\n"},{"topic":"openspec-api","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Overview endpoint\r\nThe system SHALL provide `GET /api/openspec/overview` that returns aggregate statistics for an OpenSpec repository.\r\n\r\n#### Scenario: Get overview of repo with specs and changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `specsCount`, `changesCount` (with `active` and `archived` breakdown), and `taskStats` (aggregate `total` and `completed` across all changes, including both active and archived)\r\n\r\n#### Scenario: Get overview with only archived changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** there are no active changes but archived changes have tasks\r\n- **THEN** system returns `taskStats` with correct `total` and `completed` counts from archived changes\r\n\r\n#### Scenario: Get overview of repo with no specs\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** the repo has no `openspec/specs/` directory\r\n- **THEN** system returns `specsCount: 0` with changes still counted correctly\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-initial-implementation":{"slug":"2026-02-13-initial-implementation","proposal":"# spek — OpenSpec Viewer PRD\r\n\r\n## Context\r\n\r\nOpenSpec 是一個 spec-driven 的工作流程管理結構，在實際專案中會累積大量的 specs、changes（含 proposal/design/tasks）。目前這些內容只能透過檔案系統或文字編輯器閱讀，缺乏結構化瀏覽、搜尋、狀態總覽能力。\r\n\r\n**目標**：建立一個輕量級的本地 Web 應用程式 `spek`，使用者 clone 後啟動，選擇包含 `openspec/` 的 repo 路徑即可瀏覽內容。\r\n\r\n---\r\n\r\n## 1. 產品定位\r\n\r\n- **專案名稱**：`spek`\r\n- **定位**：OpenSpec 內容的本地唯讀檢視器\r\n- **使用流程**：`git clone` → `npm install` → `npm run dev` → 瀏覽器開啟 → 選擇 repo 路徑 → 瀏覽內容\r\n\r\n## 2. 非目標\r\n\r\n- 不做內容編輯功能（唯讀）\r\n- 不做使用者認證或權限管理\r\n- 不做 OpenSpec 工作流程管理（建立/封存 change 等操作）\r\n- 不做雲端部署版本（純本地工具）\r\n\r\n---\r\n\r\n## 3. OpenSpec 資料結構\r\n\r\n```\r\n{repo}/openspec/\r\n├── config.yaml                    # schema: spec-driven\r\n├── specs/                         # Spec 主題目錄\r\n│   └── {topic}/spec.md           # BDD 格式規格 (WHEN/THEN/AND)\r\n└── changes/\r\n    ├── archive/                   # 已封存變更\r\n    │   └── {YYYY-MM-DD-desc}/\r\n    │       ├── .openspec.yaml    # schema + created date\r\n    │       ├── proposal.md       # Why / What Changes / Capabilities / Impact\r\n    │       ├── design.md         # Context / Goals / Decisions / Risks\r\n    │       ├── tasks.md          # Checkbox 任務清單\r\n    │       └── specs/            # 該 change 的 delta specs\r\n    └── {active-change}/          # 進行中變更（同結構）\r\n```\r\n\r\n**內容特徵**：\r\n- 繁中+英文混排\r\n- BDD 語法：WHEN/THEN/AND/MUST\r\n- 任務用 `- [x]` / `- [ ]` checkbox\r\n- Change 命名：`YYYY-MM-DD-description`\r\n\r\n---\r\n\r\n## 4. 技術架構\r\n\r\n### 4.1 技術選型\r\n\r\n| 層面 | 選擇 | 理由 |\r\n|------|------|------|\r\n| **Backend** | Node.js + Express | 讀取本地檔案系統，提供 REST API |\r\n| **Frontend** | React + Vite | 使用者的 Rewire 專案同技術棧，熟悉且輕量 |\r\n| **Markdown 渲染** | react-markdown + remark-gfm | 支援 GFM checkbox、表格等 |\r\n| **搜尋** | Fuse.js (client-side) | 輕量模糊搜尋，無需額外服務 |\r\n| **樣式** | Tailwind CSS v4 | 快速開發，深色主題支援 |\r\n| **語言** | TypeScript | 前後端一致的型別安全 |\r\n\r\n### 4.2 專案結構\r\n\r\n```\r\nspek/\r\n├── package.json\r\n├── tsconfig.json\r\n├── vite.config.ts\r\n├── server/\r\n│   ├── index.ts               # Express 入口，啟動 API server\r\n│   ├── routes/\r\n│   │   ├── openspec.ts        # /api/openspec/* — 讀取 OpenSpec 資料\r\n│   │   └── filesystem.ts      # /api/fs/* — 目錄瀏覽（選擇 repo 用）\r\n│   └── lib/\r\n│       ├── scanner.ts         # OpenSpec 目錄掃描 + 解析\r\n│       └── tasks.ts           # tasks.md checkbox 解析 + 統計\r\n├── src/\r\n│   ├── main.tsx               # React 入口\r\n│   ├── App.tsx                # 路由設定\r\n│   ├── pages/\r\n│   │   ├── SelectRepo.tsx     # 首頁：選擇/輸入 repo 路徑\r\n│   │   ├── Dashboard.tsx      # 專案總覽 dashboard\r\n│   │   ├── SpecList.tsx       # Specs 列表\r\n│   │   ├── SpecDetail.tsx     # Spec 詳細頁面\r\n│   │   ├── ChangeList.tsx     # Changes 時間線\r\n│   │   └── ChangeDetail.tsx   # Change 詳細（tab: proposal/design/tasks/specs）\r\n│   ├── components/\r\n│   │   ├── Layout.tsx         # 共用佈局（sidebar + header）\r\n│   │   ├── Sidebar.tsx        # 側邊導覽\r\n│   │   ├── MarkdownRenderer.tsx  # Markdown 渲染 + BDD 高亮\r\n│   │   ├── TaskProgress.tsx   # 任務進度條\r\n│   │   ├── SearchDialog.tsx   # 搜尋對話框 (Cmd+K)\r\n│   │   └── TabView.tsx        # Tab 切換元件\r\n│   ├── hooks/\r\n│   │   └── useOpenSpec.ts     # API 呼叫 hooks\r\n│   └── styles/\r\n│       └── global.css         # Tailwind + 自訂樣式\r\n└── public/\r\n    └── favicon.svg\r\n```\r\n\r\n### 4.3 API 設計\r\n\r\n```\r\nGET  /api/fs/browse?path=...        # 瀏覽目錄（選擇 repo 用）\r\nGET  /api/fs/detect?path=...        # 偵測指定路徑是否有 openspec/\r\n\r\nGET  /api/openspec/overview?dir=... # 總覽（specs數量、changes數量、任務統計）\r\nGET  /api/openspec/specs?dir=...    # Spec 主題列表\r\nGET  /api/openspec/specs/:topic?dir=...  # 單一 spec 內容 + 關聯 changes\r\nGET  /api/openspec/changes?dir=...  # Changes 列表（含任務統計）\r\nGET  /api/openspec/changes/:slug?dir=... # 單一 change 完整內容\r\nGET  /api/openspec/search?dir=...&q=...  # 全文搜尋\r\n```\r\n\r\n### 4.4 啟動方式\r\n\r\n```bash\r\n# Clone 後啟動\r\ngit clone <spek-repo>\r\ncd spek\r\nnpm install\r\nnpm run dev        # 啟動 Vite dev server + Express API server (concurrently)\r\n\r\n# 瀏覽器開啟 http://localhost:5173\r\n# 在 UI 中輸入或瀏覽選擇 repo 路徑\r\n```\r\n\r\n---\r\n\r\n## 5. 功能需求\r\n\r\n### FR-1：選擇 Repo\r\n\r\n- 首頁顯示路徑輸入框\r\n- 輸入路徑後自動偵測是否有 `openspec/` 目錄\r\n- 記住最近使用的路徑（localStorage）\r\n- 偵測成功後自動跳轉到 Dashboard\r\n\r\n### FR-2：Dashboard 總覽\r\n\r\n- Specs 數量、Changes 數量（active/archived）、任務完成率\r\n- Active changes 列表（含進度條）\r\n- 最近封存的 changes（最近 10 個）\r\n\r\n### FR-3：Specs 瀏覽\r\n\r\n- Spec 主題列表（字母排序 + 即時過濾）\r\n- Spec 詳細頁：Markdown 渲染 + BDD 關鍵字高亮\r\n- 關聯 changes 列表（哪些 changes 影響了此 spec）\r\n\r\n### FR-4：Changes 瀏覽\r\n\r\n- 按日期分組的時間線列表\r\n- 區分 active / archived\r\n- Change 詳細頁：Tab 切換（Proposal / Design / Tasks / Specs）\r\n- Tasks tab 顯示 checkbox 狀態 + 進度統計\r\n\r\n### FR-5：全文搜尋\r\n\r\n- `Cmd+K` 快捷鍵開啟搜尋對話框\r\n- 跨 specs + changes 搜尋\r\n- 結果分類顯示，附上下文預覽\r\n- 點擊跳轉到對應頁面\r\n\r\n### FR-6：BDD 語法高亮\r\n\r\n- `WHEN`/`GIVEN`：藍色標籤\r\n- `THEN`：綠色標籤\r\n- `AND`：灰色標籤\r\n- `MUST`/`SHALL`：紅色粗體\r\n- `ADDED`/`MODIFIED`：橘/藍 badge\r\n\r\n---\r\n\r\n## 6. UI 設計\r\n\r\n### 佈局\r\n\r\n```\r\n┌──────────────────────────────────────────────┐\r\n│  spek        [搜尋 ⌘K]        [/path/to/repo]│\r\n├─────────┬────────────────────────────────────┤\r\n│ Sidebar │  主要內容區                         │\r\n│         │                                    │\r\n│ Overview│  [根據路由渲染對應頁面]              │\r\n│ Specs   │                                    │\r\n│  ├ ...  │                                    │\r\n│ Changes │                                    │\r\n│  ├ Act  │                                    │\r\n│  └ Arc  │                                    │\r\n└─────────┴────────────────────────────────────┘\r\n```\r\n\r\n### 視覺風格\r\n\r\n- 深色主題為主（背景 #0a0c0f 系列）\r\n- Accent：琥珀色 #f59e0b\r\n- 中文行高 1.75、段落間距 1.5rem\r\n- 程式碼區塊 JetBrains Mono\r\n\r\n---\r\n\r\n## 7. 實作計畫\r\n\r\n### Phase 1：專案骨架 + API Server\r\n- 初始化 Vite + React + TypeScript 專案\r\n- Express API server 設定（concurrently 同時啟動）\r\n- OpenSpec 目錄掃描器（scanner.ts）\r\n- Tasks 解析器（tasks.ts）\r\n- 基礎 API endpoints（overview、specs、changes）\r\n\r\n### Phase 2：核心 UI 頁面\r\n- 選擇 Repo 頁面（路徑輸入 + 偵測）\r\n- 共用 Layout（sidebar + header）\r\n- Dashboard 總覽頁\r\n- Specs 列表 + 詳細頁\r\n- Changes 列表 + 詳細頁（含 Tab 切換）\r\n\r\n### Phase 3：Markdown 渲染 + 搜尋\r\n- MarkdownRenderer 元件 + BDD 語法高亮\r\n- 全文搜尋 API + SearchDialog UI\r\n- Cmd+K 快捷鍵\r\n\r\n### Phase 4：完善\r\n- 響應式佈局\r\n- 深色/淺色主題切換\r\n- 最近使用路徑記憶\r\n- Spec 演進歷史追蹤\r\n\r\n---\r\n\r\n## 8. 驗證方式\r\n\r\n1. `npm run dev` 啟動後，瀏覽器開啟 localhost\r\n2. 輸入 `/home/kewang/git/rewire` 路徑\r\n3. 確認 Dashboard 顯示正確的 specs/changes 數量\r\n4. 瀏覽幾個 spec（如 simulation-engine）確認 Markdown 渲染正確\r\n5. 瀏覽幾個 change（如 2026-02-10-main-breaker-simulation）確認四個 tab 都正常\r\n6. 搜尋「effectiveCurrent」確認跨文件搜尋正常\r\n7. 確認 BDD 關鍵字（WHEN/THEN/MUST）有視覺高亮\r\n","design":"## Context\r\n\r\nspek 是一個本地唯讀 Web 應用，讓使用者瀏覽任何包含 `openspec/` 目錄的 repo。目前 OpenSpec 內容只能透過檔案系統或文字編輯器閱讀，缺乏結構化瀏覽、搜尋與狀態總覽能力。\r\n\r\n本設計涵蓋 spek 從零開始的完整技術架構，包含 Express API server（讀取本地檔案系統）與 React SPA（渲染 UI）。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 建立可獨立運行的本地 Web 應用，`npm run dev` 即可啟動\r\n- Express backend 提供 REST API 讀取任意路徑下的 OpenSpec 結構\r\n- React frontend 提供 Dashboard、Specs 瀏覽、Changes 瀏覽、全文搜尋\r\n- 支援 BDD 語法高亮（WHEN/THEN/AND/MUST 等關鍵字）\r\n- 支援 tasks.md checkbox 解析與進度統計\r\n- 深色主題 UI，琥珀色 accent\r\n\r\n**Non-Goals:**\r\n- 不做內容編輯（純唯讀）\r\n- 不做使用者認證或權限管理\r\n- 不做 OpenSpec 工作流程管理（建立/封存 change）\r\n- 不做雲端部署版本\r\n- 不做 SSR（純 CSR SPA 即可）\r\n\r\n## Decisions\r\n\r\n### D1: Monorepo 單一 package，前後端共存\r\n\r\n前端（Vite + React）與後端（Express）放在同一個 package 中。開發時用 `concurrently` 同時啟動 Vite dev server（port 5173）與 Express API server（port 3001）。Vite 設定 proxy 將 `/api/*` 轉發到 Express。\r\n\r\n**理由**：專案規模小，分成兩個 package 增加複雜度但沒有實質好處。單一 package 簡化安裝與啟動流程。\r\n\r\n**替代方案**：monorepo workspace — 對此規模過度工程化。\r\n\r\n### D2: Express 讀取檔案系統，前端透過 `dir` query param 指定 repo 路徑\r\n\r\n所有 `/api/openspec/*` endpoints 接受 `dir` query parameter，指定要讀取的 repo 根目錄。Express 在該路徑下尋找 `openspec/` 目錄並讀取內容。\r\n\r\n**理由**：讓使用者可以在不重啟 server 的情況下切換不同 repo。路徑驗證在 server 端進行（檢查 `openspec/` 目錄存在）。\r\n\r\n**安全考量**：僅允許讀取操作，不暴露任意檔案內容（僅讀取 `openspec/` 子目錄內的 `.md`、`.yaml` 檔案）。\r\n\r\n### D3: 前端路由結構\r\n\r\n使用 React Router v7，路由設計：\r\n\r\n- `/` — SelectRepo 頁面（輸入/選擇 repo 路徑）\r\n- `/dashboard` — Dashboard 總覽\r\n- `/specs` — Specs 列表\r\n- `/specs/:topic` — Spec 詳細頁\r\n- `/changes` — Changes 列表\r\n- `/changes/:slug` — Change 詳細頁（含 tab 切換）\r\n\r\nrepo 路徑存在 React context 中（`RepoContext`），各頁面從 context 讀取後作為 `dir` 參數傳給 API。\r\n\r\n### D4: Markdown 渲染 + BDD 語法高亮\r\n\r\n使用 `react-markdown` + `remark-gfm` 渲染 Markdown。BDD 語法高亮透過自訂 remark plugin 或 post-processing：\r\n\r\n- 在渲染後的文字節點中偵測 BDD 關鍵字（WHEN、GIVEN、THEN、AND、MUST、SHALL、ADDED、MODIFIED）\r\n- 將關鍵字包裝成帶有對應 CSS class 的 `<span>` 標籤\r\n- 各關鍵字顏色依 PRD 定義（藍/綠/灰/紅/橘）\r\n\r\n### D5: 搜尋架構 — Server-side 全文搜尋 + Client-side Fuse.js\r\n\r\n搜尋 API（`/api/openspec/search`）在 server 端遍歷所有 `.md` 檔案進行全文比對，回傳匹配結果（含檔案路徑、匹配行、上下文）。\r\n\r\n前端 SearchDialog 使用 Fuse.js 對搜尋結果做進一步的模糊排序與過濾。`Cmd+K` 快捷鍵開啟對話框。\r\n\r\n**理由**：Server 端讀取檔案內容進行搜尋最直接。Fuse.js 在前端做結果排序提供更好的 UX。\r\n\r\n### D6: Tailwind CSS v4 + 深色主題\r\n\r\n使用 Tailwind CSS v4（`@tailwindcss/vite` plugin）。以深色主題為預設：\r\n\r\n- 背景色系：`#0a0c0f` / `#0f1318` / `#1a1f2e`\r\n- Accent：琥珀色 `#f59e0b`\r\n- 文字：`#e2e8f0`（主文字）、`#94a3b8`（次要文字）\r\n- 透過 CSS custom properties 定義色彩變數，為未來淺色主題切換預留\r\n\r\n### D7: tasks.md 解析策略\r\n\r\nServer 端解析 `tasks.md` 的 checkbox 格式：\r\n- `- [x]` 計為已完成\r\n- `- [ ]` 計為未完成\r\n- 支援巢狀結構（section headers `##` 分組）\r\n- 回傳統計：`{ total, completed, sections: [{ title, total, completed }] }`\r\n\r\n## Risks / Trade-offs\r\n\r\n**[大型 repo 效能]** → OpenSpec 目錄通常不會太大（數十到數百個檔案），全文搜尋遍歷所有 .md 檔案在本地應可接受。若未來需要優化，可加入 file content cache。\r\n\r\n**[路徑安全]** → `dir` 參數允許讀取任意本地路徑。Mitigation：僅讀取 `openspec/` 子目錄內容，不暴露其他檔案。Express 路由中驗證路徑合法性。\r\n\r\n**[前後端 port 衝突]** → 開發時使用 5173（Vite）+ 3001（Express）兩個 port。Mitigation：Vite proxy 設定統一入口，使用者只需存取 5173。\r\n\r\n**[TypeScript 設定複雜度]** → 前端（ESNext + JSX）與後端（Node.js）需要不同 tsconfig。Mitigation：使用 tsconfig references，server/ 有獨立的 tsconfig.server.json。\r\n","tasks":{"total":10,"completed":10,"sections":[{"title":"1. 撰寫 PRD","tasks":[{"text":"1.1 定義產品定位與非目標","completed":true},{"text":"1.2 描述 OpenSpec 資料結構","completed":true},{"text":"1.3 選定技術架構（Vite + React + Express + Tailwind v4 + TypeScript）","completed":true},{"text":"1.4 設計專案目錄結構","completed":true},{"text":"1.5 定義 REST API endpoints","completed":true},{"text":"1.6 撰寫六項功能需求（FR-1 ~ FR-6）","completed":true},{"text":"1.7 設計 UI 佈局與視覺風格","completed":true},{"text":"1.8 規劃四階段實作計畫","completed":true},{"text":"1.9 定義驗證方式","completed":true}]},{"title":"2. 撰寫技術設計","tasks":[{"text":"2.1 撰寫 design.md（架構決策、風險評估）","completed":true}]}]},"specs":[],"metadata":{}},"2026-02-13-phase1-skeleton-and-api":{"slug":"2026-02-13-phase1-skeleton-and-api","proposal":"## Why\r\n\r\nspek 目前只有 PRD 和設計文件，尚無任何可執行的程式碼。需要建立專案骨架（Vite + React + Express）與後端 API server，作為所有後續功能的基礎設施。這是第一個實作階段，沒有骨架就無法進行任何 UI 或功能開發。\r\n\r\n## What Changes\r\n\r\n- 初始化 Node.js 專案（package.json、TypeScript 設定、Vite 設定）\r\n- 建立 Express API server，提供本地檔案系統讀取能力\r\n- 實作 OpenSpec 目錄掃描器（scanner），解析 specs、changes 結構\r\n- 實作 tasks.md checkbox 解析器，計算任務完成統計\r\n- 建立所有 REST API endpoints（filesystem 瀏覽、openspec 資料讀取、全文搜尋）\r\n- 設定 Vite dev server proxy，將 `/api/*` 轉發到 Express\r\n- 建立最小化的 React 前端入口，確認前後端串接正常\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `filesystem-api`: 目錄瀏覽與 openspec 目錄偵測 API（`/api/fs/*`）\r\n- `openspec-api`: OpenSpec 資料讀取 API — overview、specs 列表與詳情、changes 列表與詳情（`/api/openspec/*`）\r\n- `search-api`: 跨 specs 與 changes 的全文搜尋 API（`/api/openspec/search`）\r\n- `openspec-scanner`: 目錄掃描與 Markdown/YAML 解析邏輯\r\n- `task-parser`: tasks.md checkbox 解析與統計（section 分組、完成率計算）\r\n\r\n### Modified Capabilities\r\n\r\n（無既有 capabilities）\r\n\r\n## Impact\r\n\r\n- **新增依賴**：express、cors、glob、gray-matter、fuse.js、concurrently、tsx、typescript、@types/*\r\n- **新增目錄**：`server/`（API server）、`src/`（React 前端入口）\r\n- **設定檔**：package.json、tsconfig.json、tsconfig.server.json、vite.config.ts、tailwind 相關設定\r\n- **開發流程**：`npm run dev` 同時啟動 Vite (5173) + Express (3001)\r\n","design":"## Context\r\n\r\nspek 是一個全新專案，目前只有 PRD（`docs/prd.md`）和 OpenSpec 工作流程文件。此 Phase 1 需要從零建立專案骨架，包含前端建置工具、後端 API server、以及核心的 OpenSpec 資料解析邏輯。\r\n\r\nPRD 已定義完整的技術選型與 API 設計，本設計文件聚焦在實作層面的決策。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 建立可運行的 Vite + React + Express 開發環境\r\n- 實作完整的後端 API endpoints，能正確讀取任意 repo 的 OpenSpec 內容\r\n- 前後端能透過 proxy 正常串接\r\n- `npm run dev` 一鍵啟動\r\n\r\n**Non-Goals:**\r\n- UI 頁面的完整實作（Phase 2）\r\n- Markdown 渲染與 BDD 語法高亮（Phase 3）\r\n- 搜尋 UI（Phase 3）；本階段只做搜尋 API\r\n- 響應式佈局、主題切換（Phase 4）\r\n\r\n## Decisions\r\n\r\n### D1: Express 使用 tsx 執行，不預先編譯\r\n\r\n**選擇**：開發時用 `tsx watch server/index.ts` 直接執行 TypeScript\r\n**替代方案**：tsc 編譯後執行 JS、ts-node\r\n**理由**：tsx 基於 esbuild，啟動快、支援 watch mode、不需額外 tsconfig 設定。ts-node 較慢且 ESM 設定複雜。\r\n\r\n### D2: 前後端各自 tsconfig\r\n\r\n**選擇**：`tsconfig.json`（前端，Vite 用）+ `tsconfig.server.json`（後端）\r\n**理由**：前端需要 JSX、DOM types；後端需要 Node types、不同 module 設定。共用 tsconfig 會造成型別衝突。\r\n\r\n### D3: 安全性 — 路徑限制\r\n\r\n**選擇**：所有 openspec routes 限制只讀取 `{dir}/openspec/` 下的 `.md` 和 `.yaml` 檔案，filesystem routes 只回傳目錄列表\r\n**理由**：雖然是本地工具，但仍應避免意外暴露敏感檔案。path traversal 攻擊（`../../etc/passwd`）必須防範。\r\n\r\n### D4: Scanner 使用同步檔案讀取\r\n\r\n**選擇**：scanner 和 tasks parser 使用 `fs.readFileSync` / `fs.readdirSync`\r\n**替代方案**：async fs API\r\n**理由**：OpenSpec 目錄通常很小（數十個檔案），同步讀取程式碼更簡潔。API response 時間不會有感知差異。若未來效能成為問題再改為 async。\r\n\r\n### D5: 搜尋用 server-side 遍歷 + Fuse.js 排序\r\n\r\n**選擇**：搜尋 API 在 server 端讀取所有 `.md` 內容，用 Fuse.js 做模糊匹配與排序\r\n**替代方案**：純 client-side 搜尋（需先載入所有內容）、SQLite FTS\r\n**理由**：Server-side 讀檔避免一次傳輸大量內容到前端。Fuse.js 輕量且支援模糊搜尋，足以應付 OpenSpec 規模的內容量。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **同步 I/O 阻塞**：scanner 使用同步讀取，若 repo 極大（數百個 specs）可能短暫阻塞 → 目前 OpenSpec 規模不大，可接受；未來可改 async\r\n- **無快取機制**：每次 API 呼叫重新讀取檔案系統 → 本地 SSD 讀取延遲極低，Phase 1 不需要快取\r\n- **path traversal 風險**：使用者可傳入惡意路徑 → 所有路徑需經過 `path.resolve` + 檢查是否在允許範圍內\r\n","tasks":{"total":25,"completed":25,"sections":[{"title":"1. 專案初始化","tasks":[{"text":"1.1 建立 package.json（name、scripts、dependencies、devDependencies）","completed":true},{"text":"1.2 建立 tsconfig.json（前端）與 tsconfig.server.json（後端）","completed":true},{"text":"1.3 建立 vite.config.ts（含 proxy 設定將 /api 轉發到 port 3001）","completed":true},{"text":"1.4 設定 Tailwind CSS v4（global.css）","completed":true},{"text":"1.5 建立 React 入口（src/main.tsx、src/App.tsx）— 最小化版本確認前端可運行","completed":true},{"text":"1.6 npm install 驗證所有依賴安裝成功","completed":true}]},{"title":"2. Express API Server 骨架","tasks":[{"text":"2.1 建立 server/index.ts — Express 入口，啟動 port 3001，掛載 routes","completed":true},{"text":"2.2 建立 server/routes/filesystem.ts — `/api/fs/browse` 與 `/api/fs/detect` endpoints","completed":true},{"text":"2.3 建立 server/routes/openspec.ts — 掛載所有 `/api/openspec/*` routes（先回傳空殼）","completed":true}]},{"title":"3. OpenSpec Scanner","tasks":[{"text":"3.1 建立 server/lib/scanner.ts — 掃描 openspec/ 目錄結構（specs、active changes、archived changes）","completed":true},{"text":"3.2 實作 readSpec() — 讀取單一 spec 的 Markdown 內容","completed":true},{"text":"3.3 實作 readChange() — 讀取 change 的所有 artifacts（proposal、design、tasks、delta specs）","completed":true},{"text":"3.4 實作 findRelatedChanges() — 找出與某 spec topic 相關的 changes","completed":true}]},{"title":"4. Task Parser","tasks":[{"text":"4.1 建立 server/lib/tasks.ts — 解析 tasks.md checkbox 語法","completed":true},{"text":"4.2 實作 section 分組邏輯（## heading 分組）","completed":true},{"text":"4.3 實作統計計算（total、completed）","completed":true}]},{"title":"5. OpenSpec API Endpoints","tasks":[{"text":"5.1 實作 GET /api/openspec/overview — 回傳 specsCount、changesCount、taskStats","completed":true},{"text":"5.2 實作 GET /api/openspec/specs — 回傳 spec topics 列表","completed":true},{"text":"5.3 實作 GET /api/openspec/specs/:topic — 回傳單一 spec 內容 + relatedChanges","completed":true},{"text":"5.4 實作 GET /api/openspec/changes — 回傳 active/archived changes 列表","completed":true},{"text":"5.5 實作 GET /api/openspec/changes/:slug — 回傳單一 change 完整內容","completed":true},{"text":"5.6 實作 GET /api/openspec/search — 全文搜尋（Fuse.js）","completed":true}]},{"title":"6. 驗證","tasks":[{"text":"6.1 npm run dev 啟動成功（Vite + Express 同時運行）","completed":true},{"text":"6.2 前端頁面可開啟 http://localhost:5173","completed":true},{"text":"6.3 API endpoints 可透過 curl 或瀏覽器測試回傳正確資料","completed":true}]}]},"specs":[{"topic":"filesystem-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Browse directories\r\nThe system SHALL provide an API endpoint `GET /api/fs/browse` that returns directory contents for a given path, allowing users to navigate the filesystem to find repos.\r\n\r\n#### Scenario: Browse valid directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/projects`\r\n- **THEN** system returns a JSON array of entries, each with `name`, `type` (\"file\" or \"directory\"), and `path`\r\n- **AND** entries are sorted with directories first, then alphabetically\r\n\r\n#### Scenario: Browse without path parameter\r\n- **WHEN** client sends `GET /api/fs/browse` without a `path` parameter\r\n- **THEN** system returns the contents of the user's home directory\r\n\r\n#### Scenario: Browse non-existent directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/nonexistent`\r\n- **THEN** system returns HTTP 400 with an error message\r\n\r\n### Requirement: Detect OpenSpec directory\r\nThe system SHALL provide an API endpoint `GET /api/fs/detect` that checks whether a given path contains an `openspec/` directory with a valid `config.yaml`.\r\n\r\n#### Scenario: Path contains valid OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/my-repo`\r\n- **AND** `/home/user/my-repo/openspec/config.yaml` exists\r\n- **THEN** system returns `{ \"hasOpenSpec\": true, \"schema\": \"<schema-value>\" }`\r\n\r\n#### Scenario: Path does not contain OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/empty-repo`\r\n- **AND** no `openspec/` directory exists at that path\r\n- **THEN** system returns `{ \"hasOpenSpec\": false }`\r\n\r\n### Requirement: Path traversal protection\r\nThe system SHALL reject any path that attempts directory traversal outside the specified root.\r\n\r\n#### Scenario: Path traversal attempt\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/../../../etc`\r\n- **THEN** system resolves the path and returns the directory contents of the resolved absolute path without exposing system files outside normal filesystem permissions\r\n"},{"topic":"openspec-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Overview endpoint\r\nThe system SHALL provide `GET /api/openspec/overview` that returns aggregate statistics for an OpenSpec repository.\r\n\r\n#### Scenario: Get overview of repo with specs and changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `specsCount`, `changesCount` (with `active` and `archived` breakdown), and `taskStats` (aggregate `total` and `completed` across all active changes)\r\n\r\n#### Scenario: Get overview of repo with no specs\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** the repo has no `openspec/specs/` directory\r\n- **THEN** system returns `specsCount: 0` with changes still counted correctly\r\n\r\n### Requirement: List specs\r\nThe system SHALL provide `GET /api/openspec/specs` that returns all spec topics.\r\n\r\n#### Scenario: List all specs\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **THEN** system returns a JSON array of spec topics, each with `topic` name and `path`\r\n- **AND** topics are sorted alphabetically\r\n\r\n#### Scenario: No specs directory\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **AND** `openspec/specs/` does not exist\r\n- **THEN** system returns an empty array\r\n\r\n### Requirement: Get single spec\r\nThe system SHALL provide `GET /api/openspec/specs/:topic` that returns the full content of a spec.\r\n\r\n#### Scenario: Get existing spec\r\n- **WHEN** client sends `GET /api/openspec/specs/simulation-engine?dir=/path/to/repo`\r\n- **AND** `openspec/specs/simulation-engine/spec.md` exists\r\n- **THEN** system returns JSON with `topic`, `content` (raw Markdown), and `relatedChanges` (list of changes that have delta specs for this topic)\r\n\r\n#### Scenario: Get non-existent spec\r\n- **WHEN** client sends `GET /api/openspec/specs/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: List changes\r\nThe system SHALL provide `GET /api/openspec/changes` that returns all changes grouped by status.\r\n\r\n#### Scenario: List changes with active and archived\r\n- **WHEN** client sends `GET /api/openspec/changes?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `active` array and `archived` array\r\n- **AND** each change includes `slug`, `date` (parsed from slug prefix), `description` (parsed from slug), `hasProposal`, `hasDesign`, `hasTasks`, `hasSpecs`, and `taskStats`\r\n- **AND** changes are sorted by date descending (newest first)\r\n\r\n### Requirement: Get single change\r\nThe system SHALL provide `GET /api/openspec/changes/:slug` that returns full change content.\r\n\r\n#### Scenario: Get existing change with all artifacts\r\n- **WHEN** client sends `GET /api/openspec/changes/2026-02-10-my-feature?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `slug`, `proposal` (Markdown content or null), `design` (Markdown content or null), `tasks` (parsed task structure or null), `specs` (array of delta spec contents), and `metadata` (from `.openspec.yaml` if present)\r\n\r\n#### Scenario: Get non-existent change\r\n- **WHEN** client sends `GET /api/openspec/changes/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: Missing dir parameter\r\nThe system SHALL require the `dir` query parameter on all openspec endpoints.\r\n\r\n#### Scenario: Request without dir parameter\r\n- **WHEN** client sends any `/api/openspec/*` request without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n"},{"topic":"openspec-scanner","content":"## ADDED Requirements\r\n\r\n### Requirement: Scan OpenSpec directory structure\r\nThe scanner SHALL read an OpenSpec directory and return its complete structure including specs, active changes, and archived changes.\r\n\r\n#### Scenario: Scan repo with full OpenSpec structure\r\n- **WHEN** scanner is given a repo path containing `openspec/specs/` and `openspec/changes/`\r\n- **THEN** it returns a structure with `specs` (list of topic names), `activeChanges` (changes directly under `openspec/changes/` excluding `archive/`), and `archivedChanges` (changes under `openspec/changes/archive/`)\r\n\r\n#### Scenario: Scan repo with empty OpenSpec directory\r\n- **WHEN** scanner is given a repo path where `openspec/` exists but contains only `config.yaml`\r\n- **THEN** it returns empty arrays for specs, activeChanges, and archivedChanges\r\n\r\n### Requirement: Parse change artifacts\r\nThe scanner SHALL read individual change directories and extract available artifacts.\r\n\r\n#### Scenario: Change with all artifacts\r\n- **WHEN** scanner reads a change directory containing proposal.md, design.md, tasks.md, and specs/\r\n- **THEN** it returns the raw Markdown content for each artifact and a list of delta spec files\r\n\r\n#### Scenario: Change with partial artifacts\r\n- **WHEN** scanner reads a change directory containing only proposal.md\r\n- **THEN** it returns proposal content and null for missing artifacts\r\n\r\n### Requirement: Read spec content\r\nThe scanner SHALL read spec files and return their Markdown content.\r\n\r\n#### Scenario: Read existing spec\r\n- **WHEN** scanner reads `openspec/specs/{topic}/spec.md`\r\n- **THEN** it returns the raw Markdown content of the spec file\r\n\r\n### Requirement: Detect related changes for a spec\r\nThe scanner SHALL identify which changes contain delta specs for a given spec topic.\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** scanner checks for changes related to spec topic \"simulation-engine\"\r\n- **THEN** it returns all change slugs that have a `specs/simulation-engine/spec.md` delta file\r\n"},{"topic":"search-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Full-text search endpoint\r\nThe system SHALL provide `GET /api/openspec/search` that searches across all specs and changes content.\r\n\r\n#### Scenario: Search with matching results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=effectiveCurrent`\r\n- **THEN** system returns a JSON array of results, each with `type` (\"spec\" or \"change\"), `name` (topic or slug), `matches` (array of matching text with context), and `score`\r\n- **AND** results are sorted by relevance score (best match first)\r\n\r\n#### Scenario: Search with no results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=xyznonexistent`\r\n- **THEN** system returns an empty array\r\n\r\n#### Scenario: Search without query parameter\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo` without `q` parameter\r\n- **THEN** system returns HTTP 400 with error message\r\n\r\n### Requirement: Search context preview\r\nEach search result SHALL include surrounding context to help users identify the relevant content.\r\n\r\n#### Scenario: Result includes context\r\n- **WHEN** a search matches text within a Markdown file\r\n- **THEN** the match includes up to 100 characters before and after the matched text as context preview\r\n"},{"topic":"task-parser","content":"## ADDED Requirements\r\n\r\n### Requirement: Parse task checkboxes\r\nThe task parser SHALL read a tasks.md file and extract checkbox items with their completion status.\r\n\r\n#### Scenario: Parse file with mixed checkboxes\r\n- **WHEN** parser reads a tasks.md containing `- [x] Done task` and `- [ ] Pending task`\r\n- **THEN** it returns each task with `text` and `completed` (boolean) fields\r\n\r\n### Requirement: Group tasks by section\r\nThe task parser SHALL group tasks under their `##` heading sections.\r\n\r\n#### Scenario: Tasks under multiple sections\r\n- **WHEN** parser reads a tasks.md with `## Phase 1` followed by tasks and `## Phase 2` followed by tasks\r\n- **THEN** it returns sections array, each with `title` and `tasks` array\r\n\r\n#### Scenario: Tasks without section headings\r\n- **WHEN** parser reads a tasks.md where tasks appear before any `##` heading\r\n- **THEN** those tasks are grouped under a default section with empty title\r\n\r\n### Requirement: Calculate task statistics\r\nThe task parser SHALL compute aggregate statistics from parsed tasks.\r\n\r\n#### Scenario: Calculate completion stats\r\n- **WHEN** parser processes a tasks.md with 10 total checkboxes where 7 are checked\r\n- **THEN** it returns `{ total: 10, completed: 7 }` along with the sections breakdown\r\n\r\n#### Scenario: Empty tasks file\r\n- **WHEN** parser processes an empty tasks.md or one with no checkboxes\r\n- **THEN** it returns `{ total: 0, completed: 0, sections: [] }`\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-phase2-core-ui-pages":{"slug":"2026-02-13-phase2-core-ui-pages","proposal":"## Why\r\n\r\nPhase 1 完成了後端 API 和專案骨架，但前端目前只有一個 placeholder 頁面。使用者無法實際瀏覽任何 OpenSpec 內容。Phase 2 需要建立所有核心 UI 頁面，讓 spek 成為一個可操作的唯讀瀏覽器。\r\n\r\n## What Changes\r\n\r\n- 新增 React Router 路由設定，串接所有頁面\r\n- 新增 RepoContext 管理目前選擇的 repo 路徑\r\n- 新增 `useOpenSpec` hooks 封裝所有 API 呼叫\r\n- 新增 SelectRepo 頁面（路徑輸入 + 目錄瀏覽 + 自動偵測 + localStorage 記憶）\r\n- 新增 Layout 共用佈局（Header + Sidebar + 主內容區）\r\n- 新增 Dashboard 總覽頁（統計數據 + active changes + 最近封存）\r\n- 新增 SpecList + SpecDetail 頁面（列表過濾 + 內容顯示 + 關聯 changes）\r\n- 新增 ChangeList + ChangeDetail 頁面（時間線 + Tab 切換 proposal/design/tasks/specs）\r\n- 新增 TaskProgress 進度條元件\r\n- 新增 TabView 頁籤切換元件\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `repo-selection`: 選擇 repo 路徑的 UI 流程，包含目錄瀏覽、openspec 偵測、localStorage 持久化\r\n- `spa-routing`: React Router 路由架構與 RepoContext 狀態管理\r\n- `dashboard-view`: 專案總覽 dashboard，顯示統計與 change 進度\r\n- `spec-browsing`: Spec 列表與詳細頁面，含即時過濾與關聯 changes\r\n- `change-browsing`: Change 列表與詳細頁面，含 Tab 切換與任務進度顯示\r\n- `shared-layout`: 共用佈局元件（Header、Sidebar、TaskProgress、TabView）\r\n\r\n### Modified Capabilities\r\n（無既有 spec 需修改，Phase 2 純為前端新增）\r\n\r\n## Impact\r\n\r\n- **新增檔案**：`src/pages/` 6 個頁面、`src/components/` 4+ 個元件、`src/hooks/useOpenSpec.ts`、`src/contexts/RepoContext.tsx`\r\n- **修改檔案**：`src/App.tsx`（加入路由）、`src/main.tsx`（加入 providers）\r\n- **依賴**：使用已安裝的 react-router-dom v7；Markdown 渲染留待 Phase 3\r\n- **後端**：無變更，完全使用 Phase 1 建立的 API\r\n","design":"## Context\r\n\r\nPhase 1 完成了 Express API server 和專案骨架。後端提供完整的 OpenSpec 資料讀取 API，前端目前僅有 placeholder。Phase 2 要建立完整的前端頁面系統，使 spek 成為可操作的瀏覽器。\r\n\r\n現有基礎設施：\r\n- Vite + React 19 + TypeScript + Tailwind CSS v4 已設定完成\r\n- 深色主題色系已定義（`global.css` @theme）\r\n- react-router-dom v7 已安裝但未使用\r\n- API proxy 已設定（`/api` → localhost:3001）\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 建立 6 個核心頁面，串接所有後端 API\r\n- 建立可重用的 Layout、Sidebar、TaskProgress、TabView 元件\r\n- 實作 RepoContext 管理全域 repo 路徑狀態\r\n- 提供流暢的導覽體驗（路由、sidebar、breadcrumb）\r\n\r\n**Non-Goals:**\r\n- Markdown 渲染與 BDD 語法高亮（Phase 3）\r\n- 全文搜尋 UI / SearchDialog（Phase 3）\r\n- 響應式佈局（Phase 4）\r\n- 深色/淺色主題切換（Phase 4）\r\n\r\n## Decisions\r\n\r\n### 1. 路由架構：React Router v7 data router\r\n\r\n使用 `createBrowserRouter` + `RouterProvider`。路由結構：\r\n\r\n```\r\n/                    → SelectRepo（無 Layout）\r\n/dashboard           → Layout > Dashboard\r\n/specs               → Layout > SpecList\r\n/specs/:topic        → Layout > SpecDetail\r\n/changes             → Layout > ChangeList\r\n/changes/:slug       → Layout > ChangeDetail\r\n```\r\n\r\n所有 `/dashboard` 以下路由共用 Layout wrapper，SelectRepo 獨立。`dir` query param 在 RepoContext 中管理，各 hook 自動附加。\r\n\r\n**替代方案**：用 `<BrowserRouter>` + `<Routes>` 聲明式路由 — 但 data router 支援 loader/action，未來擴充性較好。\r\n\r\n### 2. 狀態管理：React Context + URL query param\r\n\r\n- `RepoContext` 提供 `repoPath` 和 `setRepoPath`\r\n- `repoPath` 同步到 URL `?dir=` query param（single source of truth）\r\n- localStorage 記憶最近使用的路徑列表（最多 5 個）\r\n- 未選擇 repo 時，自動導向 `/`\r\n\r\n**替代方案**：Zustand / Redux — 過度工程，Context 足以應付唯讀場景。\r\n\r\n### 3. API hooks：自訂 hooks + fetch\r\n\r\n`src/hooks/useOpenSpec.ts` 提供：\r\n- `useOverview()` → overview 統計\r\n- `useSpecs()` → spec 列表\r\n- `useSpec(topic)` → 單一 spec\r\n- `useChanges()` → change 列表\r\n- `useChange(slug)` → 單一 change\r\n- `useBrowse(path)` → 目錄瀏覽\r\n- `useDetect(path)` → openspec 偵測\r\n\r\n每個 hook 回傳 `{ data, loading, error }`，內部使用 `fetch` + `useEffect`。`dir` 從 RepoContext 取得。\r\n\r\n**替代方案**：TanStack Query — 功能強大但此場景不需要 cache invalidation、mutation 等功能。\r\n\r\n### 4. Markdown 內容顯示：Phase 2 用純文字預覽\r\n\r\nPhase 2 先用 `<pre>` 顯示 raw markdown 內容，Phase 3 再替換為 react-markdown + BDD 高亮。這樣可以先驗證資料流是否正確。\r\n\r\n### 5. Layout 結構\r\n\r\n```\r\n┌─ Header ──────────────────────────────────┐\r\n│  spek logo     [搜尋預留]    repo path     │\r\n├─ Sidebar ─┬─ Main ────────────────────────┤\r\n│ 240px     │  padding 24px                 │\r\n│ fixed     │  max-width 容器               │\r\n│           │                               │\r\n└───────────┴───────────────────────────────┘\r\n```\r\n\r\n- Header 高度 56px，bg-secondary，border-bottom\r\n- Sidebar 寬度 240px，bg-secondary，fixed left\r\n- Main 區域 `ml-60` offset\r\n\r\n### 6. 頁面資料流\r\n\r\n每個頁面在 mount 時透過 hook 取得資料。Loading 狀態顯示 skeleton/spinner，error 狀態顯示錯誤訊息。不做 prefetch。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **無 Markdown 渲染**：Phase 2 顯示原始文字，使用者體驗有限。→ Phase 3 會補上，Phase 2 先確保資料流正確。\r\n- **無搜尋功能**：Header 搜尋按鈕為 placeholder。→ Phase 3 實作 SearchDialog。\r\n- **單一 Context**：如果 repo 路徑頻繁變更可能造成全部重新渲染。→ 實際使用場景中 repo 路徑很少變更，不是問題。\r\n- **無 loading skeleton**：先用簡單 spinner，不做精緻的 skeleton screen。→ 未來可改善但非 Phase 2 優先。\r\n","tasks":{"total":27,"completed":27,"sections":[{"title":"1. 基礎建設：路由與狀態管理","tasks":[{"text":"1.0 建立 `.nvmrc` — 指定 Node 22","completed":true},{"text":"1.1 建立 `src/contexts/RepoContext.tsx` — 提供 repoPath / setRepoPath，從 localStorage 初始化","completed":true},{"text":"1.2 建立 `src/hooks/useOpenSpec.ts` — 封裝所有 API hooks（useOverview, useSpecs, useSpec, useChanges, useChange, useBrowse, useDetect），每個回傳 { data, loading, error }","completed":true},{"text":"1.3 改寫 `src/App.tsx` — 使用 createBrowserRouter 設定路由表，包裹 RepoContext Provider","completed":true},{"text":"1.4 更新 `src/main.tsx` — 渲染 RouterProvider","completed":true}]},{"title":"2. 共用元件","tasks":[{"text":"2.1 建立 `src/components/Layout.tsx` — Header (56px) + Sidebar (240px) + Main 區域，使用 Outlet 渲染子路由","completed":true},{"text":"2.2 建立 `src/components/Sidebar.tsx` — Overview / Specs / Changes 導覽連結，當前路由高亮","completed":true},{"text":"2.3 建立 `src/components/TaskProgress.tsx` — 進度條元件，接收 completed / total props","completed":true},{"text":"2.4 建立 `src/components/TabView.tsx` — 通用 Tab 切換元件，接收 tabs 配置","completed":true}]},{"title":"3. SelectRepo 頁面","tasks":[{"text":"3.1 建立 `src/pages/SelectRepo.tsx` — 路徑輸入框 + 偵測結果顯示 + 開啟按鈕","completed":true},{"text":"3.2 實作目錄瀏覽功能 — 呼叫 browse API 顯示目錄列表，點擊導覽","completed":true},{"text":"3.3 實作最近路徑列表 — 從 localStorage 讀取，點擊快速選擇","completed":true},{"text":"3.4 實作自動導向 — 選擇有效 repo 後設定 RepoContext 並導向 /dashboard","completed":true}]},{"title":"4. Dashboard 頁面","tasks":[{"text":"4.1 建立 `src/pages/Dashboard.tsx` — 呼叫 useOverview 顯示統計卡片（specs 數量、active/archived changes 數量、任務完成率）","completed":true},{"text":"4.2 實作 active changes 列表區塊 — 顯示名稱 + TaskProgress 進度條","completed":true},{"text":"4.3 實作最近封存 changes 區塊 — 最近 10 個 archived changes","completed":true},{"text":"4.4 實作導覽卡片 — 連結到 /specs 和 /changes","completed":true}]},{"title":"5. Spec 頁面","tasks":[{"text":"5.1 建立 `src/pages/SpecList.tsx` — 呼叫 useSpecs 顯示字母排序列表 + 即時過濾輸入","completed":true},{"text":"5.2 建立 `src/pages/SpecDetail.tsx` — 呼叫 useSpec(topic) 顯示標題 + raw markdown 內容 + 關聯 changes 列表","completed":true}]},{"title":"6. Change 頁面","tasks":[{"text":"6.1 建立 `src/pages/ChangeList.tsx` — 呼叫 useChanges 分 Active / Archived 區塊顯示，Archived 按日期排序","completed":true},{"text":"6.2 建立 `src/pages/ChangeDetail.tsx` — 呼叫 useChange(slug)，使用 TabView 切換 Proposal / Design / Tasks / Specs 四個 tab","completed":true},{"text":"6.3 實作 Tasks tab — 顯示 TaskProgress 進度條 + raw tasks 內容","completed":true},{"text":"6.4 實作 Specs tab — 列出 delta specs 並顯示內容","completed":true}]},{"title":"7. 保護性路由與收尾","tasks":[{"text":"7.1 實作未選擇 repo 時重導向 `/` 的邏輯（在 Layout 或路由 loader 中）","completed":true},{"text":"7.2 驗證所有頁面的 loading / error 狀態顯示","completed":true},{"text":"7.3 確認 `npm run type-check` 通過","completed":true},{"text":"7.4 確認 `npm run build` 成功","completed":true}]}]},"specs":[{"topic":"change-browsing","content":"## ADDED Requirements\r\n\r\n### Requirement: Change list with active/archived separation\r\nThe system SHALL display changes grouped into active and archived sections. Archived changes SHALL be sorted by date (most recent first).\r\n\r\n#### Scenario: Display active changes\r\n- **WHEN** user navigates to the ChangeList page and there are active changes\r\n- **THEN** active changes are listed in an \"Active\" section with name and task progress\r\n\r\n#### Scenario: Display archived changes\r\n- **WHEN** user navigates to the ChangeList page\r\n- **THEN** archived changes are listed in an \"Archived\" section sorted by date descending\r\n\r\n#### Scenario: No changes\r\n- **WHEN** there are no changes in the repo\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Change detail with tab navigation\r\nThe system SHALL display change details using a tabbed interface with tabs for: Proposal, Design, Tasks, and Specs (delta specs).\r\n\r\n#### Scenario: View proposal tab\r\n- **WHEN** user views a change and clicks the Proposal tab\r\n- **THEN** the proposal.md content is displayed (raw markdown)\r\n\r\n#### Scenario: View design tab\r\n- **WHEN** user clicks the Design tab\r\n- **THEN** the design.md content is displayed (raw markdown)\r\n\r\n#### Scenario: View tasks tab\r\n- **WHEN** user clicks the Tasks tab\r\n- **THEN** the tasks.md content is displayed with a TaskProgress bar showing completion statistics\r\n\r\n#### Scenario: View specs tab\r\n- **WHEN** user clicks the Specs tab and the change has delta specs\r\n- **THEN** the delta spec files are listed and their content displayed\r\n\r\n#### Scenario: Missing artifact\r\n- **WHEN** a tab's corresponding artifact file does not exist\r\n- **THEN** the tab shows a \"No content\" placeholder\r\n\r\n### Requirement: Task progress display in change detail\r\nThe Tasks tab SHALL display a progress bar and statistics (completed/total) derived from the change's task data.\r\n\r\n#### Scenario: Show task progress\r\n- **WHEN** viewing the Tasks tab of a change with tasks\r\n- **THEN** a TaskProgress component shows a visual progress bar with \"X / Y completed\" text\r\n"},{"topic":"dashboard-view","content":"## ADDED Requirements\r\n\r\n### Requirement: Overview statistics display\r\nThe system SHALL display overview statistics from the overview API: total specs count, active changes count, archived changes count, and task completion rate (percentage).\r\n\r\n#### Scenario: Display statistics\r\n- **WHEN** user navigates to the Dashboard page\r\n- **THEN** system displays specs count, active changes count, archived changes count, and overall task completion percentage in stat cards\r\n\r\n### Requirement: Active changes list\r\nThe system SHALL display a list of active changes with their names and task progress indicators.\r\n\r\n#### Scenario: Show active changes with progress\r\n- **WHEN** there are active changes in the repo\r\n- **THEN** each active change is displayed with its name and a TaskProgress bar showing completed/total tasks\r\n\r\n#### Scenario: No active changes\r\n- **WHEN** there are no active changes\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Recent archived changes\r\nThe system SHALL display the most recent 10 archived changes.\r\n\r\n#### Scenario: Show archived changes\r\n- **WHEN** user views the Dashboard\r\n- **THEN** the most recent 10 archived changes are listed with their names and dates\r\n\r\n### Requirement: Navigation cards\r\nThe system SHALL provide navigation cards/links to the Specs list and Changes list pages.\r\n\r\n#### Scenario: Navigate to specs\r\n- **WHEN** user clicks the Specs navigation card\r\n- **THEN** system navigates to `/specs`\r\n\r\n#### Scenario: Navigate to changes\r\n- **WHEN** user clicks the Changes navigation card\r\n- **THEN** system navigates to `/changes`\r\n"},{"topic":"repo-selection","content":"## ADDED Requirements\r\n\r\n### Requirement: Path input with auto-detection\r\nThe system SHALL provide a text input for entering a filesystem path. Upon input, the system SHALL call the detect API to check for an `openspec/` directory and display the detection result.\r\n\r\n#### Scenario: Valid path with openspec directory\r\n- **WHEN** user enters a path that contains an `openspec/` directory\r\n- **THEN** system displays a success indicator and a button to open the repo\r\n\r\n#### Scenario: Valid path without openspec directory\r\n- **WHEN** user enters a path that does not contain an `openspec/` directory\r\n- **THEN** system displays a warning message indicating no openspec directory found\r\n\r\n#### Scenario: Invalid path\r\n- **WHEN** user enters a path that does not exist\r\n- **THEN** system displays an error message\r\n\r\n### Requirement: Directory browsing\r\nThe system SHALL provide a directory browser that calls the browse API, allowing users to navigate the filesystem and select a repo path.\r\n\r\n#### Scenario: Browse directories\r\n- **WHEN** user clicks the browse button\r\n- **THEN** system displays a list of directories at the current path\r\n- **AND** user can click a directory to navigate into it\r\n- **AND** user can select the current directory as the repo path\r\n\r\n### Requirement: Recent paths persistence\r\nThe system SHALL persist the most recent 5 repo paths in localStorage. On page load, previously used paths SHALL be displayed for quick selection.\r\n\r\n#### Scenario: Save path on successful detection\r\n- **WHEN** user successfully opens a repo (path with valid openspec/)\r\n- **THEN** the path is saved to localStorage recent paths list (max 5, most recent first)\r\n\r\n#### Scenario: Display recent paths on load\r\n- **WHEN** user visits the SelectRepo page\r\n- **THEN** previously saved paths are displayed as clickable options\r\n\r\n### Requirement: Auto-navigate to dashboard\r\nThe system SHALL automatically navigate to the Dashboard page after the user selects a valid repo path.\r\n\r\n#### Scenario: Navigate after selection\r\n- **WHEN** user selects a valid repo path (via input, browse, or recent paths)\r\n- **THEN** system navigates to `/dashboard` with the repo path set in RepoContext\r\n"},{"topic":"shared-layout","content":"## ADDED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: the \"spek\" logo/brand text (left), a search button placeholder (center), and the current repo path (right).\r\n\r\n#### Scenario: Display header\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the header displays the spek brand, a disabled search button, and the current repo path from RepoContext\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a fixed sidebar (240px width) with navigation links: Overview (Dashboard), Specs, and Changes. The current route SHALL be visually highlighted.\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n### Requirement: TaskProgress component\r\nThe system SHALL provide a reusable TaskProgress component that displays a progress bar with completed/total count.\r\n\r\n#### Scenario: Display progress\r\n- **WHEN** TaskProgress is rendered with `completed=3` and `total=5`\r\n- **THEN** a progress bar at 60% width is shown with text \"3 / 5\"\r\n\r\n#### Scenario: Zero tasks\r\n- **WHEN** TaskProgress is rendered with `total=0`\r\n- **THEN** component displays \"No tasks\" or an empty state\r\n\r\n### Requirement: TabView component\r\nThe system SHALL provide a reusable TabView component that renders tab headers and switches between tab content panels.\r\n\r\n#### Scenario: Switch tabs\r\n- **WHEN** user clicks a tab header\r\n- **THEN** the corresponding tab content panel is displayed and the previous panel is hidden\r\n\r\n#### Scenario: Default tab\r\n- **WHEN** TabView is first rendered\r\n- **THEN** the first tab is selected by default\r\n"},{"topic":"spa-routing","content":"## ADDED Requirements\r\n\r\n### Requirement: Client-side routing\r\nThe system SHALL use React Router v7 with `createBrowserRouter` to define the following routes:\r\n\r\n| Path | Page | Layout |\r\n|------|------|--------|\r\n| `/` | SelectRepo | None |\r\n| `/dashboard` | Dashboard | Layout |\r\n| `/specs` | SpecList | Layout |\r\n| `/specs/:topic` | SpecDetail | Layout |\r\n| `/changes` | ChangeList | Layout |\r\n| `/changes/:slug` | ChangeDetail | Layout |\r\n\r\n#### Scenario: Route to SelectRepo\r\n- **WHEN** user navigates to `/`\r\n- **THEN** the SelectRepo page is rendered without Layout wrapper\r\n\r\n#### Scenario: Route to Dashboard with Layout\r\n- **WHEN** user navigates to `/dashboard`\r\n- **THEN** the Dashboard page is rendered within the shared Layout (Header + Sidebar + Main)\r\n\r\n### Requirement: RepoContext state management\r\nThe system SHALL provide a React Context (`RepoContext`) that stores the current repo path. All API hooks SHALL read the repo path from this context.\r\n\r\n#### Scenario: Set repo path\r\n- **WHEN** user selects a repo on the SelectRepo page\r\n- **THEN** `RepoContext.repoPath` is updated and available to all child components\r\n\r\n#### Scenario: Redirect when no repo selected\r\n- **WHEN** user navigates to any page other than `/` without a repo path in context\r\n- **THEN** system redirects to `/`\r\n\r\n### Requirement: API hooks\r\nThe system SHALL provide custom React hooks in `useOpenSpec.ts` that encapsulate API calls. Each hook SHALL return `{ data, loading, error }` and automatically include the `dir` query parameter from RepoContext.\r\n\r\n#### Scenario: Hook returns loading state\r\n- **WHEN** an API hook is called and the request is in flight\r\n- **THEN** hook returns `{ data: null, loading: true, error: null }`\r\n\r\n#### Scenario: Hook returns data\r\n- **WHEN** the API request succeeds\r\n- **THEN** hook returns `{ data: <response>, loading: false, error: null }`\r\n\r\n#### Scenario: Hook returns error\r\n- **WHEN** the API request fails\r\n- **THEN** hook returns `{ data: null, loading: false, error: <error message> }`\r\n"},{"topic":"spec-browsing","content":"## ADDED Requirements\r\n\r\n### Requirement: Spec list with filtering\r\nThe system SHALL display all specs sorted alphabetically. A filter input SHALL allow instant client-side filtering by spec topic name.\r\n\r\n#### Scenario: Display all specs\r\n- **WHEN** user navigates to the SpecList page\r\n- **THEN** all spec topics are listed alphabetically\r\n\r\n#### Scenario: Filter specs\r\n- **WHEN** user types in the filter input\r\n- **THEN** the list is filtered in real-time to show only specs whose topic name contains the search text (case-insensitive)\r\n\r\n### Requirement: Spec detail display\r\nThe system SHALL display the full content of a spec when the user navigates to its detail page. The raw markdown content SHALL be shown (react-markdown rendering deferred to Phase 3).\r\n\r\n#### Scenario: View spec content\r\n- **WHEN** user navigates to `/specs/:topic`\r\n- **THEN** system displays the spec topic as title and the full spec.md content\r\n\r\n#### Scenario: Spec not found\r\n- **WHEN** user navigates to a spec topic that does not exist\r\n- **THEN** system displays a \"not found\" message\r\n\r\n### Requirement: Related changes display\r\nThe spec detail page SHALL display a list of changes that affect the spec (from the API's `relatedChanges` field). Each change SHALL be a link to its detail page.\r\n\r\n#### Scenario: Show related changes\r\n- **WHEN** viewing a spec that has related changes\r\n- **THEN** a \"Related Changes\" section lists each change as a clickable link to `/changes/:slug`\r\n\r\n#### Scenario: No related changes\r\n- **WHEN** viewing a spec with no related changes\r\n- **THEN** the \"Related Changes\" section shows an empty state message\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-phase3-markdown-and-search":{"slug":"2026-02-13-phase3-markdown-and-search","proposal":"## Why\r\n\r\nPhase 2 完成了核心 UI 頁面，但 Markdown 內容以 `<pre>` 原始文字顯示，缺乏可讀性和 BDD 語法高亮。搜尋按鈕目前為 disabled 狀態，後端搜尋 API 已就緒但前端尚未串接。本階段將補齊 Markdown 渲染和搜尋 UI，使 spek 成為可實際使用的 OpenSpec 檢視器。\r\n\r\n## What Changes\r\n\r\n- 新增 `MarkdownRenderer` 元件，使用 `react-markdown` + `remark-gfm` 渲染 Markdown 內容\r\n- 實作 BDD 語法高亮：WHEN/GIVEN（藍）、THEN（綠）、AND（灰）、MUST/SHALL（紅）、ADDED/MODIFIED（橘/藍 badge）\r\n- 新增 `SearchDialog` 元件，支援 `Cmd+K` / `Ctrl+K` 快捷鍵開啟\r\n- 串接後端 `/api/openspec/search` API，搜尋結果含上下文預覽\r\n- 將 SpecDetail、ChangeDetail 頁面的 `<pre>` 替換為 `MarkdownRenderer`\r\n- 將 Layout header 的 disabled search 按鈕替換為可用的搜尋觸發器\r\n- 新增 `react-markdown` 和 `remark-gfm` npm 依賴\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `markdown-renderer`: Markdown 渲染元件，含 GFM 支援與 BDD 語法高亮\r\n- `search-ui`: 全文搜尋對話框 UI，含鍵盤快捷鍵與結果導覽\r\n\r\n### Modified Capabilities\r\n（無 spec 層級的需求變更，現有 API 行為不變）\r\n\r\n## Impact\r\n\r\n- **前端元件**：新增 `MarkdownRenderer.tsx`、`SearchDialog.tsx`；修改 `SpecDetail.tsx`、`ChangeDetail.tsx`、`Layout.tsx`\r\n- **依賴**：新增 `react-markdown`、`remark-gfm` 套件\r\n- **API**：僅串接現有 search API，無後端變更\r\n- **樣式**：新增 BDD 高亮相關 CSS 規則\r\n","design":"## Context\r\n\r\nPhase 2 完成了核心 UI 頁面，但所有 Markdown 內容以 `<pre>` 顯示原始文字。搜尋按鈕為 disabled placeholder。後端搜尋 API（`/api/openspec/search`，使用 Fuse.js）已在 Phase 1 實作完成。\r\n\r\n目前前端尚未安裝 `react-markdown` 或 `remark-gfm`，需新增這兩個依賴。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 以 react-markdown 渲染所有 Markdown 內容，支援 GFM（表格、checkbox、strikethrough）\r\n- 實作 BDD 語法高亮，讓 WHEN/THEN/MUST 等關鍵字在視覺上突出\r\n- 提供 SearchDialog 搜尋對話框，支援 Cmd+K / Ctrl+K 快捷鍵\r\n- 搜尋結果按類型分組（spec / change），點擊可導覽至對應頁面\r\n\r\n**Non-Goals:**\r\n- 不做 Markdown 編輯功能\r\n- 不修改後端搜尋 API 邏輯\r\n- 不做搜尋結果的 client-side re-ranking（直接使用後端排序）\r\n- 不做搜尋歷史記錄\r\n\r\n## Decisions\r\n\r\n### D1: BDD 高亮實作方式 — react-markdown custom components\r\n\r\n使用 react-markdown 的 `components` prop 自訂渲染。在段落（`p`）和列表項（`li`）元件中，對文字節點進行正規表達式匹配，將 BDD 關鍵字包裹在 `<span>` 中套用對應樣式。\r\n\r\n**替代方案**：remark plugin 做 AST 轉換 — 較複雜且不易維護，BDD 高亮本質是視覺層處理，不需要改動 AST。\r\n\r\n**關鍵字與樣式對應**：\r\n- `WHEN`、`GIVEN` → 藍色背景標籤 (`bg-blue-500/20 text-blue-400`)\r\n- `THEN` → 綠色背景標籤 (`bg-green-500/20 text-green-400`)\r\n- `AND` → 灰色背景標籤 (`bg-gray-500/20 text-gray-400`)\r\n- `MUST`、`SHALL` → 紅色粗體 (`text-red-400 font-bold`)\r\n- `ADDED`、`MODIFIED` → 橘/藍 badge (`bg-orange-500/20` / `bg-blue-500/20`)\r\n\r\n匹配規則：僅在單字邊界（word boundary）匹配，且關鍵字為全大寫時才觸發，避免誤匹配一般英文文字。\r\n\r\n### D2: SearchDialog 設計 — Modal overlay + 即時搜尋\r\n\r\n採用 modal overlay 模式，按 `Cmd+K` / `Ctrl+K` 開啟，按 `Escape` 關閉。輸入文字時 debounce 300ms 後呼叫後端搜尋 API。\r\n\r\n結果按 type 分組顯示（Specs / Changes），每筆結果顯示名稱和上下文預覽片段。點擊結果使用 React Router `navigate()` 跳轉到對應頁面。\r\n\r\n支援鍵盤導覽：上下箭頭選取結果、Enter 確認跳轉。\r\n\r\n### D3: MarkdownRenderer 整合點\r\n\r\nMarkdownRenderer 作為純展示元件，接受 `content: string` prop。在以下位置使用：\r\n- `SpecDetail.tsx` — 替換 `<pre>{data.content}</pre>`\r\n- `ChangeDetail.tsx` — 替換 proposal、design、specs tab 的 `<pre>` 區塊\r\n- Tasks tab 保持現有的結構化顯示（checkbox + progress），不使用 MarkdownRenderer\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[效能] 大型 Markdown 檔案渲染延遲** → react-markdown 已有虛擬化機制，且 OpenSpec 檔案通常不超過數百行，風險低\r\n- **[誤匹配] BDD 關鍵字出現在程式碼區塊中** → 僅在非 code 元素中執行高亮，`code` 和 `pre` 元件不做處理\r\n- **[搜尋延遲] 每次輸入都打 API** → debounce 300ms 減少請求頻率；後端為本地檔案讀取，延遲可忽略\r\n","tasks":{"total":13,"completed":13,"sections":[{"title":"1. Dependencies","tasks":[{"text":"1.1 Install react-markdown and remark-gfm packages","completed":true}]},{"title":"2. MarkdownRenderer Component","tasks":[{"text":"2.1 Create MarkdownRenderer component with react-markdown + remark-gfm rendering","completed":true},{"text":"2.2 Implement BDD keyword highlighting (WHEN/GIVEN, THEN, AND, MUST/SHALL, ADDED/MODIFIED) using custom component overrides","completed":true},{"text":"2.3 Add dark theme styles for rendered Markdown (code blocks, links, headings, tables)","completed":true}]},{"title":"3. Integrate MarkdownRenderer","tasks":[{"text":"3.1 Replace `<pre>` in SpecDetail with MarkdownRenderer","completed":true},{"text":"3.2 Replace `<pre>` in ChangeDetail (proposal, design, specs tabs) with MarkdownRenderer","completed":true}]},{"title":"4. SearchDialog Component","tasks":[{"text":"4.1 Create SearchDialog component with modal overlay, search input, and results display","completed":true},{"text":"4.2 Add useSearch hook to call `/api/openspec/search` with 300ms debounce","completed":true},{"text":"4.3 Implement result grouping by type (Specs / Changes) with context preview","completed":true},{"text":"4.4 Implement keyboard navigation (arrow keys to select, Enter to confirm, Escape to close)","completed":true},{"text":"4.5 Implement click-to-navigate using React Router","completed":true}]},{"title":"5. Integrate SearchDialog","tasks":[{"text":"5.1 Add Cmd+K / Ctrl+K global keyboard shortcut to open SearchDialog","completed":true},{"text":"5.2 Replace disabled search button in Layout header with functional search trigger","completed":true}]}]},"specs":[{"topic":"markdown-renderer","content":"## ADDED Requirements\r\n\r\n### Requirement: Markdown content rendering\r\nThe system SHALL render Markdown content using react-markdown with remark-gfm plugin, supporting GFM features including tables, strikethrough, and task lists.\r\n\r\n#### Scenario: Standard Markdown rendering\r\n- **WHEN** MarkdownRenderer receives a string containing standard Markdown (headings, lists, bold, italic, links, code blocks)\r\n- **THEN** the content is rendered as formatted HTML with appropriate styling\r\n\r\n#### Scenario: GFM table rendering\r\n- **WHEN** MarkdownRenderer receives content containing a GFM pipe table\r\n- **THEN** the table is rendered as a styled HTML table with header row and data rows\r\n\r\n#### Scenario: GFM checkbox rendering\r\n- **WHEN** MarkdownRenderer receives content containing `- [x]` or `- [ ]` items\r\n- **THEN** the items are rendered as visual checkboxes (read-only)\r\n\r\n### Requirement: BDD keyword highlighting\r\nThe system SHALL visually highlight BDD keywords in rendered Markdown content to improve readability of spec documents.\r\n\r\n#### Scenario: WHEN/GIVEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `WHEN` or `GIVEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a blue background label style (blue text on blue-tinted background)\r\n\r\n#### Scenario: THEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `THEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a green background label style (green text on green-tinted background)\r\n\r\n#### Scenario: AND keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `AND` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a gray background label style (gray text on gray-tinted background)\r\n\r\n#### Scenario: MUST/SHALL keyword highlighting\r\n- **WHEN** rendered Markdown contains `MUST` or `SHALL` as standalone uppercase keywords\r\n- **THEN** the keywords are displayed in red bold text\r\n\r\n#### Scenario: ADDED/MODIFIED badge rendering\r\n- **WHEN** rendered Markdown contains `ADDED` or `MODIFIED` as standalone uppercase keywords\r\n- **THEN** `ADDED` is displayed as an orange badge and `MODIFIED` is displayed as a blue badge\r\n\r\n#### Scenario: Keywords inside code blocks are not highlighted\r\n- **WHEN** BDD keywords appear inside inline code or fenced code blocks\r\n- **THEN** the keywords are NOT highlighted and remain as plain code text\r\n\r\n#### Scenario: Case-sensitive matching\r\n- **WHEN** text contains lowercase or mixed-case variations like \"when\", \"Then\", \"must\"\r\n- **THEN** the keywords are NOT highlighted (only exact uppercase matches trigger highlighting)\r\n\r\n### Requirement: Dark theme styling\r\nThe system SHALL apply dark theme styles consistent with the application's design system (background #0a0c0f series, amber accent, text #e2e8f0).\r\n\r\n#### Scenario: Code block styling\r\n- **WHEN** MarkdownRenderer renders a fenced code block\r\n- **THEN** the code block uses a dark background with monospace font and appropriate padding\r\n\r\n#### Scenario: Link styling\r\n- **WHEN** MarkdownRenderer renders a hyperlink\r\n- **THEN** the link is displayed in accent color (amber) with hover effect\r\n\r\n#### Scenario: Heading styling\r\n- **WHEN** MarkdownRenderer renders headings (h1-h6)\r\n- **THEN** headings use appropriate font sizes and weights consistent with the dark theme\r\n"},{"topic":"search-ui","content":"## ADDED Requirements\r\n\r\n### Requirement: Search dialog activation\r\nThe system SHALL provide a search dialog that can be opened via keyboard shortcut or UI interaction.\r\n\r\n#### Scenario: Open search with keyboard shortcut\r\n- **WHEN** user presses `Cmd+K` (macOS) or `Ctrl+K` (other platforms) anywhere in the application\r\n- **THEN** a search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Open search via header button\r\n- **WHEN** user clicks the search button in the application header\r\n- **THEN** the search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Close search with Escape\r\n- **WHEN** the search dialog is open and user presses `Escape`\r\n- **THEN** the search dialog closes\r\n\r\n#### Scenario: Close search by clicking backdrop\r\n- **WHEN** the search dialog is open and user clicks outside the dialog\r\n- **THEN** the search dialog closes\r\n\r\n### Requirement: Search query execution\r\nThe system SHALL search across all specs and changes content by calling the backend search API with debounced input.\r\n\r\n#### Scenario: Debounced search on input\r\n- **WHEN** user types a query in the search input\r\n- **THEN** the system waits 300ms after the last keystroke before sending the search request to `GET /api/openspec/search`\r\n\r\n#### Scenario: Display search results\r\n- **WHEN** the search API returns results\r\n- **THEN** results are displayed grouped by type (Specs and Changes), each showing the name and a context preview snippet\r\n\r\n#### Scenario: No results found\r\n- **WHEN** the search API returns an empty array\r\n- **THEN** the dialog displays a \"No results found\" message\r\n\r\n#### Scenario: Empty query\r\n- **WHEN** the search input is empty\r\n- **THEN** no search request is made and the results area shows a prompt to start typing\r\n\r\n### Requirement: Search result navigation\r\nThe system SHALL allow users to navigate to search results using keyboard or mouse.\r\n\r\n#### Scenario: Click to navigate\r\n- **WHEN** user clicks on a search result\r\n- **THEN** the application navigates to the corresponding page (`/specs/:topic` for spec results, `/changes/:slug` for change results) and the search dialog closes\r\n\r\n#### Scenario: Keyboard navigation with arrow keys\r\n- **WHEN** user presses the down arrow key in the search dialog\r\n- **THEN** the next result item is highlighted\r\n- **AND** pressing the up arrow key highlights the previous result item\r\n\r\n#### Scenario: Confirm selection with Enter\r\n- **WHEN** user presses Enter with a result item highlighted\r\n- **THEN** the application navigates to that result's page and the search dialog closes\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-phase4-polish-and-enhancement":{"slug":"2026-02-13-phase4-polish-and-enhancement","proposal":"## Why\r\n\r\nPhase 1~3 完成了核心功能（API、頁面、Markdown 渲染、搜尋），但 UI 仍為桌面限定、僅深色主題、缺少 spec 演進的歷史脈絡。Phase 4 的目標是提升使用體驗——讓應用在各種裝置上可用、提供淺色主題選項、並讓使用者能追蹤 spec 隨時間演進的歷程。\r\n\r\n## What Changes\r\n\r\n- 新增響應式佈局：sidebar 可收合、行動裝置漢堡選單、內容區自適應寬度\r\n- 新增深色/淺色主題切換，支援系統偏好偵測與 localStorage 持久化\r\n- 增強 repo 選擇頁的最近路徑體驗：驗證路徑是否仍有效、顯示路徑狀態\r\n- 新增 spec 演進歷史 API 與 UI：顯示哪些 change 影響了特定 spec，含時間線視圖\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `responsive-layout`: 響應式佈局系統，包含 sidebar 收合、漢堡選單、斷點適配\r\n- `theme-toggle`: 深色/淺色主題切換功能，含系統偏好偵測、localStorage 持久化、CSS 變數雙主題定義\r\n- `spec-history`: Spec 演進歷史追蹤，API 回傳每個 spec 被哪些 change 修改及時間線，UI 以時間線呈現\r\n\r\n### Modified Capabilities\r\n- `shared-layout`: 加入 sidebar 收合能力與響應式斷點適配\r\n- `repo-selection`: 增強最近路徑清單——非同步驗證路徑有效性、顯示狀態指標（有效/無效/檢查中）\r\n\r\n## Impact\r\n\r\n- **前端元件**：Layout、Sidebar 需重構支援收合；新增 ThemeProvider context；SpecDetail 加入歷史時間線區塊\r\n- **CSS**：global.css 需定義淺色主題 CSS 變數，切換以 `data-theme` attribute 或 class 控制\r\n- **API**：新增 `GET /api/openspec/specs/:topic/history` endpoint，回傳 change 影響時間線\r\n- **依賴**：無需新增外部依賴\r\n- **Context**：新增 ThemeContext（或擴充既有 context），管理主題狀態\r\n","design":"## Context\r\n\r\nPhase 1~3 已完成核心功能。目前 UI 為桌面固定 240px sidebar + 固定 header，僅深色主題，spec 詳細頁僅顯示 related changes 的 slug 清單但缺乏時間脈絡。SelectRepo 已有最近路徑清單，但不驗證路徑是否仍存在。\r\n\r\n技術現狀：\r\n- Tailwind CSS v4 + CSS custom properties（`@theme` 區塊定義色彩）\r\n- 固定佈局：header 56px、sidebar 240px、`ml-60 pt-14` 主內容區\r\n- RepoContext 管理 repo 路徑 + localStorage 最近路徑\r\n- `findRelatedChanges()` 已能查找哪些 change 含有特定 spec 的 delta spec\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 讓應用在 768px 以下螢幕可用（sidebar 收合為漢堡選單）\r\n- 提供淺色主題切換，支援 system preference 自動偵測\r\n- 增強最近路徑的可用性（顯示路徑狀態）\r\n- 以時間線呈現 spec 被哪些 change 修改的歷史\r\n\r\n**Non-Goals:**\r\n- 完整的 PWA 或離線支援\r\n- 自訂主題色彩（僅深色/淺色兩套）\r\n- Spec 內容 diff 比對（僅顯示哪些 change 影響了 spec，不比對內容差異）\r\n- 拖放或觸控手勢操作\r\n\r\n## Decisions\r\n\r\n### D1: 響應式斷點策略\r\n\r\n**選擇**：單一斷點 768px，使用 Tailwind `md:` prefix\r\n\r\n- < 768px：sidebar 隱藏，header 顯示漢堡按鈕，點擊彈出 overlay sidebar\r\n- ≥ 768px：sidebar 固定顯示（目前行為），可選收合為 icon-only 模式\r\n\r\n**替代方案**：多斷點（sm/md/lg/xl）→ 過度工程，本應用內容結構單純，一個斷點足夠\r\n\r\n**實作方式**：\r\n- Layout.tsx 加入 `sidebarOpen` state，桌面預設 open，行動版預設 closed\r\n- Sidebar 行動版為 fixed overlay + backdrop，桌面版為 fixed sidebar\r\n- 使用 `window.matchMedia('(min-width: 768px)')` 監聽斷點變化\r\n- Dashboard grid: `grid-cols-2 md:grid-cols-4`\r\n\r\n### D2: 主題切換機制\r\n\r\n**選擇**：`<html data-theme=\"dark|light\">` + CSS custom properties 雙套定義\r\n\r\n- `global.css` 定義兩套 `@theme` 變數（dark 為預設，light 在 `[data-theme=\"light\"]` selector 下覆寫）\r\n- ThemeContext 管理狀態，localStorage key `spek:theme`\r\n- 初始化順序：localStorage → `prefers-color-scheme` → 預設 dark\r\n- Header 右側加入主題切換按鈕（太陽/月亮 icon）\r\n\r\n**替代方案**：\r\n- Tailwind `dark:` class → 需要每個元件都寫兩套 class，改動量大\r\n- CSS-only media query → 無法手動切換\r\n\r\n**注意**：Tailwind CSS v4 的 `@theme` 是全域的，不支援 selector-scoped override。淺色主題需用普通 CSS 變數 override 搭配 `[data-theme=\"light\"]` selector。\r\n\r\n### D3: Spec 歷史 API\r\n\r\n**選擇**：擴充現有 `GET /api/openspec/specs/:topic` 回傳，加入 `history` 欄位\r\n\r\n- `history` 陣列包含每個 related change 的 `{ slug, date, description, status }` 資訊\r\n- 不新增獨立 endpoint，因為 `readSpec()` 已呼叫 `findRelatedChanges()`，只需擴充回傳資料\r\n- 前端 SpecDetail 新增「History」區塊，以時間線呈現\r\n\r\n**替代方案**：新增 `/api/openspec/specs/:topic/history` 獨立 endpoint → 多一次 API call，且資料來源相同，不划算\r\n\r\n### D4: 最近路徑驗證\r\n\r\n**選擇**：SelectRepo 載入時，對每個最近路徑呼叫 detect API 進行非同步驗證\r\n\r\n- 顯示三種狀態：檢查中（spinner）、有效（綠色）、無效（紅色 + 刪除按鈕）\r\n- 驗證在背景進行，不阻擋 UI 互動\r\n- 使用者可刪除無效路徑\r\n\r\n**替代方案**：只在點擊時驗證 → 使用者看到的路徑可能已不存在，體驗不佳\r\n\r\n## Risks / Trade-offs\r\n\r\n- **Tailwind v4 @theme 限制** → CSS custom property override 不在 `@theme` 區塊內，而是用普通 CSS `[data-theme=\"light\"]` selector。需確認所有元件使用 `bg-bg-primary` 等 semantic token 而非直接硬編碼色值。\r\n  - 緩解：全域搜尋硬編碼色值，統一改用 CSS 變數\r\n- **Sidebar overlay 觸控** → 行動版 sidebar overlay 需處理 backdrop 點擊關閉。\r\n  - 緩解：使用 fixed backdrop div + onClick handler\r\n- **路徑驗證延遲** → 多個路徑同時驗證可能造成短暫 loading 狀態。\r\n  - 緩解：並行發送所有 detect 請求，各自獨立更新狀態\r\n","tasks":{"total":21,"completed":21,"sections":[{"title":"1. Theme Toggle","tasks":[{"text":"1.1 Define light theme CSS variables in `global.css` under `[data-theme=\"light\"]` selector","completed":true},{"text":"1.2 Create `ThemeContext` with theme state, toggle function, localStorage persistence (`spek:theme`), and system preference detection","completed":true},{"text":"1.3 Wrap app with `ThemeProvider` in `main.tsx`, set `data-theme` attribute on `<html>`","completed":true},{"text":"1.4 Add theme toggle button (sun/moon icon) to Layout header","completed":true}]},{"title":"2. Responsive Layout","tasks":[{"text":"2.1 Add `sidebarOpen` state and mobile breakpoint detection (`matchMedia 768px`) to Layout","completed":true},{"text":"2.2 Refactor Sidebar to accept `open`/`onClose` props; render as overlay with backdrop on mobile, fixed on desktop","completed":true},{"text":"2.3 Add hamburger menu button to header (visible only on mobile)","completed":true},{"text":"2.4 Update main content area to remove fixed `ml-60` on mobile","completed":true},{"text":"2.5 Update header to hide repo path on mobile","completed":true},{"text":"2.6 Update Dashboard stat cards grid to `grid-cols-2 md:grid-cols-4` and navigation cards to stack on mobile","completed":true}]},{"title":"3. Recent Path Enhancement","tasks":[{"text":"3.1 Add async path validation in SelectRepo — call detect API for each recent path on mount","completed":true},{"text":"3.2 Display status indicators for each recent path: spinner (checking), green checkmark (valid), red indicator (invalid)","completed":true},{"text":"3.3 Add delete button for individual recent paths, update localStorage on removal","completed":true}]},{"title":"4. Spec History","tasks":[{"text":"4.1 Extend `readSpec()` in `scanner.ts` to return `history` array with `{ slug, date, description, status }` for each related change","completed":true},{"text":"4.2 Update `useSpec` hook type to include `history` field","completed":true},{"text":"4.3 Add history timeline UI section to SpecDetail page with date, description, and link to change","completed":true}]},{"title":"5. Verification","tasks":[{"text":"5.1 Verify theme toggle works: dark ↔ light, persists across reload, respects system preference on first visit","completed":true},{"text":"5.2 Verify responsive layout: sidebar collapses on mobile, overlay works, grids adapt","completed":true},{"text":"5.3 Verify recent paths show validation status and allow deletion","completed":true},{"text":"5.4 Verify spec history timeline displays correctly with links to changes","completed":true},{"text":"5.5 Run `npm run type-check` and `npm run build` to confirm no errors","completed":true}]}]},"specs":[{"topic":"repo-selection","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Recent paths persistence\r\nThe system SHALL persist the most recent 5 repo paths in localStorage. On page load, previously used paths SHALL be displayed for quick selection. Each recent path SHALL be validated asynchronously against the detect API to show its current status (valid, invalid, or checking).\r\n\r\n#### Scenario: Save path on successful detection\r\n- **WHEN** user successfully opens a repo (path with valid openspec/)\r\n- **THEN** the path is saved to localStorage recent paths list (max 5, most recent first)\r\n\r\n#### Scenario: Display recent paths on load\r\n- **WHEN** user visits the SelectRepo page\r\n- **THEN** previously saved paths are displayed as clickable options\r\n\r\n#### Scenario: Validate recent paths asynchronously\r\n- **WHEN** the SelectRepo page loads with saved recent paths\r\n- **THEN** the system calls the detect API for each path in parallel\r\n- **AND** each path displays a status indicator: spinner (checking), green checkmark (valid openspec/ found), or red indicator (path invalid or no openspec/)\r\n\r\n#### Scenario: Remove invalid path\r\n- **WHEN** a recent path is determined to be invalid\r\n- **THEN** a delete button appears next to the path allowing the user to remove it from the list\r\n"},{"topic":"responsive-layout","content":"## ADDED Requirements\r\n\r\n### Requirement: Mobile breakpoint detection\r\nThe system SHALL detect whether the viewport width is below 768px and adapt the layout accordingly. The detection MUST use `window.matchMedia` and respond to runtime viewport changes (e.g., device rotation).\r\n\r\n#### Scenario: Viewport below 768px\r\n- **WHEN** the viewport width is less than 768px\r\n- **THEN** the sidebar is hidden by default and a hamburger menu button appears in the header\r\n\r\n#### Scenario: Viewport at or above 768px\r\n- **WHEN** the viewport width is 768px or greater\r\n- **THEN** the sidebar is displayed in its fixed position and the hamburger menu button is hidden\r\n\r\n#### Scenario: Viewport resize crossing breakpoint\r\n- **WHEN** the viewport is resized from below 768px to at or above 768px\r\n- **THEN** the sidebar transitions to fixed display and the hamburger menu button is hidden\r\n\r\n### Requirement: Mobile sidebar overlay\r\nThe system SHALL display the sidebar as a full-height overlay with a backdrop when opened on viewports below 768px.\r\n\r\n#### Scenario: Open mobile sidebar\r\n- **WHEN** the user taps the hamburger menu button on a mobile viewport\r\n- **THEN** the sidebar slides in from the left as an overlay with a semi-transparent backdrop behind it\r\n\r\n#### Scenario: Close mobile sidebar via backdrop\r\n- **WHEN** the mobile sidebar overlay is open and the user taps the backdrop area\r\n- **THEN** the sidebar closes and the backdrop disappears\r\n\r\n#### Scenario: Close mobile sidebar via navigation\r\n- **WHEN** the mobile sidebar overlay is open and the user taps a navigation link\r\n- **THEN** the system navigates to the selected route and the sidebar closes automatically\r\n\r\n### Requirement: Responsive content grids\r\nThe system SHALL adapt grid layouts for different viewport sizes. Dashboard stat cards MUST use 2 columns on mobile and 4 columns on desktop. Navigation cards MUST stack vertically on mobile.\r\n\r\n#### Scenario: Dashboard stat cards on mobile\r\n- **WHEN** the Dashboard page is rendered on a viewport below 768px\r\n- **THEN** the stat cards are displayed in a 2-column grid\r\n\r\n#### Scenario: Dashboard stat cards on desktop\r\n- **WHEN** the Dashboard page is rendered on a viewport at or above 768px\r\n- **THEN** the stat cards are displayed in a 4-column grid\r\n\r\n### Requirement: Responsive header\r\nThe system SHALL adapt the header layout for mobile viewports. The repo path display MUST be hidden on mobile to save space. The search button MUST remain accessible.\r\n\r\n#### Scenario: Header on mobile\r\n- **WHEN** the header is rendered on a viewport below 768px\r\n- **THEN** the hamburger button is shown on the left, the search button is centered, and the repo path is hidden\r\n\r\n#### Scenario: Header on desktop\r\n- **WHEN** the header is rendered on a viewport at or above 768px\r\n- **THEN** the layout shows the spek brand on the left, search button centered, and repo path on the right\r\n"},{"topic":"shared-layout","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a sidebar with navigation links: Overview (Dashboard), Specs, and Changes. The current route SHALL be visually highlighted. On viewports below 768px, the sidebar SHALL be hidden by default and displayed as an overlay when toggled. On viewports at or above 768px, the sidebar SHALL be displayed in a fixed position (240px width).\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n#### Scenario: Sidebar on mobile viewport\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar is hidden by default and only shown when the hamburger menu is activated\r\n\r\n#### Scenario: Sidebar on desktop viewport\r\n- **WHEN** the viewport is at or above 768px\r\n- **THEN** the sidebar is displayed in its fixed position (240px width)\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: the \"spek\" logo/brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button and hide the repo path. The header SHALL also include a theme toggle button.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the spek brand, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button, the spek brand, search button, and theme toggle, but hides the repo path\r\n"},{"topic":"spec-history","content":"## ADDED Requirements\r\n\r\n### Requirement: Spec history data in API response\r\nThe system SHALL include a `history` array in the `GET /api/openspec/specs/:topic` response. Each entry MUST contain the change slug, date (if parseable from slug), description, and status (active or archived).\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** a spec has been affected by one or more changes (i.e., changes that contain a delta spec for this topic)\r\n- **THEN** the API response includes a `history` array with entries sorted by date descending (most recent first)\r\n- **AND** each entry contains `{ slug, date, description, status }`\r\n\r\n#### Scenario: Spec with no related changes\r\n- **WHEN** a spec has no related changes\r\n- **THEN** the API response includes an empty `history` array\r\n\r\n### Requirement: Spec history timeline UI\r\nThe system SHALL display a visual timeline on the SpecDetail page showing all changes that affected the spec. Each timeline entry MUST display the date, change description, and a link to the change detail page.\r\n\r\n#### Scenario: Display history timeline\r\n- **WHEN** the SpecDetail page is rendered for a spec with related changes\r\n- **THEN** a \"History\" section is displayed with a vertical timeline showing each change chronologically\r\n\r\n#### Scenario: Timeline entry links to change\r\n- **WHEN** the user clicks on a timeline entry\r\n- **THEN** the system navigates to the corresponding change detail page\r\n\r\n#### Scenario: No history\r\n- **WHEN** the SpecDetail page is rendered for a spec with no related changes\r\n- **THEN** the \"History\" section displays a message indicating no changes have affected this spec\r\n"},{"topic":"theme-toggle","content":"## ADDED Requirements\r\n\r\n### Requirement: Theme state management\r\nThe system SHALL provide a ThemeContext that manages the current theme (\"dark\" or \"light\") and exposes a toggle function. The theme state MUST be persisted in localStorage under the key `spek:theme`.\r\n\r\n#### Scenario: Initialize from localStorage\r\n- **WHEN** the application loads and localStorage contains a saved theme preference\r\n- **THEN** the system applies the saved theme\r\n\r\n#### Scenario: Initialize from system preference\r\n- **WHEN** the application loads and no theme is saved in localStorage\r\n- **AND** the user's system preference is light mode (`prefers-color-scheme: light`)\r\n- **THEN** the system applies the light theme\r\n\r\n#### Scenario: Initialize default\r\n- **WHEN** the application loads and no theme is saved and no system preference is detected\r\n- **THEN** the system applies the dark theme as default\r\n\r\n#### Scenario: Toggle theme\r\n- **WHEN** the user triggers the theme toggle\r\n- **THEN** the current theme switches (dark → light or light → dark)\r\n- **AND** the new preference is saved to localStorage\r\n- **AND** the `data-theme` attribute on `<html>` is updated\r\n\r\n### Requirement: Light theme CSS variables\r\nThe system SHALL define a complete set of light theme CSS variables that override the dark theme defaults when `[data-theme=\"light\"]` is set on the `<html>` element.\r\n\r\n#### Scenario: Light theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"light\"`\r\n- **THEN** all color CSS variables (`--color-bg-primary`, `--color-bg-secondary`, `--color-bg-tertiary`, `--color-border`, `--color-text-primary`, `--color-text-secondary`, `--color-text-muted`, `--color-accent`, `--color-accent-hover`) are overridden with light-appropriate values\r\n\r\n#### Scenario: Dark theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"dark\"` or no `data-theme` attribute\r\n- **THEN** the default dark theme CSS variables are used\r\n\r\n### Requirement: Theme toggle button\r\nThe system SHALL display a theme toggle button in the header. The button MUST show a sun icon when in dark mode (indicating \"switch to light\") and a moon icon when in light mode (indicating \"switch to dark\").\r\n\r\n#### Scenario: Display toggle in header\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** a theme toggle button is visible in the header area\r\n\r\n#### Scenario: Icon reflects current theme\r\n- **WHEN** the current theme is dark\r\n- **THEN** the toggle button displays a sun icon\r\n- **WHEN** the current theme is light\r\n- **THEN** the toggle button displays a moon icon\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-push-to-github":{"slug":"2026-02-13-push-to-github","proposal":"## Why\r\n\r\n專案已經開發到可公開的狀態，但 repo 尚未 push 到 GitHub remote。同時 VS Code Extension 已發佈至 Marketplace，但 README 仍顯示手動 build `.vsix` 的安裝方式，需更新為 Marketplace 安裝連結。\r\n\r\n## What Changes\r\n\r\n- 設定 GitHub remote 並將 `master` 分支 push 到 `https://github.com/kewang/spek`\r\n- 更新 `README.md` 的 VS Code Extension 區塊：移除手動 build 指令，改為 Marketplace 安裝連結\r\n- 更新 `README.zh-TW.md` 的 VS Code Extension 區塊：同上\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n（無新增 capability）\r\n\r\n### Modified Capabilities\r\n\r\n（無 spec 層級的需求變更，僅文件與 repo 配置調整）\r\n\r\n## Impact\r\n\r\n- **文件**：`README.md`、`README.zh-TW.md` 的安裝說明更新\r\n- **Git**：新增 remote origin，push `master` 分支\r\n- **程式碼**：無影響\r\n","design":"## Context\r\n\r\n專案目前只有本地 git repo，尚未設定 remote。VS Code Extension 已發佈至 Marketplace，但兩份 README（英文、繁中）的安裝說明仍為手動 build `.vsix` 流程。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 設定 GitHub remote 並 push `master` 分支\r\n- 更新 README.md 和 README.zh-TW.md 的 VS Code Extension 安裝說明為 Marketplace 連結\r\n\r\n**Non-Goals:**\r\n- 不重新命名分支（維持 `master`）\r\n- 不修改程式碼或功能\r\n- 不調整 CI/CD 或 GitHub Actions\r\n\r\n## Decisions\r\n\r\n### 1. 維持 `master` 分支名稱\r\n直接以 `master` push，不改為 `main`。這是使用者的明確要求。\r\n\r\n### 2. README VS Code Extension 區塊改寫方式\r\n- 移除手動 build + `.vsix` 安裝的 code block\r\n- 改為 Marketplace 安裝連結 + 一句說明\r\n- Extension URL: `https://marketplace.visualstudio.com/items?itemName=kewang.spek-vscode`\r\n- 保留 Commands 區塊（`spek: Open spek`、`spek: Search OpenSpec`）不變\r\n\r\n## Risks / Trade-offs\r\n\r\n- [README 手動 build 說明移除] → 開發者如需自行 build extension，可參考 Development 區塊的 build 指令，不另外保留\r\n","tasks":{"total":4,"completed":4,"sections":[{"title":"1. 更新 README","tasks":[{"text":"1.1 更新 README.md 的 VS Code Extension 區塊：移除手動 build 指令，改為 Marketplace 安裝連結","completed":true},{"text":"1.2 更新 README.zh-TW.md 的 VS Code Extension 區塊：同上","completed":true}]},{"title":"2. Push to GitHub","tasks":[{"text":"2.1 設定 GitHub remote origin (`https://github.com/kewang/spek`)","completed":true},{"text":"2.2 Push `master` 分支到 remote","completed":true}]}]},"specs":[],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-spec-history-git-timestamp-cache":{"slug":"2026-02-13-spec-history-git-timestamp-cache","proposal":"## Why\r\n\r\n目前 spec history 的排序只依賴 change slug 中的日期字串（精度到天），同一天內的多個 changes 無法區分先後順序。需要引入 git commit 時間戳作為精確排序依據，並透過 in-memory cache 機制避免每次 API 請求都執行 git 指令。同時，因為 repo 會持續推進，使用者需要手動 resync 的能力來更新快取。\r\n\r\n## What Changes\r\n\r\n- 新增 git timestamp cache 模組：啟動時或首次請求時執行單一 `git log` 指令，解析每個 change 目錄的最早 commit 時間，建立 in-memory Map 快取\r\n- 修改 spec history 排序邏輯：從純日期字串排序改為使用 git commit timestamp 排序，無 timestamp 時 fallback 回 slug 日期\r\n- 新增 resync API endpoint：`POST /api/openspec/resync`，強制重建指定 repo 的 timestamp cache\r\n- 新增 UI resync 按鈕：在畫面上提供手動重新同步的操作，讓使用者在 repo 推進後能更新快取\r\n- 擴充 HistoryEntry 資料結構：新增 `timestamp` 欄位（ISO 8601 格式）\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n- `git-timestamp-cache`: Git commit 時間戳快取模組，負責解析 git log、建立 in-memory cache、提供 resync 機制\r\n\r\n### Modified Capabilities\r\n- `spec-history`: history 排序改用 git commit timestamp，HistoryEntry 新增 timestamp 欄位\r\n- `openspec-api`: 新增 `POST /api/openspec/resync` endpoint\r\n\r\n## Impact\r\n\r\n- **後端新增檔案**：`server/lib/git-cache.ts`\r\n- **後端修改**：`server/lib/scanner.ts`（readSpec 排序邏輯）、`server/routes/openspec.ts`（新增 resync route）\r\n- **前端修改**：`src/hooks/useOpenSpec.ts`（resync hook）、`src/components/Layout.tsx` 或相關元件（resync 按鈕）、`src/pages/SpecDetail.tsx`（可選：顯示精確時間）\r\n- **新增依賴**：無，使用 Node.js 內建 `child_process` 執行 git\r\n- **效能考量**：git log 只在 cache miss 或手動 resync 時執行一次，日常 API 請求零 git 開銷\r\n","design":"## Context\r\n\r\n目前 spec history 排序僅依賴 change slug 中的日期字串（`YYYY-MM-DD`），同一天有多個 changes 時順序不確定。需要引入 git commit 時間戳作為精確排序來源，同時避免每次 API 請求都執行 git 指令。\r\n\r\n現有流程：`readSpec()` → `findRelatedChanges()` → `parseSlug()` 取日期 → `localeCompare` 排序。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 用 git commit 時間戳精確排序同一天內的 history entries\r\n- 透過 in-memory cache 將 git 操作降為一次性成本\r\n- 提供手動 resync 機制讓使用者在 repo 推進後更新快取\r\n- 無 git 資訊時 graceful fallback 回原有的 slug 日期排序\r\n\r\n**Non-Goals:**\r\n- 不做 file watcher 自動偵測 repo 變更\r\n- 不持久化 cache 到磁碟（server 重啟重建即可）\r\n- 不追蹤 git 以外的時間來源\r\n\r\n## Decisions\r\n\r\n### 1. Git 時間戳取「change 目錄最早 commit 時間」\r\n\r\n取最早 commit 代表 change 的建立時間，符合 history 的時序語意（「這個 change 是什麼時候開始的」）。\r\n\r\n替代方案：取最晚 commit（最後更新時間）— 但這會讓頻繁修改的舊 change 排到前面，不符合時間線直覺。\r\n\r\n### 2. 單一 `git log` 指令批次取得所有 change 時間\r\n\r\n執行一次 `git log --format=\"COMMIT %aI\" --name-only -- openspec/changes/`，解析輸出取得每個 slug 對應的最早 commit 時間。\r\n\r\ngit log 預設最新在前輸出，對同一個 slug 持續覆寫，最後留下的即為最早 commit。\r\n\r\n替代方案：每個 slug 各跑一次 `git log --reverse` — 變更數量多時 N 次 fork 效能差。\r\n\r\n### 3. In-memory Map 快取，以 repo 路徑為 key\r\n\r\n結構：`Map<repoDir, Map<slug, isoTimestamp>>`\r\n\r\nspek 是本地開發工具，記憶體用量極低，無需磁碟持久化。Server 重啟時 cache 清空，下次請求 lazy rebuild。\r\n\r\n### 4. Lazy build + 手動 resync 雙軌機制\r\n\r\n- **Lazy build**：第一次對某 repo 發 API 請求且 cache 不存在時自動建立\r\n- **手動 resync**：`POST /api/openspec/resync?dir=...` 清除該 repo 的 cache 並立即重建\r\n\r\n### 5. Resync 按鈕放在 sidebar 底部\r\n\r\n使用者隨時可觸發，不限特定頁面。按鈕帶 loading 狀態回饋。\r\n\r\n替代方案：放 header — 但 header 空間已用於標題和主題切換，sidebar 底部更適合作為工具類操作。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **非 git repo 的情況** → 若 `git log` 失敗（目錄非 git repo），cache 回傳空 Map，排序 fallback 回 slug 日期。不影響功能。\r\n- **大型 repo git log 較慢** → 限定 `-- openspec/changes/` 路徑過濾，大幅縮小掃描範圍。一般 OpenSpec 的 commit 數量不會太大。\r\n- **Cache 過期使用者不察覺** → 透過 UI resync 按鈕讓使用者主動控制，不做自動失效避免複雜度。\r\n","tasks":{"total":8,"completed":8,"sections":[{"title":"1. Git Timestamp Cache 模組","tasks":[{"text":"1.1 建立 `server/lib/git-cache.ts`，實作 `buildChangeTimestamps(repoDir)` 函式：執行 `git log --format=\"COMMIT %aI\" --name-only -- openspec/changes/` 並解析輸出為 `Map<slug, isoTimestamp>`","completed":true},{"text":"1.2 實作 in-memory cache (`Map<repoDir, Map<slug, timestamp>>`)，含 `getTimestamps(repoDir)` (lazy build) 和 `resyncTimestamps(repoDir)` (清除並重建)","completed":true},{"text":"1.3 處理非 git repo 的 fallback：git 指令失敗時回傳空 Map","completed":true}]},{"title":"2. 後端整合","tasks":[{"text":"2.1 修改 `server/lib/scanner.ts` 的 `readSpec()`：HistoryEntry 新增 `timestamp` 欄位，排序改用 timestamp 降序（無 timestamp 時 fallback 回 date）","completed":true},{"text":"2.2 在 `server/routes/openspec.ts` 新增 `POST /api/openspec/resync` endpoint，呼叫 `resyncTimestamps()`","completed":true}]},{"title":"3. 前端整合","tasks":[{"text":"3.1 修改 `src/hooks/useOpenSpec.ts`：SpecHistoryEntry 新增 `timestamp` 欄位，新增 `useResync()` hook","completed":true},{"text":"3.2 在 sidebar（`src/components/Layout.tsx` 或相關元件）加入 resync 按鈕，含 loading 狀態，未選 repo 時隱藏/disabled","completed":true},{"text":"3.3 修改 `src/pages/SpecDetail.tsx`：history timeline 可顯示精確時間（當 timestamp 存在時）","completed":true}]}]},"specs":[{"topic":"git-timestamp-cache","content":"## ADDED Requirements\r\n\r\n### Requirement: Build timestamp cache from git log\r\nThe system SHALL provide a function that executes a single `git log` command scoped to `openspec/changes/` and parses the output to build a Map of change slug to earliest commit timestamp (ISO 8601 format).\r\n\r\n#### Scenario: Build cache for repo with git history\r\n- **WHEN** the cache builder is invoked for a repo directory that is a git repository\r\n- **THEN** the system executes `git log --format=\"COMMIT %aI\" --name-only -- openspec/changes/` in the repo directory\r\n- **AND** parses the output to extract the earliest commit timestamp for each change slug\r\n- **AND** returns a `Map<string, string>` mapping slug to ISO 8601 timestamp\r\n\r\n#### Scenario: Build cache for non-git directory\r\n- **WHEN** the cache builder is invoked for a directory that is not a git repository\r\n- **THEN** the system returns an empty Map without throwing an error\r\n\r\n#### Scenario: Change exists in filesystem but not in git\r\n- **WHEN** a change directory exists but has no git commits (e.g., uncommitted new change)\r\n- **THEN** that change slug is not present in the returned Map\r\n\r\n### Requirement: In-memory cache keyed by repo path\r\nThe system SHALL maintain an in-memory cache (`Map<string, Map<string, string>>`) keyed by absolute repo directory path, storing the timestamp Map for each repo.\r\n\r\n#### Scenario: Cache hit\r\n- **WHEN** a timestamp lookup is requested for a repo that has been previously cached\r\n- **THEN** the system returns the cached Map without executing any git commands\r\n\r\n#### Scenario: Cache miss with lazy build\r\n- **WHEN** a timestamp lookup is requested for a repo that has not been cached\r\n- **THEN** the system automatically builds the cache by executing the git log command\r\n- **AND** stores the result for subsequent lookups\r\n\r\n### Requirement: Resync cache\r\nThe system SHALL provide a resync function that clears the cached timestamps for a given repo and immediately rebuilds the cache from git.\r\n\r\n#### Scenario: Resync after repo changes\r\n- **WHEN** the resync function is invoked for a repo directory\r\n- **THEN** the system clears the existing cache entry for that repo\r\n- **AND** rebuilds the cache by executing the git log command\r\n- **AND** returns the newly built timestamp Map\r\n"},{"topic":"openspec-api","content":"## ADDED Requirements\r\n\r\n### Requirement: Resync cache endpoint\r\nThe system SHALL provide `POST /api/openspec/resync` that clears and rebuilds the git timestamp cache for a given repo.\r\n\r\n#### Scenario: Successful resync\r\n- **WHEN** client sends `POST /api/openspec/resync?dir=/path/to/repo`\r\n- **THEN** the system clears the timestamp cache for that repo\r\n- **AND** rebuilds the cache from git history\r\n- **AND** returns HTTP 200 with `{ ok: true }`\r\n\r\n#### Scenario: Resync without dir parameter\r\n- **WHEN** client sends `POST /api/openspec/resync` without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n\r\n### Requirement: Resync UI control\r\nThe system SHALL display a resync button in the sidebar that triggers a cache rebuild. The button MUST show a loading state while the resync is in progress.\r\n\r\n#### Scenario: User triggers resync\r\n- **WHEN** the user clicks the resync button in the sidebar\r\n- **THEN** the system sends `POST /api/openspec/resync` with the current repo path\r\n- **AND** the button shows a loading/spinning state during the request\r\n- **AND** on success, the current page data is refreshed to reflect updated ordering\r\n\r\n#### Scenario: Resync with no repo selected\r\n- **WHEN** no repo is currently selected\r\n- **THEN** the resync button is not displayed or is disabled\r\n"},{"topic":"spec-history","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec history data in API response\r\nThe system SHALL include a `history` array in the `GET /api/openspec/specs/:topic` response. Each entry MUST contain the change slug, date (if parseable from slug), timestamp (ISO 8601 from git commit cache, or null if unavailable), description, and status (active or archived).\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** a spec has been affected by one or more changes (i.e., changes that contain a delta spec for this topic)\r\n- **THEN** the API response includes a `history` array with entries sorted by git commit timestamp descending (most recent first)\r\n- **AND** if two entries have the same date, the git commit timestamp determines their order\r\n- **AND** each entry contains `{ slug, date, timestamp, description, status }`\r\n\r\n#### Scenario: Spec with no related changes\r\n- **WHEN** a spec has no related changes\r\n- **THEN** the API response includes an empty `history` array\r\n\r\n#### Scenario: Fallback sorting when git timestamp unavailable\r\n- **WHEN** a history entry has no git commit timestamp (e.g., uncommitted change or non-git repo)\r\n- **THEN** the entry's `timestamp` field is null\r\n- **AND** sorting falls back to the date parsed from the slug\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-vscode-extension":{"slug":"2026-02-13-vscode-extension","proposal":"## Why\r\n\r\nspek 目前是獨立的 Web 應用，使用者需要在終端執行 `npm run dev` 再開啟瀏覽器。對於日常在 VS Code 中工作的開發者而言，切換到瀏覽器查看 OpenSpec 內容會中斷工作流。將 spek 包裝為 VS Code Extension，讓使用者在編輯器內直接瀏覽 specs 和 changes，是最自然的整合方式。\r\n\r\n## What Changes\r\n\r\n- 新增 VS Code Extension，使用 Webview Panel 嵌入現有 React UI\r\n- 將 `server/lib/` 的核心邏輯（scanner、tasks parser）抽成獨立的 `packages/core/` 共用模組\r\n- 重構為 monorepo 結構（`packages/core`、`packages/web`、`packages/vscode`）\r\n- React 前端新增 API adapter 抽象層，支援 fetch（web）與 postMessage（vscode）兩種通訊模式\r\n- Extension 自動偵測 workspace 中的 `openspec/` 目錄，不需手動選路徑\r\n- 新增 VS Code commands（開啟 spek 面板、搜尋 OpenSpec 內容）\r\n- 現有 Web 版本維持不變，仍可獨立使用\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `vscode-extension-host`: Extension 生命週期管理（activate/deactivate）、Webview Panel 建立與通訊、VS Code commands 註冊\r\n- `webview-integration`: React SPA 在 VS Code Webview 中的載入、CSP 設定、資源路徑轉換、message-based API 通訊\r\n- `core-module`: 從 server/lib/ 抽出的共用核心邏輯模組（scanner、tasks parser、型別定義），可被 web server 和 extension host 共用\r\n- `api-adapter`: 前端 API 通訊抽象層，統一 fetch 與 postMessage 兩種模式的介面\r\n\r\n### Modified Capabilities\r\n\r\n- `openspec-scanner`: 核心掃描邏輯需從 Express route 解耦，移至 core module 成為純函式\r\n- `task-parser`: 核心解析邏輯需從 Express route 解耦，移至 core module 成為純函式\r\n\r\n## Impact\r\n\r\n- **專案結構**：從單一 package 重構為 monorepo（packages/core、packages/web、packages/vscode）\r\n- **依賴**：新增 `@types/vscode`、`@vscode/vsce`（打包工具）\r\n- **Build pipeline**：需要新增 extension bundling（esbuild/webpack）、Webview asset build\r\n- **現有 Web 版**：搬到 `packages/web/`，import 路徑從 `server/lib/` 改為 `@spek/core`，功能不變\r\n- **發布**：Web 版照舊 `npm run dev`；Extension 可透過 `vsce package` 打包為 `.vsix`\r\n","design":"## Context\r\n\r\nspek 目前是一個單體 Web 應用（Express + React SPA），使用者需要 `npm run dev` 啟動後在瀏覽器中操作。核心邏輯（OpenSpec 目錄掃描、tasks 解析）與 Express HTTP 層緊耦合在 `server/routes/` 中。\r\n\r\n目標是新增 VS Code Extension 版本，將 React UI 嵌入 Webview Panel，同時保持現有 Web 版本正常運作。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 將 spek 重構為 monorepo，抽出共用核心邏輯\r\n- 建立 VS Code Extension，使用 Webview Panel 呈現 React UI\r\n- Extension 自動偵測 workspace 的 openspec/ 目錄\r\n- 前端透過 API adapter 抽象層支援 fetch 和 postMessage 兩種通訊模式\r\n- 現有 Web 版本功能不變，仍可獨立使用\r\n\r\n**Non-Goals:**\r\n- 不做 VS Code TreeView 原生 sidebar（保持 React UI 一致性）\r\n- 不做 Extension marketplace 發布（先本地 .vsix 安裝）\r\n- 不做 VS Code 原生 Markdown preview 整合\r\n- 不做 multi-root workspace 支援（只取第一個 workspace folder）\r\n\r\n## Decisions\r\n\r\n### D1: Monorepo 結構 — npm workspaces\r\n\r\n使用 npm workspaces 管理三個 package：\r\n\r\n```\r\npackages/\r\n├── core/       # @spek/core — 純邏輯，無框架依賴\r\n├── web/        # @spek/web — 現有 Express + React 應用\r\n└── vscode/     # spek-vscode — VS Code Extension\r\n```\r\n\r\n**Why npm workspaces over turborepo/nx**: 專案規模小，不需要額外的 build orchestration 工具。npm workspaces 原生支援，零配置。\r\n\r\n### D2: Core module 設計 — 純函式 + 型別定義\r\n\r\n從 `server/lib/scanner.ts` 和 `server/lib/tasks.ts` 抽出核心邏輯，成為接受 `basePath: string` 參數的純函式。所有 TypeScript 型別定義也集中在 core。\r\n\r\n```typescript\r\n// packages/core/src/scanner.ts\r\nexport function scanOpenSpec(basePath: string): Promise<OpenSpecStructure>\r\nexport function readSpec(basePath: string, topic: string): Promise<SpecDetail>\r\nexport function readChange(basePath: string, slug: string): Promise<ChangeDetail>\r\nexport function searchContent(basePath: string, query: string): Promise<SearchResult[]>\r\n\r\n// packages/core/src/tasks.ts\r\nexport function parseTasks(content: string): ParsedTasks\r\n```\r\n\r\nCore 直接使用 Node.js `fs/promises`，不依賴 Express 或 VS Code API。Web server 和 Extension host 都直接呼叫這些函式。\r\n\r\n**Why 不用依賴注入 fs**: scanner 和 tasks parser 只需要讀取本地檔案，Node.js fs 在 Express 和 VS Code extension host 中都可用，不需要額外抽象。\r\n\r\n### D3: Webview 通訊 — postMessage + request/response 模式\r\n\r\nExtension host 和 Webview 之間使用 `postMessage` 通訊，模擬 HTTP request/response 模式：\r\n\r\n```typescript\r\n// Webview → Extension Host\r\n{ type: 'request', id: 'req-1', method: 'getOverview' }\r\n\r\n// Extension Host → Webview\r\n{ type: 'response', id: 'req-1', data: { specsCount: 5, ... } }\r\n```\r\n\r\n每個 request 帶唯一 id，response 回傳相同 id，前端用 Promise 包裝等待對應回覆。\r\n\r\n### D4: API Adapter — 策略模式\r\n\r\n前端新增 `ApiAdapter` 介面，hooks 透過 adapter 呼叫 API：\r\n\r\n```typescript\r\ninterface ApiAdapter {\r\n  getOverview(): Promise<OverviewData>;\r\n  getSpecs(): Promise<SpecInfo[]>;\r\n  getSpec(topic: string): Promise<SpecDetail>;\r\n  getChanges(): Promise<ChangesData>;\r\n  getChange(slug: string): Promise<ChangeDetail>;\r\n  search(query: string): Promise<SearchResult[]>;\r\n  browse(path: string): Promise<BrowseData>;\r\n  detect(path: string): Promise<DetectData>;\r\n}\r\n```\r\n\r\n- `FetchAdapter`: 呼叫 `fetch('/api/...')`，用於 Web 版\r\n- `MessageAdapter`: 透過 `postMessage` 傳送請求，用於 Webview 版\r\n\r\nAdapter 透過 React Context 注入，hooks 從 context 取得 adapter 實例。\r\n\r\n**Why 不用 service worker**: postMessage 更直接，service worker 在 Webview 中支援不穩定。\r\n\r\n### D5: Vite build for Webview — 單一 HTML bundle\r\n\r\nWebview 需要載入的 assets 路徑必須透過 `webview.asWebviewUri()` 轉換。Vite build 設定：\r\n\r\n- 產出單一 `index.html` + JS/CSS 各一檔\r\n- Extension 啟動時讀取 build output 的 HTML，替換 asset 路徑為 webview URI\r\n- Tailwind CSS 透過 build 產出，不需 inline style（避免 CSP 問題）\r\n\r\n### D6: Extension 生命週期\r\n\r\n- `activate`: 掃描 workspace folders 尋找 openspec/ 目錄，若找到則在 status bar 顯示 icon\r\n- Command `spek.open`: 建立或聚焦 Webview Panel\r\n- Command `spek.search`: 開啟 Webview 並觸發搜尋對話框\r\n- `deactivate`: 清理 Webview Panel\r\n\r\n### D7: Repo 路徑處理\r\n\r\n- VS Code Extension：自動使用 `vscode.workspace.workspaceFolders[0]`，不需要 SelectRepo 頁面和 filesystem API\r\n- Web 版：維持現有的 SelectRepo 頁面 + filesystem API 行為\r\n- React 端透過 `RepoContext` 初始值區分：Webview 版在 mount 時就注入 workspace path\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[Webview CSP 限制]** → 使用 nonce-based CSP，Vite build 時避免 inline script/style。Tailwind v4 需確認 build output 不含 inline style。\r\n- **[Monorepo 遷移破壞現有功能]** → 分階段進行：先抽 core，確認 web 版正常後再建 extension。\r\n- **[Webview 冷啟動效能]** → React bundle 需要在 Webview 中載入。可考慮 lazy loading 非首頁 route，但初始版本先不優化。\r\n- **[VS Code API 版本相容性]** → 設定 `engines.vscode` 為 `^1.85.0`（2024 年初版本），Webview API 穩定。\r\n- **[npm workspaces 路徑解析]** → 開發時需確認 TypeScript path resolution 和 Vite alias 正確指向 core package。\r\n","tasks":{"total":32,"completed":32,"sections":[{"title":"1. Monorepo 結構建立","tasks":[{"text":"1.1 初始化 npm workspaces：在根目錄 package.json 加入 `workspaces` 設定，建立 `packages/core`、`packages/web`、`packages/vscode` 目錄","completed":true},{"text":"1.2 建立 `packages/core/package.json`（名稱 `@spek/core`），設定 TypeScript 編譯配置","completed":true},{"text":"1.3 搬移現有 `server/` 和 `src/` 到 `packages/web/`，更新 import 路徑和 build 設定","completed":true},{"text":"1.4 驗證 `packages/web` 的 `npm run dev` 仍可正常啟動","completed":true}]},{"title":"2. Core Module 抽取","tasks":[{"text":"2.1 將 `server/lib/scanner.ts` 的核心邏輯搬到 `packages/core/src/scanner.ts`，移除 Express 依賴，改為接受 `basePath` 參數的純函式","completed":true},{"text":"2.2 將 `server/lib/tasks.ts` 搬到 `packages/core/src/tasks.ts`，確保只接受 content string 參數","completed":true},{"text":"2.3 在 `packages/core/src/types.ts` 集中定義所有共用型別（OverviewData、SpecInfo、ChangeInfo 等）","completed":true},{"text":"2.4 建立 `packages/core/src/index.ts` 匯出所有公開 API","completed":true},{"text":"2.5 更新 `packages/web/server/routes/` 改為 import `@spek/core` 的函式","completed":true}]},{"title":"3. API Adapter 抽象層","tasks":[{"text":"3.1 在 `packages/web/src/` 建立 `ApiAdapter` 介面定義（getOverview、getSpecs、getSpec、getChanges、getChange、search、browse、detect）","completed":true},{"text":"3.2 實作 `FetchAdapter`：將現有 `useOpenSpec.ts` 的 fetch 邏輯抽為 adapter 方法","completed":true},{"text":"3.3 實作 `MessageAdapter`：透過 `postMessage` 發送請求，用 Promise + unique id 等待回應","completed":true},{"text":"3.4 建立 `ApiAdapterContext` 和 `ApiAdapterProvider`，透過 React Context 注入 adapter","completed":true},{"text":"3.5 重構 `useOpenSpec.ts` 的 hooks 改為從 context 取得 adapter 呼叫 API","completed":true},{"text":"3.6 在 web 版的 `main.tsx` 用 `FetchAdapter` 包裝 app","completed":true}]},{"title":"4. VS Code Extension 骨架","tasks":[{"text":"4.1 建立 `packages/vscode/package.json`，設定 `engines.vscode`、`activationEvents`、`contributes.commands`","completed":true},{"text":"4.2 設定 extension bundling（esbuild config），產出單一 extension.js","completed":true},{"text":"4.3 實作 `extension.ts`：activate 函式註冊 commands、掃描 workspace 偵測 openspec/、建立 status bar item","completed":true},{"text":"4.4 實作 `deactivate` 函式清理 Webview Panel 和 listeners","completed":true}]},{"title":"5. Webview Panel 整合","tasks":[{"text":"5.1 實作 Webview HTML 產生器：讀取 web build output，替換 asset 路徑為 `webview.asWebviewUri()`，注入 CSP meta tag with nonce","completed":true},{"text":"5.2 設定 Vite build 配置產出適合 Webview 載入的 bundle（固定檔名、相對路徑）","completed":true},{"text":"5.3 實作 message handler：接收 Webview 的 API requests，呼叫 `@spek/core` 函式，回傳 response","completed":true},{"text":"5.4 實作 ready handshake：收到 Webview 的 `ready` 訊息後發送 `init` 訊息含 workspace path","completed":true},{"text":"5.5 實作 theme 同步：監聯 VS Code theme 變更事件，發送 theme 訊息到 Webview","completed":true}]},{"title":"6. Webview 前端適配","tasks":[{"text":"6.1 建立 Webview 專用 entry point，使用 `MessageAdapter` 初始化 app","completed":true},{"text":"6.2 處理 `init` 訊息：收到 workspace path 後自動設定 RepoContext 並跳轉到 Dashboard","completed":true},{"text":"6.3 處理 theme 訊息：根據 VS Code theme 切換 spek 的深色/淺色主題","completed":true},{"text":"6.4 隱藏 web 版專有的 UI 元素（SelectRepo 頁面、repo 路徑輸入框）","completed":true}]},{"title":"7. Build 與打包","tasks":[{"text":"7.1 在根目錄 package.json 新增 scripts：`build:core`、`build:web`、`build:vscode`、`build:all`","completed":true},{"text":"7.2 設定 `packages/vscode` 的 build pipeline：先 build core → build web (webview assets) → bundle extension","completed":true},{"text":"7.3 驗證 `vsce package` 可成功產出 `.vsix` 檔案","completed":true},{"text":"7.4 驗證 `.vsix` 安裝到 VS Code 後可正常使用（開啟 panel、瀏覽 specs/changes、搜尋）","completed":true}]}]},"specs":[{"topic":"api-adapter","content":"## ADDED Requirements\r\n\r\n### Requirement: ApiAdapter interface\r\nThe frontend SHALL define an `ApiAdapter` interface that abstracts all API communication, allowing different implementations for web and VS Code environments.\r\n\r\n#### Scenario: Adapter interface contract\r\n- **WHEN** a component needs to fetch OpenSpec data\r\n- **THEN** it calls methods on the `ApiAdapter` interface (e.g., `getOverview()`, `getSpecs()`, `getChange(slug)`) which return Promises of typed data\r\n\r\n### Requirement: FetchAdapter for web\r\nThe web version SHALL use a `FetchAdapter` that calls the Express REST API via HTTP fetch.\r\n\r\n#### Scenario: Fetch adapter API call\r\n- **WHEN** `FetchAdapter.getOverview()` is called with repoPath set\r\n- **THEN** it performs `fetch('/api/openspec/overview?dir=...')` and returns the parsed JSON response\r\n\r\n#### Scenario: Fetch adapter error handling\r\n- **WHEN** a fetch request returns a non-OK HTTP status\r\n- **THEN** the adapter throws an error with the HTTP status code\r\n\r\n### Requirement: MessageAdapter for VS Code Webview\r\nThe VS Code version SHALL use a `MessageAdapter` that communicates with the extension host via `postMessage`.\r\n\r\n#### Scenario: Message adapter API call\r\n- **WHEN** `MessageAdapter.getOverview()` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getOverview' }` via `postMessage` and returns a Promise that resolves when the matching response arrives\r\n\r\n#### Scenario: Message adapter timeout\r\n- **WHEN** a message request does not receive a response within 10 seconds\r\n- **THEN** the adapter rejects the Promise with a timeout error\r\n\r\n#### Scenario: Message adapter error response\r\n- **WHEN** the extension host responds with `{ type: 'response', id, error: '...' }`\r\n- **THEN** the adapter rejects the Promise with the error message\r\n\r\n### Requirement: Adapter injection via React Context\r\nThe adapter SHALL be provided to the React component tree via a Context provider, allowing hooks to use the appropriate adapter without knowing the environment.\r\n\r\n#### Scenario: Web app initialization\r\n- **WHEN** the web app mounts\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `FetchAdapter`\r\n\r\n#### Scenario: Webview app initialization\r\n- **WHEN** the React app mounts inside a VS Code Webview\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `MessageAdapter`\r\n\r\n#### Scenario: Hook usage\r\n- **WHEN** a hook like `useOverview()` needs to fetch data\r\n- **THEN** it obtains the adapter from `useApiAdapter()` context and calls `adapter.getOverview()`\r\n"},{"topic":"core-module","content":"## ADDED Requirements\r\n\r\n### Requirement: Standalone core package\r\nThe core module SHALL be an independent npm package (`@spek/core`) with no framework dependencies, usable by both the web server and the VS Code extension host.\r\n\r\n#### Scenario: Import from web server\r\n- **WHEN** the Express server imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n#### Scenario: Import from extension host\r\n- **WHEN** the VS Code extension host imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n### Requirement: Scanner functions\r\nThe core module SHALL export scanner functions that accept a base path and return structured OpenSpec data.\r\n\r\n#### Scenario: Scan overview\r\n- **WHEN** `scanOverview(basePath)` is called with a valid repo path\r\n- **THEN** it returns `{ specsCount, changesCount: { active, archived }, taskStats: { total, completed } }`\r\n\r\n#### Scenario: List specs\r\n- **WHEN** `listSpecs(basePath)` is called\r\n- **THEN** it returns an array of `{ topic, path }` for each spec directory\r\n\r\n#### Scenario: Read single spec\r\n- **WHEN** `readSpec(basePath, topic)` is called with an existing topic\r\n- **THEN** it returns `{ topic, content, relatedChanges, history }`\r\n\r\n#### Scenario: List changes\r\n- **WHEN** `listChanges(basePath)` is called\r\n- **THEN** it returns `{ active: ChangeInfo[], archived: ChangeInfo[] }`\r\n\r\n#### Scenario: Read single change\r\n- **WHEN** `readChange(basePath, slug)` is called with an existing change slug\r\n- **THEN** it returns `{ slug, proposal, design, tasks, specs, metadata }`\r\n\r\n#### Scenario: Search content\r\n- **WHEN** `searchContent(basePath, query)` is called\r\n- **THEN** it returns matching results across specs and changes with context snippets\r\n\r\n### Requirement: Task parser functions\r\nThe core module SHALL export task parsing functions that operate on raw Markdown content strings.\r\n\r\n#### Scenario: Parse tasks from content\r\n- **WHEN** `parseTasks(content)` is called with Markdown containing `- [x]` and `- [ ]` checkboxes\r\n- **THEN** it returns `{ total, completed, sections }` with tasks grouped by `##` headings\r\n\r\n### Requirement: Shared type definitions\r\nThe core module SHALL export all TypeScript type definitions used by both the web app and the extension.\r\n\r\n#### Scenario: Type imports\r\n- **WHEN** the web app or extension imports types from `@spek/core`\r\n- **THEN** types such as `OverviewData`, `SpecInfo`, `SpecDetail`, `ChangeInfo`, `ChangeDetail`, `ParsedTasks`, `SearchResult` are available\r\n"},{"topic":"openspec-scanner","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Scan OpenSpec directory structure\r\nThe scanner SHALL be a pure function in the `@spek/core` package that reads an OpenSpec directory and returns its complete structure including specs, active changes, and archived changes. It SHALL use Node.js `fs/promises` directly and have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Scan repo with full OpenSpec structure\r\n- **WHEN** scanner is given a repo path containing `openspec/specs/` and `openspec/changes/`\r\n- **THEN** it returns a structure with `specs` (list of topic names), `activeChanges` (changes directly under `openspec/changes/` excluding `archive/`), and `archivedChanges` (changes under `openspec/changes/archive/`)\r\n\r\n#### Scenario: Scan repo with empty OpenSpec directory\r\n- **WHEN** scanner is given a repo path where `openspec/` exists but contains only `config.yaml`\r\n- **THEN** it returns empty arrays for specs, activeChanges, and archivedChanges\r\n\r\n### Requirement: Parse change artifacts\r\nThe scanner SHALL read individual change directories and extract available artifacts.\r\n\r\n#### Scenario: Change with all artifacts\r\n- **WHEN** scanner reads a change directory containing proposal.md, design.md, tasks.md, and specs/\r\n- **THEN** it returns the raw Markdown content for each artifact and a list of delta spec files\r\n\r\n#### Scenario: Change with partial artifacts\r\n- **WHEN** scanner reads a change directory containing only proposal.md\r\n- **THEN** it returns proposal content and null for missing artifacts\r\n\r\n### Requirement: Read spec content\r\nThe scanner SHALL read spec files and return their Markdown content.\r\n\r\n#### Scenario: Read existing spec\r\n- **WHEN** scanner reads `openspec/specs/{topic}/spec.md`\r\n- **THEN** it returns the raw Markdown content of the spec file\r\n\r\n### Requirement: Detect related changes for a spec\r\nThe scanner SHALL identify which changes contain delta specs for a given spec topic.\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** scanner checks for changes related to spec topic \"simulation-engine\"\r\n- **THEN** it returns all change slugs that have a `specs/simulation-engine/spec.md` delta file\r\n"},{"topic":"task-parser","content":"## MODIFIED Requirements\r\n\r\n### Requirement: Parse task checkboxes\r\nThe task parser SHALL be a pure function in the `@spek/core` package that reads a tasks.md content string and extracts checkbox items with their completion status. It SHALL have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Parse file with mixed checkboxes\r\n- **WHEN** parser receives a string containing `- [x] Done task` and `- [ ] Pending task`\r\n- **THEN** it returns each task with `text` and `completed` (boolean) fields\r\n\r\n### Requirement: Group tasks by section\r\nThe task parser SHALL group tasks under their `##` heading sections.\r\n\r\n#### Scenario: Tasks under multiple sections\r\n- **WHEN** parser receives a string with `## Phase 1` followed by tasks and `## Phase 2` followed by tasks\r\n- **THEN** it returns sections array, each with `title` and `tasks` array\r\n\r\n#### Scenario: Tasks without section headings\r\n- **WHEN** parser receives a string where tasks appear before any `##` heading\r\n- **THEN** those tasks are grouped under a default section with empty title\r\n\r\n### Requirement: Calculate task statistics\r\nThe task parser SHALL compute aggregate statistics from parsed tasks.\r\n\r\n#### Scenario: Calculate completion stats\r\n- **WHEN** parser processes a string with 10 total checkboxes where 7 are checked\r\n- **THEN** it returns `{ total: 10, completed: 7 }` along with the sections breakdown\r\n\r\n#### Scenario: Empty tasks file\r\n- **WHEN** parser processes an empty string or one with no checkboxes\r\n- **THEN** it returns `{ total: 0, completed: 0, sections: [] }`\r\n"},{"topic":"vscode-extension-host","content":"## ADDED Requirements\r\n\r\n### Requirement: Extension activation\r\nThe extension SHALL activate when a workspace containing an `openspec/` directory is opened, or when the user explicitly invokes a spek command.\r\n\r\n#### Scenario: Workspace with openspec directory\r\n- **WHEN** VS Code opens a workspace where the first workspace folder contains an `openspec/` directory\r\n- **THEN** the extension activates and displays a spek icon in the status bar\r\n\r\n#### Scenario: Workspace without openspec directory\r\n- **WHEN** VS Code opens a workspace without an `openspec/` directory\r\n- **THEN** the extension remains inactive and no status bar icon is shown\r\n\r\n#### Scenario: Manual activation via command\r\n- **WHEN** the user invokes the `spek.open` command from the command palette\r\n- **THEN** the extension activates and opens the spek Webview Panel\r\n\r\n### Requirement: Webview Panel lifecycle\r\nThe extension SHALL manage a single Webview Panel instance for displaying the spek UI.\r\n\r\n#### Scenario: Open spek panel\r\n- **WHEN** the user invokes `spek.open` and no panel exists\r\n- **THEN** the extension creates a new Webview Panel in the active editor column with the title \"spek\"\r\n\r\n#### Scenario: Focus existing panel\r\n- **WHEN** the user invokes `spek.open` and a panel already exists\r\n- **THEN** the extension reveals (focuses) the existing panel instead of creating a new one\r\n\r\n#### Scenario: Panel disposal\r\n- **WHEN** the user closes the spek Webview Panel\r\n- **THEN** the extension cleans up the panel reference and associated message listeners\r\n\r\n### Requirement: Command registration\r\nThe extension SHALL register commands in the VS Code command palette.\r\n\r\n#### Scenario: Available commands\r\n- **WHEN** the extension is active\r\n- **THEN** the following commands are available: `spek.open` (Open spek) and `spek.search` (Search OpenSpec)\r\n\r\n#### Scenario: Search command\r\n- **WHEN** the user invokes `spek.search`\r\n- **THEN** the extension opens (or focuses) the spek panel and sends a message to trigger the search dialog\r\n\r\n### Requirement: Message handler for API requests\r\nThe extension host SHALL handle message-based API requests from the Webview and return responses using core module functions.\r\n\r\n#### Scenario: Handle API request\r\n- **WHEN** the Webview sends a message `{ type: 'request', id: 'req-1', method: 'getOverview' }`\r\n- **THEN** the extension host calls the corresponding core module function and replies with `{ type: 'response', id: 'req-1', data: <result> }`\r\n\r\n#### Scenario: Handle API error\r\n- **WHEN** the Webview sends a request and the core module function throws an error\r\n- **THEN** the extension host replies with `{ type: 'response', id: 'req-1', error: <error message> }`\r\n"},{"topic":"webview-integration","content":"## ADDED Requirements\r\n\r\n### Requirement: Load React SPA in Webview\r\nThe Webview SHALL load the spek React application from the extension's bundled assets.\r\n\r\n#### Scenario: Webview HTML generation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** it generates an HTML document that loads the built React bundle with asset paths converted via `webview.asWebviewUri()`\r\n\r\n#### Scenario: Asset path resolution\r\n- **WHEN** the Webview HTML references JS or CSS files\r\n- **THEN** all asset paths SHALL use `webview.asWebviewUri()` to convert local file paths to Webview-safe URIs\r\n\r\n### Requirement: Content Security Policy\r\nThe Webview SHALL enforce a Content Security Policy that allows the React application to function while preventing unauthorized content.\r\n\r\n#### Scenario: CSP configuration\r\n- **WHEN** the Webview HTML is generated\r\n- **THEN** it includes a CSP meta tag that allows scripts and styles from the extension's webview URI origin with a unique nonce, and disallows inline scripts without the nonce\r\n\r\n#### Scenario: Tailwind CSS compatibility\r\n- **WHEN** Tailwind CSS styles are loaded in the Webview\r\n- **THEN** all styles SHALL be loaded from external CSS files (not inline style tags) to comply with CSP\r\n\r\n### Requirement: Workspace path injection\r\nThe Webview SHALL receive the workspace path from the extension host so the React app can skip the repo selection page.\r\n\r\n#### Scenario: Initial workspace path\r\n- **WHEN** the Webview is created in a workspace with an `openspec/` directory\r\n- **THEN** the extension host sends a `{ type: 'init', workspacePath: '/path/to/repo' }` message after the Webview is ready\r\n\r\n#### Scenario: Webview ready handshake\r\n- **WHEN** the React app finishes mounting in the Webview\r\n- **THEN** it sends a `{ type: 'ready' }` message to the extension host to signal it can receive the workspace path\r\n\r\n### Requirement: Theme synchronization\r\nThe Webview SHALL respect the VS Code color theme.\r\n\r\n#### Scenario: Dark theme active\r\n- **WHEN** VS Code is using a dark color theme\r\n- **THEN** the Webview renders the spek dark theme\r\n\r\n#### Scenario: Light theme active\r\n- **WHEN** VS Code is using a light color theme\r\n- **THEN** the Webview renders the spek light theme\r\n\r\n#### Scenario: Theme change\r\n- **WHEN** the user changes the VS Code color theme while the Webview is open\r\n- **THEN** the Webview updates its theme to match\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}},"2026-02-13-vscode-marketplace-publish":{"slug":"2026-02-13-vscode-marketplace-publish","proposal":"## Why\r\n\r\n目前 spek VS Code extension 只能透過手動打包 `.vsix` 安裝，使用門檻高且無法自動更新。發佈到 VS Code Marketplace 讓使用者能直接搜尋安裝，並享有版本更新通知。\r\n\r\n## What Changes\r\n\r\n- 移除 `package.json` 的 `\"private\": true` 限制\r\n- 新增 Marketplace 必要欄位：`repository`、`license`、`icon`、`homepage`、`bugs`\r\n- 建立 extension 專屬 `README.md`（Marketplace 頁面內容）\r\n- 建立 `CHANGELOG.md`\r\n- 產生 128x128 PNG icon（從現有 SVG logomark 轉換）\r\n- 更新 `.vscodeignore` 排除不需要的檔案\r\n- 補充 `categories`、`keywords` 提升 Marketplace 搜尋能見度\r\n\r\n## Capabilities\r\n\r\n### New Capabilities\r\n\r\n- `vscode-marketplace-metadata`: 定義 VS Code extension 發佈到 Marketplace 所需的 metadata 配置、檔案結構與發佈流程\r\n\r\n### Modified Capabilities\r\n\r\n（無既有 spec 的需求層級變更，此次僅新增發佈配置）\r\n\r\n## Impact\r\n\r\n- **packages/vscode/package.json**：新增多個 Marketplace 必要欄位\r\n- **packages/vscode/README.md**：新建，作為 Marketplace 頁面內容\r\n- **packages/vscode/CHANGELOG.md**：新建\r\n- **packages/vscode/.vscodeignore**：更新排除規則\r\n- **packages/vscode/icon.png**：新建（從 SVG 轉換）\r\n- **發佈流程**：需要 publisher 帳號與 Azure DevOps PAT\r\n","design":"## Context\r\n\r\nspek VS Code extension 目前以 `\"private\": true` 設定，只能手動打包 `.vsix` 安裝。要發佈到 VS Code Marketplace，需要補齊 metadata、建立 publisher 帳號、並準備 Marketplace 頁面所需的內容檔案（README、icon、CHANGELOG）。\r\n\r\n現有的 extension 打包流程已可運作（esbuild + vsce package），主要缺少的是發佈配置而非功能變更。\r\n\r\n## Goals / Non-Goals\r\n\r\n**Goals:**\r\n- 讓 extension 可透過 `vsce publish` 發佈到 VS Code Marketplace\r\n- 提供完整的 Marketplace 頁面（說明、icon、changelog）\r\n- 維持現有打包流程相容\r\n\r\n**Non-Goals:**\r\n- 不建立 CI/CD 自動發佈流程（未來再做）\r\n- 不變更 extension 功能或行為\r\n- 不處理 pre-release / insider channel\r\n\r\n## Decisions\r\n\r\n### 1. Publisher ID 使用 `kewang`\r\n\r\n與 GitHub username 一致，方便辨識。使用者需在 marketplace.visualstudio.com/manage 手動建立此 publisher。\r\n\r\n### 2. Icon 使用 PNG 格式\r\n\r\nMarketplace 要求 128x128 以上的 PNG icon。從現有 `logo/logomark.svg` 轉換為 128x128 PNG，放在 `packages/vscode/icon.png`。\r\n\r\n考慮過的替代方案：直接用 SVG — 但 Marketplace 不支援 SVG icon。\r\n\r\n### 3. Extension README 獨立於 root README\r\n\r\nMarketplace 頁面顯示 extension 目錄下的 README.md，內容應聚焦在 VS Code 使用者的需求（安裝、功能、截圖指引），而非完整的開發文件。\r\n\r\n### 4. categories 與 keywords 選擇\r\n\r\n- categories: `[\"Other\"]` — OpenSpec 是自訂格式，無更精確的分類\r\n- keywords: `[\"openspec\", \"spec\", \"bdd\", \"documentation\", \"viewer\"]` — 最多 5 個，涵蓋搜尋意圖\r\n\r\n### 5. 手動發佈流程\r\n\r\n使用 `vsce login` + `vsce publish` 手動發佈。流程簡單且符合目前需求。\r\n\r\n## Risks / Trade-offs\r\n\r\n- **[風險] publisher 名稱被佔用** → 如果 `kewang` 已被佔用，需改用其他 ID 並同步更新 package.json\r\n- **[風險] icon 轉換品質** → SVG 轉 PNG 可能失真，需確認轉換後的效果\r\n- **[取捨] 無 CI/CD 自動發佈** → 每次發佈需手動執行，但避免了 GitHub Actions 設定與 secret 管理的複雜度\r\n","tasks":{"total":14,"completed":14,"sections":[{"title":"1. Icon 準備","tasks":[{"text":"1.1 將 `logo/logomark.svg` 轉換為 128x128 PNG，輸出到 `packages/vscode/icon.png`","completed":true}]},{"title":"2. package.json 更新","tasks":[{"text":"2.1 移除 `\"private\": true`","completed":true},{"text":"2.2 更新 `publisher` 為 `\"kewang\"`","completed":true},{"text":"2.3 新增 `\"repository\"` 欄位（指向 GitHub repo）","completed":true},{"text":"2.4 新增 `\"license\": \"MIT\"`","completed":true},{"text":"2.5 新增 `\"icon\": \"icon.png\"`","completed":true},{"text":"2.6 新增 `\"homepage\"` 與 `\"bugs\"` 欄位","completed":true},{"text":"2.7 更新 `\"categories\"` 為 `[\"Other\"]`","completed":true},{"text":"2.8 新增 `\"keywords\": [\"openspec\", \"spec\", \"bdd\", \"documentation\", \"viewer\"]`","completed":true}]},{"title":"3. Extension README","tasks":[{"text":"3.1 建立 `packages/vscode/README.md`，包含功能說明、安裝方式、使用方法","completed":true}]},{"title":"4. CHANGELOG","tasks":[{"text":"4.1 建立 `packages/vscode/CHANGELOG.md`，包含 v0.1.0 初始版本記錄","completed":true}]},{"title":"5. vscodeignore 更新","tasks":[{"text":"5.1 更新 `packages/vscode/.vscodeignore`，確保排除 src/、node_modules/ 等，保留 dist/、webview/、icon.png、README.md、CHANGELOG.md","completed":true}]},{"title":"6. 驗證打包","tasks":[{"text":"6.1 執行 `vsce package --no-dependencies` 確認打包成功無錯誤","completed":true},{"text":"6.2 檢查 `.vsix` 檔案大小與內容合理","completed":true}]}]},"specs":[{"topic":"vscode-marketplace-metadata","content":"## ADDED Requirements\r\n\r\n### Requirement: Marketplace-ready package.json\r\nExtension 的 `package.json` SHALL 包含所有 VS Code Marketplace 發佈所需的欄位。\r\n\r\n#### Scenario: Required fields present\r\n- **WHEN** 執行 `vsce package` 打包 extension\r\n- **THEN** package.json 包含以下欄位且無 validation 錯誤：`publisher`、`repository`、`license`、`icon`、`categories`、`keywords`\r\n\r\n#### Scenario: Private flag removed\r\n- **WHEN** package.json 被讀取\r\n- **THEN** `\"private\"` 欄位 SHALL 不存在或為 `false`\r\n\r\n#### Scenario: Icon file exists\r\n- **WHEN** package.json 指定 `\"icon\": \"icon.png\"`\r\n- **THEN** `packages/vscode/icon.png` 檔案存在且為 128x128 以上的 PNG 圖片\r\n\r\n### Requirement: Marketplace README\r\nExtension 目錄下 SHALL 有獨立的 `README.md` 作為 Marketplace 頁面內容。\r\n\r\n#### Scenario: README content\r\n- **WHEN** Marketplace 頁面載入\r\n- **THEN** 顯示 extension 的功能說明、安裝方式與使用說明\r\n\r\n#### Scenario: README exists in extension directory\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `packages/vscode/README.md` 被包含在 `.vsix` 中\r\n\r\n### Requirement: CHANGELOG\r\nExtension 目錄下 SHALL 有 `CHANGELOG.md` 記錄版本變更。\r\n\r\n#### Scenario: CHANGELOG content\r\n- **WHEN** 使用者在 Marketplace 或 VS Code 中檢視 extension 的 changelog\r\n- **THEN** 顯示按版本分組的變更記錄\r\n\r\n### Requirement: vscodeignore configuration\r\n`.vscodeignore` SHALL 排除不需要包含在 `.vsix` 中的檔案，減少套件大小。\r\n\r\n#### Scenario: Source files excluded\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `src/`、`node_modules/`、`tsconfig.json`、`.gitignore` 不被包含在 `.vsix` 中\r\n\r\n#### Scenario: Required files included\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `dist/`、`webview/`、`icon.png`、`README.md`、`CHANGELOG.md`、`LICENSE` 被包含在 `.vsix` 中\r\n\r\n### Requirement: Publish workflow\r\n使用者 SHALL 能透過 `vsce` CLI 將 extension 發佈到 Marketplace。\r\n\r\n#### Scenario: First-time publish\r\n- **WHEN** 使用者執行 `vsce login <publisher>` 並輸入有效的 PAT\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Version update publish\r\n- **WHEN** 使用者更新 package.json 版本號\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** Marketplace 上的 extension 更新到新版本\r\n"}],"metadata":{"schema":"spec-driven","created":"2026-02-13"}}},"specVersions":{"api-adapter":{"2026-02-16-ui-design-polish-p0-p1":"## ADDED Requirements\r\n\r\n### Requirement: StaticAdapter for demo\r\nThe demo version SHALL use a `StaticAdapter` that reads all data from a pre-embedded JSON object (`window.__DEMO_DATA__`) and implements the `ApiAdapter` interface.\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive substring matching across all spec topic names, spec content, change slugs, and change proposal/design content, returning matching results with context snippets\r\n\r\n#### Scenario: Search matches spec topic names\r\n- **WHEN** `search(\"dashboard\")` is called and a spec with topic `dashboard-view` exists\r\n- **THEN** the result includes `dashboard-view` as a match\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n","2026-02-13-vscode-extension":"## ADDED Requirements\r\n\r\n### Requirement: ApiAdapter interface\r\nThe frontend SHALL define an `ApiAdapter` interface that abstracts all API communication, allowing different implementations for web and VS Code environments.\r\n\r\n#### Scenario: Adapter interface contract\r\n- **WHEN** a component needs to fetch OpenSpec data\r\n- **THEN** it calls methods on the `ApiAdapter` interface (e.g., `getOverview()`, `getSpecs()`, `getChange(slug)`) which return Promises of typed data\r\n\r\n### Requirement: FetchAdapter for web\r\nThe web version SHALL use a `FetchAdapter` that calls the Express REST API via HTTP fetch.\r\n\r\n#### Scenario: Fetch adapter API call\r\n- **WHEN** `FetchAdapter.getOverview()` is called with repoPath set\r\n- **THEN** it performs `fetch('/api/openspec/overview?dir=...')` and returns the parsed JSON response\r\n\r\n#### Scenario: Fetch adapter error handling\r\n- **WHEN** a fetch request returns a non-OK HTTP status\r\n- **THEN** the adapter throws an error with the HTTP status code\r\n\r\n### Requirement: MessageAdapter for VS Code Webview\r\nThe VS Code version SHALL use a `MessageAdapter` that communicates with the extension host via `postMessage`.\r\n\r\n#### Scenario: Message adapter API call\r\n- **WHEN** `MessageAdapter.getOverview()` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getOverview' }` via `postMessage` and returns a Promise that resolves when the matching response arrives\r\n\r\n#### Scenario: Message adapter timeout\r\n- **WHEN** a message request does not receive a response within 10 seconds\r\n- **THEN** the adapter rejects the Promise with a timeout error\r\n\r\n#### Scenario: Message adapter error response\r\n- **WHEN** the extension host responds with `{ type: 'response', id, error: '...' }`\r\n- **THEN** the adapter rejects the Promise with the error message\r\n\r\n### Requirement: Adapter injection via React Context\r\nThe adapter SHALL be provided to the React component tree via a Context provider, allowing hooks to use the appropriate adapter without knowing the environment.\r\n\r\n#### Scenario: Web app initialization\r\n- **WHEN** the web app mounts\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `FetchAdapter`\r\n\r\n#### Scenario: Webview app initialization\r\n- **WHEN** the React app mounts inside a VS Code Webview\r\n- **THEN** it wraps the component tree with an `ApiAdapterProvider` using `MessageAdapter`\r\n\r\n#### Scenario: Hook usage\r\n- **WHEN** a hook like `useOverview()` needs to fetch data\r\n- **THEN** it obtains the adapter from `useApiAdapter()` context and calls `adapter.getOverview()`\r\n","spec-diff-viewer":"## MODIFIED Requirements\r\n\r\n### Requirement: ApiAdapter interface\r\nThe frontend SHALL define an `ApiAdapter` interface that abstracts all API communication, allowing different implementations for web and VS Code environments. The interface SHALL include a `getSpecAtChange(topic: string, slug: string): Promise<{ content: string }>` method for fetching spec content at a specific change version.\r\n\r\n#### Scenario: Adapter interface contract\r\n- **WHEN** a component needs to fetch OpenSpec data\r\n- **THEN** it calls methods on the `ApiAdapter` interface (e.g., `getOverview()`, `getSpecs()`, `getChange(slug)`, `getSpecAtChange(topic, slug)`) which return Promises of typed data\r\n\r\n### Requirement: FetchAdapter for web\r\nThe web version SHALL use a `FetchAdapter` that calls the Express REST API via HTTP fetch.\r\n\r\n#### Scenario: Fetch adapter API call\r\n- **WHEN** `FetchAdapter.getOverview()` is called with repoPath set\r\n- **THEN** it performs `fetch('/api/openspec/overview?dir=...')` and returns the parsed JSON response\r\n\r\n#### Scenario: Fetch adapter error handling\r\n- **WHEN** a fetch request returns a non-OK HTTP status\r\n- **THEN** the adapter throws an error with the HTTP status code\r\n\r\n#### Scenario: Fetch adapter getSpecAtChange\r\n- **WHEN** `FetchAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it performs `fetch('/api/openspec/specs/user-auth/at/2026-01-15-add-oauth?dir=...')` and returns the parsed JSON response\r\n\r\n### Requirement: MessageAdapter for VS Code Webview\r\nThe VS Code version SHALL use a `MessageAdapter` that communicates with the extension host via `postMessage`.\r\n\r\n#### Scenario: Message adapter API call\r\n- **WHEN** `MessageAdapter.getOverview()` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getOverview' }` via `postMessage` and returns a Promise that resolves when the matching response arrives\r\n\r\n#### Scenario: Message adapter timeout\r\n- **WHEN** a message request does not receive a response within 10 seconds\r\n- **THEN** the adapter rejects the Promise with a timeout error\r\n\r\n#### Scenario: Message adapter error response\r\n- **WHEN** the extension host responds with `{ type: 'response', id, error: '...' }`\r\n- **THEN** the adapter rejects the Promise with the error message\r\n\r\n#### Scenario: Message adapter getSpecAtChange\r\n- **WHEN** `MessageAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it sends `{ type: 'request', id: '<unique>', method: 'getSpecAtChange', params: { topic: 'user-auth', slug: '2026-01-15-add-oauth' } }` via `postMessage`\r\n\r\n### Requirement: StaticAdapter for demo\r\nThe demo version SHALL use a `StaticAdapter` that reads all data from a pre-embedded JSON object (`window.__DEMO_DATA__`) and implements the `ApiAdapter` interface. The `DemoData` structure SHALL include a `specVersions` field mapping topic to slug to content.\r\n\r\n#### Scenario: Serve pre-embedded data\r\n- **WHEN** any API method is called (getOverview, getSpecs, getSpec, getChanges, getChange)\r\n- **THEN** it returns the corresponding data from the embedded JSON via `Promise.resolve()`\r\n\r\n#### Scenario: Client-side search\r\n- **WHEN** `search(query)` is called\r\n- **THEN** it performs case-insensitive substring matching across all spec topic names, spec content, change slugs, and change proposal/design content, returning matching results with context snippets\r\n\r\n#### Scenario: Search matches spec topic names\r\n- **WHEN** `search(\"dashboard\")` is called and a spec with topic `dashboard-view` exists\r\n- **THEN** the result includes `dashboard-view` as a match\r\n\r\n#### Scenario: No-op for inapplicable methods\r\n- **WHEN** `browse()`, `detect()`, or `resync()` is called\r\n- **THEN** it returns sensible defaults without error (empty browse, `hasOpenSpec: true`, void)\r\n\r\n#### Scenario: StaticAdapter getSpecAtChange\r\n- **WHEN** `StaticAdapter.getSpecAtChange(\"user-auth\", \"2026-01-15-add-oauth\")` is called\r\n- **THEN** it reads from `window.__DEMO_DATA__.specVersions[\"user-auth\"][\"2026-01-15-add-oauth\"]` and returns `{ content: \"...\" }`\r\n\r\n#### Scenario: StaticAdapter getSpecAtChange not found\r\n- **WHEN** `StaticAdapter.getSpecAtChange(\"user-auth\", \"nonexistent\")` is called\r\n- **AND** no matching version exists in the embedded data\r\n- **THEN** it rejects with an error\r\n"},"change-browsing":{"2026-02-16-ui-design-polish-p2":"## MODIFIED Requirements\r\n\r\n### Requirement: Change detail with tab navigation\r\nThe system SHALL display change details using a tabbed interface with tabs in OpenSpec workflow order: Proposal, Design, Specs (delta specs), and Tasks. Tab content SHALL transition with a fade-in animation when switching.\r\n\r\n#### Scenario: View proposal tab\r\n- **WHEN** user views a change and clicks the Proposal tab\r\n- **THEN** the proposal.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View design tab\r\n- **WHEN** user clicks the Design tab\r\n- **THEN** the design.md content is displayed with a fade-in transition\r\n\r\n#### Scenario: View specs tab\r\n- **WHEN** user clicks the Specs tab and the change has delta specs\r\n- **THEN** the delta spec files are listed and their content displayed with a fade-in transition\r\n\r\n#### Scenario: View tasks tab\r\n- **WHEN** user clicks the Tasks tab\r\n- **THEN** the tasks.md content is displayed with a TaskProgress bar showing completion statistics, with a fade-in transition\r\n\r\n#### Scenario: Tab order\r\n- **WHEN** the ChangeDetail page is rendered\r\n- **THEN** the tabs are displayed in order: Proposal, Design, Specs, Tasks (matching the OpenSpec workflow sequence)\r\n\r\n#### Scenario: Missing artifact\r\n- **WHEN** a tab's corresponding artifact file does not exist\r\n- **THEN** the tab shows a \"No content\" placeholder\r\n\r\n### Requirement: Change list with active/archived separation\r\nThe system SHALL display changes grouped into active and archived sections. Active changes SHALL be visually distinguished with a left accent color border (4px). Archived changes SHALL be sorted by date (most recent first).\r\n\r\n#### Scenario: Display active changes\r\n- **WHEN** user navigates to the ChangeList page and there are active changes\r\n- **THEN** active changes are listed in an \"Active\" section with a left accent color border, name, and task progress\r\n\r\n#### Scenario: Display archived changes\r\n- **WHEN** user navigates to the ChangeList page\r\n- **THEN** archived changes are listed in an \"Archived\" section sorted by date descending, without accent border\r\n\r\n#### Scenario: No changes\r\n- **WHEN** there are no changes in the repo\r\n- **THEN** system displays an empty state message\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Custom task checkbox styling\r\nThe system SHALL render task items in the Tasks tab using custom SVG icons instead of text-based `[x]`/`[ ]` markers. Completed tasks SHALL display a filled checkmark icon in green, and incomplete tasks SHALL display an empty circle icon. Completed task text SHALL have reduced opacity (0.6) in addition to the existing strikethrough styling.\r\n\r\n#### Scenario: Incomplete task display\r\n- **WHEN** a task item is not completed\r\n- **THEN** the task displays an empty circle SVG icon followed by the task text at full opacity\r\n\r\n#### Scenario: Completed task display\r\n- **WHEN** a task item is completed\r\n- **THEN** the task displays a green checkmark SVG icon followed by the task text with strikethrough and reduced opacity (0.6)\r\n","2026-02-13-fix-task-stats-and-capability-nav":"## ADDED Requirements\r\n\r\n### Requirement: Capability ID linking in proposal\r\nThe system SHALL render inline code elements in proposal markdown as navigable links when the code text matches an existing spec topic name.\r\n\r\n#### Scenario: Capability ID matches existing spec\r\n- **WHEN** a proposal markdown contains an inline code element (e.g., `` `responsive-layout` ``)\r\n- **AND** a spec with the topic name `responsive-layout` exists\r\n- **THEN** the inline code SHALL be rendered as a clickable link navigating to `/specs/responsive-layout`\r\n\r\n#### Scenario: Inline code does not match any spec\r\n- **WHEN** a proposal markdown contains an inline code element that does not match any existing spec topic\r\n- **THEN** the inline code SHALL be rendered as a normal styled code element without a link\r\n\r\n#### Scenario: MarkdownRenderer receives spec topics list\r\n- **WHEN** MarkdownRenderer is used with a `specTopics` prop containing the list of available spec topic names\r\n- **THEN** inline code matching any topic in the list SHALL be rendered as navigable links\r\n","2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Change list with active/archived separation\r\nThe system SHALL display changes grouped into active and archived sections. Archived changes SHALL be sorted by date (most recent first).\r\n\r\n#### Scenario: Display active changes\r\n- **WHEN** user navigates to the ChangeList page and there are active changes\r\n- **THEN** active changes are listed in an \"Active\" section with name and task progress\r\n\r\n#### Scenario: Display archived changes\r\n- **WHEN** user navigates to the ChangeList page\r\n- **THEN** archived changes are listed in an \"Archived\" section sorted by date descending\r\n\r\n#### Scenario: No changes\r\n- **WHEN** there are no changes in the repo\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Change detail with tab navigation\r\nThe system SHALL display change details using a tabbed interface with tabs for: Proposal, Design, Tasks, and Specs (delta specs).\r\n\r\n#### Scenario: View proposal tab\r\n- **WHEN** user views a change and clicks the Proposal tab\r\n- **THEN** the proposal.md content is displayed (raw markdown)\r\n\r\n#### Scenario: View design tab\r\n- **WHEN** user clicks the Design tab\r\n- **THEN** the design.md content is displayed (raw markdown)\r\n\r\n#### Scenario: View tasks tab\r\n- **WHEN** user clicks the Tasks tab\r\n- **THEN** the tasks.md content is displayed with a TaskProgress bar showing completion statistics\r\n\r\n#### Scenario: View specs tab\r\n- **WHEN** user clicks the Specs tab and the change has delta specs\r\n- **THEN** the delta spec files are listed and their content displayed\r\n\r\n#### Scenario: Missing artifact\r\n- **WHEN** a tab's corresponding artifact file does not exist\r\n- **THEN** the tab shows a \"No content\" placeholder\r\n\r\n### Requirement: Task progress display in change detail\r\nThe Tasks tab SHALL display a progress bar and statistics (completed/total) derived from the change's task data.\r\n\r\n#### Scenario: Show task progress\r\n- **WHEN** viewing the Tasks tab of a change with tasks\r\n- **THEN** a TaskProgress component shows a visual progress bar with \"X / Y completed\" text\r\n"},"core-module":{"2026-02-13-vscode-extension":"## ADDED Requirements\r\n\r\n### Requirement: Standalone core package\r\nThe core module SHALL be an independent npm package (`@spek/core`) with no framework dependencies, usable by both the web server and the VS Code extension host.\r\n\r\n#### Scenario: Import from web server\r\n- **WHEN** the Express server imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n#### Scenario: Import from extension host\r\n- **WHEN** the VS Code extension host imports `@spek/core`\r\n- **THEN** it can call scanner and task parser functions directly without additional adapters\r\n\r\n### Requirement: Scanner functions\r\nThe core module SHALL export scanner functions that accept a base path and return structured OpenSpec data.\r\n\r\n#### Scenario: Scan overview\r\n- **WHEN** `scanOverview(basePath)` is called with a valid repo path\r\n- **THEN** it returns `{ specsCount, changesCount: { active, archived }, taskStats: { total, completed } }`\r\n\r\n#### Scenario: List specs\r\n- **WHEN** `listSpecs(basePath)` is called\r\n- **THEN** it returns an array of `{ topic, path }` for each spec directory\r\n\r\n#### Scenario: Read single spec\r\n- **WHEN** `readSpec(basePath, topic)` is called with an existing topic\r\n- **THEN** it returns `{ topic, content, relatedChanges, history }`\r\n\r\n#### Scenario: List changes\r\n- **WHEN** `listChanges(basePath)` is called\r\n- **THEN** it returns `{ active: ChangeInfo[], archived: ChangeInfo[] }`\r\n\r\n#### Scenario: Read single change\r\n- **WHEN** `readChange(basePath, slug)` is called with an existing change slug\r\n- **THEN** it returns `{ slug, proposal, design, tasks, specs, metadata }`\r\n\r\n#### Scenario: Search content\r\n- **WHEN** `searchContent(basePath, query)` is called\r\n- **THEN** it returns matching results across specs and changes with context snippets\r\n\r\n### Requirement: Task parser functions\r\nThe core module SHALL export task parsing functions that operate on raw Markdown content strings.\r\n\r\n#### Scenario: Parse tasks from content\r\n- **WHEN** `parseTasks(content)` is called with Markdown containing `- [x]` and `- [ ]` checkboxes\r\n- **THEN** it returns `{ total, completed, sections }` with tasks grouped by `##` headings\r\n\r\n### Requirement: Shared type definitions\r\nThe core module SHALL export all TypeScript type definitions used by both the web app and the extension.\r\n\r\n#### Scenario: Type imports\r\n- **WHEN** the web app or extension imports types from `@spek/core`\r\n- **THEN** types such as `OverviewData`, `SpecInfo`, `SpecDetail`, `ChangeInfo`, `ChangeDetail`, `ParsedTasks`, `SearchResult` are available\r\n"},"dashboard-view":{"2026-02-16-ui-design-polish-p0-p1":"## MODIFIED Requirements\r\n\r\n### Requirement: Overview statistics display\r\nThe system SHALL display overview statistics from the overview API: total specs count, active changes count, archived changes count, and task completion rate (percentage). Statistics SHALL be displayed in stat cards with large numbers (text-4xl) and a staggered fade-in-up entry animation on page load.\r\n\r\n#### Scenario: Display statistics\r\n- **WHEN** user navigates to the Dashboard page\r\n- **THEN** system displays specs count, active changes count, archived changes count, and overall task completion percentage in stat cards with large accent-colored numbers\r\n\r\n#### Scenario: Staggered entry animation\r\n- **WHEN** the Dashboard page loads\r\n- **THEN** the four stat cards appear with a fade-in-up animation, each card delayed by an incremental amount (e.g., 0ms, 80ms, 160ms, 240ms) creating a staggered reveal effect\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** stat cards appear immediately without animation\r\n","2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Overview statistics display\r\nThe system SHALL display overview statistics from the overview API: total specs count, active changes count, archived changes count, and task completion rate (percentage).\r\n\r\n#### Scenario: Display statistics\r\n- **WHEN** user navigates to the Dashboard page\r\n- **THEN** system displays specs count, active changes count, archived changes count, and overall task completion percentage in stat cards\r\n\r\n### Requirement: Active changes list\r\nThe system SHALL display a list of active changes with their names and task progress indicators.\r\n\r\n#### Scenario: Show active changes with progress\r\n- **WHEN** there are active changes in the repo\r\n- **THEN** each active change is displayed with its name and a TaskProgress bar showing completed/total tasks\r\n\r\n#### Scenario: No active changes\r\n- **WHEN** there are no active changes\r\n- **THEN** system displays an empty state message\r\n\r\n### Requirement: Recent archived changes\r\nThe system SHALL display the most recent 10 archived changes.\r\n\r\n#### Scenario: Show archived changes\r\n- **WHEN** user views the Dashboard\r\n- **THEN** the most recent 10 archived changes are listed with their names and dates\r\n\r\n### Requirement: Navigation cards\r\nThe system SHALL provide navigation cards/links to the Specs list and Changes list pages.\r\n\r\n#### Scenario: Navigate to specs\r\n- **WHEN** user clicks the Specs navigation card\r\n- **THEN** system navigates to `/specs`\r\n\r\n#### Scenario: Navigate to changes\r\n- **WHEN** user clicks the Changes navigation card\r\n- **THEN** system navigates to `/changes`\r\n"},"filesystem-api":{"2026-02-13-phase1-skeleton-and-api":"## ADDED Requirements\r\n\r\n### Requirement: Browse directories\r\nThe system SHALL provide an API endpoint `GET /api/fs/browse` that returns directory contents for a given path, allowing users to navigate the filesystem to find repos.\r\n\r\n#### Scenario: Browse valid directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/projects`\r\n- **THEN** system returns a JSON array of entries, each with `name`, `type` (\"file\" or \"directory\"), and `path`\r\n- **AND** entries are sorted with directories first, then alphabetically\r\n\r\n#### Scenario: Browse without path parameter\r\n- **WHEN** client sends `GET /api/fs/browse` without a `path` parameter\r\n- **THEN** system returns the contents of the user's home directory\r\n\r\n#### Scenario: Browse non-existent directory\r\n- **WHEN** client sends `GET /api/fs/browse?path=/nonexistent`\r\n- **THEN** system returns HTTP 400 with an error message\r\n\r\n### Requirement: Detect OpenSpec directory\r\nThe system SHALL provide an API endpoint `GET /api/fs/detect` that checks whether a given path contains an `openspec/` directory with a valid `config.yaml`.\r\n\r\n#### Scenario: Path contains valid OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/my-repo`\r\n- **AND** `/home/user/my-repo/openspec/config.yaml` exists\r\n- **THEN** system returns `{ \"hasOpenSpec\": true, \"schema\": \"<schema-value>\" }`\r\n\r\n#### Scenario: Path does not contain OpenSpec directory\r\n- **WHEN** client sends `GET /api/fs/detect?path=/home/user/empty-repo`\r\n- **AND** no `openspec/` directory exists at that path\r\n- **THEN** system returns `{ \"hasOpenSpec\": false }`\r\n\r\n### Requirement: Path traversal protection\r\nThe system SHALL reject any path that attempts directory traversal outside the specified root.\r\n\r\n#### Scenario: Path traversal attempt\r\n- **WHEN** client sends `GET /api/fs/browse?path=/home/user/../../../etc`\r\n- **THEN** system resolves the path and returns the directory contents of the resolved absolute path without exposing system files outside normal filesystem permissions\r\n"},"frontend-design-skill":{"2026-02-15-add-frontend-design-skill":"## ADDED Requirements\r\n\r\n### Requirement: Skill 目錄結構\r\n\r\nfrontend-design skill SHALL 存放於 `.agents/skills/frontend-design/` 目錄下，包含 `SKILL.md` 和 `LICENSE.txt` 兩個檔案。\r\n\r\n#### Scenario: Skill 檔案存在\r\n\r\n- **WHEN** 檢查 `.agents/skills/frontend-design/` 目錄\r\n- **THEN** 目錄中 SHALL 包含 `SKILL.md` 和 `LICENSE.txt`\r\n\r\n### Requirement: Claude Code Skill 註冊\r\n\r\n`.claude/skills/frontend-design` SHALL 為一個 symlink，指向 `../../.agents/skills/frontend-design`，使 Claude Code 能自動偵測並載入此 skill。\r\n\r\n#### Scenario: Symlink 正確指向\r\n\r\n- **WHEN** Claude Code 掃描 `.claude/skills/` 目錄\r\n- **THEN** `frontend-design` symlink SHALL 解析至 `.agents/skills/frontend-design/`\r\n\r\n### Requirement: SKILL.md 包含設計指引\r\n\r\n`SKILL.md` SHALL 包含 frontmatter（name、description、license）以及設計指引內容，涵蓋 Design Thinking 流程和 Frontend Aesthetics Guidelines。\r\n\r\n#### Scenario: Skill 被觸發時提供指引\r\n\r\n- **WHEN** 使用者要求建立網頁元件、頁面、dashboard 或美化 web UI\r\n- **THEN** Claude Code SHALL 載入 SKILL.md 中的設計指引，引導產出高品質前端介面\r\n"},"git-timestamp-cache":{"2026-02-13-spec-history-git-timestamp-cache":"## ADDED Requirements\r\n\r\n### Requirement: Build timestamp cache from git log\r\nThe system SHALL provide a function that executes a single `git log` command scoped to `openspec/changes/` and parses the output to build a Map of change slug to earliest commit timestamp (ISO 8601 format).\r\n\r\n#### Scenario: Build cache for repo with git history\r\n- **WHEN** the cache builder is invoked for a repo directory that is a git repository\r\n- **THEN** the system executes `git log --format=\"COMMIT %aI\" --name-only -- openspec/changes/` in the repo directory\r\n- **AND** parses the output to extract the earliest commit timestamp for each change slug\r\n- **AND** returns a `Map<string, string>` mapping slug to ISO 8601 timestamp\r\n\r\n#### Scenario: Build cache for non-git directory\r\n- **WHEN** the cache builder is invoked for a directory that is not a git repository\r\n- **THEN** the system returns an empty Map without throwing an error\r\n\r\n#### Scenario: Change exists in filesystem but not in git\r\n- **WHEN** a change directory exists but has no git commits (e.g., uncommitted new change)\r\n- **THEN** that change slug is not present in the returned Map\r\n\r\n### Requirement: In-memory cache keyed by repo path\r\nThe system SHALL maintain an in-memory cache (`Map<string, Map<string, string>>`) keyed by absolute repo directory path, storing the timestamp Map for each repo.\r\n\r\n#### Scenario: Cache hit\r\n- **WHEN** a timestamp lookup is requested for a repo that has been previously cached\r\n- **THEN** the system returns the cached Map without executing any git commands\r\n\r\n#### Scenario: Cache miss with lazy build\r\n- **WHEN** a timestamp lookup is requested for a repo that has not been cached\r\n- **THEN** the system automatically builds the cache by executing the git log command\r\n- **AND** stores the result for subsequent lookups\r\n\r\n### Requirement: Resync cache\r\nThe system SHALL provide a resync function that clears the cached timestamps for a given repo and immediately rebuilds the cache from git.\r\n\r\n#### Scenario: Resync after repo changes\r\n- **WHEN** the resync function is invoked for a repo directory\r\n- **THEN** the system clears the existing cache entry for that repo\r\n- **AND** rebuilds the cache by executing the git log command\r\n- **AND** returns the newly built timestamp Map\r\n"},"markdown-renderer":{"2026-02-13-phase3-markdown-and-search":"## ADDED Requirements\r\n\r\n### Requirement: Markdown content rendering\r\nThe system SHALL render Markdown content using react-markdown with remark-gfm plugin, supporting GFM features including tables, strikethrough, and task lists.\r\n\r\n#### Scenario: Standard Markdown rendering\r\n- **WHEN** MarkdownRenderer receives a string containing standard Markdown (headings, lists, bold, italic, links, code blocks)\r\n- **THEN** the content is rendered as formatted HTML with appropriate styling\r\n\r\n#### Scenario: GFM table rendering\r\n- **WHEN** MarkdownRenderer receives content containing a GFM pipe table\r\n- **THEN** the table is rendered as a styled HTML table with header row and data rows\r\n\r\n#### Scenario: GFM checkbox rendering\r\n- **WHEN** MarkdownRenderer receives content containing `- [x]` or `- [ ]` items\r\n- **THEN** the items are rendered as visual checkboxes (read-only)\r\n\r\n### Requirement: BDD keyword highlighting\r\nThe system SHALL visually highlight BDD keywords in rendered Markdown content to improve readability of spec documents.\r\n\r\n#### Scenario: WHEN/GIVEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `WHEN` or `GIVEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a blue background label style (blue text on blue-tinted background)\r\n\r\n#### Scenario: THEN keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `THEN` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a green background label style (green text on green-tinted background)\r\n\r\n#### Scenario: AND keyword highlighting\r\n- **WHEN** rendered Markdown contains the word `AND` as a standalone uppercase keyword\r\n- **THEN** the keyword is displayed with a gray background label style (gray text on gray-tinted background)\r\n\r\n#### Scenario: MUST/SHALL keyword highlighting\r\n- **WHEN** rendered Markdown contains `MUST` or `SHALL` as standalone uppercase keywords\r\n- **THEN** the keywords are displayed in red bold text\r\n\r\n#### Scenario: ADDED/MODIFIED badge rendering\r\n- **WHEN** rendered Markdown contains `ADDED` or `MODIFIED` as standalone uppercase keywords\r\n- **THEN** `ADDED` is displayed as an orange badge and `MODIFIED` is displayed as a blue badge\r\n\r\n#### Scenario: Keywords inside code blocks are not highlighted\r\n- **WHEN** BDD keywords appear inside inline code or fenced code blocks\r\n- **THEN** the keywords are NOT highlighted and remain as plain code text\r\n\r\n#### Scenario: Case-sensitive matching\r\n- **WHEN** text contains lowercase or mixed-case variations like \"when\", \"Then\", \"must\"\r\n- **THEN** the keywords are NOT highlighted (only exact uppercase matches trigger highlighting)\r\n\r\n### Requirement: Dark theme styling\r\nThe system SHALL apply dark theme styles consistent with the application's design system (background #0a0c0f series, amber accent, text #e2e8f0).\r\n\r\n#### Scenario: Code block styling\r\n- **WHEN** MarkdownRenderer renders a fenced code block\r\n- **THEN** the code block uses a dark background with monospace font and appropriate padding\r\n\r\n#### Scenario: Link styling\r\n- **WHEN** MarkdownRenderer renders a hyperlink\r\n- **THEN** the link is displayed in accent color (amber) with hover effect\r\n\r\n#### Scenario: Heading styling\r\n- **WHEN** MarkdownRenderer renders headings (h1-h6)\r\n- **THEN** headings use appropriate font sizes and weights consistent with the dark theme\r\n"},"openspec-api":{"2026-02-13-spec-history-git-timestamp-cache":"## ADDED Requirements\r\n\r\n### Requirement: Resync cache endpoint\r\nThe system SHALL provide `POST /api/openspec/resync` that clears and rebuilds the git timestamp cache for a given repo.\r\n\r\n#### Scenario: Successful resync\r\n- **WHEN** client sends `POST /api/openspec/resync?dir=/path/to/repo`\r\n- **THEN** the system clears the timestamp cache for that repo\r\n- **AND** rebuilds the cache from git history\r\n- **AND** returns HTTP 200 with `{ ok: true }`\r\n\r\n#### Scenario: Resync without dir parameter\r\n- **WHEN** client sends `POST /api/openspec/resync` without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n\r\n### Requirement: Resync UI control\r\nThe system SHALL display a resync button in the sidebar that triggers a cache rebuild. The button MUST show a loading state while the resync is in progress.\r\n\r\n#### Scenario: User triggers resync\r\n- **WHEN** the user clicks the resync button in the sidebar\r\n- **THEN** the system sends `POST /api/openspec/resync` with the current repo path\r\n- **AND** the button shows a loading/spinning state during the request\r\n- **AND** on success, the current page data is refreshed to reflect updated ordering\r\n\r\n#### Scenario: Resync with no repo selected\r\n- **WHEN** no repo is currently selected\r\n- **THEN** the resync button is not displayed or is disabled\r\n","2026-02-13-fix-task-stats-and-capability-nav":"## MODIFIED Requirements\r\n\r\n### Requirement: Overview endpoint\r\nThe system SHALL provide `GET /api/openspec/overview` that returns aggregate statistics for an OpenSpec repository.\r\n\r\n#### Scenario: Get overview of repo with specs and changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `specsCount`, `changesCount` (with `active` and `archived` breakdown), and `taskStats` (aggregate `total` and `completed` across all changes, including both active and archived)\r\n\r\n#### Scenario: Get overview with only archived changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** there are no active changes but archived changes have tasks\r\n- **THEN** system returns `taskStats` with correct `total` and `completed` counts from archived changes\r\n\r\n#### Scenario: Get overview of repo with no specs\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** the repo has no `openspec/specs/` directory\r\n- **THEN** system returns `specsCount: 0` with changes still counted correctly\r\n","2026-02-13-phase1-skeleton-and-api":"## ADDED Requirements\r\n\r\n### Requirement: Overview endpoint\r\nThe system SHALL provide `GET /api/openspec/overview` that returns aggregate statistics for an OpenSpec repository.\r\n\r\n#### Scenario: Get overview of repo with specs and changes\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `specsCount`, `changesCount` (with `active` and `archived` breakdown), and `taskStats` (aggregate `total` and `completed` across all active changes)\r\n\r\n#### Scenario: Get overview of repo with no specs\r\n- **WHEN** client sends `GET /api/openspec/overview?dir=/path/to/repo`\r\n- **AND** the repo has no `openspec/specs/` directory\r\n- **THEN** system returns `specsCount: 0` with changes still counted correctly\r\n\r\n### Requirement: List specs\r\nThe system SHALL provide `GET /api/openspec/specs` that returns all spec topics.\r\n\r\n#### Scenario: List all specs\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **THEN** system returns a JSON array of spec topics, each with `topic` name and `path`\r\n- **AND** topics are sorted alphabetically\r\n\r\n#### Scenario: No specs directory\r\n- **WHEN** client sends `GET /api/openspec/specs?dir=/path/to/repo`\r\n- **AND** `openspec/specs/` does not exist\r\n- **THEN** system returns an empty array\r\n\r\n### Requirement: Get single spec\r\nThe system SHALL provide `GET /api/openspec/specs/:topic` that returns the full content of a spec.\r\n\r\n#### Scenario: Get existing spec\r\n- **WHEN** client sends `GET /api/openspec/specs/simulation-engine?dir=/path/to/repo`\r\n- **AND** `openspec/specs/simulation-engine/spec.md` exists\r\n- **THEN** system returns JSON with `topic`, `content` (raw Markdown), and `relatedChanges` (list of changes that have delta specs for this topic)\r\n\r\n#### Scenario: Get non-existent spec\r\n- **WHEN** client sends `GET /api/openspec/specs/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: List changes\r\nThe system SHALL provide `GET /api/openspec/changes` that returns all changes grouped by status.\r\n\r\n#### Scenario: List changes with active and archived\r\n- **WHEN** client sends `GET /api/openspec/changes?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `active` array and `archived` array\r\n- **AND** each change includes `slug`, `date` (parsed from slug prefix), `description` (parsed from slug), `hasProposal`, `hasDesign`, `hasTasks`, `hasSpecs`, and `taskStats`\r\n- **AND** changes are sorted by date descending (newest first)\r\n\r\n### Requirement: Get single change\r\nThe system SHALL provide `GET /api/openspec/changes/:slug` that returns full change content.\r\n\r\n#### Scenario: Get existing change with all artifacts\r\n- **WHEN** client sends `GET /api/openspec/changes/2026-02-10-my-feature?dir=/path/to/repo`\r\n- **THEN** system returns JSON with `slug`, `proposal` (Markdown content or null), `design` (Markdown content or null), `tasks` (parsed task structure or null), `specs` (array of delta spec contents), and `metadata` (from `.openspec.yaml` if present)\r\n\r\n#### Scenario: Get non-existent change\r\n- **WHEN** client sends `GET /api/openspec/changes/nonexistent?dir=/path/to/repo`\r\n- **THEN** system returns HTTP 404\r\n\r\n### Requirement: Missing dir parameter\r\nThe system SHALL require the `dir` query parameter on all openspec endpoints.\r\n\r\n#### Scenario: Request without dir parameter\r\n- **WHEN** client sends any `/api/openspec/*` request without `dir` parameter\r\n- **THEN** system returns HTTP 400 with error message \"dir parameter is required\"\r\n"},"openspec-scanner":{"2026-02-13-vscode-extension":"## MODIFIED Requirements\r\n\r\n### Requirement: Scan OpenSpec directory structure\r\nThe scanner SHALL be a pure function in the `@spek/core` package that reads an OpenSpec directory and returns its complete structure including specs, active changes, and archived changes. It SHALL use Node.js `fs/promises` directly and have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Scan repo with full OpenSpec structure\r\n- **WHEN** scanner is given a repo path containing `openspec/specs/` and `openspec/changes/`\r\n- **THEN** it returns a structure with `specs` (list of topic names), `activeChanges` (changes directly under `openspec/changes/` excluding `archive/`), and `archivedChanges` (changes under `openspec/changes/archive/`)\r\n\r\n#### Scenario: Scan repo with empty OpenSpec directory\r\n- **WHEN** scanner is given a repo path where `openspec/` exists but contains only `config.yaml`\r\n- **THEN** it returns empty arrays for specs, activeChanges, and archivedChanges\r\n\r\n### Requirement: Parse change artifacts\r\nThe scanner SHALL read individual change directories and extract available artifacts.\r\n\r\n#### Scenario: Change with all artifacts\r\n- **WHEN** scanner reads a change directory containing proposal.md, design.md, tasks.md, and specs/\r\n- **THEN** it returns the raw Markdown content for each artifact and a list of delta spec files\r\n\r\n#### Scenario: Change with partial artifacts\r\n- **WHEN** scanner reads a change directory containing only proposal.md\r\n- **THEN** it returns proposal content and null for missing artifacts\r\n\r\n### Requirement: Read spec content\r\nThe scanner SHALL read spec files and return their Markdown content.\r\n\r\n#### Scenario: Read existing spec\r\n- **WHEN** scanner reads `openspec/specs/{topic}/spec.md`\r\n- **THEN** it returns the raw Markdown content of the spec file\r\n\r\n### Requirement: Detect related changes for a spec\r\nThe scanner SHALL identify which changes contain delta specs for a given spec topic.\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** scanner checks for changes related to spec topic \"simulation-engine\"\r\n- **THEN** it returns all change slugs that have a `specs/simulation-engine/spec.md` delta file\r\n","2026-02-13-phase1-skeleton-and-api":"## ADDED Requirements\r\n\r\n### Requirement: Scan OpenSpec directory structure\r\nThe scanner SHALL read an OpenSpec directory and return its complete structure including specs, active changes, and archived changes.\r\n\r\n#### Scenario: Scan repo with full OpenSpec structure\r\n- **WHEN** scanner is given a repo path containing `openspec/specs/` and `openspec/changes/`\r\n- **THEN** it returns a structure with `specs` (list of topic names), `activeChanges` (changes directly under `openspec/changes/` excluding `archive/`), and `archivedChanges` (changes under `openspec/changes/archive/`)\r\n\r\n#### Scenario: Scan repo with empty OpenSpec directory\r\n- **WHEN** scanner is given a repo path where `openspec/` exists but contains only `config.yaml`\r\n- **THEN** it returns empty arrays for specs, activeChanges, and archivedChanges\r\n\r\n### Requirement: Parse change artifacts\r\nThe scanner SHALL read individual change directories and extract available artifacts.\r\n\r\n#### Scenario: Change with all artifacts\r\n- **WHEN** scanner reads a change directory containing proposal.md, design.md, tasks.md, and specs/\r\n- **THEN** it returns the raw Markdown content for each artifact and a list of delta spec files\r\n\r\n#### Scenario: Change with partial artifacts\r\n- **WHEN** scanner reads a change directory containing only proposal.md\r\n- **THEN** it returns proposal content and null for missing artifacts\r\n\r\n### Requirement: Read spec content\r\nThe scanner SHALL read spec files and return their Markdown content.\r\n\r\n#### Scenario: Read existing spec\r\n- **WHEN** scanner reads `openspec/specs/{topic}/spec.md`\r\n- **THEN** it returns the raw Markdown content of the spec file\r\n\r\n### Requirement: Detect related changes for a spec\r\nThe scanner SHALL identify which changes contain delta specs for a given spec topic.\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** scanner checks for changes related to spec topic \"simulation-engine\"\r\n- **THEN** it returns all change slugs that have a `specs/simulation-engine/spec.md` delta file\r\n"},"repo-selection":{"2026-02-13-phase4-polish-and-enhancement":"## MODIFIED Requirements\r\n\r\n### Requirement: Recent paths persistence\r\nThe system SHALL persist the most recent 5 repo paths in localStorage. On page load, previously used paths SHALL be displayed for quick selection. Each recent path SHALL be validated asynchronously against the detect API to show its current status (valid, invalid, or checking).\r\n\r\n#### Scenario: Save path on successful detection\r\n- **WHEN** user successfully opens a repo (path with valid openspec/)\r\n- **THEN** the path is saved to localStorage recent paths list (max 5, most recent first)\r\n\r\n#### Scenario: Display recent paths on load\r\n- **WHEN** user visits the SelectRepo page\r\n- **THEN** previously saved paths are displayed as clickable options\r\n\r\n#### Scenario: Validate recent paths asynchronously\r\n- **WHEN** the SelectRepo page loads with saved recent paths\r\n- **THEN** the system calls the detect API for each path in parallel\r\n- **AND** each path displays a status indicator: spinner (checking), green checkmark (valid openspec/ found), or red indicator (path invalid or no openspec/)\r\n\r\n#### Scenario: Remove invalid path\r\n- **WHEN** a recent path is determined to be invalid\r\n- **THEN** a delete button appears next to the path allowing the user to remove it from the list\r\n","2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Path input with auto-detection\r\nThe system SHALL provide a text input for entering a filesystem path. Upon input, the system SHALL call the detect API to check for an `openspec/` directory and display the detection result.\r\n\r\n#### Scenario: Valid path with openspec directory\r\n- **WHEN** user enters a path that contains an `openspec/` directory\r\n- **THEN** system displays a success indicator and a button to open the repo\r\n\r\n#### Scenario: Valid path without openspec directory\r\n- **WHEN** user enters a path that does not contain an `openspec/` directory\r\n- **THEN** system displays a warning message indicating no openspec directory found\r\n\r\n#### Scenario: Invalid path\r\n- **WHEN** user enters a path that does not exist\r\n- **THEN** system displays an error message\r\n\r\n### Requirement: Directory browsing\r\nThe system SHALL provide a directory browser that calls the browse API, allowing users to navigate the filesystem and select a repo path.\r\n\r\n#### Scenario: Browse directories\r\n- **WHEN** user clicks the browse button\r\n- **THEN** system displays a list of directories at the current path\r\n- **AND** user can click a directory to navigate into it\r\n- **AND** user can select the current directory as the repo path\r\n\r\n### Requirement: Recent paths persistence\r\nThe system SHALL persist the most recent 5 repo paths in localStorage. On page load, previously used paths SHALL be displayed for quick selection.\r\n\r\n#### Scenario: Save path on successful detection\r\n- **WHEN** user successfully opens a repo (path with valid openspec/)\r\n- **THEN** the path is saved to localStorage recent paths list (max 5, most recent first)\r\n\r\n#### Scenario: Display recent paths on load\r\n- **WHEN** user visits the SelectRepo page\r\n- **THEN** previously saved paths are displayed as clickable options\r\n\r\n### Requirement: Auto-navigate to dashboard\r\nThe system SHALL automatically navigate to the Dashboard page after the user selects a valid repo path.\r\n\r\n#### Scenario: Navigate after selection\r\n- **WHEN** user selects a valid repo path (via input, browse, or recent paths)\r\n- **THEN** system navigates to `/dashboard` with the repo path set in RepoContext\r\n"},"responsive-layout":{"2026-02-13-phase4-polish-and-enhancement":"## ADDED Requirements\r\n\r\n### Requirement: Mobile breakpoint detection\r\nThe system SHALL detect whether the viewport width is below 768px and adapt the layout accordingly. The detection MUST use `window.matchMedia` and respond to runtime viewport changes (e.g., device rotation).\r\n\r\n#### Scenario: Viewport below 768px\r\n- **WHEN** the viewport width is less than 768px\r\n- **THEN** the sidebar is hidden by default and a hamburger menu button appears in the header\r\n\r\n#### Scenario: Viewport at or above 768px\r\n- **WHEN** the viewport width is 768px or greater\r\n- **THEN** the sidebar is displayed in its fixed position and the hamburger menu button is hidden\r\n\r\n#### Scenario: Viewport resize crossing breakpoint\r\n- **WHEN** the viewport is resized from below 768px to at or above 768px\r\n- **THEN** the sidebar transitions to fixed display and the hamburger menu button is hidden\r\n\r\n### Requirement: Mobile sidebar overlay\r\nThe system SHALL display the sidebar as a full-height overlay with a backdrop when opened on viewports below 768px.\r\n\r\n#### Scenario: Open mobile sidebar\r\n- **WHEN** the user taps the hamburger menu button on a mobile viewport\r\n- **THEN** the sidebar slides in from the left as an overlay with a semi-transparent backdrop behind it\r\n\r\n#### Scenario: Close mobile sidebar via backdrop\r\n- **WHEN** the mobile sidebar overlay is open and the user taps the backdrop area\r\n- **THEN** the sidebar closes and the backdrop disappears\r\n\r\n#### Scenario: Close mobile sidebar via navigation\r\n- **WHEN** the mobile sidebar overlay is open and the user taps a navigation link\r\n- **THEN** the system navigates to the selected route and the sidebar closes automatically\r\n\r\n### Requirement: Responsive content grids\r\nThe system SHALL adapt grid layouts for different viewport sizes. Dashboard stat cards MUST use 2 columns on mobile and 4 columns on desktop. Navigation cards MUST stack vertically on mobile.\r\n\r\n#### Scenario: Dashboard stat cards on mobile\r\n- **WHEN** the Dashboard page is rendered on a viewport below 768px\r\n- **THEN** the stat cards are displayed in a 2-column grid\r\n\r\n#### Scenario: Dashboard stat cards on desktop\r\n- **WHEN** the Dashboard page is rendered on a viewport at or above 768px\r\n- **THEN** the stat cards are displayed in a 4-column grid\r\n\r\n### Requirement: Responsive header\r\nThe system SHALL adapt the header layout for mobile viewports. The repo path display MUST be hidden on mobile to save space. The search button MUST remain accessible.\r\n\r\n#### Scenario: Header on mobile\r\n- **WHEN** the header is rendered on a viewport below 768px\r\n- **THEN** the hamburger button is shown on the left, the search button is centered, and the repo path is hidden\r\n\r\n#### Scenario: Header on desktop\r\n- **WHEN** the header is rendered on a viewport at or above 768px\r\n- **THEN** the layout shows the spek brand on the left, search button centered, and repo path on the right\r\n"},"search-api":{"2026-02-13-phase1-skeleton-and-api":"## ADDED Requirements\r\n\r\n### Requirement: Full-text search endpoint\r\nThe system SHALL provide `GET /api/openspec/search` that searches across all specs and changes content.\r\n\r\n#### Scenario: Search with matching results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=effectiveCurrent`\r\n- **THEN** system returns a JSON array of results, each with `type` (\"spec\" or \"change\"), `name` (topic or slug), `matches` (array of matching text with context), and `score`\r\n- **AND** results are sorted by relevance score (best match first)\r\n\r\n#### Scenario: Search with no results\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo&q=xyznonexistent`\r\n- **THEN** system returns an empty array\r\n\r\n#### Scenario: Search without query parameter\r\n- **WHEN** client sends `GET /api/openspec/search?dir=/path/to/repo` without `q` parameter\r\n- **THEN** system returns HTTP 400 with error message\r\n\r\n### Requirement: Search context preview\r\nEach search result SHALL include surrounding context to help users identify the relevant content.\r\n\r\n#### Scenario: Result includes context\r\n- **WHEN** a search matches text within a Markdown file\r\n- **THEN** the match includes up to 100 characters before and after the matched text as context preview\r\n"},"search-ui":{"2026-02-16-ui-design-polish-p2":"## MODIFIED Requirements\r\n\r\n### Requirement: Search query execution\r\nThe system SHALL search across all specs and changes content by calling the backend search API with debounced input. Search results SHALL highlight matching text fragments in the title and context preview.\r\n\r\n#### Scenario: Debounced search on input\r\n- **WHEN** user types a query in the search input\r\n- **THEN** the system waits 300ms after the last keystroke before sending the search request\r\n\r\n#### Scenario: Display search results with highlights\r\n- **WHEN** the search API returns results\r\n- **THEN** results are displayed grouped by type (Specs and Changes), with matching query text highlighted using a contrasting background color in both the title and context snippet\r\n\r\n#### Scenario: No results found\r\n- **WHEN** the search API returns an empty array\r\n- **THEN** the dialog displays a \"No results found\" message with a suggestion to try different keywords\r\n\r\n#### Scenario: Empty query\r\n- **WHEN** the search input is empty\r\n- **THEN** no search request is made and the results area shows a prompt to start typing\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Search type filter\r\nThe system SHALL provide a type filter in the search dialog allowing users to narrow results by category: All, Specs only, or Changes only.\r\n\r\n#### Scenario: Filter by type\r\n- **WHEN** user selects \"Specs\" filter while search results are displayed\r\n- **THEN** only spec-type results are shown, change-type results are hidden\r\n\r\n#### Scenario: Default filter\r\n- **WHEN** the search dialog opens\r\n- **THEN** the \"All\" filter is selected by default, showing both spec and change results\r\n\r\n#### Scenario: Filter with no matching results\r\n- **WHEN** user selects a type filter and no results match that type\r\n- **THEN** a \"No results found\" message is displayed for that category\r\n","2026-02-13-phase3-markdown-and-search":"## ADDED Requirements\r\n\r\n### Requirement: Search dialog activation\r\nThe system SHALL provide a search dialog that can be opened via keyboard shortcut or UI interaction.\r\n\r\n#### Scenario: Open search with keyboard shortcut\r\n- **WHEN** user presses `Cmd+K` (macOS) or `Ctrl+K` (other platforms) anywhere in the application\r\n- **THEN** a search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Open search via header button\r\n- **WHEN** user clicks the search button in the application header\r\n- **THEN** the search dialog modal opens with focus on the search input field\r\n\r\n#### Scenario: Close search with Escape\r\n- **WHEN** the search dialog is open and user presses `Escape`\r\n- **THEN** the search dialog closes\r\n\r\n#### Scenario: Close search by clicking backdrop\r\n- **WHEN** the search dialog is open and user clicks outside the dialog\r\n- **THEN** the search dialog closes\r\n\r\n### Requirement: Search query execution\r\nThe system SHALL search across all specs and changes content by calling the backend search API with debounced input.\r\n\r\n#### Scenario: Debounced search on input\r\n- **WHEN** user types a query in the search input\r\n- **THEN** the system waits 300ms after the last keystroke before sending the search request to `GET /api/openspec/search`\r\n\r\n#### Scenario: Display search results\r\n- **WHEN** the search API returns results\r\n- **THEN** results are displayed grouped by type (Specs and Changes), each showing the name and a context preview snippet\r\n\r\n#### Scenario: No results found\r\n- **WHEN** the search API returns an empty array\r\n- **THEN** the dialog displays a \"No results found\" message\r\n\r\n#### Scenario: Empty query\r\n- **WHEN** the search input is empty\r\n- **THEN** no search request is made and the results area shows a prompt to start typing\r\n\r\n### Requirement: Search result navigation\r\nThe system SHALL allow users to navigate to search results using keyboard or mouse.\r\n\r\n#### Scenario: Click to navigate\r\n- **WHEN** user clicks on a search result\r\n- **THEN** the application navigates to the corresponding page (`/specs/:topic` for spec results, `/changes/:slug` for change results) and the search dialog closes\r\n\r\n#### Scenario: Keyboard navigation with arrow keys\r\n- **WHEN** user presses the down arrow key in the search dialog\r\n- **THEN** the next result item is highlighted\r\n- **AND** pressing the up arrow key highlights the previous result item\r\n\r\n#### Scenario: Confirm selection with Enter\r\n- **WHEN** user presses Enter with a result item highlighted\r\n- **THEN** the application navigates to that result's page and the search dialog closes\r\n"},"shared-layout":{"2026-02-16-ui-design-polish-p2":"## MODIFIED Requirements\r\n\r\n### Requirement: TabView component\r\nThe system SHALL provide a reusable TabView component that renders tab headers and switches between tab content panels. When switching tabs, the new content panel SHALL fade in with a 150ms CSS animation.\r\n\r\n#### Scenario: Switch tabs\r\n- **WHEN** user clicks a tab header\r\n- **THEN** the corresponding tab content panel is displayed with a fade-in animation (150ms duration) and the previous panel is hidden\r\n\r\n#### Scenario: Default tab\r\n- **WHEN** TabView is first rendered\r\n- **THEN** the first tab is selected by default\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** user has `prefers-reduced-motion: reduce` enabled\r\n- **THEN** tab content switches instantly without fade animation\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Main content area top spacing\r\nThe system SHALL render the main content area with sufficient top spacing below the fixed header to provide visual breathing room between the navbar and page content. The top padding SHALL be at least 72px (header height 56px + 16px spacing).\r\n\r\n#### Scenario: Page title spacing\r\n- **WHEN** any page is rendered within the Layout\r\n- **THEN** the first content element (typically h1) has at least 16px of visual spacing below the header bar\r\n\r\n### Requirement: Back navigation link styling\r\nThe system SHALL render back navigation links (e.g., \"← Back to Specs\", \"← Back to Changes\") at base font size (16px) with medium font weight for adequate visibility and clickability.\r\n\r\n#### Scenario: Back link display\r\n- **WHEN** user views a detail page (SpecDetail or ChangeDetail)\r\n- **THEN** the back navigation link is displayed at 16px font size with medium weight, muted color, and accent color on hover\r\n","2026-02-16-ui-design-polish-p0-p1":"## MODIFIED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: an inline SVG logomark (S-curve with diamond accents, 24x24) followed by the \"spek\" brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button with `aria-label=\"Open navigation menu\"` and hide the repo path. The header SHALL also include a theme toggle button. The logomark SVG SHALL use `currentColor` to follow the accent color, ensuring theme compatibility.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the SVG logomark alongside \"spek\" brand text, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button with `aria-label=\"Open navigation menu\"`, the SVG logomark alongside \"spek\" brand text, search button, and theme toggle, but hides the repo path\r\n\r\n#### Scenario: Logo theme compatibility\r\n- **WHEN** the user toggles between dark and light theme\r\n- **THEN** the logomark color adjusts automatically via the accent color CSS variable\r\n\r\n### Requirement: TaskProgress component\r\nThe system SHALL provide a reusable TaskProgress component that displays a progress bar with completed/total count. The progress bar color SHALL reflect completion status: amber/accent color when incomplete, green when all tasks are completed (completed equals total).\r\n\r\n#### Scenario: Display progress\r\n- **WHEN** TaskProgress is rendered with `completed=3` and `total=5`\r\n- **THEN** a progress bar at 60% width is shown in amber/accent color with text \"3 / 5\"\r\n\r\n#### Scenario: Display completed progress\r\n- **WHEN** TaskProgress is rendered with `completed=5` and `total=5`\r\n- **THEN** a progress bar at 100% width is shown in green color with text \"5 / 5\"\r\n\r\n#### Scenario: Zero tasks\r\n- **WHEN** TaskProgress is rendered with `total=0`\r\n- **THEN** component displays \"No tasks\" or an empty state\r\n\r\n## ADDED Requirements\r\n\r\n### Requirement: Custom typography\r\nThe system SHALL use \"Plus Jakarta Sans\" as the primary font family for all UI text, loaded via Google Fonts CDN. The font stack SHALL include `sans-serif` as fallback for offline environments. Code and monospace text SHALL continue to use \"JetBrains Mono\".\r\n\r\n#### Scenario: Font loading\r\n- **WHEN** the application loads in a browser with internet access\r\n- **THEN** \"Plus Jakarta Sans\" is loaded and applied to all non-code text elements\r\n\r\n#### Scenario: Font fallback\r\n- **WHEN** the application loads without internet access (or Google Fonts is blocked)\r\n- **THEN** the browser falls back to the system default sans-serif font\r\n\r\n#### Scenario: Reduced motion preference\r\n- **WHEN** the user has `prefers-reduced-motion: reduce` set in their OS/browser\r\n- **THEN** all CSS entry animations are disabled\r\n","2026-02-14-add-sidebar-toggle":"## MODIFIED Requirements\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a sidebar with navigation links: Overview (Dashboard), Specs, and Changes. Each link SHALL have an associated icon (LayoutDashboard for Overview, FileText for Specs, GitBranch for Changes). The current route SHALL be visually highlighted. On viewports below 768px, the sidebar SHALL be hidden by default and displayed as an overlay when toggled. On viewports at or above 768px, the sidebar SHALL support two states: expanded (240px width, showing icons and labels) and collapsed (56px width, showing icons only). A toggle button at the bottom of the sidebar SHALL switch between states. The main content area left margin SHALL adjust to match the current sidebar width.\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes with corresponding icons\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n#### Scenario: Sidebar on mobile viewport\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar is hidden by default and only shown when the hamburger menu is activated\r\n\r\n#### Scenario: Sidebar expanded on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is expanded\r\n- **THEN** the sidebar is displayed at 240px width with icons and text labels, and main content has matching left margin\r\n\r\n#### Scenario: Sidebar collapsed on desktop viewport\r\n- **WHEN** the viewport is at or above 768px and sidebar is collapsed\r\n- **THEN** the sidebar is displayed at 56px width with icons only, and main content has matching left margin\r\n","2026-02-13-apply-brand-logo":"## MODIFIED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: an inline SVG logomark (S-curve with diamond accents, 24x24) followed by the \"spek\" brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button and hide the repo path. The header SHALL also include a theme toggle button. The logomark SVG SHALL use `currentColor` to follow the accent color, ensuring theme compatibility.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the SVG logomark alongside \"spek\" brand text, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button, the SVG logomark alongside \"spek\" brand text, search button, and theme toggle, but hides the repo path\r\n\r\n#### Scenario: Logo theme compatibility\r\n- **WHEN** the user toggles between dark and light theme\r\n- **THEN** the logomark color adjusts automatically via the accent color CSS variable\r\n","2026-02-13-phase4-polish-and-enhancement":"## MODIFIED Requirements\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a sidebar with navigation links: Overview (Dashboard), Specs, and Changes. The current route SHALL be visually highlighted. On viewports below 768px, the sidebar SHALL be hidden by default and displayed as an overlay when toggled. On viewports at or above 768px, the sidebar SHALL be displayed in a fixed position (240px width).\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n#### Scenario: Sidebar on mobile viewport\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar is hidden by default and only shown when the hamburger menu is activated\r\n\r\n#### Scenario: Sidebar on desktop viewport\r\n- **WHEN** the viewport is at or above 768px\r\n- **THEN** the sidebar is displayed in its fixed position (240px width)\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: the \"spek\" logo/brand text (left), a search button (center), and the current repo path (right, desktop only). On mobile viewports, the header SHALL include a hamburger menu button and hide the repo path. The header SHALL also include a theme toggle button.\r\n\r\n#### Scenario: Display header on desktop\r\n- **WHEN** any page within the Layout is rendered on a viewport at or above 768px\r\n- **THEN** the header displays the spek brand, search button, theme toggle, and current repo path\r\n\r\n#### Scenario: Display header on mobile\r\n- **WHEN** any page within the Layout is rendered on a viewport below 768px\r\n- **THEN** the header displays a hamburger button, the spek brand, search button, and theme toggle, but hides the repo path\r\n","2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Header component\r\nThe system SHALL render a fixed header bar (56px height) containing: the \"spek\" logo/brand text (left), a search button placeholder (center), and the current repo path (right).\r\n\r\n#### Scenario: Display header\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the header displays the spek brand, a disabled search button, and the current repo path from RepoContext\r\n\r\n### Requirement: Sidebar navigation\r\nThe system SHALL render a fixed sidebar (240px width) with navigation links: Overview (Dashboard), Specs, and Changes. The current route SHALL be visually highlighted.\r\n\r\n#### Scenario: Display sidebar links\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** the sidebar shows navigation links for Overview, Specs, and Changes\r\n\r\n#### Scenario: Highlight active route\r\n- **WHEN** user is on the Dashboard page\r\n- **THEN** the \"Overview\" link in the sidebar is highlighted with the accent color\r\n\r\n### Requirement: TaskProgress component\r\nThe system SHALL provide a reusable TaskProgress component that displays a progress bar with completed/total count.\r\n\r\n#### Scenario: Display progress\r\n- **WHEN** TaskProgress is rendered with `completed=3` and `total=5`\r\n- **THEN** a progress bar at 60% width is shown with text \"3 / 5\"\r\n\r\n#### Scenario: Zero tasks\r\n- **WHEN** TaskProgress is rendered with `total=0`\r\n- **THEN** component displays \"No tasks\" or an empty state\r\n\r\n### Requirement: TabView component\r\nThe system SHALL provide a reusable TabView component that renders tab headers and switches between tab content panels.\r\n\r\n#### Scenario: Switch tabs\r\n- **WHEN** user clicks a tab header\r\n- **THEN** the corresponding tab content panel is displayed and the previous panel is hidden\r\n\r\n#### Scenario: Default tab\r\n- **WHEN** TabView is first rendered\r\n- **THEN** the first tab is selected by default\r\n"},"sidebar-toggle":{"2026-02-14-add-sidebar-toggle":"## ADDED Requirements\r\n\r\n### Requirement: Sidebar collapse toggle button\r\nThe system SHALL display a toggle button at the bottom of the sidebar (above the Resync button) that collapses or expands the sidebar. The button SHALL display a left-pointing chevron (`«`) when the sidebar is expanded and a right-pointing chevron (`»`) when collapsed.\r\n\r\n#### Scenario: Toggle sidebar from expanded to collapsed\r\n- **WHEN** the sidebar is expanded and the user clicks the toggle button\r\n- **THEN** the sidebar collapses to 56px width showing only navigation icons\r\n\r\n#### Scenario: Toggle sidebar from collapsed to expanded\r\n- **WHEN** the sidebar is collapsed and the user clicks the toggle button\r\n- **THEN** the sidebar expands to the full 240px width showing icons and labels\r\n\r\n### Requirement: Collapsed sidebar icon-only navigation\r\nThe system SHALL display navigation items as icon-only buttons when the sidebar is collapsed. Each navigation link SHALL display a corresponding icon: LayoutDashboard icon for Overview, FileText icon for Specs, and GitBranch icon for Changes. Each icon button SHALL include a `title` attribute showing the full link label.\r\n\r\n#### Scenario: Display collapsed navigation with icons\r\n- **WHEN** the sidebar is in collapsed state\r\n- **THEN** navigation items display as icon-only buttons with tooltips\r\n\r\n#### Scenario: Navigate from collapsed sidebar\r\n- **WHEN** the user clicks a navigation icon in collapsed state\r\n- **THEN** the app navigates to the corresponding route\r\n\r\n#### Scenario: Active route indication in collapsed state\r\n- **WHEN** the user is on the Specs page and sidebar is collapsed\r\n- **THEN** the Specs icon is highlighted with the accent color\r\n\r\n### Requirement: Collapsed sidebar Resync button\r\nThe system SHALL display the Resync button as icon-only in collapsed state, without the text label, and with a `title` attribute for tooltip.\r\n\r\n#### Scenario: Resync button in collapsed state\r\n- **WHEN** the sidebar is collapsed\r\n- **THEN** the Resync button displays only the sync icon with a tooltip\r\n\r\n### Requirement: Sidebar collapse state persistence\r\nThe system SHALL persist the sidebar collapse state to localStorage (key: `spek-sidebar-collapsed`) in the web version. On page load, the sidebar SHALL restore the previously saved state. In VS Code webview, the state SHALL default to expanded and not persist across sessions.\r\n\r\n#### Scenario: Persist collapsed state in web version\r\n- **WHEN** the user collapses the sidebar and refreshes the page\r\n- **THEN** the sidebar remains collapsed after reload\r\n\r\n#### Scenario: Default state in VS Code webview\r\n- **WHEN** the webview is first opened\r\n- **THEN** the sidebar is in expanded state\r\n\r\n### Requirement: Sidebar transition animation\r\nThe system SHALL animate the sidebar width change and main content margin with a smooth CSS transition (200ms duration).\r\n\r\n#### Scenario: Smooth collapse animation\r\n- **WHEN** the user clicks the toggle button\r\n- **THEN** the sidebar width and main content margin animate smoothly over 200ms\r\n\r\n### Requirement: Mobile behavior unchanged\r\nThe sidebar toggle feature SHALL only apply to desktop viewports (768px and above). On mobile viewports, the existing overlay sidebar behavior SHALL remain unchanged.\r\n\r\n#### Scenario: Mobile viewport ignores collapse state\r\n- **WHEN** the viewport is below 768px\r\n- **THEN** the sidebar uses the existing overlay behavior regardless of collapse state\r\n"},"spa-routing":{"2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Client-side routing\r\nThe system SHALL use React Router v7 with `createBrowserRouter` to define the following routes:\r\n\r\n| Path | Page | Layout |\r\n|------|------|--------|\r\n| `/` | SelectRepo | None |\r\n| `/dashboard` | Dashboard | Layout |\r\n| `/specs` | SpecList | Layout |\r\n| `/specs/:topic` | SpecDetail | Layout |\r\n| `/changes` | ChangeList | Layout |\r\n| `/changes/:slug` | ChangeDetail | Layout |\r\n\r\n#### Scenario: Route to SelectRepo\r\n- **WHEN** user navigates to `/`\r\n- **THEN** the SelectRepo page is rendered without Layout wrapper\r\n\r\n#### Scenario: Route to Dashboard with Layout\r\n- **WHEN** user navigates to `/dashboard`\r\n- **THEN** the Dashboard page is rendered within the shared Layout (Header + Sidebar + Main)\r\n\r\n### Requirement: RepoContext state management\r\nThe system SHALL provide a React Context (`RepoContext`) that stores the current repo path. All API hooks SHALL read the repo path from this context.\r\n\r\n#### Scenario: Set repo path\r\n- **WHEN** user selects a repo on the SelectRepo page\r\n- **THEN** `RepoContext.repoPath` is updated and available to all child components\r\n\r\n#### Scenario: Redirect when no repo selected\r\n- **WHEN** user navigates to any page other than `/` without a repo path in context\r\n- **THEN** system redirects to `/`\r\n\r\n### Requirement: API hooks\r\nThe system SHALL provide custom React hooks in `useOpenSpec.ts` that encapsulate API calls. Each hook SHALL return `{ data, loading, error }` and automatically include the `dir` query parameter from RepoContext.\r\n\r\n#### Scenario: Hook returns loading state\r\n- **WHEN** an API hook is called and the request is in flight\r\n- **THEN** hook returns `{ data: null, loading: true, error: null }`\r\n\r\n#### Scenario: Hook returns data\r\n- **WHEN** the API request succeeds\r\n- **THEN** hook returns `{ data: <response>, loading: false, error: null }`\r\n\r\n#### Scenario: Hook returns error\r\n- **WHEN** the API request fails\r\n- **THEN** hook returns `{ data: null, loading: false, error: <error message> }`\r\n"},"spec-browsing":{"2026-02-16-ui-design-polish-p2":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec list with filtering\r\nThe system SHALL display all specs sorted alphabetically with history count metadata. A filter input SHALL allow instant client-side filtering by spec topic name. Each spec item SHALL display the topic name and the number of related changes (history count) as secondary information.\r\n\r\n#### Scenario: Display all specs\r\n- **WHEN** user navigates to the SpecList page\r\n- **THEN** all spec topics are listed alphabetically, each showing the topic name and history change count\r\n\r\n#### Scenario: Filter specs\r\n- **WHEN** user types in the filter input\r\n- **THEN** the list is filtered in real-time to show only specs whose topic name contains the search text (case-insensitive)\r\n\r\n#### Scenario: Spec with no history\r\n- **WHEN** a spec has zero related changes\r\n- **THEN** the history count is not displayed (or shows \"No changes\")\r\n","2026-02-13-phase2-core-ui-pages":"## ADDED Requirements\r\n\r\n### Requirement: Spec list with filtering\r\nThe system SHALL display all specs sorted alphabetically. A filter input SHALL allow instant client-side filtering by spec topic name.\r\n\r\n#### Scenario: Display all specs\r\n- **WHEN** user navigates to the SpecList page\r\n- **THEN** all spec topics are listed alphabetically\r\n\r\n#### Scenario: Filter specs\r\n- **WHEN** user types in the filter input\r\n- **THEN** the list is filtered in real-time to show only specs whose topic name contains the search text (case-insensitive)\r\n\r\n### Requirement: Spec detail display\r\nThe system SHALL display the full content of a spec when the user navigates to its detail page. The raw markdown content SHALL be shown (react-markdown rendering deferred to Phase 3).\r\n\r\n#### Scenario: View spec content\r\n- **WHEN** user navigates to `/specs/:topic`\r\n- **THEN** system displays the spec topic as title and the full spec.md content\r\n\r\n#### Scenario: Spec not found\r\n- **WHEN** user navigates to a spec topic that does not exist\r\n- **THEN** system displays a \"not found\" message\r\n\r\n### Requirement: Related changes display\r\nThe spec detail page SHALL display a list of changes that affect the spec (from the API's `relatedChanges` field). Each change SHALL be a link to its detail page.\r\n\r\n#### Scenario: Show related changes\r\n- **WHEN** viewing a spec that has related changes\r\n- **THEN** a \"Related Changes\" section lists each change as a clickable link to `/changes/:slug`\r\n\r\n#### Scenario: No related changes\r\n- **WHEN** viewing a spec with no related changes\r\n- **THEN** the \"Related Changes\" section shows an empty state message\r\n"},"spec-history":{"2026-02-13-spec-history-git-timestamp-cache":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec history data in API response\r\nThe system SHALL include a `history` array in the `GET /api/openspec/specs/:topic` response. Each entry MUST contain the change slug, date (if parseable from slug), timestamp (ISO 8601 from git commit cache, or null if unavailable), description, and status (active or archived).\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** a spec has been affected by one or more changes (i.e., changes that contain a delta spec for this topic)\r\n- **THEN** the API response includes a `history` array with entries sorted by git commit timestamp descending (most recent first)\r\n- **AND** if two entries have the same date, the git commit timestamp determines their order\r\n- **AND** each entry contains `{ slug, date, timestamp, description, status }`\r\n\r\n#### Scenario: Spec with no related changes\r\n- **WHEN** a spec has no related changes\r\n- **THEN** the API response includes an empty `history` array\r\n\r\n#### Scenario: Fallback sorting when git timestamp unavailable\r\n- **WHEN** a history entry has no git commit timestamp (e.g., uncommitted change or non-git repo)\r\n- **THEN** the entry's `timestamp` field is null\r\n- **AND** sorting falls back to the date parsed from the slug\r\n","2026-02-13-phase4-polish-and-enhancement":"## ADDED Requirements\r\n\r\n### Requirement: Spec history data in API response\r\nThe system SHALL include a `history` array in the `GET /api/openspec/specs/:topic` response. Each entry MUST contain the change slug, date (if parseable from slug), description, and status (active or archived).\r\n\r\n#### Scenario: Spec with related changes\r\n- **WHEN** a spec has been affected by one or more changes (i.e., changes that contain a delta spec for this topic)\r\n- **THEN** the API response includes a `history` array with entries sorted by date descending (most recent first)\r\n- **AND** each entry contains `{ slug, date, description, status }`\r\n\r\n#### Scenario: Spec with no related changes\r\n- **WHEN** a spec has no related changes\r\n- **THEN** the API response includes an empty `history` array\r\n\r\n### Requirement: Spec history timeline UI\r\nThe system SHALL display a visual timeline on the SpecDetail page showing all changes that affected the spec. Each timeline entry MUST display the date, change description, and a link to the change detail page.\r\n\r\n#### Scenario: Display history timeline\r\n- **WHEN** the SpecDetail page is rendered for a spec with related changes\r\n- **THEN** a \"History\" section is displayed with a vertical timeline showing each change chronologically\r\n\r\n#### Scenario: Timeline entry links to change\r\n- **WHEN** the user clicks on a timeline entry\r\n- **THEN** the system navigates to the corresponding change detail page\r\n\r\n#### Scenario: No history\r\n- **WHEN** the SpecDetail page is rendered for a spec with no related changes\r\n- **THEN** the \"History\" section displays a message indicating no changes have affected this spec\r\n","spec-diff-viewer":"## MODIFIED Requirements\r\n\r\n### Requirement: Spec history timeline UI\r\nThe system SHALL display a visual timeline on the SpecDetail page showing all changes that affected the spec. Each timeline entry MUST display the date, change description, and a link to the change detail page. Each timeline entry SHALL also include a \"Compare\" action that triggers diff comparison against the current spec content.\r\n\r\n#### Scenario: Display history timeline\r\n- **WHEN** the SpecDetail page is rendered for a spec with related changes\r\n- **THEN** a \"History\" section is displayed with a vertical timeline showing each change chronologically\r\n\r\n#### Scenario: Timeline entry links to change\r\n- **WHEN** the user clicks on a timeline entry's title or description\r\n- **THEN** the system navigates to the corresponding change detail page\r\n\r\n#### Scenario: No history\r\n- **WHEN** the SpecDetail page is rendered for a spec with no related changes\r\n- **THEN** the \"History\" section displays a message indicating no changes have affected this spec\r\n\r\n#### Scenario: Timeline entry compare action\r\n- **WHEN** the user clicks the \"Compare\" action on a timeline entry\r\n- **THEN** the system enters diff comparison mode showing the difference between that change version and the current spec content\r\n"},"task-parser":{"2026-02-13-vscode-extension":"## MODIFIED Requirements\r\n\r\n### Requirement: Parse task checkboxes\r\nThe task parser SHALL be a pure function in the `@spek/core` package that reads a tasks.md content string and extracts checkbox items with their completion status. It SHALL have no dependency on Express or any HTTP framework.\r\n\r\n#### Scenario: Parse file with mixed checkboxes\r\n- **WHEN** parser receives a string containing `- [x] Done task` and `- [ ] Pending task`\r\n- **THEN** it returns each task with `text` and `completed` (boolean) fields\r\n\r\n### Requirement: Group tasks by section\r\nThe task parser SHALL group tasks under their `##` heading sections.\r\n\r\n#### Scenario: Tasks under multiple sections\r\n- **WHEN** parser receives a string with `## Phase 1` followed by tasks and `## Phase 2` followed by tasks\r\n- **THEN** it returns sections array, each with `title` and `tasks` array\r\n\r\n#### Scenario: Tasks without section headings\r\n- **WHEN** parser receives a string where tasks appear before any `##` heading\r\n- **THEN** those tasks are grouped under a default section with empty title\r\n\r\n### Requirement: Calculate task statistics\r\nThe task parser SHALL compute aggregate statistics from parsed tasks.\r\n\r\n#### Scenario: Calculate completion stats\r\n- **WHEN** parser processes a string with 10 total checkboxes where 7 are checked\r\n- **THEN** it returns `{ total: 10, completed: 7 }` along with the sections breakdown\r\n\r\n#### Scenario: Empty tasks file\r\n- **WHEN** parser processes an empty string or one with no checkboxes\r\n- **THEN** it returns `{ total: 0, completed: 0, sections: [] }`\r\n","2026-02-13-phase1-skeleton-and-api":"## ADDED Requirements\r\n\r\n### Requirement: Parse task checkboxes\r\nThe task parser SHALL read a tasks.md file and extract checkbox items with their completion status.\r\n\r\n#### Scenario: Parse file with mixed checkboxes\r\n- **WHEN** parser reads a tasks.md containing `- [x] Done task` and `- [ ] Pending task`\r\n- **THEN** it returns each task with `text` and `completed` (boolean) fields\r\n\r\n### Requirement: Group tasks by section\r\nThe task parser SHALL group tasks under their `##` heading sections.\r\n\r\n#### Scenario: Tasks under multiple sections\r\n- **WHEN** parser reads a tasks.md with `## Phase 1` followed by tasks and `## Phase 2` followed by tasks\r\n- **THEN** it returns sections array, each with `title` and `tasks` array\r\n\r\n#### Scenario: Tasks without section headings\r\n- **WHEN** parser reads a tasks.md where tasks appear before any `##` heading\r\n- **THEN** those tasks are grouped under a default section with empty title\r\n\r\n### Requirement: Calculate task statistics\r\nThe task parser SHALL compute aggregate statistics from parsed tasks.\r\n\r\n#### Scenario: Calculate completion stats\r\n- **WHEN** parser processes a tasks.md with 10 total checkboxes where 7 are checked\r\n- **THEN** it returns `{ total: 10, completed: 7 }` along with the sections breakdown\r\n\r\n#### Scenario: Empty tasks file\r\n- **WHEN** parser processes an empty tasks.md or one with no checkboxes\r\n- **THEN** it returns `{ total: 0, completed: 0, sections: [] }`\r\n"},"theme-toggle":{"2026-02-13-phase4-polish-and-enhancement":"## ADDED Requirements\r\n\r\n### Requirement: Theme state management\r\nThe system SHALL provide a ThemeContext that manages the current theme (\"dark\" or \"light\") and exposes a toggle function. The theme state MUST be persisted in localStorage under the key `spek:theme`.\r\n\r\n#### Scenario: Initialize from localStorage\r\n- **WHEN** the application loads and localStorage contains a saved theme preference\r\n- **THEN** the system applies the saved theme\r\n\r\n#### Scenario: Initialize from system preference\r\n- **WHEN** the application loads and no theme is saved in localStorage\r\n- **AND** the user's system preference is light mode (`prefers-color-scheme: light`)\r\n- **THEN** the system applies the light theme\r\n\r\n#### Scenario: Initialize default\r\n- **WHEN** the application loads and no theme is saved and no system preference is detected\r\n- **THEN** the system applies the dark theme as default\r\n\r\n#### Scenario: Toggle theme\r\n- **WHEN** the user triggers the theme toggle\r\n- **THEN** the current theme switches (dark → light or light → dark)\r\n- **AND** the new preference is saved to localStorage\r\n- **AND** the `data-theme` attribute on `<html>` is updated\r\n\r\n### Requirement: Light theme CSS variables\r\nThe system SHALL define a complete set of light theme CSS variables that override the dark theme defaults when `[data-theme=\"light\"]` is set on the `<html>` element.\r\n\r\n#### Scenario: Light theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"light\"`\r\n- **THEN** all color CSS variables (`--color-bg-primary`, `--color-bg-secondary`, `--color-bg-tertiary`, `--color-border`, `--color-text-primary`, `--color-text-secondary`, `--color-text-muted`, `--color-accent`, `--color-accent-hover`) are overridden with light-appropriate values\r\n\r\n#### Scenario: Dark theme applied\r\n- **WHEN** the `<html>` element has `data-theme=\"dark\"` or no `data-theme` attribute\r\n- **THEN** the default dark theme CSS variables are used\r\n\r\n### Requirement: Theme toggle button\r\nThe system SHALL display a theme toggle button in the header. The button MUST show a sun icon when in dark mode (indicating \"switch to light\") and a moon icon when in light mode (indicating \"switch to dark\").\r\n\r\n#### Scenario: Display toggle in header\r\n- **WHEN** any page within the Layout is rendered\r\n- **THEN** a theme toggle button is visible in the header area\r\n\r\n#### Scenario: Icon reflects current theme\r\n- **WHEN** the current theme is dark\r\n- **THEN** the toggle button displays a sun icon\r\n- **WHEN** the current theme is light\r\n- **THEN** the toggle button displays a moon icon\r\n"},"vscode-cicd":{"2026-02-14-vscode-cicd-publish":"## ADDED Requirements\r\n\r\n### Requirement: Tag-triggered publish workflow\r\n系統 SHALL 提供 GitHub Actions workflow，於 push 符合 `v*` pattern 的 tag 時自動觸發 VS Code extension 的 build 與 publish 流程。\r\n\r\n#### Scenario: Push version tag triggers workflow\r\n- **WHEN** 開發者 push 一個 `v0.2.0` 格式的 tag\r\n- **THEN** GitHub Actions workflow 自動觸發並執行完整 build chain\r\n\r\n#### Scenario: Non-matching tag does not trigger\r\n- **WHEN** 開發者 push 一個 `release-0.2.0` 或 `feat/something` 格式的 ref\r\n- **THEN** 此 workflow 不被觸發\r\n\r\n### Requirement: Full build chain execution\r\nWorkflow SHALL 依序執行完整 build chain：install dependencies → build @spek/core → build webview assets → build VS Code extension。\r\n\r\n#### Scenario: Build chain completes successfully\r\n- **WHEN** workflow 被觸發且所有 build 步驟成功\r\n- **THEN** `packages/vscode/dist/extension.js` 和 webview assets 皆存在且為最新\r\n\r\n#### Scenario: Build failure stops pipeline\r\n- **WHEN** 任一 build 步驟失敗\r\n- **THEN** 後續步驟不執行，workflow 標記為失敗\r\n\r\n### Requirement: Marketplace publish\r\nWorkflow SHALL 使用 `VSCE_PAT` secret 透過 `vsce publish` 將 extension 發佈到 VS Code Marketplace。\r\n\r\n#### Scenario: Successful publish\r\n- **WHEN** build chain 完成且 `VSCE_PAT` secret 有效\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Missing PAT secret\r\n- **WHEN** `VSCE_PAT` secret 未設定或已過期\r\n- **THEN** publish 步驟失敗，workflow 標記為失敗\r\n\r\n### Requirement: Manual trigger support\r\nWorkflow SHALL 支援 `workflow_dispatch` 手動觸發，方便除錯和測試。\r\n\r\n#### Scenario: Manual trigger from Actions UI\r\n- **WHEN** 開發者在 GitHub Actions UI 手動觸發此 workflow\r\n- **THEN** workflow 執行完整 build + publish 流程\r\n\r\n### Requirement: Version consistency check\r\nWorkflow SHALL 在 publish 前驗證 tag 版號與 `packages/vscode/package.json` 中的 version 欄位一致。\r\n\r\n#### Scenario: Version matches\r\n- **WHEN** tag `v0.2.0` 且 package.json version 為 `0.2.0`\r\n- **THEN** 繼續執行 publish\r\n\r\n#### Scenario: Version mismatch\r\n- **WHEN** tag `v0.3.0` 但 package.json version 為 `0.2.0`\r\n- **THEN** workflow 失敗並輸出版號不一致的錯誤訊息\r\n"},"vscode-extension-host":{"2026-02-13-vscode-extension":"## ADDED Requirements\r\n\r\n### Requirement: Extension activation\r\nThe extension SHALL activate when a workspace containing an `openspec/` directory is opened, or when the user explicitly invokes a spek command.\r\n\r\n#### Scenario: Workspace with openspec directory\r\n- **WHEN** VS Code opens a workspace where the first workspace folder contains an `openspec/` directory\r\n- **THEN** the extension activates and displays a spek icon in the status bar\r\n\r\n#### Scenario: Workspace without openspec directory\r\n- **WHEN** VS Code opens a workspace without an `openspec/` directory\r\n- **THEN** the extension remains inactive and no status bar icon is shown\r\n\r\n#### Scenario: Manual activation via command\r\n- **WHEN** the user invokes the `spek.open` command from the command palette\r\n- **THEN** the extension activates and opens the spek Webview Panel\r\n\r\n### Requirement: Webview Panel lifecycle\r\nThe extension SHALL manage a single Webview Panel instance for displaying the spek UI.\r\n\r\n#### Scenario: Open spek panel\r\n- **WHEN** the user invokes `spek.open` and no panel exists\r\n- **THEN** the extension creates a new Webview Panel in the active editor column with the title \"spek\"\r\n\r\n#### Scenario: Focus existing panel\r\n- **WHEN** the user invokes `spek.open` and a panel already exists\r\n- **THEN** the extension reveals (focuses) the existing panel instead of creating a new one\r\n\r\n#### Scenario: Panel disposal\r\n- **WHEN** the user closes the spek Webview Panel\r\n- **THEN** the extension cleans up the panel reference and associated message listeners\r\n\r\n### Requirement: Command registration\r\nThe extension SHALL register commands in the VS Code command palette.\r\n\r\n#### Scenario: Available commands\r\n- **WHEN** the extension is active\r\n- **THEN** the following commands are available: `spek.open` (Open spek) and `spek.search` (Search OpenSpec)\r\n\r\n#### Scenario: Search command\r\n- **WHEN** the user invokes `spek.search`\r\n- **THEN** the extension opens (or focuses) the spek panel and sends a message to trigger the search dialog\r\n\r\n### Requirement: Message handler for API requests\r\nThe extension host SHALL handle message-based API requests from the Webview and return responses using core module functions.\r\n\r\n#### Scenario: Handle API request\r\n- **WHEN** the Webview sends a message `{ type: 'request', id: 'req-1', method: 'getOverview' }`\r\n- **THEN** the extension host calls the corresponding core module function and replies with `{ type: 'response', id: 'req-1', data: <result> }`\r\n\r\n#### Scenario: Handle API error\r\n- **WHEN** the Webview sends a request and the core module function throws an error\r\n- **THEN** the extension host replies with `{ type: 'response', id: 'req-1', error: <error message> }`\r\n"},"vscode-marketplace-metadata":{"2026-02-14-add-changelog-entry":"## MODIFIED Requirements\r\n\r\n### Requirement: Extension version and changelog\r\nExtension SHALL 維護 CHANGELOG.md 記錄每個版本的功能異動，且 package.json version 欄位 SHALL 與最新 CHANGELOG entry 一致。\r\n\r\n#### Scenario: Version bump with new feature\r\n- **WHEN** 新功能（sidebar toggle）已實作完成\r\n- **THEN** package.json version 更新為 `0.2.0`，CHANGELOG.md 包含 `0.2.0` 區塊描述新功能\r\n","2026-02-13-vscode-marketplace-publish":"## ADDED Requirements\r\n\r\n### Requirement: Marketplace-ready package.json\r\nExtension 的 `package.json` SHALL 包含所有 VS Code Marketplace 發佈所需的欄位。\r\n\r\n#### Scenario: Required fields present\r\n- **WHEN** 執行 `vsce package` 打包 extension\r\n- **THEN** package.json 包含以下欄位且無 validation 錯誤：`publisher`、`repository`、`license`、`icon`、`categories`、`keywords`\r\n\r\n#### Scenario: Private flag removed\r\n- **WHEN** package.json 被讀取\r\n- **THEN** `\"private\"` 欄位 SHALL 不存在或為 `false`\r\n\r\n#### Scenario: Icon file exists\r\n- **WHEN** package.json 指定 `\"icon\": \"icon.png\"`\r\n- **THEN** `packages/vscode/icon.png` 檔案存在且為 128x128 以上的 PNG 圖片\r\n\r\n### Requirement: Marketplace README\r\nExtension 目錄下 SHALL 有獨立的 `README.md` 作為 Marketplace 頁面內容。\r\n\r\n#### Scenario: README content\r\n- **WHEN** Marketplace 頁面載入\r\n- **THEN** 顯示 extension 的功能說明、安裝方式與使用說明\r\n\r\n#### Scenario: README exists in extension directory\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `packages/vscode/README.md` 被包含在 `.vsix` 中\r\n\r\n### Requirement: CHANGELOG\r\nExtension 目錄下 SHALL 有 `CHANGELOG.md` 記錄版本變更。\r\n\r\n#### Scenario: CHANGELOG content\r\n- **WHEN** 使用者在 Marketplace 或 VS Code 中檢視 extension 的 changelog\r\n- **THEN** 顯示按版本分組的變更記錄\r\n\r\n### Requirement: vscodeignore configuration\r\n`.vscodeignore` SHALL 排除不需要包含在 `.vsix` 中的檔案，減少套件大小。\r\n\r\n#### Scenario: Source files excluded\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `src/`、`node_modules/`、`tsconfig.json`、`.gitignore` 不被包含在 `.vsix` 中\r\n\r\n#### Scenario: Required files included\r\n- **WHEN** 執行 `vsce package`\r\n- **THEN** `dist/`、`webview/`、`icon.png`、`README.md`、`CHANGELOG.md`、`LICENSE` 被包含在 `.vsix` 中\r\n\r\n### Requirement: Publish workflow\r\n使用者 SHALL 能透過 `vsce` CLI 將 extension 發佈到 Marketplace。\r\n\r\n#### Scenario: First-time publish\r\n- **WHEN** 使用者執行 `vsce login <publisher>` 並輸入有效的 PAT\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** extension 成功發佈到 VS Code Marketplace\r\n\r\n#### Scenario: Version update publish\r\n- **WHEN** 使用者更新 package.json 版本號\r\n- **AND** 執行 `vsce publish`\r\n- **THEN** Marketplace 上的 extension 更新到新版本\r\n"},"webview-integration":{"2026-02-17-add-vscode-tab-icon":"## ADDED Requirements\r\n\r\n### Requirement: Tab icon display\r\nThe Webview Panel SHALL display the spek logo as the tab icon for visual identification.\r\n\r\n#### Scenario: Tab icon is set on panel creation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** the panel's `iconPath` SHALL be set to the `webview/favicon.svg` file from the extension's bundled assets\r\n\r\n#### Scenario: Icon visibility across themes\r\n- **WHEN** the tab icon is displayed in either light or dark VS Code theme\r\n- **THEN** the icon SHALL be visually distinguishable against the tab bar background\r\n","2026-02-13-vscode-extension":"## ADDED Requirements\r\n\r\n### Requirement: Load React SPA in Webview\r\nThe Webview SHALL load the spek React application from the extension's bundled assets.\r\n\r\n#### Scenario: Webview HTML generation\r\n- **WHEN** the extension creates a Webview Panel\r\n- **THEN** it generates an HTML document that loads the built React bundle with asset paths converted via `webview.asWebviewUri()`\r\n\r\n#### Scenario: Asset path resolution\r\n- **WHEN** the Webview HTML references JS or CSS files\r\n- **THEN** all asset paths SHALL use `webview.asWebviewUri()` to convert local file paths to Webview-safe URIs\r\n\r\n### Requirement: Content Security Policy\r\nThe Webview SHALL enforce a Content Security Policy that allows the React application to function while preventing unauthorized content.\r\n\r\n#### Scenario: CSP configuration\r\n- **WHEN** the Webview HTML is generated\r\n- **THEN** it includes a CSP meta tag that allows scripts and styles from the extension's webview URI origin with a unique nonce, and disallows inline scripts without the nonce\r\n\r\n#### Scenario: Tailwind CSS compatibility\r\n- **WHEN** Tailwind CSS styles are loaded in the Webview\r\n- **THEN** all styles SHALL be loaded from external CSS files (not inline style tags) to comply with CSP\r\n\r\n### Requirement: Workspace path injection\r\nThe Webview SHALL receive the workspace path from the extension host so the React app can skip the repo selection page.\r\n\r\n#### Scenario: Initial workspace path\r\n- **WHEN** the Webview is created in a workspace with an `openspec/` directory\r\n- **THEN** the extension host sends a `{ type: 'init', workspacePath: '/path/to/repo' }` message after the Webview is ready\r\n\r\n#### Scenario: Webview ready handshake\r\n- **WHEN** the React app finishes mounting in the Webview\r\n- **THEN** it sends a `{ type: 'ready' }` message to the extension host to signal it can receive the workspace path\r\n\r\n### Requirement: Theme synchronization\r\nThe Webview SHALL respect the VS Code color theme.\r\n\r\n#### Scenario: Dark theme active\r\n- **WHEN** VS Code is using a dark color theme\r\n- **THEN** the Webview renders the spek dark theme\r\n\r\n#### Scenario: Light theme active\r\n- **WHEN** VS Code is using a light color theme\r\n- **THEN** the Webview renders the spek light theme\r\n\r\n#### Scenario: Theme change\r\n- **WHEN** the user changes the VS Code color theme while the Webview is open\r\n- **THEN** the Webview updates its theme to match\r\n"}}};</script>
    <script>var sz=Object.defineProperty;var cz=(zl,el,Al)=>el in zl?sz(zl,el,{enumerable:!0,configurable:!0,writable:!0,value:Al}):zl[el]=Al;var kv=(zl,el,Al)=>cz(zl,typeof el!="symbol"?el+"":el,Al);(function(){"use strict";var zl=document.createElement("style");zl.textContent=`/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-space-y-reverse:0;--tw-border-style:solid;--tw-leading:initial;--tw-font-weight:initial;--tw-tracking:initial;--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-blur:initial;--tw-brightness:initial;--tw-contrast:initial;--tw-grayscale:initial;--tw-hue-rotate:initial;--tw-invert:initial;--tw-opacity:initial;--tw-saturate:initial;--tw-sepia:initial;--tw-drop-shadow:initial;--tw-drop-shadow-color:initial;--tw-drop-shadow-alpha:100%;--tw-drop-shadow-size:initial;--tw-duration:initial}}}@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-red-400:oklch(70.4% .191 22.216);--color-orange-400:oklch(75% .183 55.934);--color-orange-500:oklch(70.5% .213 47.604);--color-yellow-400:oklch(85.2% .199 91.936);--color-green-400:oklch(79.2% .209 151.711);--color-green-500:oklch(72.3% .219 149.579);--color-blue-400:oklch(70.7% .165 254.624);--color-blue-500:oklch(62.3% .214 259.815);--color-gray-400:oklch(70.7% .022 261.325);--color-gray-500:oklch(55.1% .027 264.364);--color-black:#000;--spacing:.25rem;--container-lg:32rem;--container-xl:36rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-base:1rem;--text-base--line-height: 1.5 ;--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--text-2xl:1.5rem;--text-2xl--line-height:calc(2/1.5);--text-3xl:1.875rem;--text-3xl--line-height: 1.2 ;--text-4xl:2.25rem;--text-4xl--line-height:calc(2.5/2.25);--font-weight-medium:500;--font-weight-semibold:600;--font-weight-bold:700;--tracking-wider:.05em;--leading-relaxed:1.625;--radius-lg:.5rem;--animate-spin:spin 1s linear infinite;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono);--color-bg-primary:#0a0c0f;--color-bg-secondary:#111318;--color-bg-tertiary:#1a1d24;--color-border:#2a2d35;--color-text-primary:#e2e8f0;--color-text-secondary:#94a3b8;--color-text-muted:#64748b;--color-accent:#f59e0b;--color-accent-hover:#d97706}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}::-webkit-calendar-picker-indicator{line-height:1}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:calc(var(--spacing)*0)}.top-0{top:calc(var(--spacing)*0)}.top-1{top:calc(var(--spacing)*1)}.top-3\\.5{top:calc(var(--spacing)*3.5)}.top-14{top:calc(var(--spacing)*14)}.right-0{right:calc(var(--spacing)*0)}.bottom-0{bottom:calc(var(--spacing)*0)}.bottom-1{bottom:calc(var(--spacing)*1)}.-left-4{left:calc(var(--spacing)*-4)}.left-0{left:calc(var(--spacing)*0)}.left-2{left:calc(var(--spacing)*2)}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-50{z-index:50}.my-4{margin-block:calc(var(--spacing)*4)}.my-6{margin-block:calc(var(--spacing)*6)}.mt-0\\.5{margin-top:calc(var(--spacing)*.5)}.mt-1{margin-top:calc(var(--spacing)*1)}.mt-2{margin-top:calc(var(--spacing)*2)}.mt-3{margin-top:calc(var(--spacing)*3)}.mt-4{margin-top:calc(var(--spacing)*4)}.mt-5{margin-top:calc(var(--spacing)*5)}.mt-6{margin-top:calc(var(--spacing)*6)}.mr-2{margin-right:calc(var(--spacing)*2)}.-mb-px{margin-bottom:-1px}.mb-0\\.5{margin-bottom:calc(var(--spacing)*.5)}.mb-1{margin-bottom:calc(var(--spacing)*1)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-3{margin-bottom:calc(var(--spacing)*3)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.mb-6{margin-bottom:calc(var(--spacing)*6)}.mb-8{margin-bottom:calc(var(--spacing)*8)}.ml-2{margin-left:calc(var(--spacing)*2)}.ml-14{margin-left:calc(var(--spacing)*14)}.ml-60{margin-left:calc(var(--spacing)*60)}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.inline{display:inline}.inline-block{display:inline-block}.h-2{height:calc(var(--spacing)*2)}.h-2\\.5{height:calc(var(--spacing)*2.5)}.h-4{height:calc(var(--spacing)*4)}.h-5{height:calc(var(--spacing)*5)}.h-6{height:calc(var(--spacing)*6)}.h-14{height:calc(var(--spacing)*14)}.h-full{height:100%}.h-screen{height:100vh}.max-h-64{max-height:calc(var(--spacing)*64)}.max-h-80{max-height:calc(var(--spacing)*80)}.min-h-screen{min-height:100vh}.w-2\\.5{width:calc(var(--spacing)*2.5)}.w-4{width:calc(var(--spacing)*4)}.w-5{width:calc(var(--spacing)*5)}.w-6{width:calc(var(--spacing)*6)}.w-14{width:calc(var(--spacing)*14)}.w-60{width:calc(var(--spacing)*60)}.w-full{width:100%}.w-px{width:1px}.max-w-80{max-width:calc(var(--spacing)*80)}.max-w-lg{max-width:var(--container-lg)}.max-w-xl{max-width:var(--container-xl)}.min-w-full{min-width:100%}.flex-1{flex:1}.flex-shrink-0,.shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.animate-spin{animation:var(--animate-spin)}.cursor-pointer{cursor:pointer}.list-inside{list-style-position:inside}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.items-start{align-items:flex-start}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.gap-1{gap:calc(var(--spacing)*1)}.gap-1\\.5{gap:calc(var(--spacing)*1.5)}.gap-2{gap:calc(var(--spacing)*2)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}:where(.space-y-0\\.5>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*.5)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*.5)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-1>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*1)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-3>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*3)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*3)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-4>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*4)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-6>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*6)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*6)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-8>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*8)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*8)*calc(1 - var(--tw-space-y-reverse)))}.truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:.25rem}.rounded-full{border-radius:3.40282e38px}.rounded-lg{border-radius:var(--radius-lg)}.border{border-style:var(--tw-border-style);border-width:1px}.border-2{border-style:var(--tw-border-style);border-width:2px}.border-y{border-block-style:var(--tw-border-style);border-block-width:1px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-r{border-right-style:var(--tw-border-style);border-right-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-b-2{border-bottom-style:var(--tw-border-style);border-bottom-width:2px}.border-l-4{border-left-style:var(--tw-border-style);border-left-width:4px}.border-accent{border-color:var(--color-accent)}.border-border{border-color:var(--color-border)}.border-text-muted{border-color:var(--color-text-muted)}.border-transparent{border-color:#0000}.border-t-transparent{border-top-color:#0000}.border-l-accent{border-left-color:var(--color-accent)}.bg-accent{background-color:var(--color-accent)}.bg-accent\\/10{background-color:#f59e0b1a}@supports (color:color-mix(in lab,red,red)){.bg-accent\\/10{background-color:color-mix(in oklab,var(--color-accent)10%,transparent)}}.bg-accent\\/20{background-color:#f59e0b33}@supports (color:color-mix(in lab,red,red)){.bg-accent\\/20{background-color:color-mix(in oklab,var(--color-accent)20%,transparent)}}.bg-bg-primary{background-color:var(--color-bg-primary)}.bg-bg-primary\\/50{background-color:#0a0c0f80}@supports (color:color-mix(in lab,red,red)){.bg-bg-primary\\/50{background-color:color-mix(in oklab,var(--color-bg-primary)50%,transparent)}}.bg-bg-secondary{background-color:var(--color-bg-secondary)}.bg-bg-tertiary{background-color:var(--color-bg-tertiary)}.bg-black\\/50{background-color:#00000080}@supports (color:color-mix(in lab,red,red)){.bg-black\\/50{background-color:color-mix(in oklab,var(--color-black)50%,transparent)}}.bg-black\\/60{background-color:#0009}@supports (color:color-mix(in lab,red,red)){.bg-black\\/60{background-color:color-mix(in oklab,var(--color-black)60%,transparent)}}.bg-blue-500\\/20{background-color:#3080ff33}@supports (color:color-mix(in lab,red,red)){.bg-blue-500\\/20{background-color:color-mix(in oklab,var(--color-blue-500)20%,transparent)}}.bg-border{background-color:var(--color-border)}.bg-gray-500\\/20{background-color:#6a728233}@supports (color:color-mix(in lab,red,red)){.bg-gray-500\\/20{background-color:color-mix(in oklab,var(--color-gray-500)20%,transparent)}}.bg-green-400\\/10{background-color:#05df721a}@supports (color:color-mix(in lab,red,red)){.bg-green-400\\/10{background-color:color-mix(in oklab,var(--color-green-400)10%,transparent)}}.bg-green-500{background-color:var(--color-green-500)}.bg-green-500\\/20{background-color:#00c75833}@supports (color:color-mix(in lab,red,red)){.bg-green-500\\/20{background-color:color-mix(in oklab,var(--color-green-500)20%,transparent)}}.bg-orange-500\\/20{background-color:#fe6e0033}@supports (color:color-mix(in lab,red,red)){.bg-orange-500\\/20{background-color:color-mix(in oklab,var(--color-orange-500)20%,transparent)}}.bg-red-400\\/10{background-color:#ff65681a}@supports (color:color-mix(in lab,red,red)){.bg-red-400\\/10{background-color:color-mix(in oklab,var(--color-red-400)10%,transparent)}}.bg-text-muted\\/10{background-color:#64748b1a}@supports (color:color-mix(in lab,red,red)){.bg-text-muted\\/10{background-color:color-mix(in oklab,var(--color-text-muted)10%,transparent)}}.bg-transparent{background-color:#0000}.p-2{padding:calc(var(--spacing)*2)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.p-8{padding:calc(var(--spacing)*8)}.px-0\\.5{padding-inline:calc(var(--spacing)*.5)}.px-1\\.5{padding-inline:calc(var(--spacing)*1.5)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-2\\.5{padding-inline:calc(var(--spacing)*2.5)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-4{padding-inline:calc(var(--spacing)*4)}.py-0\\.5{padding-block:calc(var(--spacing)*.5)}.py-1{padding-block:calc(var(--spacing)*1)}.py-1\\.5{padding-block:calc(var(--spacing)*1.5)}.py-2{padding-block:calc(var(--spacing)*2)}.py-3{padding-block:calc(var(--spacing)*3)}.pt-2{padding-top:calc(var(--spacing)*2)}.pt-3{padding-top:calc(var(--spacing)*3)}.pt-18{padding-top:calc(var(--spacing)*18)}.pt-\\[20vh\\]{padding-top:20vh}.pb-1{padding-bottom:calc(var(--spacing)*1)}.pb-2{padding-bottom:calc(var(--spacing)*2)}.pl-4{padding-left:calc(var(--spacing)*4)}.pl-6{padding-left:calc(var(--spacing)*6)}.text-center{text-align:center}.text-left{text-align:left}.font-mono{font-family:var(--font-mono)}.text-2xl{font-size:var(--text-2xl);line-height:var(--tw-leading,var(--text-2xl--line-height))}.text-3xl{font-size:var(--text-3xl);line-height:var(--tw-leading,var(--text-3xl--line-height))}.text-4xl{font-size:var(--text-4xl);line-height:var(--tw-leading,var(--text-4xl--line-height))}.text-base{font-size:var(--text-base);line-height:var(--tw-leading,var(--text-base--line-height))}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.leading-relaxed{--tw-leading:var(--leading-relaxed);line-height:var(--leading-relaxed)}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.font-semibold{--tw-font-weight:var(--font-weight-semibold);font-weight:var(--font-weight-semibold)}.tracking-wider{--tw-tracking:var(--tracking-wider);letter-spacing:var(--tracking-wider)}.whitespace-nowrap{white-space:nowrap}.text-accent{color:var(--color-accent)}.text-bg-primary{color:var(--color-bg-primary)}.text-blue-400{color:var(--color-blue-400)}.text-gray-400{color:var(--color-gray-400)}.text-green-400{color:var(--color-green-400)}.text-orange-400{color:var(--color-orange-400)}.text-red-400{color:var(--color-red-400)}.text-text-muted{color:var(--color-text-muted)}.text-text-primary{color:var(--color-text-primary)}.text-text-secondary{color:var(--color-text-secondary)}.text-yellow-400{color:var(--color-yellow-400)}.uppercase{text-transform:uppercase}.italic{font-style:italic}.line-through{text-decoration-line:line-through}.underline{text-decoration-line:underline}.decoration-dotted{text-decoration-style:dotted}.accent-accent{accent-color:var(--color-accent)}.opacity-60{opacity:.6}.shadow-2xl{--tw-shadow:0 25px 50px -12px var(--tw-shadow-color,#00000040);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.transition-all{transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.duration-200{--tw-duration:.2s;transition-duration:.2s}.outline-none{--tw-outline-style:none;outline-style:none}.select-none{-webkit-user-select:none;user-select:none}.placeholder\\:text-text-muted::placeholder{color:var(--color-text-muted)}@media(hover:hover){.hover\\:border-accent:hover{border-color:var(--color-accent)}.hover\\:bg-accent-hover:hover{background-color:var(--color-accent-hover)}.hover\\:bg-bg-secondary:hover{background-color:var(--color-bg-secondary)}.hover\\:bg-bg-tertiary:hover{background-color:var(--color-bg-tertiary)}.hover\\:bg-bg-tertiary\\/50:hover{background-color:#1a1d2480}@supports (color:color-mix(in lab,red,red)){.hover\\:bg-bg-tertiary\\/50:hover{background-color:color-mix(in oklab,var(--color-bg-tertiary)50%,transparent)}}.hover\\:bg-bg-tertiary\\/80:hover{background-color:#1a1d24cc}@supports (color:color-mix(in lab,red,red)){.hover\\:bg-bg-tertiary\\/80:hover{background-color:color-mix(in oklab,var(--color-bg-tertiary)80%,transparent)}}.hover\\:text-accent:hover{color:var(--color-accent)}.hover\\:text-accent-hover:hover{color:var(--color-accent-hover)}.hover\\:text-red-400:hover{color:var(--color-red-400)}.hover\\:text-text-primary:hover{color:var(--color-text-primary)}.hover\\:text-text-secondary:hover{color:var(--color-text-secondary)}.hover\\:underline:hover{text-decoration-line:underline}}.focus\\:border-accent:focus{border-color:var(--color-accent)}.focus\\:outline-none:focus{--tw-outline-style:none;outline-style:none}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:opacity-50:disabled{opacity:.5}@media(min-width:48rem){.md\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}}}[data-theme=light]{--color-bg-primary:#f8fafc;--color-bg-secondary:#fff;--color-bg-tertiary:#f1f5f9;--color-border:#e2e8f0;--color-text-primary:#0f172a;--color-text-secondary:#475569;--color-text-muted:#94a3b8;--color-accent:#d97706;--color-accent-hover:#b45309}body{background-color:var(--color-bg-primary);color:var(--color-text-primary);font-family:Plus Jakarta Sans,sans-serif;line-height:1.75}code,pre{font-family:JetBrains Mono,Fira Code,monospace}@keyframes fadeInUp{0%{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in-up{animation:.4s ease-out both fadeInUp}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.animate-fade-in{animation:.15s ease-out both fadeIn}@media(prefers-reduced-motion:reduce){.animate-fade-in-up,.animate-fade-in{animation:none}}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-leading{syntax:"*";inherits:false}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-tracking{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-drop-shadow-color{syntax:"*";inherits:false}@property --tw-drop-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-drop-shadow-size{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@keyframes spin{to{transform:rotate(360deg)}}
/*$vite$:1*/`,document.head.appendChild(zl);function el(t,r){for(var a=0;a<r.length;a++){const i=r[a];if(typeof i!="string"&&!Array.isArray(i)){for(const o in i)if(o!=="default"&&!(o in t)){const s=Object.getOwnPropertyDescriptor(i,o);s&&Object.defineProperty(t,o,s.get?s:{enumerable:!0,get:()=>i[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}function Al(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lo={exports:{}},Ma={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yd;function Cv(){if(yd)return Ma;yd=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(i,o,s){var c=null;if(s!==void 0&&(c=""+s),o.key!==void 0&&(c=""+o.key),"key"in o){s={};for(var h in o)h!=="key"&&(s[h]=o[h])}else s=o;return o=s.ref,{$$typeof:t,type:i,key:c,ref:o!==void 0?o:null,props:s}}return Ma.Fragment=r,Ma.jsx=a,Ma.jsxs=a,Ma}var vd;function Tv(){return vd||(vd=1,Lo.exports=Cv()),Lo.exports}var w=Tv(),Uo={exports:{}},Me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd;function zv(){if(bd)return Me;bd=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),x=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=x&&A[x]||A["@@iterator"],typeof A=="function"?A:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,N={};function R(A,Z,E){this.props=A,this.context=Z,this.refs=N,this.updater=E||k}R.prototype.isReactComponent={},R.prototype.setState=function(A,Z){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,Z,"setState")},R.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function _(){}_.prototype=R.prototype;function H(A,Z,E){this.props=A,this.context=Z,this.refs=N,this.updater=E||k}var ie=H.prototype=new _;ie.constructor=H,D(ie,R.prototype),ie.isPureReactComponent=!0;var K=Array.isArray;function q(){}var M={H:null,A:null,T:null,S:null},le=Object.prototype.hasOwnProperty;function de(A,Z,E){var oe=E.ref;return{$$typeof:t,type:A,key:Z,ref:oe!==void 0?oe:null,props:E}}function Y(A,Z){return de(A.type,Z,A.props)}function ne(A){return typeof A=="object"&&A!==null&&A.$$typeof===t}function ae(A){var Z={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(E){return Z[E]})}var Ae=/\/+/g;function he(A,Z){return typeof A=="object"&&A!==null&&A.key!=null?ae(""+A.key):Z.toString(36)}function te(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(q,q):(A.status="pending",A.then(function(Z){A.status==="pending"&&(A.status="fulfilled",A.value=Z)},function(Z){A.status==="pending"&&(A.status="rejected",A.reason=Z)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function U(A,Z,E,oe,pe){var ge=typeof A;(ge==="undefined"||ge==="boolean")&&(A=null);var je=!1;if(A===null)je=!0;else switch(ge){case"bigint":case"string":case"number":je=!0;break;case"object":switch(A.$$typeof){case t:case r:je=!0;break;case y:return je=A._init,U(je(A._payload),Z,E,oe,pe)}}if(je)return pe=pe(A),je=oe===""?"."+he(A,0):oe,K(pe)?(E="",je!=null&&(E=je.replace(Ae,"$&/")+"/"),U(pe,Z,E,"",function(Jt){return Jt})):pe!=null&&(ne(pe)&&(pe=Y(pe,E+(pe.key==null||A&&A.key===pe.key?"":(""+pe.key).replace(Ae,"$&/")+"/")+je)),Z.push(pe)),1;je=0;var Je=oe===""?".":oe+":";if(K(A))for(var et=0;et<A.length;et++)oe=A[et],ge=Je+he(oe,et),je+=U(oe,Z,E,ge,pe);else if(et=b(A),typeof et=="function")for(A=et.call(A),et=0;!(oe=A.next()).done;)oe=oe.value,ge=Je+he(oe,et++),je+=U(oe,Z,E,ge,pe);else if(ge==="object"){if(typeof A.then=="function")return U(te(A),Z,E,oe,pe);throw Z=String(A),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return je}function $(A,Z,E){if(A==null)return A;var oe=[],pe=0;return U(A,oe,"","",function(ge){return Z.call(E,ge,pe++)}),oe}function ue(A){if(A._status===-1){var Z=A._result;Z=Z(),Z.then(function(E){(A._status===0||A._status===-1)&&(A._status=1,A._result=E)},function(E){(A._status===0||A._status===-1)&&(A._status=2,A._result=E)}),A._status===-1&&(A._status=0,A._result=Z)}if(A._status===1)return A._result.default;throw A._result}var Ce=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},C={map:$,forEach:function(A,Z,E){$(A,function(){Z.apply(this,arguments)},E)},count:function(A){var Z=0;return $(A,function(){Z++}),Z},toArray:function(A){return $(A,function(Z){return Z})||[]},only:function(A){if(!ne(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Me.Activity=g,Me.Children=C,Me.Component=R,Me.Fragment=a,Me.Profiler=o,Me.PureComponent=H,Me.StrictMode=i,Me.Suspense=p,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Me.__COMPILER_RUNTIME={__proto__:null,c:function(A){return M.H.useMemoCache(A)}},Me.cache=function(A){return function(){return A.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(A,Z,E){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var oe=D({},A.props),pe=A.key;if(Z!=null)for(ge in Z.key!==void 0&&(pe=""+Z.key),Z)!le.call(Z,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&Z.ref===void 0||(oe[ge]=Z[ge]);var ge=arguments.length-2;if(ge===1)oe.children=E;else if(1<ge){for(var je=Array(ge),Je=0;Je<ge;Je++)je[Je]=arguments[Je+2];oe.children=je}return de(A.type,pe,oe)},Me.createContext=function(A){return A={$$typeof:c,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:s,_context:A},A},Me.createElement=function(A,Z,E){var oe,pe={},ge=null;if(Z!=null)for(oe in Z.key!==void 0&&(ge=""+Z.key),Z)le.call(Z,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(pe[oe]=Z[oe]);var je=arguments.length-2;if(je===1)pe.children=E;else if(1<je){for(var Je=Array(je),et=0;et<je;et++)Je[et]=arguments[et+2];pe.children=Je}if(A&&A.defaultProps)for(oe in je=A.defaultProps,je)pe[oe]===void 0&&(pe[oe]=je[oe]);return de(A,ge,pe)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(A){return{$$typeof:h,render:A}},Me.isValidElement=ne,Me.lazy=function(A){return{$$typeof:y,_payload:{_status:-1,_result:A},_init:ue}},Me.memo=function(A,Z){return{$$typeof:m,type:A,compare:Z===void 0?null:Z}},Me.startTransition=function(A){var Z=M.T,E={};M.T=E;try{var oe=A(),pe=M.S;pe!==null&&pe(E,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(q,Ce)}catch(ge){Ce(ge)}finally{Z!==null&&E.types!==null&&(Z.types=E.types),M.T=Z}},Me.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Me.use=function(A){return M.H.use(A)},Me.useActionState=function(A,Z,E){return M.H.useActionState(A,Z,E)},Me.useCallback=function(A,Z){return M.H.useCallback(A,Z)},Me.useContext=function(A){return M.H.useContext(A)},Me.useDebugValue=function(){},Me.useDeferredValue=function(A,Z){return M.H.useDeferredValue(A,Z)},Me.useEffect=function(A,Z){return M.H.useEffect(A,Z)},Me.useEffectEvent=function(A){return M.H.useEffectEvent(A)},Me.useId=function(){return M.H.useId()},Me.useImperativeHandle=function(A,Z,E){return M.H.useImperativeHandle(A,Z,E)},Me.useInsertionEffect=function(A,Z){return M.H.useInsertionEffect(A,Z)},Me.useLayoutEffect=function(A,Z){return M.H.useLayoutEffect(A,Z)},Me.useMemo=function(A,Z){return M.H.useMemo(A,Z)},Me.useOptimistic=function(A,Z){return M.H.useOptimistic(A,Z)},Me.useReducer=function(A,Z,E){return M.H.useReducer(A,Z,E)},Me.useRef=function(A){return M.H.useRef(A)},Me.useState=function(A){return M.H.useState(A)},Me.useSyncExternalStore=function(A,Z,E){return M.H.useSyncExternalStore(A,Z,E)},Me.useTransition=function(){return M.H.useTransition()},Me.version="19.2.4",Me}var xd;function Bo(){return xd||(xd=1,Uo.exports=zv()),Uo.exports}var j=Bo();const Av=el({__proto__:null,default:Al(j)},[j]);var Ho={exports:{}},Oa={},qo={exports:{}},Yo={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sd;function Rv(){return Sd||(Sd=1,(function(t){function r(U,$){var ue=U.length;U.push($);e:for(;0<ue;){var Ce=ue-1>>>1,C=U[Ce];if(0<o(C,$))U[Ce]=$,U[ue]=C,ue=Ce;else break e}}function a(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var $=U[0],ue=U.pop();if(ue!==$){U[0]=ue;e:for(var Ce=0,C=U.length,A=C>>>1;Ce<A;){var Z=2*(Ce+1)-1,E=U[Z],oe=Z+1,pe=U[oe];if(0>o(E,ue))oe<C&&0>o(pe,E)?(U[Ce]=pe,U[oe]=ue,Ce=oe):(U[Ce]=E,U[Z]=ue,Ce=Z);else if(oe<C&&0>o(pe,ue))U[Ce]=pe,U[oe]=ue,Ce=oe;else break e}}return $}function o(U,$){var ue=U.sortIndex-$.sortIndex;return ue!==0?ue:U.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,h=c.now();t.unstable_now=function(){return c.now()-h}}var p=[],m=[],y=1,g=null,x=3,b=!1,k=!1,D=!1,N=!1,R=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function ie(U){for(var $=a(m);$!==null;){if($.callback===null)i(m);else if($.startTime<=U)i(m),$.sortIndex=$.expirationTime,r(p,$);else break;$=a(m)}}function K(U){if(D=!1,ie(U),!k)if(a(p)!==null)k=!0,q||(q=!0,ae());else{var $=a(m);$!==null&&te(K,$.startTime-U)}}var q=!1,M=-1,le=5,de=-1;function Y(){return N?!0:!(t.unstable_now()-de<le)}function ne(){if(N=!1,q){var U=t.unstable_now();de=U;var $=!0;try{e:{k=!1,D&&(D=!1,_(M),M=-1),b=!0;var ue=x;try{t:{for(ie(U),g=a(p);g!==null&&!(g.expirationTime>U&&Y());){var Ce=g.callback;if(typeof Ce=="function"){g.callback=null,x=g.priorityLevel;var C=Ce(g.expirationTime<=U);if(U=t.unstable_now(),typeof C=="function"){g.callback=C,ie(U),$=!0;break t}g===a(p)&&i(p),ie(U)}else i(p);g=a(p)}if(g!==null)$=!0;else{var A=a(m);A!==null&&te(K,A.startTime-U),$=!1}}break e}finally{g=null,x=ue,b=!1}$=void 0}}finally{$?ae():q=!1}}}var ae;if(typeof H=="function")ae=function(){H(ne)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,he=Ae.port2;Ae.port1.onmessage=ne,ae=function(){he.postMessage(null)}}else ae=function(){R(ne,0)};function te(U,$){M=R(function(){U(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(U){switch(x){case 1:case 2:case 3:var $=3;break;default:$=x}var ue=x;x=$;try{return U()}finally{x=ue}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(U,$){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var ue=x;x=U;try{return $()}finally{x=ue}},t.unstable_scheduleCallback=function(U,$,ue){var Ce=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ce+ue:Ce):ue=Ce,U){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ue+C,U={id:y++,callback:$,priorityLevel:U,startTime:ue,expirationTime:C,sortIndex:-1},ue>Ce?(U.sortIndex=ue,r(m,U),a(p)===null&&U===a(m)&&(D?(_(M),M=-1):D=!0,te(K,ue-Ce))):(U.sortIndex=C,r(p,U),k||b||(k=!0,q||(q=!0,ae()))),U},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(U){var $=x;return function(){var ue=x;x=$;try{return U.apply(this,arguments)}finally{x=ue}}}})(Yo)),Yo}var wd;function Dv(){return wd||(wd=1,qo.exports=Rv()),qo.exports}var Vo={exports:{}},Yt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ed;function Mv(){if(Ed)return Yt;Ed=1;var t=Bo();function r(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)m+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var i={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function s(p,m,y){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:p,containerInfo:m,implementation:y}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Yt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Yt.createPortal=function(p,m){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(r(299));return s(p,m,null,y)},Yt.flushSync=function(p){var m=c.T,y=i.p;try{if(c.T=null,i.p=2,p)return p()}finally{c.T=m,i.p=y,i.d.f()}},Yt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(p,m))},Yt.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},Yt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var y=m.as,g=h(y,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;y==="style"?i.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:g,integrity:x,fetchPriority:b}):y==="script"&&i.d.X(p,{crossOrigin:g,integrity:x,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Yt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var y=h(m.as,m.crossOrigin);i.d.M(p,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(p)},Yt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var y=m.as,g=h(y,m.crossOrigin);i.d.L(p,y,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Yt.preloadModule=function(p,m){if(typeof p=="string")if(m){var y=h(m.as,m.crossOrigin);i.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(p)},Yt.requestFormReset=function(p){i.d.r(p)},Yt.unstable_batchedUpdates=function(p,m){return p(m)},Yt.useFormState=function(p,m,y){return c.H.useFormState(p,m,y)},Yt.useFormStatus=function(){return c.H.useHostTransitionStatus()},Yt.version="19.2.4",Yt}var kd;function Cd(){if(kd)return Vo.exports;kd=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Vo.exports=Mv(),Vo.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Td;function Ov(){if(Td)return Oa;Td=1;var t=Dv(),r=Bo(),a=Cd();function i(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function s(e){var n=e,l=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(l=n.return),e=n.return;while(e)}return n.tag===3?l:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function p(e){if(s(e)!==e)throw Error(i(188))}function m(e){var n=e.alternate;if(!n){if(n=s(e),n===null)throw Error(i(188));return n!==e?null:e}for(var l=e,u=n;;){var f=l.return;if(f===null)break;var d=f.alternate;if(d===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===d.child){for(d=f.child;d;){if(d===l)return p(f),e;if(d===u)return p(f),n;d=d.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=d;else{for(var v=!1,S=f.child;S;){if(S===l){v=!0,l=f,u=d;break}if(S===u){v=!0,u=f,l=d;break}S=S.sibling}if(!v){for(S=d.child;S;){if(S===l){v=!0,l=d,u=f;break}if(S===u){v=!0,u=d,l=f;break}S=S.sibling}if(!v)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?e:n}function y(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=y(e),n!==null)return n;e=e.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),H=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),de=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function ae(e){return e===null||typeof e!="object"?null:(e=ne&&e[ne]||e["@@iterator"],typeof e=="function"?e:null)}var Ae=Symbol.for("react.client.reference");function he(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ae?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case R:return"Profiler";case N:return"StrictMode";case K:return"Suspense";case q:return"SuspenseList";case de:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case k:return"Portal";case H:return e.displayName||"Context";case _:return(e._context.displayName||"Context")+".Consumer";case ie:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case M:return n=e.displayName||null,n!==null?n:he(e.type)||"Memo";case le:n=e._payload,e=e._init;try{return he(e(n))}catch{}}return null}var te=Array.isArray,U=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},Ce=[],C=-1;function A(e){return{current:e}}function Z(e){0>C||(e.current=Ce[C],Ce[C]=null,C--)}function E(e,n){C++,Ce[C]=e.current,e.current=n}var oe=A(null),pe=A(null),ge=A(null),je=A(null);function Je(e,n){switch(E(ge,n),E(pe,e),E(oe,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Z0(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Z0(n),e=K0(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Z(oe),E(oe,e)}function et(){Z(oe),Z(pe),Z(ge)}function Jt(e){e.memoizedState!==null&&E(je,e);var n=oe.current,l=K0(n,e.type);n!==l&&(E(pe,e),E(oe,l))}function Un(e){pe.current===e&&(Z(oe),Z(pe)),je.current===e&&(Z(je),Xi._currentValue=ue)}var yt,Bn;function kn(e){if(yt===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);yt=n&&n[1]||"",Bn=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+yt+e+Bn}var Ll=!1;function Pt(e,n){if(!e||Ll)return"";Ll=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(n){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(Q){var G=Q}Reflect.construct(e,[],W)}else{try{W.call()}catch(Q){G=Q}e.call(W.prototype)}}else{try{throw Error()}catch(Q){G=Q}(W=e())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(Q){if(Q&&G&&typeof Q.stack=="string")return[Q.stack,G.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var d=u.DetermineComponentFrameRoot(),v=d[0],S=d[1];if(v&&S){var z=v.split(`
`),F=S.split(`
`);for(f=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;f<F.length&&!F[f].includes("DetermineComponentFrameRoot");)f++;if(u===z.length||f===F.length)for(u=z.length-1,f=F.length-1;1<=u&&0<=f&&z[u]!==F[f];)f--;for(;1<=u&&0<=f;u--,f--)if(z[u]!==F[f]){if(u!==1||f!==1)do if(u--,f--,0>f||z[u]!==F[f]){var I=`
`+z[u].replace(" at new "," at ");return e.displayName&&I.includes("<anonymous>")&&(I=I.replace("<anonymous>",e.displayName)),I}while(1<=u&&0<=f);break}}}finally{Ll=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?kn(l):""}function Jr(e,n){switch(e.tag){case 26:case 27:case 5:return kn(e.type);case 16:return kn("Lazy");case 13:return e.child!==n&&n!==null?kn("Suspense Fallback"):kn("Suspense");case 19:return kn("SuspenseList");case 0:case 15:return Pt(e.type,!1);case 11:return Pt(e.type.render,!1);case 1:return Pt(e.type,!0);case 31:return kn("Activity");default:return""}}function Pr(e){try{var n="",l=null;do n+=Jr(e,l),l=e,e=e.return;while(e);return n}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var al=Object.prototype.hasOwnProperty,Ul=t.unstable_scheduleCallback,pr=t.unstable_cancelCallback,ai=t.unstable_shouldYield,ii=t.unstable_requestPaint,pt=t.unstable_now,il=t.unstable_getCurrentPriorityLevel,J=t.unstable_ImmediatePriority,se=t.unstable_UserBlockingPriority,we=t.unstable_NormalPriority,Re=t.unstable_LowPriority,Ie=t.unstable_IdlePriority,Qt=t.log,cn=t.unstable_setDisableYieldValue,_t=null,nt=null;function jt(e){if(typeof Qt=="function"&&cn(e),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(_t,e)}catch{}}var tt=Math.clz32?Math.clz32:Su,Hn=Math.log,fn=Math.LN2;function Su(e){return e>>>=0,e===0?32:31-(Hn(e)/fn|0)|0}var ul=256,gr=262144,Bl=4194304;function ol(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function yr(e,n,l){var u=e.pendingLanes;if(u===0)return 0;var f=0,d=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var S=u&134217727;return S!==0?(u=S&~d,u!==0?f=ol(u):(v&=S,v!==0?f=ol(v):l||(l=S&~e,l!==0&&(f=ol(l))))):(S=u&~d,S!==0?f=ol(S):v!==0?f=ol(v):l||(l=u&~e,l!==0&&(f=ol(l)))),f===0?0:n!==0&&n!==f&&(n&d)===0&&(d=f&-f,l=n&-n,d>=l||d===32&&(l&4194048)!==0)?n:f}function vr(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function wu(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function br(){var e=Bl;return Bl<<=1,(Bl&62914560)===0&&(Bl=4194304),e}function Hl(e){for(var n=[],l=0;31>l;l++)n.push(e);return n}function ql(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function sc(e,n,l,u,f,d){var v=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var S=e.entanglements,z=e.expirationTimes,F=e.hiddenUpdates;for(l=v&~l;0<l;){var I=31-tt(l),W=1<<I;S[I]=0,z[I]=-1;var G=F[I];if(G!==null)for(F[I]=null,I=0;I<G.length;I++){var Q=G[I];Q!==null&&(Q.lane&=-536870913)}l&=~W}u!==0&&Eu(e,u,0),d!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=d&~(v&~n))}function Eu(e,n,l){e.pendingLanes|=n,e.suspendedLanes&=~n;var u=31-tt(n);e.entangledLanes|=n,e.entanglements[u]=e.entanglements[u]|1073741824|l&261930}function T(e,n){var l=e.entangledLanes|=n;for(e=e.entanglements;l;){var u=31-tt(l),f=1<<u;f&n|e[u]&n&&(e[u]|=n),l&=~f}}function L(e,n){var l=n&-n;return l=(l&42)!==0?1:X(l),(l&(e.suspendedLanes|n))!==0?0:l}function X(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ee(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ce(){var e=$.p;return e!==0?e:(e=window.event,e===void 0?32:yv(e.type))}function Se(e,n){var l=$.p;try{return $.p=e,n()}finally{$.p=l}}var ve=Math.random().toString(36).slice(2),fe="__reactFiber$"+ve,me="__reactProps$"+ve,be="__reactContainer$"+ve,De="__reactEvents$"+ve,Ee="__reactListeners$"+ve,Oe="__reactHandles$"+ve,He="__reactResources$"+ve,gt="__reactMarker$"+ve;function vt(e){delete e[fe],delete e[me],delete e[De],delete e[Ee],delete e[Oe]}function bt(e){var n=e[fe];if(n)return n;for(var l=e.parentNode;l;){if(n=l[be]||l[fe]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(e=tv(e);e!==null;){if(l=e[fe])return l;e=tv(e)}return n}e=l,l=e.parentNode}return null}function Ge(e){if(e=e[fe]||e[be]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Ot(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(i(33))}function $t(e){var n=e[He];return n||(n=e[He]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ht(e){e[gt]=!0}var qn=new Set,dn={};function Yn(e,n){Cn(e,n),Cn(e+"Capture",n)}function Cn(e,n){for(dn[e]=n,e=0;e<n.length;e++)qn.add(n[e])}var sl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xr={},Sr={};function Xe(e){return al.call(Sr,e)?!0:al.call(xr,e)?!1:sl.test(e)?Sr[e]=!0:(xr[e]=!0,!1)}function Et(e,n,l){if(Xe(n))if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var u=n.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+l)}}function Vn(e,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+l)}}function Lt(e,n,l,u){if(u===null)e.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(n,l,""+u)}}function Qe(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wr(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function ku(e,n,l){var u=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,d=u.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,d.call(this,v)}}),Object.defineProperty(e,n,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function ui(e){if(!e._valueTracker){var n=wr(e)?"checked":"value";e._valueTracker=ku(e,n,""+e[n])}}function qp(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var l=n.getValue(),u="";return e&&(u=wr(e)?e.checked?"true":"false":e.value),e=u,e!==l?(n.setValue(e),!0):!1}function Cu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var l4=/[\n"\\]/g;function Tn(e){return e.replace(l4,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function cc(e,n,l,u,f,d,v,S){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Qe(n)):e.value!==""+Qe(n)&&(e.value=""+Qe(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?fc(e,v,Qe(n)):l!=null?fc(e,v,Qe(l)):u!=null&&e.removeAttribute("value"),f==null&&d!=null&&(e.defaultChecked=!!d),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+Qe(S):e.removeAttribute("name")}function Yp(e,n,l,u,f,d,v,S){if(d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.type=d),n!=null||l!=null){if(!(d!=="submit"&&d!=="reset"||n!=null)){ui(e);return}l=l!=null?""+Qe(l):"",n=n!=null?""+Qe(n):l,S||n===e.value||(e.value=n),e.defaultValue=n}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=S?e.checked:!!u,e.defaultChecked=!!u,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),ui(e)}function fc(e,n,l){n==="number"&&Cu(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function $r(e,n,l,u){if(e=e.options,n){n={};for(var f=0;f<l.length;f++)n["$"+l[f]]=!0;for(l=0;l<e.length;l++)f=n.hasOwnProperty("$"+e[l].value),e[l].selected!==f&&(e[l].selected=f),f&&u&&(e[l].defaultSelected=!0)}else{for(l=""+Qe(l),n=null,f=0;f<e.length;f++){if(e[f].value===l){e[f].selected=!0,u&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function Vp(e,n,l){if(n!=null&&(n=""+Qe(n),n!==e.value&&(e.value=n),l==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=l!=null?""+Qe(l):""}function Fp(e,n,l,u){if(n==null){if(u!=null){if(l!=null)throw Error(i(92));if(te(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),n=l}l=Qe(n),e.defaultValue=l,u=e.textContent,u===l&&u!==""&&u!==null&&(e.value=u),ui(e)}function Wr(e,n){if(n){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=n;return}}e.textContent=n}var r4=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gp(e,n,l){var u=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":u?e.setProperty(n,l):typeof l!="number"||l===0||r4.has(n)?n==="float"?e.cssFloat=l:e[n]=(""+l).trim():e[n]=l+"px"}function Xp(e,n,l){if(n!=null&&typeof n!="object")throw Error(i(62));if(e=e.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||n!=null&&n.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var f in n)u=n[f],n.hasOwnProperty(f)&&l[f]!==u&&Gp(e,f,u)}else for(var d in n)n.hasOwnProperty(d)&&Gp(e,d,n[d])}function dc(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var a4=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),i4=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tu(e){return i4.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function cl(){}var hc=null;function mc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ea=null,ta=null;function Qp(e){var n=Ge(e);if(n&&(e=n.stateNode)){var l=e[me]||null;e:switch(e=n.stateNode,n.type){case"input":if(cc(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Tn(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var u=l[n];if(u!==e&&u.form===e.form){var f=u[me]||null;if(!f)throw Error(i(90));cc(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<l.length;n++)u=l[n],u.form===e.form&&qp(u)}break e;case"textarea":Vp(e,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&$r(e,!!l.multiple,n,!1)}}}var pc=!1;function Zp(e,n,l){if(pc)return e(n,l);pc=!0;try{var u=e(n);return u}finally{if(pc=!1,(ea!==null||ta!==null)&&(mo(),ea&&(n=ea,e=ta,ta=ea=null,Qp(n),e)))for(n=0;n<e.length;n++)Qp(e[n])}}function oi(e,n){var l=e.stateNode;if(l===null)return null;var u=l[me]||null;if(u===null)return null;l=u[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(i(231,n,typeof l));return l}var fl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gc=!1;if(fl)try{var si={};Object.defineProperty(si,"passive",{get:function(){gc=!0}}),window.addEventListener("test",si,si),window.removeEventListener("test",si,si)}catch{gc=!1}var Yl=null,yc=null,zu=null;function Kp(){if(zu)return zu;var e,n=yc,l=n.length,u,f="value"in Yl?Yl.value:Yl.textContent,d=f.length;for(e=0;e<l&&n[e]===f[e];e++);var v=l-e;for(u=1;u<=v&&n[l-u]===f[d-u];u++);return zu=f.slice(e,1<u?1-u:void 0)}function Au(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Ru(){return!0}function Ip(){return!1}function Wt(e){function n(l,u,f,d,v){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=d,this.target=v,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(l=e[S],this[S]=l?l(d):d[S]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Ru:Ip,this.isPropagationStopped=Ip,this}return g(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ru)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ru)},persist:function(){},isPersistent:Ru}),n}var Er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Du=Wt(Er),ci=g({},Er,{view:0,detail:0}),u4=Wt(ci),vc,bc,fi,Mu=g({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fi&&(fi&&e.type==="mousemove"?(vc=e.screenX-fi.screenX,bc=e.screenY-fi.screenY):bc=vc=0,fi=e),vc)},movementY:function(e){return"movementY"in e?e.movementY:bc}}),Jp=Wt(Mu),o4=g({},Mu,{dataTransfer:0}),s4=Wt(o4),c4=g({},ci,{relatedTarget:0}),xc=Wt(c4),f4=g({},Er,{animationName:0,elapsedTime:0,pseudoElement:0}),d4=Wt(f4),h4=g({},Er,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),m4=Wt(h4),p4=g({},Er,{data:0}),Pp=Wt(p4),g4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},y4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b4(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=v4[e])?!!n[e]:!1}function Sc(){return b4}var x4=g({},ci,{key:function(e){if(e.key){var n=g4[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Au(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?y4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sc,charCode:function(e){return e.type==="keypress"?Au(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Au(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),S4=Wt(x4),w4=g({},Mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$p=Wt(w4),E4=g({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sc}),k4=Wt(E4),C4=g({},Er,{propertyName:0,elapsedTime:0,pseudoElement:0}),T4=Wt(C4),z4=g({},Mu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),A4=Wt(z4),R4=g({},Er,{newState:0,oldState:0}),D4=Wt(R4),M4=[9,13,27,32],wc=fl&&"CompositionEvent"in window,di=null;fl&&"documentMode"in document&&(di=document.documentMode);var O4=fl&&"TextEvent"in window&&!di,Wp=fl&&(!wc||di&&8<di&&11>=di),eg=" ",tg=!1;function ng(e,n){switch(e){case"keyup":return M4.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var na=!1;function N4(e,n){switch(e){case"compositionend":return lg(n);case"keypress":return n.which!==32?null:(tg=!0,eg);case"textInput":return e=n.data,e===eg&&tg?null:e;default:return null}}function _4(e,n){if(na)return e==="compositionend"||!wc&&ng(e,n)?(e=Kp(),zu=yc=Yl=null,na=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Wp&&n.locale!=="ko"?null:n.data;default:return null}}var j4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rg(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!j4[e.type]:n==="textarea"}function ag(e,n,l,u){ea?ta?ta.push(u):ta=[u]:ea=u,n=So(n,"onChange"),0<n.length&&(l=new Du("onChange","change",null,l,u),e.push({event:l,listeners:n}))}var hi=null,mi=null;function L4(e){Y0(e,0)}function Ou(e){var n=Ot(e);if(qp(n))return e}function ig(e,n){if(e==="change")return n}var ug=!1;if(fl){var Ec;if(fl){var kc="oninput"in document;if(!kc){var og=document.createElement("div");og.setAttribute("oninput","return;"),kc=typeof og.oninput=="function"}Ec=kc}else Ec=!1;ug=Ec&&(!document.documentMode||9<document.documentMode)}function sg(){hi&&(hi.detachEvent("onpropertychange",cg),mi=hi=null)}function cg(e){if(e.propertyName==="value"&&Ou(mi)){var n=[];ag(n,mi,e,mc(e)),Zp(L4,n)}}function U4(e,n,l){e==="focusin"?(sg(),hi=n,mi=l,hi.attachEvent("onpropertychange",cg)):e==="focusout"&&sg()}function B4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ou(mi)}function H4(e,n){if(e==="click")return Ou(n)}function q4(e,n){if(e==="input"||e==="change")return Ou(n)}function Y4(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var hn=typeof Object.is=="function"?Object.is:Y4;function pi(e,n){if(hn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var l=Object.keys(e),u=Object.keys(n);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!al.call(n,f)||!hn(e[f],n[f]))return!1}return!0}function fg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dg(e,n){var l=fg(e);e=0;for(var u;l;){if(l.nodeType===3){if(u=e+l.textContent.length,e<=n&&u>=n)return{node:l,offset:n-e};e=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fg(l)}}function hg(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?hg(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function mg(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Cu(e.document);n instanceof e.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)e=n.contentWindow;else break;n=Cu(e.document)}return n}function Cc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var V4=fl&&"documentMode"in document&&11>=document.documentMode,la=null,Tc=null,gi=null,zc=!1;function pg(e,n,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;zc||la==null||la!==Cu(u)||(u=la,"selectionStart"in u&&Cc(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),gi&&pi(gi,u)||(gi=u,u=So(Tc,"onSelect"),0<u.length&&(n=new Du("onSelect","select",null,n,l),e.push({event:n,listeners:u}),n.target=la)))}function kr(e,n){var l={};return l[e.toLowerCase()]=n.toLowerCase(),l["Webkit"+e]="webkit"+n,l["Moz"+e]="moz"+n,l}var ra={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionrun:kr("Transition","TransitionRun"),transitionstart:kr("Transition","TransitionStart"),transitioncancel:kr("Transition","TransitionCancel"),transitionend:kr("Transition","TransitionEnd")},Ac={},gg={};fl&&(gg=document.createElement("div").style,"AnimationEvent"in window||(delete ra.animationend.animation,delete ra.animationiteration.animation,delete ra.animationstart.animation),"TransitionEvent"in window||delete ra.transitionend.transition);function Cr(e){if(Ac[e])return Ac[e];if(!ra[e])return e;var n=ra[e],l;for(l in n)if(n.hasOwnProperty(l)&&l in gg)return Ac[e]=n[l];return e}var yg=Cr("animationend"),vg=Cr("animationiteration"),bg=Cr("animationstart"),F4=Cr("transitionrun"),G4=Cr("transitionstart"),X4=Cr("transitioncancel"),xg=Cr("transitionend"),Sg=new Map,Rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rc.push("scrollEnd");function Fn(e,n){Sg.set(e,n),Yn(n,[e])}var Nu=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},zn=[],aa=0,Dc=0;function _u(){for(var e=aa,n=Dc=aa=0;n<e;){var l=zn[n];zn[n++]=null;var u=zn[n];zn[n++]=null;var f=zn[n];zn[n++]=null;var d=zn[n];if(zn[n++]=null,u!==null&&f!==null){var v=u.pending;v===null?f.next=f:(f.next=v.next,v.next=f),u.pending=f}d!==0&&wg(l,f,d)}}function ju(e,n,l,u){zn[aa++]=e,zn[aa++]=n,zn[aa++]=l,zn[aa++]=u,Dc|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function Mc(e,n,l,u){return ju(e,n,l,u),Lu(e)}function Tr(e,n){return ju(e,null,null,n),Lu(e)}function wg(e,n,l){e.lanes|=l;var u=e.alternate;u!==null&&(u.lanes|=l);for(var f=!1,d=e.return;d!==null;)d.childLanes|=l,u=d.alternate,u!==null&&(u.childLanes|=l),d.tag===22&&(e=d.stateNode,e===null||e._visibility&1||(f=!0)),e=d,d=d.return;return e.tag===3?(d=e.stateNode,f&&n!==null&&(f=31-tt(l),e=d.hiddenUpdates,u=e[f],u===null?e[f]=[n]:u.push(n),n.lane=l|536870912),d):null}function Lu(e){if(50<Bi)throw Bi=0,Yf=null,Error(i(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var ia={};function Q4(e,n,l,u){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(e,n,l,u){return new Q4(e,n,l,u)}function Oc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dl(e,n){var l=e.alternate;return l===null?(l=mn(e.tag,n,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=n,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,n=e.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function Eg(e,n){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,n=l.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Uu(e,n,l,u,f,d){var v=0;if(u=e,typeof e=="function")Oc(e)&&(v=1);else if(typeof e=="string")v=PT(e,l,oe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case de:return e=mn(31,l,n,f),e.elementType=de,e.lanes=d,e;case D:return zr(l.children,f,d,n);case N:v=8,f|=24;break;case R:return e=mn(12,l,n,f|2),e.elementType=R,e.lanes=d,e;case K:return e=mn(13,l,n,f),e.elementType=K,e.lanes=d,e;case q:return e=mn(19,l,n,f),e.elementType=q,e.lanes=d,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case H:v=10;break e;case _:v=9;break e;case ie:v=11;break e;case M:v=14;break e;case le:v=16,u=null;break e}v=29,l=Error(i(130,e===null?"null":typeof e,"")),u=null}return n=mn(v,l,n,f),n.elementType=e,n.type=u,n.lanes=d,n}function zr(e,n,l,u){return e=mn(7,e,u,n),e.lanes=l,e}function Nc(e,n,l){return e=mn(6,e,null,n),e.lanes=l,e}function kg(e){var n=mn(18,null,null,0);return n.stateNode=e,n}function _c(e,n,l){return n=mn(4,e.children!==null?e.children:[],e.key,n),n.lanes=l,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Cg=new WeakMap;function An(e,n){if(typeof e=="object"&&e!==null){var l=Cg.get(e);return l!==void 0?l:(n={value:e,source:n,stack:Pr(n)},Cg.set(e,n),n)}return{value:e,source:n,stack:Pr(n)}}var ua=[],oa=0,Bu=null,yi=0,Rn=[],Dn=0,Vl=null,Jn=1,Pn="";function hl(e,n){ua[oa++]=yi,ua[oa++]=Bu,Bu=e,yi=n}function Tg(e,n,l){Rn[Dn++]=Jn,Rn[Dn++]=Pn,Rn[Dn++]=Vl,Vl=e;var u=Jn;e=Pn;var f=32-tt(u)-1;u&=~(1<<f),l+=1;var d=32-tt(n)+f;if(30<d){var v=f-f%5;d=(u&(1<<v)-1).toString(32),u>>=v,f-=v,Jn=1<<32-tt(n)+f|l<<f|u,Pn=d+e}else Jn=1<<d|l<<f|u,Pn=e}function jc(e){e.return!==null&&(hl(e,1),Tg(e,1,0))}function Lc(e){for(;e===Bu;)Bu=ua[--oa],ua[oa]=null,yi=ua[--oa],ua[oa]=null;for(;e===Vl;)Vl=Rn[--Dn],Rn[Dn]=null,Pn=Rn[--Dn],Rn[Dn]=null,Jn=Rn[--Dn],Rn[Dn]=null}function zg(e,n){Rn[Dn++]=Jn,Rn[Dn++]=Pn,Rn[Dn++]=Vl,Jn=n.id,Pn=n.overflow,Vl=e}var Ut=null,ft=null,Ze=!1,Fl=null,Mn=!1,Uc=Error(i(519));function Gl(e){var n=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vi(An(n,e)),Uc}function Ag(e){var n=e.stateNode,l=e.type,u=e.memoizedProps;switch(n[fe]=e,n[me]=u,l){case"dialog":Ye("cancel",n),Ye("close",n);break;case"iframe":case"object":case"embed":Ye("load",n);break;case"video":case"audio":for(l=0;l<qi.length;l++)Ye(qi[l],n);break;case"source":Ye("error",n);break;case"img":case"image":case"link":Ye("error",n),Ye("load",n);break;case"details":Ye("toggle",n);break;case"input":Ye("invalid",n),Yp(n,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ye("invalid",n);break;case"textarea":Ye("invalid",n),Fp(n,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||u.suppressHydrationWarning===!0||X0(n.textContent,l)?(u.popover!=null&&(Ye("beforetoggle",n),Ye("toggle",n)),u.onScroll!=null&&Ye("scroll",n),u.onScrollEnd!=null&&Ye("scrollend",n),u.onClick!=null&&(n.onclick=cl),n=!0):n=!1,n||Gl(e,!0)}function Rg(e){for(Ut=e.return;Ut;)switch(Ut.tag){case 5:case 31:case 13:Mn=!1;return;case 27:case 3:Mn=!0;return;default:Ut=Ut.return}}function sa(e){if(e!==Ut)return!1;if(!Ze)return Rg(e),Ze=!0,!1;var n=e.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||nd(e.type,e.memoizedProps)),l=!l),l&&ft&&Gl(e),Rg(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));ft=ev(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));ft=ev(e)}else n===27?(n=ft,rr(e.type)?(e=ud,ud=null,ft=e):ft=n):ft=Ut?Nn(e.stateNode.nextSibling):null;return!0}function Ar(){ft=Ut=null,Ze=!1}function Bc(){var e=Fl;return e!==null&&(ln===null?ln=e:ln.push.apply(ln,e),Fl=null),e}function vi(e){Fl===null?Fl=[e]:Fl.push(e)}var Hc=A(null),Rr=null,ml=null;function Xl(e,n,l){E(Hc,n._currentValue),n._currentValue=l}function pl(e){e._currentValue=Hc.current,Z(Hc)}function qc(e,n,l){for(;e!==null;){var u=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,u!==null&&(u.childLanes|=n)):u!==null&&(u.childLanes&n)!==n&&(u.childLanes|=n),e===l)break;e=e.return}}function Yc(e,n,l,u){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var d=f.dependencies;if(d!==null){var v=f.child;d=d.firstContext;e:for(;d!==null;){var S=d;d=f;for(var z=0;z<n.length;z++)if(S.context===n[z]){d.lanes|=l,S=d.alternate,S!==null&&(S.lanes|=l),qc(d.return,l,e),u||(v=null);break e}d=S.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=l,d=v.alternate,d!==null&&(d.lanes|=l),qc(v,l,e),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===e){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function ca(e,n,l,u){e=null;for(var f=n,d=!1;f!==null;){if(!d){if((f.flags&524288)!==0)d=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var S=f.type;hn(f.pendingProps.value,v.value)||(e!==null?e.push(S):e=[S])}}else if(f===je.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(Xi):e=[Xi])}f=f.return}e!==null&&Yc(n,e,l,u),n.flags|=262144}function Hu(e){for(e=e.firstContext;e!==null;){if(!hn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Dr(e){Rr=e,ml=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bt(e){return Dg(Rr,e)}function qu(e,n){return Rr===null&&Dr(e),Dg(e,n)}function Dg(e,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},ml===null){if(e===null)throw Error(i(308));ml=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else ml=ml.next=n;return l}var Z4=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(l,u){e.push(u)}};this.abort=function(){n.aborted=!0,e.forEach(function(l){return l()})}},K4=t.unstable_scheduleCallback,I4=t.unstable_NormalPriority,zt={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vc(){return{controller:new Z4,data:new Map,refCount:0}}function bi(e){e.refCount--,e.refCount===0&&K4(I4,function(){e.controller.abort()})}var xi=null,Fc=0,fa=0,da=null;function J4(e,n){if(xi===null){var l=xi=[];Fc=0,fa=Zf(),da={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Fc++,n.then(Mg,Mg),n}function Mg(){if(--Fc===0&&xi!==null){da!==null&&(da.status="fulfilled");var e=xi;xi=null,fa=0,da=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function P4(e,n){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return e.then(function(){u.status="fulfilled",u.value=n;for(var f=0;f<l.length;f++)(0,l[f])(n)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var Og=U.S;U.S=function(e,n){p0=pt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&J4(e,n),Og!==null&&Og(e,n)};var Mr=A(null);function Gc(){var e=Mr.current;return e!==null?e:st.pooledCache}function Yu(e,n){n===null?E(Mr,Mr.current):E(Mr,n.pool)}function Ng(){var e=Gc();return e===null?null:{parent:zt._currentValue,pool:e}}var ha=Error(i(460)),Xc=Error(i(474)),Vu=Error(i(542)),Fu={then:function(){}};function _g(e){return e=e.status,e==="fulfilled"||e==="rejected"}function jg(e,n,l){switch(l=e[l],l===void 0?e.push(n):l!==n&&(n.then(cl,cl),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ug(e),e;default:if(typeof n.status=="string")n.then(cl,cl);else{if(e=st,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=n,e.status="pending",e.then(function(u){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=u}},function(u){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=u}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ug(e),e}throw Nr=n,ha}}function Or(e){try{var n=e._init;return n(e._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Nr=l,ha):l}}var Nr=null;function Lg(){if(Nr===null)throw Error(i(459));var e=Nr;return Nr=null,e}function Ug(e){if(e===ha||e===Vu)throw Error(i(483))}var ma=null,Si=0;function Gu(e){var n=Si;return Si+=1,ma===null&&(ma=[]),jg(ma,e,n)}function wi(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Xu(e,n){throw n.$$typeof===x?Error(i(525)):(e=Object.prototype.toString.call(n),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Bg(e){function n(B,O){if(e){var V=B.deletions;V===null?(B.deletions=[O],B.flags|=16):V.push(O)}}function l(B,O){if(!e)return null;for(;O!==null;)n(B,O),O=O.sibling;return null}function u(B){for(var O=new Map;B!==null;)B.key!==null?O.set(B.key,B):O.set(B.index,B),B=B.sibling;return O}function f(B,O){return B=dl(B,O),B.index=0,B.sibling=null,B}function d(B,O,V){return B.index=V,e?(V=B.alternate,V!==null?(V=V.index,V<O?(B.flags|=67108866,O):V):(B.flags|=67108866,O)):(B.flags|=1048576,O)}function v(B){return e&&B.alternate===null&&(B.flags|=67108866),B}function S(B,O,V,P){return O===null||O.tag!==6?(O=Nc(V,B.mode,P),O.return=B,O):(O=f(O,V),O.return=B,O)}function z(B,O,V,P){var ke=V.type;return ke===D?I(B,O,V.props.children,P,V.key):O!==null&&(O.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===le&&Or(ke)===O.type)?(O=f(O,V.props),wi(O,V),O.return=B,O):(O=Uu(V.type,V.key,V.props,null,B.mode,P),wi(O,V),O.return=B,O)}function F(B,O,V,P){return O===null||O.tag!==4||O.stateNode.containerInfo!==V.containerInfo||O.stateNode.implementation!==V.implementation?(O=_c(V,B.mode,P),O.return=B,O):(O=f(O,V.children||[]),O.return=B,O)}function I(B,O,V,P,ke){return O===null||O.tag!==7?(O=zr(V,B.mode,P,ke),O.return=B,O):(O=f(O,V),O.return=B,O)}function W(B,O,V){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=Nc(""+O,B.mode,V),O.return=B,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case b:return V=Uu(O.type,O.key,O.props,null,B.mode,V),wi(V,O),V.return=B,V;case k:return O=_c(O,B.mode,V),O.return=B,O;case le:return O=Or(O),W(B,O,V)}if(te(O)||ae(O))return O=zr(O,B.mode,V,null),O.return=B,O;if(typeof O.then=="function")return W(B,Gu(O),V);if(O.$$typeof===H)return W(B,qu(B,O),V);Xu(B,O)}return null}function G(B,O,V,P){var ke=O!==null?O.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return ke!==null?null:S(B,O,""+V,P);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return V.key===ke?z(B,O,V,P):null;case k:return V.key===ke?F(B,O,V,P):null;case le:return V=Or(V),G(B,O,V,P)}if(te(V)||ae(V))return ke!==null?null:I(B,O,V,P,null);if(typeof V.then=="function")return G(B,O,Gu(V),P);if(V.$$typeof===H)return G(B,O,qu(B,V),P);Xu(B,V)}return null}function Q(B,O,V,P,ke){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return B=B.get(V)||null,S(O,B,""+P,ke);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case b:return B=B.get(P.key===null?V:P.key)||null,z(O,B,P,ke);case k:return B=B.get(P.key===null?V:P.key)||null,F(O,B,P,ke);case le:return P=Or(P),Q(B,O,V,P,ke)}if(te(P)||ae(P))return B=B.get(V)||null,I(O,B,P,ke,null);if(typeof P.then=="function")return Q(B,O,V,Gu(P),ke);if(P.$$typeof===H)return Q(B,O,V,qu(O,P),ke);Xu(O,P)}return null}function ye(B,O,V,P){for(var ke=null,Pe=null,xe=O,Le=O=0,Fe=null;xe!==null&&Le<V.length;Le++){xe.index>Le?(Fe=xe,xe=null):Fe=xe.sibling;var $e=G(B,xe,V[Le],P);if($e===null){xe===null&&(xe=Fe);break}e&&xe&&$e.alternate===null&&n(B,xe),O=d($e,O,Le),Pe===null?ke=$e:Pe.sibling=$e,Pe=$e,xe=Fe}if(Le===V.length)return l(B,xe),Ze&&hl(B,Le),ke;if(xe===null){for(;Le<V.length;Le++)xe=W(B,V[Le],P),xe!==null&&(O=d(xe,O,Le),Pe===null?ke=xe:Pe.sibling=xe,Pe=xe);return Ze&&hl(B,Le),ke}for(xe=u(xe);Le<V.length;Le++)Fe=Q(xe,B,Le,V[Le],P),Fe!==null&&(e&&Fe.alternate!==null&&xe.delete(Fe.key===null?Le:Fe.key),O=d(Fe,O,Le),Pe===null?ke=Fe:Pe.sibling=Fe,Pe=Fe);return e&&xe.forEach(function(sr){return n(B,sr)}),Ze&&hl(B,Le),ke}function ze(B,O,V,P){if(V==null)throw Error(i(151));for(var ke=null,Pe=null,xe=O,Le=O=0,Fe=null,$e=V.next();xe!==null&&!$e.done;Le++,$e=V.next()){xe.index>Le?(Fe=xe,xe=null):Fe=xe.sibling;var sr=G(B,xe,$e.value,P);if(sr===null){xe===null&&(xe=Fe);break}e&&xe&&sr.alternate===null&&n(B,xe),O=d(sr,O,Le),Pe===null?ke=sr:Pe.sibling=sr,Pe=sr,xe=Fe}if($e.done)return l(B,xe),Ze&&hl(B,Le),ke;if(xe===null){for(;!$e.done;Le++,$e=V.next())$e=W(B,$e.value,P),$e!==null&&(O=d($e,O,Le),Pe===null?ke=$e:Pe.sibling=$e,Pe=$e);return Ze&&hl(B,Le),ke}for(xe=u(xe);!$e.done;Le++,$e=V.next())$e=Q(xe,B,Le,$e.value,P),$e!==null&&(e&&$e.alternate!==null&&xe.delete($e.key===null?Le:$e.key),O=d($e,O,Le),Pe===null?ke=$e:Pe.sibling=$e,Pe=$e);return e&&xe.forEach(function(oz){return n(B,oz)}),Ze&&hl(B,Le),ke}function ut(B,O,V,P){if(typeof V=="object"&&V!==null&&V.type===D&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case b:e:{for(var ke=V.key;O!==null;){if(O.key===ke){if(ke=V.type,ke===D){if(O.tag===7){l(B,O.sibling),P=f(O,V.props.children),P.return=B,B=P;break e}}else if(O.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===le&&Or(ke)===O.type){l(B,O.sibling),P=f(O,V.props),wi(P,V),P.return=B,B=P;break e}l(B,O);break}else n(B,O);O=O.sibling}V.type===D?(P=zr(V.props.children,B.mode,P,V.key),P.return=B,B=P):(P=Uu(V.type,V.key,V.props,null,B.mode,P),wi(P,V),P.return=B,B=P)}return v(B);case k:e:{for(ke=V.key;O!==null;){if(O.key===ke)if(O.tag===4&&O.stateNode.containerInfo===V.containerInfo&&O.stateNode.implementation===V.implementation){l(B,O.sibling),P=f(O,V.children||[]),P.return=B,B=P;break e}else{l(B,O);break}else n(B,O);O=O.sibling}P=_c(V,B.mode,P),P.return=B,B=P}return v(B);case le:return V=Or(V),ut(B,O,V,P)}if(te(V))return ye(B,O,V,P);if(ae(V)){if(ke=ae(V),typeof ke!="function")throw Error(i(150));return V=ke.call(V),ze(B,O,V,P)}if(typeof V.then=="function")return ut(B,O,Gu(V),P);if(V.$$typeof===H)return ut(B,O,qu(B,V),P);Xu(B,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,O!==null&&O.tag===6?(l(B,O.sibling),P=f(O,V),P.return=B,B=P):(l(B,O),P=Nc(V,B.mode,P),P.return=B,B=P),v(B)):l(B,O)}return function(B,O,V,P){try{Si=0;var ke=ut(B,O,V,P);return ma=null,ke}catch(xe){if(xe===ha||xe===Vu)throw xe;var Pe=mn(29,xe,null,B.mode);return Pe.lanes=P,Pe.return=B,Pe}finally{}}}var _r=Bg(!0),Hg=Bg(!1),Ql=!1;function Qc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Zl(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Kl(e,n,l){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(We&2)!==0){var f=u.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),u.pending=n,n=Lu(e),wg(e,null,l),n}return ju(e,u,n,l),Lu(e)}function Ei(e,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var u=n.lanes;u&=e.pendingLanes,l|=u,n.lanes=l,T(e,l)}}function Kc(e,n){var l=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,d=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};d===null?f=d=v:d=d.next=v,l=l.next}while(l!==null);d===null?f=d=n:d=d.next=n}else f=d=n;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:d,shared:u.shared,callbacks:u.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=n:e.next=n,l.lastBaseUpdate=n}var Ic=!1;function ki(){if(Ic){var e=da;if(e!==null)throw e}}function Ci(e,n,l,u){Ic=!1;var f=e.updateQueue;Ql=!1;var d=f.firstBaseUpdate,v=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var z=S,F=z.next;z.next=null,v===null?d=F:v.next=F,v=z;var I=e.alternate;I!==null&&(I=I.updateQueue,S=I.lastBaseUpdate,S!==v&&(S===null?I.firstBaseUpdate=F:S.next=F,I.lastBaseUpdate=z))}if(d!==null){var W=f.baseState;v=0,I=F=z=null,S=d;do{var G=S.lane&-536870913,Q=G!==S.lane;if(Q?(Ve&G)===G:(u&G)===G){G!==0&&G===fa&&(Ic=!0),I!==null&&(I=I.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var ye=e,ze=S;G=n;var ut=l;switch(ze.tag){case 1:if(ye=ze.payload,typeof ye=="function"){W=ye.call(ut,W,G);break e}W=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=ze.payload,G=typeof ye=="function"?ye.call(ut,W,G):ye,G==null)break e;W=g({},W,G);break e;case 2:Ql=!0}}G=S.callback,G!==null&&(e.flags|=64,Q&&(e.flags|=8192),Q=f.callbacks,Q===null?f.callbacks=[G]:Q.push(G))}else Q={lane:G,tag:S.tag,payload:S.payload,callback:S.callback,next:null},I===null?(F=I=Q,z=W):I=I.next=Q,v|=G;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;Q=S,S=Q.next,Q.next=null,f.lastBaseUpdate=Q,f.shared.pending=null}}while(!0);I===null&&(z=W),f.baseState=z,f.firstBaseUpdate=F,f.lastBaseUpdate=I,d===null&&(f.shared.lanes=0),Wl|=v,e.lanes=v,e.memoizedState=W}}function qg(e,n){if(typeof e!="function")throw Error(i(191,e));e.call(n)}function Yg(e,n){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)qg(l[e],n)}var pa=A(null),Qu=A(0);function Vg(e,n){e=kl,E(Qu,e),E(pa,n),kl=e|n.baseLanes}function Jc(){E(Qu,kl),E(pa,pa.current)}function Pc(){kl=Qu.current,Z(pa),Z(Qu)}var pn=A(null),On=null;function Il(e){var n=e.alternate;E(kt,kt.current&1),E(pn,e),On===null&&(n===null||pa.current!==null||n.memoizedState!==null)&&(On=e)}function $c(e){E(kt,kt.current),E(pn,e),On===null&&(On=e)}function Fg(e){e.tag===22?(E(kt,kt.current),E(pn,e),On===null&&(On=e)):Jl()}function Jl(){E(kt,kt.current),E(pn,pn.current)}function gn(e){Z(pn),On===e&&(On=null),Z(kt)}var kt=A(0);function Zu(e){for(var n=e;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||ad(l)||id(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var gl=0,Ne=null,at=null,At=null,Ku=!1,ga=!1,jr=!1,Iu=0,Ti=0,ya=null,$4=0;function xt(){throw Error(i(321))}function Wc(e,n){if(n===null)return!1;for(var l=0;l<n.length&&l<e.length;l++)if(!hn(e[l],n[l]))return!1;return!0}function ef(e,n,l,u,f,d){return gl=d,Ne=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,U.H=e===null||e.memoizedState===null?Ty:gf,jr=!1,d=l(u,f),jr=!1,ga&&(d=Xg(n,l,u,f)),Gg(e),d}function Gg(e){U.H=Ri;var n=at!==null&&at.next!==null;if(gl=0,At=at=Ne=null,Ku=!1,Ti=0,ya=null,n)throw Error(i(300));e===null||Rt||(e=e.dependencies,e!==null&&Hu(e)&&(Rt=!0))}function Xg(e,n,l,u){Ne=e;var f=0;do{if(ga&&(ya=null),Ti=0,ga=!1,25<=f)throw Error(i(301));if(f+=1,At=at=null,e.updateQueue!=null){var d=e.updateQueue;d.lastEffect=null,d.events=null,d.stores=null,d.memoCache!=null&&(d.memoCache.index=0)}U.H=zy,d=n(l,u)}while(ga);return d}function W4(){var e=U.H,n=e.useState()[0];return n=typeof n.then=="function"?zi(n):n,e=e.useState()[0],(at!==null?at.memoizedState:null)!==e&&(Ne.flags|=1024),n}function tf(){var e=Iu!==0;return Iu=0,e}function nf(e,n,l){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~l}function lf(e){if(Ku){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Ku=!1}gl=0,At=at=Ne=null,ga=!1,Ti=Iu=0,ya=null}function Zt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?Ne.memoizedState=At=e:At=At.next=e,At}function Ct(){if(at===null){var e=Ne.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var n=At===null?Ne.memoizedState:At.next;if(n!==null)At=n,at=e;else{if(e===null)throw Ne.alternate===null?Error(i(467)):Error(i(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},At===null?Ne.memoizedState=At=e:At=At.next=e}return At}function Ju(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zi(e){var n=Ti;return Ti+=1,ya===null&&(ya=[]),e=jg(ya,e,n),n=Ne,(At===null?n.memoizedState:At.next)===null&&(n=n.alternate,U.H=n===null||n.memoizedState===null?Ty:gf),e}function Pu(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return zi(e);if(e.$$typeof===H)return Bt(e)}throw Error(i(438,String(e)))}function rf(e){var n=null,l=Ne.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var u=Ne.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(n={data:u.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=Ju(),Ne.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(e),u=0;u<e;u++)l[u]=Y;return n.index++,l}function yl(e,n){return typeof n=="function"?n(e):n}function $u(e){var n=Ct();return af(n,at,e)}function af(e,n,l){var u=e.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=e.baseQueue,d=u.pending;if(d!==null){if(f!==null){var v=f.next;f.next=d.next,d.next=v}n.baseQueue=f=d,u.pending=null}if(d=e.baseState,f===null)e.memoizedState=d;else{n=f.next;var S=v=null,z=null,F=n,I=!1;do{var W=F.lane&-536870913;if(W!==F.lane?(Ve&W)===W:(gl&W)===W){var G=F.revertLane;if(G===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),W===fa&&(I=!0);else if((gl&G)===G){F=F.next,G===fa&&(I=!0);continue}else W={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},z===null?(S=z=W,v=d):z=z.next=W,Ne.lanes|=G,Wl|=G;W=F.action,jr&&l(d,W),d=F.hasEagerState?F.eagerState:l(d,W)}else G={lane:W,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},z===null?(S=z=G,v=d):z=z.next=G,Ne.lanes|=W,Wl|=W;F=F.next}while(F!==null&&F!==n);if(z===null?v=d:z.next=S,!hn(d,e.memoizedState)&&(Rt=!0,I&&(l=da,l!==null)))throw l;e.memoizedState=d,e.baseState=v,e.baseQueue=z,u.lastRenderedState=d}return f===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function uf(e){var n=Ct(),l=n.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=e;var u=l.dispatch,f=l.pending,d=n.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do d=e(d,v.action),v=v.next;while(v!==f);hn(d,n.memoizedState)||(Rt=!0),n.memoizedState=d,n.baseQueue===null&&(n.baseState=d),l.lastRenderedState=d}return[d,u]}function Qg(e,n,l){var u=Ne,f=Ct(),d=Ze;if(d){if(l===void 0)throw Error(i(407));l=l()}else l=n();var v=!hn((at||f).memoizedState,l);if(v&&(f.memoizedState=l,Rt=!0),f=f.queue,cf(Ig.bind(null,u,f,e),[e]),f.getSnapshot!==n||v||At!==null&&At.memoizedState.tag&1){if(u.flags|=2048,va(9,{destroy:void 0},Kg.bind(null,u,f,l,n),null),st===null)throw Error(i(349));d||(gl&127)!==0||Zg(u,n,l)}return l}function Zg(e,n,l){e.flags|=16384,e={getSnapshot:n,value:l},n=Ne.updateQueue,n===null?(n=Ju(),Ne.updateQueue=n,n.stores=[e]):(l=n.stores,l===null?n.stores=[e]:l.push(e))}function Kg(e,n,l,u){n.value=l,n.getSnapshot=u,Jg(n)&&Pg(e)}function Ig(e,n,l){return l(function(){Jg(n)&&Pg(e)})}function Jg(e){var n=e.getSnapshot;e=e.value;try{var l=n();return!hn(e,l)}catch{return!0}}function Pg(e){var n=Tr(e,2);n!==null&&rn(n,e,2)}function of(e){var n=Zt();if(typeof e=="function"){var l=e;if(e=l(),jr){jt(!0);try{l()}finally{jt(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:e},n}function $g(e,n,l,u){return e.baseState=l,af(e,at,typeof u=="function"?u:yl)}function eT(e,n,l,u,f){if(to(e))throw Error(i(485));if(e=n.action,e!==null){var d={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){d.listeners.push(v)}};U.T!==null?l(!0):d.isTransition=!1,u(d),l=n.pending,l===null?(d.next=n.pending=d,Wg(n,d)):(d.next=l.next,n.pending=l.next=d)}}function Wg(e,n){var l=n.action,u=n.payload,f=e.state;if(n.isTransition){var d=U.T,v={};U.T=v;try{var S=l(f,u),z=U.S;z!==null&&z(v,S),ey(e,n,S)}catch(F){sf(e,n,F)}finally{d!==null&&v.types!==null&&(d.types=v.types),U.T=d}}else try{d=l(f,u),ey(e,n,d)}catch(F){sf(e,n,F)}}function ey(e,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){ty(e,n,u)},function(u){return sf(e,n,u)}):ty(e,n,l)}function ty(e,n,l){n.status="fulfilled",n.value=l,ny(n),e.state=l,n=e.pending,n!==null&&(l=n.next,l===n?e.pending=null:(l=l.next,n.next=l,Wg(e,l)))}function sf(e,n,l){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do n.status="rejected",n.reason=l,ny(n),n=n.next;while(n!==u)}e.action=null}function ny(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function ly(e,n){return n}function ry(e,n){if(Ze){var l=st.formState;if(l!==null){e:{var u=Ne;if(Ze){if(ft){t:{for(var f=ft,d=Mn;f.nodeType!==8;){if(!d){f=null;break t}if(f=Nn(f.nextSibling),f===null){f=null;break t}}d=f.data,f=d==="F!"||d==="F"?f:null}if(f){ft=Nn(f.nextSibling),u=f.data==="F!";break e}}Gl(u)}u=!1}u&&(n=l[0])}}return l=Zt(),l.memoizedState=l.baseState=n,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ly,lastRenderedState:n},l.queue=u,l=Ey.bind(null,Ne,u),u.dispatch=l,u=of(!1),d=pf.bind(null,Ne,!1,u.queue),u=Zt(),f={state:n,dispatch:null,action:e,pending:null},u.queue=f,l=eT.bind(null,Ne,f,d,l),f.dispatch=l,u.memoizedState=e,[n,l,!1]}function ay(e){var n=Ct();return iy(n,at,e)}function iy(e,n,l){if(n=af(e,n,ly)[0],e=$u(yl)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var u=zi(n)}catch(v){throw v===ha?Vu:v}else u=n;n=Ct();var f=n.queue,d=f.dispatch;return l!==n.memoizedState&&(Ne.flags|=2048,va(9,{destroy:void 0},tT.bind(null,f,l),null)),[u,d,e]}function tT(e,n){e.action=n}function uy(e){var n=Ct(),l=at;if(l!==null)return iy(n,l,e);Ct(),n=n.memoizedState,l=Ct();var u=l.queue.dispatch;return l.memoizedState=e,[n,u,!1]}function va(e,n,l,u){return e={tag:e,create:l,deps:u,inst:n,next:null},n=Ne.updateQueue,n===null&&(n=Ju(),Ne.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=e.next=e:(u=l.next,l.next=e,e.next=u,n.lastEffect=e),e}function oy(){return Ct().memoizedState}function Wu(e,n,l,u){var f=Zt();Ne.flags|=e,f.memoizedState=va(1|n,{destroy:void 0},l,u===void 0?null:u)}function eo(e,n,l,u){var f=Ct();u=u===void 0?null:u;var d=f.memoizedState.inst;at!==null&&u!==null&&Wc(u,at.memoizedState.deps)?f.memoizedState=va(n,d,l,u):(Ne.flags|=e,f.memoizedState=va(1|n,d,l,u))}function sy(e,n){Wu(8390656,8,e,n)}function cf(e,n){eo(2048,8,e,n)}function nT(e){Ne.flags|=4;var n=Ne.updateQueue;if(n===null)n=Ju(),Ne.updateQueue=n,n.events=[e];else{var l=n.events;l===null?n.events=[e]:l.push(e)}}function cy(e){var n=Ct().memoizedState;return nT({ref:n,nextImpl:e}),function(){if((We&2)!==0)throw Error(i(440));return n.impl.apply(void 0,arguments)}}function fy(e,n){return eo(4,2,e,n)}function dy(e,n){return eo(4,4,e,n)}function hy(e,n){if(typeof n=="function"){e=e();var l=n(e);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function my(e,n,l){l=l!=null?l.concat([e]):null,eo(4,4,hy.bind(null,n,e),l)}function ff(){}function py(e,n){var l=Ct();n=n===void 0?null:n;var u=l.memoizedState;return n!==null&&Wc(n,u[1])?u[0]:(l.memoizedState=[e,n],e)}function gy(e,n){var l=Ct();n=n===void 0?null:n;var u=l.memoizedState;if(n!==null&&Wc(n,u[1]))return u[0];if(u=e(),jr){jt(!0);try{e()}finally{jt(!1)}}return l.memoizedState=[u,n],u}function df(e,n,l){return l===void 0||(gl&1073741824)!==0&&(Ve&261930)===0?e.memoizedState=n:(e.memoizedState=l,e=y0(),Ne.lanes|=e,Wl|=e,l)}function yy(e,n,l,u){return hn(l,n)?l:pa.current!==null?(e=df(e,l,u),hn(e,n)||(Rt=!0),e):(gl&42)===0||(gl&1073741824)!==0&&(Ve&261930)===0?(Rt=!0,e.memoizedState=l):(e=y0(),Ne.lanes|=e,Wl|=e,n)}function vy(e,n,l,u,f){var d=$.p;$.p=d!==0&&8>d?d:8;var v=U.T,S={};U.T=S,pf(e,!1,n,l);try{var z=f(),F=U.S;if(F!==null&&F(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var I=P4(z,u);Ai(e,n,I,bn(e))}else Ai(e,n,u,bn(e))}catch(W){Ai(e,n,{then:function(){},status:"rejected",reason:W},bn())}finally{$.p=d,v!==null&&S.types!==null&&(v.types=S.types),U.T=v}}function lT(){}function hf(e,n,l,u){if(e.tag!==5)throw Error(i(476));var f=by(e).queue;vy(e,f,n,ue,l===null?lT:function(){return xy(e),l(u)})}function by(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:ue},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:l},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function xy(e){var n=by(e);n.next===null&&(n=e.alternate.memoizedState),Ai(e,n.next.queue,{},bn())}function mf(){return Bt(Xi)}function Sy(){return Ct().memoizedState}function wy(){return Ct().memoizedState}function rT(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var l=bn();e=Zl(l);var u=Kl(n,e,l);u!==null&&(rn(u,n,l),Ei(u,n,l)),n={cache:Vc()},e.payload=n;return}n=n.return}}function aT(e,n,l){var u=bn();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},to(e)?ky(n,l):(l=Mc(e,n,l,u),l!==null&&(rn(l,e,u),Cy(l,n,u)))}function Ey(e,n,l){var u=bn();Ai(e,n,l,u)}function Ai(e,n,l,u){var f={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(to(e))ky(n,f);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=n.lastRenderedReducer,d!==null))try{var v=n.lastRenderedState,S=d(v,l);if(f.hasEagerState=!0,f.eagerState=S,hn(S,v))return ju(e,n,f,0),st===null&&_u(),!1}catch{}finally{}if(l=Mc(e,n,f,u),l!==null)return rn(l,e,u),Cy(l,n,u),!0}return!1}function pf(e,n,l,u){if(u={lane:2,revertLane:Zf(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},to(e)){if(n)throw Error(i(479))}else n=Mc(e,l,u,2),n!==null&&rn(n,e,2)}function to(e){var n=e.alternate;return e===Ne||n!==null&&n===Ne}function ky(e,n){ga=Ku=!0;var l=e.pending;l===null?n.next=n:(n.next=l.next,l.next=n),e.pending=n}function Cy(e,n,l){if((l&4194048)!==0){var u=n.lanes;u&=e.pendingLanes,l|=u,n.lanes=l,T(e,l)}}var Ri={readContext:Bt,use:Pu,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useLayoutEffect:xt,useInsertionEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useSyncExternalStore:xt,useId:xt,useHostTransitionStatus:xt,useFormState:xt,useActionState:xt,useOptimistic:xt,useMemoCache:xt,useCacheRefresh:xt};Ri.useEffectEvent=xt;var Ty={readContext:Bt,use:Pu,useCallback:function(e,n){return Zt().memoizedState=[e,n===void 0?null:n],e},useContext:Bt,useEffect:sy,useImperativeHandle:function(e,n,l){l=l!=null?l.concat([e]):null,Wu(4194308,4,hy.bind(null,n,e),l)},useLayoutEffect:function(e,n){return Wu(4194308,4,e,n)},useInsertionEffect:function(e,n){Wu(4,2,e,n)},useMemo:function(e,n){var l=Zt();n=n===void 0?null:n;var u=e();if(jr){jt(!0);try{e()}finally{jt(!1)}}return l.memoizedState=[u,n],u},useReducer:function(e,n,l){var u=Zt();if(l!==void 0){var f=l(n);if(jr){jt(!0);try{l(n)}finally{jt(!1)}}}else f=n;return u.memoizedState=u.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},u.queue=e,e=e.dispatch=aT.bind(null,Ne,e),[u.memoizedState,e]},useRef:function(e){var n=Zt();return e={current:e},n.memoizedState=e},useState:function(e){e=of(e);var n=e.queue,l=Ey.bind(null,Ne,n);return n.dispatch=l,[e.memoizedState,l]},useDebugValue:ff,useDeferredValue:function(e,n){var l=Zt();return df(l,e,n)},useTransition:function(){var e=of(!1);return e=vy.bind(null,Ne,e.queue,!0,!1),Zt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,l){var u=Ne,f=Zt();if(Ze){if(l===void 0)throw Error(i(407));l=l()}else{if(l=n(),st===null)throw Error(i(349));(Ve&127)!==0||Zg(u,n,l)}f.memoizedState=l;var d={value:l,getSnapshot:n};return f.queue=d,sy(Ig.bind(null,u,d,e),[e]),u.flags|=2048,va(9,{destroy:void 0},Kg.bind(null,u,d,l,n),null),l},useId:function(){var e=Zt(),n=st.identifierPrefix;if(Ze){var l=Pn,u=Jn;l=(u&~(1<<32-tt(u)-1)).toString(32)+l,n="_"+n+"R_"+l,l=Iu++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=$4++,n="_"+n+"r_"+l.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:mf,useFormState:ry,useActionState:ry,useOptimistic:function(e){var n=Zt();n.memoizedState=n.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=pf.bind(null,Ne,!0,l),l.dispatch=n,[e,n]},useMemoCache:rf,useCacheRefresh:function(){return Zt().memoizedState=rT.bind(null,Ne)},useEffectEvent:function(e){var n=Zt(),l={impl:e};return n.memoizedState=l,function(){if((We&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},gf={readContext:Bt,use:Pu,useCallback:py,useContext:Bt,useEffect:cf,useImperativeHandle:my,useInsertionEffect:fy,useLayoutEffect:dy,useMemo:gy,useReducer:$u,useRef:oy,useState:function(){return $u(yl)},useDebugValue:ff,useDeferredValue:function(e,n){var l=Ct();return yy(l,at.memoizedState,e,n)},useTransition:function(){var e=$u(yl)[0],n=Ct().memoizedState;return[typeof e=="boolean"?e:zi(e),n]},useSyncExternalStore:Qg,useId:Sy,useHostTransitionStatus:mf,useFormState:ay,useActionState:ay,useOptimistic:function(e,n){var l=Ct();return $g(l,at,e,n)},useMemoCache:rf,useCacheRefresh:wy};gf.useEffectEvent=cy;var zy={readContext:Bt,use:Pu,useCallback:py,useContext:Bt,useEffect:cf,useImperativeHandle:my,useInsertionEffect:fy,useLayoutEffect:dy,useMemo:gy,useReducer:uf,useRef:oy,useState:function(){return uf(yl)},useDebugValue:ff,useDeferredValue:function(e,n){var l=Ct();return at===null?df(l,e,n):yy(l,at.memoizedState,e,n)},useTransition:function(){var e=uf(yl)[0],n=Ct().memoizedState;return[typeof e=="boolean"?e:zi(e),n]},useSyncExternalStore:Qg,useId:Sy,useHostTransitionStatus:mf,useFormState:uy,useActionState:uy,useOptimistic:function(e,n){var l=Ct();return at!==null?$g(l,at,e,n):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:rf,useCacheRefresh:wy};zy.useEffectEvent=cy;function yf(e,n,l,u){n=e.memoizedState,l=l(u,n),l=l==null?n:g({},n,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var vf={enqueueSetState:function(e,n,l){e=e._reactInternals;var u=bn(),f=Zl(u);f.payload=n,l!=null&&(f.callback=l),n=Kl(e,f,u),n!==null&&(rn(n,e,u),Ei(n,e,u))},enqueueReplaceState:function(e,n,l){e=e._reactInternals;var u=bn(),f=Zl(u);f.tag=1,f.payload=n,l!=null&&(f.callback=l),n=Kl(e,f,u),n!==null&&(rn(n,e,u),Ei(n,e,u))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var l=bn(),u=Zl(l);u.tag=2,n!=null&&(u.callback=n),n=Kl(e,u,l),n!==null&&(rn(n,e,l),Ei(n,e,l))}};function Ay(e,n,l,u,f,d,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,d,v):n.prototype&&n.prototype.isPureReactComponent?!pi(l,u)||!pi(f,d):!0}function Ry(e,n,l,u){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,u),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,u),n.state!==e&&vf.enqueueReplaceState(n,n.state,null)}function Lr(e,n){var l=n;if("ref"in n){l={};for(var u in n)u!=="ref"&&(l[u]=n[u])}if(e=e.defaultProps){l===n&&(l=g({},l));for(var f in e)l[f]===void 0&&(l[f]=e[f])}return l}function Dy(e){Nu(e)}function My(e){console.error(e)}function Oy(e){Nu(e)}function no(e,n){try{var l=e.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(u){setTimeout(function(){throw u})}}function Ny(e,n,l){try{var u=e.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function bf(e,n,l){return l=Zl(l),l.tag=3,l.payload={element:null},l.callback=function(){no(e,n)},l}function _y(e){return e=Zl(e),e.tag=3,e}function jy(e,n,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var d=u.value;e.payload=function(){return f(d)},e.callback=function(){Ny(n,l,u)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Ny(n,l,u),typeof f!="function"&&(er===null?er=new Set([this]):er.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function iT(e,n,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(n=l.alternate,n!==null&&ca(n,l,f,!0),l=pn.current,l!==null){switch(l.tag){case 31:case 13:return On===null?po():l.alternate===null&&St===0&&(St=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Fu?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([u]):n.add(u),Gf(e,u,f)),!1;case 22:return l.flags|=65536,u===Fu?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([u]):l.add(u)),Gf(e,u,f)),!1}throw Error(i(435,l.tag))}return Gf(e,u,f),po(),!1}if(Ze)return n=pn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,u!==Uc&&(e=Error(i(422),{cause:u}),vi(An(e,l)))):(u!==Uc&&(n=Error(i(423),{cause:u}),vi(An(n,l))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,u=An(u,l),f=bf(e.stateNode,u,f),Kc(e,f),St!==4&&(St=2)),!1;var d=Error(i(520),{cause:u});if(d=An(d,l),Ui===null?Ui=[d]:Ui.push(d),St!==4&&(St=2),n===null)return!0;u=An(u,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,e=f&-f,l.lanes|=e,e=bf(l.stateNode,u,e),Kc(l,e),!1;case 1:if(n=l.type,d=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||d!==null&&typeof d.componentDidCatch=="function"&&(er===null||!er.has(d))))return l.flags|=65536,f&=-f,l.lanes|=f,f=_y(f),jy(f,e,l,u),Kc(l,f),!1}l=l.return}while(l!==null);return!1}var xf=Error(i(461)),Rt=!1;function Ht(e,n,l,u){n.child=e===null?Hg(n,null,l,u):_r(n,e.child,l,u)}function Ly(e,n,l,u,f){l=l.render;var d=n.ref;if("ref"in u){var v={};for(var S in u)S!=="ref"&&(v[S]=u[S])}else v=u;return Dr(n),u=ef(e,n,l,v,d,f),S=tf(),e!==null&&!Rt?(nf(e,n,f),vl(e,n,f)):(Ze&&S&&jc(n),n.flags|=1,Ht(e,n,u,f),n.child)}function Uy(e,n,l,u,f){if(e===null){var d=l.type;return typeof d=="function"&&!Oc(d)&&d.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=d,By(e,n,d,u,f)):(e=Uu(l.type,null,u,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(d=e.child,!Af(e,f)){var v=d.memoizedProps;if(l=l.compare,l=l!==null?l:pi,l(v,u)&&e.ref===n.ref)return vl(e,n,f)}return n.flags|=1,e=dl(d,u),e.ref=n.ref,e.return=n,n.child=e}function By(e,n,l,u,f){if(e!==null){var d=e.memoizedProps;if(pi(d,u)&&e.ref===n.ref)if(Rt=!1,n.pendingProps=u=d,Af(e,f))(e.flags&131072)!==0&&(Rt=!0);else return n.lanes=e.lanes,vl(e,n,f)}return Sf(e,n,l,u,f)}function Hy(e,n,l,u){var f=u.children,d=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((n.flags&128)!==0){if(d=d!==null?d.baseLanes|l:l,e!==null){for(u=n.child=e.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~d}else u=0,n.child=null;return qy(e,n,d,l,u)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Yu(n,d!==null?d.cachePool:null),d!==null?Vg(n,d):Jc(),Fg(n);else return u=n.lanes=536870912,qy(e,n,d!==null?d.baseLanes|l:l,l,u)}else d!==null?(Yu(n,d.cachePool),Vg(n,d),Jl(),n.memoizedState=null):(e!==null&&Yu(n,null),Jc(),Jl());return Ht(e,n,f,l),n.child}function Di(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function qy(e,n,l,u,f){var d=Gc();return d=d===null?null:{parent:zt._currentValue,pool:d},n.memoizedState={baseLanes:l,cachePool:d},e!==null&&Yu(n,null),Jc(),Fg(n),e!==null&&ca(e,n,u,!0),n.childLanes=f,null}function lo(e,n){return n=ao({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function Yy(e,n,l){return _r(n,e.child,null,l),e=lo(n,n.pendingProps),e.flags|=2,gn(n),n.memoizedState=null,e}function uT(e,n,l){var u=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Ze){if(u.mode==="hidden")return e=lo(n,u),n.lanes=536870912,Di(null,e);if($c(n),(e=ft)?(e=W0(e,Mn),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Vl!==null?{id:Jn,overflow:Pn}:null,retryLane:536870912,hydrationErrors:null},l=kg(e),l.return=n,n.child=l,Ut=n,ft=null)):e=null,e===null)throw Gl(n);return n.lanes=536870912,null}return lo(n,u)}var d=e.memoizedState;if(d!==null){var v=d.dehydrated;if($c(n),f)if(n.flags&256)n.flags&=-257,n=Yy(e,n,l);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(i(558));else if(Rt||ca(e,n,l,!1),f=(l&e.childLanes)!==0,Rt||f){if(u=st,u!==null&&(v=L(u,l),v!==0&&v!==d.retryLane))throw d.retryLane=v,Tr(e,v),rn(u,e,v),xf;po(),n=Yy(e,n,l)}else e=d.treeContext,ft=Nn(v.nextSibling),Ut=n,Ze=!0,Fl=null,Mn=!1,e!==null&&zg(n,e),n=lo(n,u),n.flags|=4096;return n}return e=dl(e.child,{mode:u.mode,children:u.children}),e.ref=n.ref,n.child=e,e.return=n,e}function ro(e,n){var l=n.ref;if(l===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(e===null||e.ref!==l)&&(n.flags|=4194816)}}function Sf(e,n,l,u,f){return Dr(n),l=ef(e,n,l,u,void 0,f),u=tf(),e!==null&&!Rt?(nf(e,n,f),vl(e,n,f)):(Ze&&u&&jc(n),n.flags|=1,Ht(e,n,l,f),n.child)}function Vy(e,n,l,u,f,d){return Dr(n),n.updateQueue=null,l=Xg(n,u,l,f),Gg(e),u=tf(),e!==null&&!Rt?(nf(e,n,d),vl(e,n,d)):(Ze&&u&&jc(n),n.flags|=1,Ht(e,n,l,d),n.child)}function Fy(e,n,l,u,f){if(Dr(n),n.stateNode===null){var d=ia,v=l.contextType;typeof v=="object"&&v!==null&&(d=Bt(v)),d=new l(u,d),n.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=vf,n.stateNode=d,d._reactInternals=n,d=n.stateNode,d.props=u,d.state=n.memoizedState,d.refs={},Qc(n),v=l.contextType,d.context=typeof v=="object"&&v!==null?Bt(v):ia,d.state=n.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(yf(n,l,v,u),d.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(v=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),v!==d.state&&vf.enqueueReplaceState(d,d.state,null),Ci(n,u,d,f),ki(),d.state=n.memoizedState),typeof d.componentDidMount=="function"&&(n.flags|=4194308),u=!0}else if(e===null){d=n.stateNode;var S=n.memoizedProps,z=Lr(l,S);d.props=z;var F=d.context,I=l.contextType;v=ia,typeof I=="object"&&I!==null&&(v=Bt(I));var W=l.getDerivedStateFromProps;I=typeof W=="function"||typeof d.getSnapshotBeforeUpdate=="function",S=n.pendingProps!==S,I||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(S||F!==v)&&Ry(n,d,u,v),Ql=!1;var G=n.memoizedState;d.state=G,Ci(n,u,d,f),ki(),F=n.memoizedState,S||G!==F||Ql?(typeof W=="function"&&(yf(n,l,W,u),F=n.memoizedState),(z=Ql||Ay(n,l,z,u,G,F,v))?(I||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(n.flags|=4194308)):(typeof d.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=u,n.memoizedState=F),d.props=u,d.state=F,d.context=v,u=z):(typeof d.componentDidMount=="function"&&(n.flags|=4194308),u=!1)}else{d=n.stateNode,Zc(e,n),v=n.memoizedProps,I=Lr(l,v),d.props=I,W=n.pendingProps,G=d.context,F=l.contextType,z=ia,typeof F=="object"&&F!==null&&(z=Bt(F)),S=l.getDerivedStateFromProps,(F=typeof S=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(v!==W||G!==z)&&Ry(n,d,u,z),Ql=!1,G=n.memoizedState,d.state=G,Ci(n,u,d,f),ki();var Q=n.memoizedState;v!==W||G!==Q||Ql||e!==null&&e.dependencies!==null&&Hu(e.dependencies)?(typeof S=="function"&&(yf(n,l,S,u),Q=n.memoizedState),(I=Ql||Ay(n,l,I,u,G,Q,z)||e!==null&&e.dependencies!==null&&Hu(e.dependencies))?(F||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(u,Q,z),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(u,Q,z)),typeof d.componentDidUpdate=="function"&&(n.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof d.componentDidUpdate!="function"||v===e.memoizedProps&&G===e.memoizedState||(n.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&G===e.memoizedState||(n.flags|=1024),n.memoizedProps=u,n.memoizedState=Q),d.props=u,d.state=Q,d.context=z,u=I):(typeof d.componentDidUpdate!="function"||v===e.memoizedProps&&G===e.memoizedState||(n.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&G===e.memoizedState||(n.flags|=1024),u=!1)}return d=u,ro(e,n),u=(n.flags&128)!==0,d||u?(d=n.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:d.render(),n.flags|=1,e!==null&&u?(n.child=_r(n,e.child,null,f),n.child=_r(n,null,l,f)):Ht(e,n,l,f),n.memoizedState=d.state,e=n.child):e=vl(e,n,f),e}function Gy(e,n,l,u){return Ar(),n.flags|=256,Ht(e,n,l,u),n.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ef(e){return{baseLanes:e,cachePool:Ng()}}function kf(e,n,l){return e=e!==null?e.childLanes&~l:0,n&&(e|=vn),e}function Xy(e,n,l){var u=n.pendingProps,f=!1,d=(n.flags&128)!==0,v;if((v=d)||(v=e!==null&&e.memoizedState===null?!1:(kt.current&2)!==0),v&&(f=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Ze){if(f?Il(n):Jl(),(e=ft)?(e=W0(e,Mn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Vl!==null?{id:Jn,overflow:Pn}:null,retryLane:536870912,hydrationErrors:null},l=kg(e),l.return=n,n.child=l,Ut=n,ft=null)):e=null,e===null)throw Gl(n);return id(e)?n.lanes=32:n.lanes=536870912,null}var S=u.children;return u=u.fallback,f?(Jl(),f=n.mode,S=ao({mode:"hidden",children:S},f),u=zr(u,f,l,null),S.return=n,u.return=n,S.sibling=u,n.child=S,u=n.child,u.memoizedState=Ef(l),u.childLanes=kf(e,v,l),n.memoizedState=wf,Di(null,u)):(Il(n),Cf(n,S))}var z=e.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(d)n.flags&256?(Il(n),n.flags&=-257,n=Tf(e,n,l)):n.memoizedState!==null?(Jl(),n.child=e.child,n.flags|=128,n=null):(Jl(),S=u.fallback,f=n.mode,u=ao({mode:"visible",children:u.children},f),S=zr(S,f,l,null),S.flags|=2,u.return=n,S.return=n,u.sibling=S,n.child=u,_r(n,e.child,null,l),u=n.child,u.memoizedState=Ef(l),u.childLanes=kf(e,v,l),n.memoizedState=wf,n=Di(null,u));else if(Il(n),id(S)){if(v=S.nextSibling&&S.nextSibling.dataset,v)var F=v.dgst;v=F,u=Error(i(419)),u.stack="",u.digest=v,vi({value:u,source:null,stack:null}),n=Tf(e,n,l)}else if(Rt||ca(e,n,l,!1),v=(l&e.childLanes)!==0,Rt||v){if(v=st,v!==null&&(u=L(v,l),u!==0&&u!==z.retryLane))throw z.retryLane=u,Tr(e,u),rn(v,e,u),xf;ad(S)||po(),n=Tf(e,n,l)}else ad(S)?(n.flags|=192,n.child=e.child,n=null):(e=z.treeContext,ft=Nn(S.nextSibling),Ut=n,Ze=!0,Fl=null,Mn=!1,e!==null&&zg(n,e),n=Cf(n,u.children),n.flags|=4096);return n}return f?(Jl(),S=u.fallback,f=n.mode,z=e.child,F=z.sibling,u=dl(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,F!==null?S=dl(F,S):(S=zr(S,f,l,null),S.flags|=2),S.return=n,u.return=n,u.sibling=S,n.child=u,Di(null,u),u=n.child,S=e.child.memoizedState,S===null?S=Ef(l):(f=S.cachePool,f!==null?(z=zt._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=Ng(),S={baseLanes:S.baseLanes|l,cachePool:f}),u.memoizedState=S,u.childLanes=kf(e,v,l),n.memoizedState=wf,Di(e.child,u)):(Il(n),l=e.child,e=l.sibling,l=dl(l,{mode:"visible",children:u.children}),l.return=n,l.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=l,n.memoizedState=null,l)}function Cf(e,n){return n=ao({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function ao(e,n){return e=mn(22,e,null,n),e.lanes=0,e}function Tf(e,n,l){return _r(n,e.child,null,l),e=Cf(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Qy(e,n,l){e.lanes|=n;var u=e.alternate;u!==null&&(u.lanes|=n),qc(e.return,n,l)}function zf(e,n,l,u,f,d){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f,treeForkCount:d}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=f,v.treeForkCount=d)}function Zy(e,n,l){var u=n.pendingProps,f=u.revealOrder,d=u.tail;u=u.children;var v=kt.current,S=(v&2)!==0;if(S?(v=v&1|2,n.flags|=128):v&=1,E(kt,v),Ht(e,n,u,l),u=Ze?yi:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qy(e,l,n);else if(e.tag===19)Qy(e,l,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(l=n.child,f=null;l!==null;)e=l.alternate,e!==null&&Zu(e)===null&&(f=l),l=l.sibling;l=f,l===null?(f=n.child,n.child=null):(f=l.sibling,l.sibling=null),zf(n,!1,f,l,d,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&Zu(e)===null){n.child=f;break}e=f.sibling,f.sibling=l,l=f,f=e}zf(n,!0,l,null,d,u);break;case"together":zf(n,!1,null,null,void 0,u);break;default:n.memoizedState=null}return n.child}function vl(e,n,l){if(e!==null&&(n.dependencies=e.dependencies),Wl|=n.lanes,(l&n.childLanes)===0)if(e!==null){if(ca(e,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(i(153));if(n.child!==null){for(e=n.child,l=dl(e,e.pendingProps),n.child=l,l.return=n;e.sibling!==null;)e=e.sibling,l=l.sibling=dl(e,e.pendingProps),l.return=n;l.sibling=null}return n.child}function Af(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Hu(e)))}function oT(e,n,l){switch(n.tag){case 3:Je(n,n.stateNode.containerInfo),Xl(n,zt,e.memoizedState.cache),Ar();break;case 27:case 5:Jt(n);break;case 4:Je(n,n.stateNode.containerInfo);break;case 10:Xl(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,$c(n),null;break;case 13:var u=n.memoizedState;if(u!==null)return u.dehydrated!==null?(Il(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Xy(e,n,l):(Il(n),e=vl(e,n,l),e!==null?e.sibling:null);Il(n);break;case 19:var f=(e.flags&128)!==0;if(u=(l&n.childLanes)!==0,u||(ca(e,n,l,!1),u=(l&n.childLanes)!==0),f){if(u)return Zy(e,n,l);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),E(kt,kt.current),u)break;return null;case 22:return n.lanes=0,Hy(e,n,l,n.pendingProps);case 24:Xl(n,zt,e.memoizedState.cache)}return vl(e,n,l)}function Ky(e,n,l){if(e!==null)if(e.memoizedProps!==n.pendingProps)Rt=!0;else{if(!Af(e,l)&&(n.flags&128)===0)return Rt=!1,oT(e,n,l);Rt=(e.flags&131072)!==0}else Rt=!1,Ze&&(n.flags&1048576)!==0&&Tg(n,yi,n.index);switch(n.lanes=0,n.tag){case 16:e:{var u=n.pendingProps;if(e=Or(n.elementType),n.type=e,typeof e=="function")Oc(e)?(u=Lr(e,u),n.tag=1,n=Fy(null,n,e,u,l)):(n.tag=0,n=Sf(null,n,e,u,l));else{if(e!=null){var f=e.$$typeof;if(f===ie){n.tag=11,n=Ly(null,n,e,u,l);break e}else if(f===M){n.tag=14,n=Uy(null,n,e,u,l);break e}}throw n=he(e)||e,Error(i(306,n,""))}}return n;case 0:return Sf(e,n,n.type,n.pendingProps,l);case 1:return u=n.type,f=Lr(u,n.pendingProps),Fy(e,n,u,f,l);case 3:e:{if(Je(n,n.stateNode.containerInfo),e===null)throw Error(i(387));u=n.pendingProps;var d=n.memoizedState;f=d.element,Zc(e,n),Ci(n,u,null,l);var v=n.memoizedState;if(u=v.cache,Xl(n,zt,u),u!==d.cache&&Yc(n,[zt],l,!0),ki(),u=v.element,d.isDehydrated)if(d={element:u,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=d,n.memoizedState=d,n.flags&256){n=Gy(e,n,u,l);break e}else if(u!==f){f=An(Error(i(424)),n),vi(f),n=Gy(e,n,u,l);break e}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ft=Nn(e.firstChild),Ut=n,Ze=!0,Fl=null,Mn=!0,l=Hg(n,null,u,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Ar(),u===f){n=vl(e,n,l);break e}Ht(e,n,u,l)}n=n.child}return n;case 26:return ro(e,n),e===null?(l=av(n.type,null,n.pendingProps,null))?n.memoizedState=l:Ze||(l=n.type,e=n.pendingProps,u=wo(ge.current).createElement(l),u[fe]=n,u[me]=e,qt(u,l,e),ht(u),n.stateNode=u):n.memoizedState=av(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Jt(n),e===null&&Ze&&(u=n.stateNode=nv(n.type,n.pendingProps,ge.current),Ut=n,Mn=!0,f=ft,rr(n.type)?(ud=f,ft=Nn(u.firstChild)):ft=f),Ht(e,n,n.pendingProps.children,l),ro(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Ze&&((f=u=ft)&&(u=BT(u,n.type,n.pendingProps,Mn),u!==null?(n.stateNode=u,Ut=n,ft=Nn(u.firstChild),Mn=!1,f=!0):f=!1),f||Gl(n)),Jt(n),f=n.type,d=n.pendingProps,v=e!==null?e.memoizedProps:null,u=d.children,nd(f,d)?u=null:v!==null&&nd(f,v)&&(n.flags|=32),n.memoizedState!==null&&(f=ef(e,n,W4,null,null,l),Xi._currentValue=f),ro(e,n),Ht(e,n,u,l),n.child;case 6:return e===null&&Ze&&((e=l=ft)&&(l=HT(l,n.pendingProps,Mn),l!==null?(n.stateNode=l,Ut=n,ft=null,e=!0):e=!1),e||Gl(n)),null;case 13:return Xy(e,n,l);case 4:return Je(n,n.stateNode.containerInfo),u=n.pendingProps,e===null?n.child=_r(n,null,u,l):Ht(e,n,u,l),n.child;case 11:return Ly(e,n,n.type,n.pendingProps,l);case 7:return Ht(e,n,n.pendingProps,l),n.child;case 8:return Ht(e,n,n.pendingProps.children,l),n.child;case 12:return Ht(e,n,n.pendingProps.children,l),n.child;case 10:return u=n.pendingProps,Xl(n,n.type,u.value),Ht(e,n,u.children,l),n.child;case 9:return f=n.type._context,u=n.pendingProps.children,Dr(n),f=Bt(f),u=u(f),n.flags|=1,Ht(e,n,u,l),n.child;case 14:return Uy(e,n,n.type,n.pendingProps,l);case 15:return By(e,n,n.type,n.pendingProps,l);case 19:return Zy(e,n,l);case 31:return uT(e,n,l);case 22:return Hy(e,n,l,n.pendingProps);case 24:return Dr(n),u=Bt(zt),e===null?(f=Gc(),f===null&&(f=st,d=Vc(),f.pooledCache=d,d.refCount++,d!==null&&(f.pooledCacheLanes|=l),f=d),n.memoizedState={parent:u,cache:f},Qc(n),Xl(n,zt,f)):((e.lanes&l)!==0&&(Zc(e,n),Ci(n,null,null,l),ki()),f=e.memoizedState,d=n.memoizedState,f.parent!==u?(f={parent:u,cache:u},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),Xl(n,zt,u)):(u=d.cache,Xl(n,zt,u),u!==f.cache&&Yc(n,[zt],l,!0))),Ht(e,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function bl(e){e.flags|=4}function Rf(e,n,l,u,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(S0())e.flags|=8192;else throw Nr=Fu,Xc}else e.flags&=-16777217}function Iy(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!cv(n))if(S0())e.flags|=8192;else throw Nr=Fu,Xc}function io(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?br():536870912,e.lanes|=n,wa|=n)}function Mi(e,n){if(!Ze)switch(e.tailMode){case"hidden":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function dt(e){var n=e.alternate!==null&&e.alternate.child===e.child,l=0,u=0;if(n)for(var f=e.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=u,e.childLanes=l,n}function sT(e,n,l){var u=n.pendingProps;switch(Lc(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(n),null;case 1:return dt(n),null;case 3:return l=n.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),n.memoizedState.cache!==u&&(n.flags|=2048),pl(zt),et(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(sa(n)?bl(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Bc())),dt(n),null;case 26:var f=n.type,d=n.memoizedState;return e===null?(bl(n),d!==null?(dt(n),Iy(n,d)):(dt(n),Rf(n,f,null,u,l))):d?d!==e.memoizedState?(bl(n),dt(n),Iy(n,d)):(dt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==u&&bl(n),dt(n),Rf(n,f,e,u,l)),null;case 27:if(Un(n),l=ge.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==u&&bl(n);else{if(!u){if(n.stateNode===null)throw Error(i(166));return dt(n),null}e=oe.current,sa(n)?Ag(n):(e=nv(f,u,l),n.stateNode=e,bl(n))}return dt(n),null;case 5:if(Un(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==u&&bl(n);else{if(!u){if(n.stateNode===null)throw Error(i(166));return dt(n),null}if(d=oe.current,sa(n))Ag(n);else{var v=wo(ge.current);switch(d){case 1:d=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:d=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":d=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":d=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":d=v.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof u.is=="string"?v.createElement("select",{is:u.is}):v.createElement("select"),u.multiple?d.multiple=!0:u.size&&(d.size=u.size);break;default:d=typeof u.is=="string"?v.createElement(f,{is:u.is}):v.createElement(f)}}d[fe]=n,d[me]=u;e:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)d.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break e;for(;v.sibling===null;){if(v.return===null||v.return===n)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=d;e:switch(qt(d,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&bl(n)}}return dt(n),Rf(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,l),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==u&&bl(n);else{if(typeof u!="string"&&n.stateNode===null)throw Error(i(166));if(e=ge.current,sa(n)){if(e=n.stateNode,l=n.memoizedProps,u=null,f=Ut,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}e[fe]=n,e=!!(e.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||X0(e.nodeValue,l)),e||Gl(n,!0)}else e=wo(e).createTextNode(u),e[fe]=n,n.stateNode=e}return dt(n),null;case 31:if(l=n.memoizedState,e===null||e.memoizedState!==null){if(u=sa(n),l!==null){if(e===null){if(!u)throw Error(i(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(557));e[fe]=n}else Ar(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;dt(n),e=!1}else l=Bc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),e=!0;if(!e)return n.flags&256?(gn(n),n):(gn(n),null);if((n.flags&128)!==0)throw Error(i(558))}return dt(n),null;case 13:if(u=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=sa(n),u!==null&&u.dehydrated!==null){if(e===null){if(!f)throw Error(i(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[fe]=n}else Ar(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;dt(n),f=!1}else f=Bc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(gn(n),n):(gn(n),null)}return gn(n),(n.flags&128)!==0?(n.lanes=l,n):(l=u!==null,e=e!==null&&e.memoizedState!==null,l&&(u=n.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),d=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(d=u.memoizedState.cachePool.pool),d!==f&&(u.flags|=2048)),l!==e&&l&&(n.child.flags|=8192),io(n,n.updateQueue),dt(n),null);case 4:return et(),e===null&&Pf(n.stateNode.containerInfo),dt(n),null;case 10:return pl(n.type),dt(n),null;case 19:if(Z(kt),u=n.memoizedState,u===null)return dt(n),null;if(f=(n.flags&128)!==0,d=u.rendering,d===null)if(f)Mi(u,!1);else{if(St!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(d=Zu(e),d!==null){for(n.flags|=128,Mi(u,!1),e=d.updateQueue,n.updateQueue=e,io(n,e),n.subtreeFlags=0,e=l,l=n.child;l!==null;)Eg(l,e),l=l.sibling;return E(kt,kt.current&1|2),Ze&&hl(n,u.treeForkCount),n.child}e=e.sibling}u.tail!==null&&pt()>fo&&(n.flags|=128,f=!0,Mi(u,!1),n.lanes=4194304)}else{if(!f)if(e=Zu(d),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,io(n,e),Mi(u,!0),u.tail===null&&u.tailMode==="hidden"&&!d.alternate&&!Ze)return dt(n),null}else 2*pt()-u.renderingStartTime>fo&&l!==536870912&&(n.flags|=128,f=!0,Mi(u,!1),n.lanes=4194304);u.isBackwards?(d.sibling=n.child,n.child=d):(e=u.last,e!==null?e.sibling=d:n.child=d,u.last=d)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=pt(),e.sibling=null,l=kt.current,E(kt,f?l&1|2:l&1),Ze&&hl(n,u.treeForkCount),e):(dt(n),null);case 22:case 23:return gn(n),Pc(),u=n.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(n.flags|=8192):u&&(n.flags|=8192),u?(l&536870912)!==0&&(n.flags&128)===0&&(dt(n),n.subtreeFlags&6&&(n.flags|=8192)):dt(n),l=n.updateQueue,l!==null&&io(n,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),u=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),u!==l&&(n.flags|=2048),e!==null&&Z(Mr),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),pl(zt),dt(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function cT(e,n){switch(Lc(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return pl(zt),et(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Un(n),null;case 31:if(n.memoizedState!==null){if(gn(n),n.alternate===null)throw Error(i(340));Ar()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(gn(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Ar()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Z(kt),null;case 4:return et(),null;case 10:return pl(n.type),null;case 22:case 23:return gn(n),Pc(),e!==null&&Z(Mr),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return pl(zt),null;case 25:return null;default:return null}}function Jy(e,n){switch(Lc(n),n.tag){case 3:pl(zt),et();break;case 26:case 27:case 5:Un(n);break;case 4:et();break;case 31:n.memoizedState!==null&&gn(n);break;case 13:gn(n);break;case 19:Z(kt);break;case 10:pl(n.type);break;case 22:case 23:gn(n),Pc(),e!==null&&Z(Mr);break;case 24:pl(zt)}}function Oi(e,n){try{var l=n.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&e)===e){u=void 0;var d=l.create,v=l.inst;u=d(),v.destroy=u}l=l.next}while(l!==f)}}catch(S){rt(n,n.return,S)}}function Pl(e,n,l){try{var u=n.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var d=f.next;u=d;do{if((u.tag&e)===e){var v=u.inst,S=v.destroy;if(S!==void 0){v.destroy=void 0,f=n;var z=l,F=S;try{F()}catch(I){rt(f,z,I)}}}u=u.next}while(u!==d)}}catch(I){rt(n,n.return,I)}}function Py(e){var n=e.updateQueue;if(n!==null){var l=e.stateNode;try{Yg(n,l)}catch(u){rt(e,e.return,u)}}}function $y(e,n,l){l.props=Lr(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(u){rt(e,n,u)}}function Ni(e,n){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof l=="function"?e.refCleanup=l(u):l.current=u}}catch(f){rt(e,n,f)}}function $n(e,n){var l=e.ref,u=e.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){rt(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){rt(e,n,f)}else l.current=null}function Wy(e){var n=e.type,l=e.memoizedProps,u=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){rt(e,e.return,f)}}function Df(e,n,l){try{var u=e.stateNode;OT(u,e.type,l,n),u[me]=n}catch(f){rt(e,e.return,f)}}function e0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&rr(e.type)||e.tag===4}function Mf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&rr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Of(e,n,l){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(e),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=cl));else if(u!==4&&(u===27&&rr(e.type)&&(l=e.stateNode,n=null),e=e.child,e!==null))for(Of(e,n,l),e=e.sibling;e!==null;)Of(e,n,l),e=e.sibling}function uo(e,n,l){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?l.insertBefore(e,n):l.appendChild(e);else if(u!==4&&(u===27&&rr(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(uo(e,n,l),e=e.sibling;e!==null;)uo(e,n,l),e=e.sibling}function t0(e){var n=e.stateNode,l=e.memoizedProps;try{for(var u=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);qt(n,u,l),n[fe]=e,n[me]=l}catch(d){rt(e,e.return,d)}}var xl=!1,Dt=!1,Nf=!1,n0=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function fT(e,n){if(e=e.containerInfo,ed=Ro,e=mg(e),Cc(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,d=u.focusNode;u=u.focusOffset;try{l.nodeType,d.nodeType}catch{l=null;break e}var v=0,S=-1,z=-1,F=0,I=0,W=e,G=null;t:for(;;){for(var Q;W!==l||f!==0&&W.nodeType!==3||(S=v+f),W!==d||u!==0&&W.nodeType!==3||(z=v+u),W.nodeType===3&&(v+=W.nodeValue.length),(Q=W.firstChild)!==null;)G=W,W=Q;for(;;){if(W===e)break t;if(G===l&&++F===f&&(S=v),G===d&&++I===u&&(z=v),(Q=W.nextSibling)!==null)break;W=G,G=W.parentNode}W=Q}l=S===-1||z===-1?null:{start:S,end:z}}else l=null}l=l||{start:0,end:0}}else l=null;for(td={focusedElem:e,selectionRange:l},Ro=!1,Nt=n;Nt!==null;)if(n=Nt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Nt=e;else for(;Nt!==null;){switch(n=Nt,d=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(l=0;l<e.length;l++)f=e[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&d!==null){e=void 0,l=n,f=d.memoizedProps,d=d.memoizedState,u=l.stateNode;try{var ye=Lr(l.type,f);e=u.getSnapshotBeforeUpdate(ye,d),u.__reactInternalSnapshotBeforeUpdate=e}catch(ze){rt(l,l.return,ze)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,l=e.nodeType,l===9)rd(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":rd(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=n.sibling,e!==null){e.return=n.return,Nt=e;break}Nt=n.return}}function l0(e,n,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:wl(e,l),u&4&&Oi(5,l);break;case 1:if(wl(e,l),u&4)if(e=l.stateNode,n===null)try{e.componentDidMount()}catch(v){rt(l,l.return,v)}else{var f=Lr(l.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){rt(l,l.return,v)}}u&64&&Py(l),u&512&&Ni(l,l.return);break;case 3:if(wl(e,l),u&64&&(e=l.updateQueue,e!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Yg(e,n)}catch(v){rt(l,l.return,v)}}break;case 27:n===null&&u&4&&t0(l);case 26:case 5:wl(e,l),n===null&&u&4&&Wy(l),u&512&&Ni(l,l.return);break;case 12:wl(e,l);break;case 31:wl(e,l),u&4&&i0(e,l);break;case 13:wl(e,l),u&4&&u0(e,l),u&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=xT.bind(null,l),qT(e,l))));break;case 22:if(u=l.memoizedState!==null||xl,!u){n=n!==null&&n.memoizedState!==null||Dt,f=xl;var d=Dt;xl=u,(Dt=n)&&!d?El(e,l,(l.subtreeFlags&8772)!==0):wl(e,l),xl=f,Dt=d}break;case 30:break;default:wl(e,l)}}function r0(e){var n=e.alternate;n!==null&&(e.alternate=null,r0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&vt(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var mt=null,en=!1;function Sl(e,n,l){for(l=l.child;l!==null;)a0(e,n,l),l=l.sibling}function a0(e,n,l){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(_t,l)}catch{}switch(l.tag){case 26:Dt||$n(l,n),Sl(e,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Dt||$n(l,n);var u=mt,f=en;rr(l.type)&&(mt=l.stateNode,en=!1),Sl(e,n,l),Vi(l.stateNode),mt=u,en=f;break;case 5:Dt||$n(l,n);case 6:if(u=mt,f=en,mt=null,Sl(e,n,l),mt=u,en=f,mt!==null)if(en)try{(mt.nodeType===9?mt.body:mt.nodeName==="HTML"?mt.ownerDocument.body:mt).removeChild(l.stateNode)}catch(d){rt(l,n,d)}else try{mt.removeChild(l.stateNode)}catch(d){rt(l,n,d)}break;case 18:mt!==null&&(en?(e=mt,P0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),Da(e)):P0(mt,l.stateNode));break;case 4:u=mt,f=en,mt=l.stateNode.containerInfo,en=!0,Sl(e,n,l),mt=u,en=f;break;case 0:case 11:case 14:case 15:Pl(2,l,n),Dt||Pl(4,l,n),Sl(e,n,l);break;case 1:Dt||($n(l,n),u=l.stateNode,typeof u.componentWillUnmount=="function"&&$y(l,n,u)),Sl(e,n,l);break;case 21:Sl(e,n,l);break;case 22:Dt=(u=Dt)||l.memoizedState!==null,Sl(e,n,l),Dt=u;break;default:Sl(e,n,l)}}function i0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Da(e)}catch(l){rt(n,n.return,l)}}}function u0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Da(e)}catch(l){rt(n,n.return,l)}}function dT(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new n0),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new n0),n;default:throw Error(i(435,e.tag))}}function oo(e,n){var l=dT(e);n.forEach(function(u){if(!l.has(u)){l.add(u);var f=ST.bind(null,e,u);u.then(f,f)}})}function tn(e,n){var l=n.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],d=e,v=n,S=v;e:for(;S!==null;){switch(S.tag){case 27:if(rr(S.type)){mt=S.stateNode,en=!1;break e}break;case 5:mt=S.stateNode,en=!1;break e;case 3:case 4:mt=S.stateNode.containerInfo,en=!0;break e}S=S.return}if(mt===null)throw Error(i(160));a0(d,v,f),mt=null,en=!1,d=f.alternate,d!==null&&(d.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)o0(n,e),n=n.sibling}var Gn=null;function o0(e,n){var l=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:tn(n,e),nn(e),u&4&&(Pl(3,e,e.return),Oi(3,e),Pl(5,e,e.return));break;case 1:tn(n,e),nn(e),u&512&&(Dt||l===null||$n(l,l.return)),u&64&&xl&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=Gn;if(tn(n,e),nn(e),u&512&&(Dt||l===null||$n(l,l.return)),u&4){var d=l!==null?l.memoizedState:null;if(u=e.memoizedState,l===null)if(u===null)if(e.stateNode===null){e:{u=e.type,l=e.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":d=f.getElementsByTagName("title")[0],(!d||d[gt]||d[fe]||d.namespaceURI==="http://www.w3.org/2000/svg"||d.hasAttribute("itemprop"))&&(d=f.createElement(u),f.head.insertBefore(d,f.querySelector("head > title"))),qt(d,u,l),d[fe]=e,ht(d),u=d;break e;case"link":var v=ov("link","href",f).get(u+(l.href||""));if(v){for(var S=0;S<v.length;S++)if(d=v[S],d.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&d.getAttribute("rel")===(l.rel==null?null:l.rel)&&d.getAttribute("title")===(l.title==null?null:l.title)&&d.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(S,1);break t}}d=f.createElement(u),qt(d,u,l),f.head.appendChild(d);break;case"meta":if(v=ov("meta","content",f).get(u+(l.content||""))){for(S=0;S<v.length;S++)if(d=v[S],d.getAttribute("content")===(l.content==null?null:""+l.content)&&d.getAttribute("name")===(l.name==null?null:l.name)&&d.getAttribute("property")===(l.property==null?null:l.property)&&d.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&d.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(S,1);break t}}d=f.createElement(u),qt(d,u,l),f.head.appendChild(d);break;default:throw Error(i(468,u))}d[fe]=e,ht(d),u=d}e.stateNode=u}else sv(f,e.type,e.stateNode);else e.stateNode=uv(f,u,e.memoizedProps);else d!==u?(d===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):d.count--,u===null?sv(f,e.type,e.stateNode):uv(f,u,e.memoizedProps)):u===null&&e.stateNode!==null&&Df(e,e.memoizedProps,l.memoizedProps)}break;case 27:tn(n,e),nn(e),u&512&&(Dt||l===null||$n(l,l.return)),l!==null&&u&4&&Df(e,e.memoizedProps,l.memoizedProps);break;case 5:if(tn(n,e),nn(e),u&512&&(Dt||l===null||$n(l,l.return)),e.flags&32){f=e.stateNode;try{Wr(f,"")}catch(ye){rt(e,e.return,ye)}}u&4&&e.stateNode!=null&&(f=e.memoizedProps,Df(e,f,l!==null?l.memoizedProps:f)),u&1024&&(Nf=!0);break;case 6:if(tn(n,e),nn(e),u&4){if(e.stateNode===null)throw Error(i(162));u=e.memoizedProps,l=e.stateNode;try{l.nodeValue=u}catch(ye){rt(e,e.return,ye)}}break;case 3:if(Co=null,f=Gn,Gn=Eo(n.containerInfo),tn(n,e),Gn=f,nn(e),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Da(n.containerInfo)}catch(ye){rt(e,e.return,ye)}Nf&&(Nf=!1,s0(e));break;case 4:u=Gn,Gn=Eo(e.stateNode.containerInfo),tn(n,e),nn(e),Gn=u;break;case 12:tn(n,e),nn(e);break;case 31:tn(n,e),nn(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,oo(e,u)));break;case 13:tn(n,e),nn(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(co=pt()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,oo(e,u)));break;case 22:f=e.memoizedState!==null;var z=l!==null&&l.memoizedState!==null,F=xl,I=Dt;if(xl=F||f,Dt=I||z,tn(n,e),Dt=I,xl=F,nn(e),u&8192)e:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(l===null||z||xl||Dt||Ur(e)),l=null,n=e;;){if(n.tag===5||n.tag===26){if(l===null){z=l=n;try{if(d=z.stateNode,f)v=d.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{S=z.stateNode;var W=z.memoizedProps.style,G=W!=null&&W.hasOwnProperty("display")?W.display:null;S.style.display=G==null||typeof G=="boolean"?"":(""+G).trim()}}catch(ye){rt(z,z.return,ye)}}}else if(n.tag===6){if(l===null){z=n;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(ye){rt(z,z.return,ye)}}}else if(n.tag===18){if(l===null){z=n;try{var Q=z.stateNode;f?$0(Q,!0):$0(z.stateNode,!1)}catch(ye){rt(z,z.return,ye)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}u&4&&(u=e.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,oo(e,l))));break;case 19:tn(n,e),nn(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,oo(e,u)));break;case 30:break;case 21:break;default:tn(n,e),nn(e)}}function nn(e){var n=e.flags;if(n&2){try{for(var l,u=e.return;u!==null;){if(e0(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,d=Mf(e);uo(e,d,f);break;case 5:var v=l.stateNode;l.flags&32&&(Wr(v,""),l.flags&=-33);var S=Mf(e);uo(e,S,v);break;case 3:case 4:var z=l.stateNode.containerInfo,F=Mf(e);Of(e,F,z);break;default:throw Error(i(161))}}catch(I){rt(e,e.return,I)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function s0(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;s0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function wl(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)l0(e,n.alternate,n),n=n.sibling}function Ur(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Pl(4,n,n.return),Ur(n);break;case 1:$n(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&$y(n,n.return,l),Ur(n);break;case 27:Vi(n.stateNode);case 26:case 5:$n(n,n.return),Ur(n);break;case 22:n.memoizedState===null&&Ur(n);break;case 30:Ur(n);break;default:Ur(n)}e=e.sibling}}function El(e,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var u=n.alternate,f=e,d=n,v=d.flags;switch(d.tag){case 0:case 11:case 15:El(f,d,l),Oi(4,d);break;case 1:if(El(f,d,l),u=d,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(F){rt(u,u.return,F)}if(u=d,f=u.updateQueue,f!==null){var S=u.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)qg(z[f],S)}catch(F){rt(u,u.return,F)}}l&&v&64&&Py(d),Ni(d,d.return);break;case 27:t0(d);case 26:case 5:El(f,d,l),l&&u===null&&v&4&&Wy(d),Ni(d,d.return);break;case 12:El(f,d,l);break;case 31:El(f,d,l),l&&v&4&&i0(f,d);break;case 13:El(f,d,l),l&&v&4&&u0(f,d);break;case 22:d.memoizedState===null&&El(f,d,l),Ni(d,d.return);break;case 30:break;default:El(f,d,l)}n=n.sibling}}function _f(e,n){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&bi(l))}function jf(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&bi(e))}function Xn(e,n,l,u){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)c0(e,n,l,u),n=n.sibling}function c0(e,n,l,u){var f=n.flags;switch(n.tag){case 0:case 11:case 15:Xn(e,n,l,u),f&2048&&Oi(9,n);break;case 1:Xn(e,n,l,u);break;case 3:Xn(e,n,l,u),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&bi(e)));break;case 12:if(f&2048){Xn(e,n,l,u),e=n.stateNode;try{var d=n.memoizedProps,v=d.id,S=d.onPostCommit;typeof S=="function"&&S(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(z){rt(n,n.return,z)}}else Xn(e,n,l,u);break;case 31:Xn(e,n,l,u);break;case 13:Xn(e,n,l,u);break;case 23:break;case 22:d=n.stateNode,v=n.alternate,n.memoizedState!==null?d._visibility&2?Xn(e,n,l,u):_i(e,n):d._visibility&2?Xn(e,n,l,u):(d._visibility|=2,ba(e,n,l,u,(n.subtreeFlags&10256)!==0||!1)),f&2048&&_f(v,n);break;case 24:Xn(e,n,l,u),f&2048&&jf(n.alternate,n);break;default:Xn(e,n,l,u)}}function ba(e,n,l,u,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var d=e,v=n,S=l,z=u,F=v.flags;switch(v.tag){case 0:case 11:case 15:ba(d,v,S,z,f),Oi(8,v);break;case 23:break;case 22:var I=v.stateNode;v.memoizedState!==null?I._visibility&2?ba(d,v,S,z,f):_i(d,v):(I._visibility|=2,ba(d,v,S,z,f)),f&&F&2048&&_f(v.alternate,v);break;case 24:ba(d,v,S,z,f),f&&F&2048&&jf(v.alternate,v);break;default:ba(d,v,S,z,f)}n=n.sibling}}function _i(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=e,u=n,f=u.flags;switch(u.tag){case 22:_i(l,u),f&2048&&_f(u.alternate,u);break;case 24:_i(l,u),f&2048&&jf(u.alternate,u);break;default:_i(l,u)}n=n.sibling}}var ji=8192;function xa(e,n,l){if(e.subtreeFlags&ji)for(e=e.child;e!==null;)f0(e,n,l),e=e.sibling}function f0(e,n,l){switch(e.tag){case 26:xa(e,n,l),e.flags&ji&&e.memoizedState!==null&&$T(l,Gn,e.memoizedState,e.memoizedProps);break;case 5:xa(e,n,l);break;case 3:case 4:var u=Gn;Gn=Eo(e.stateNode.containerInfo),xa(e,n,l),Gn=u;break;case 22:e.memoizedState===null&&(u=e.alternate,u!==null&&u.memoizedState!==null?(u=ji,ji=16777216,xa(e,n,l),ji=u):xa(e,n,l));break;default:xa(e,n,l)}}function d0(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Li(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var u=n[l];Nt=u,m0(u,e)}d0(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)h0(e),e=e.sibling}function h0(e){switch(e.tag){case 0:case 11:case 15:Li(e),e.flags&2048&&Pl(9,e,e.return);break;case 3:Li(e);break;case 12:Li(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,so(e)):Li(e);break;default:Li(e)}}function so(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var u=n[l];Nt=u,m0(u,e)}d0(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Pl(8,n,n.return),so(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,so(n));break;default:so(n)}e=e.sibling}}function m0(e,n){for(;Nt!==null;){var l=Nt;switch(l.tag){case 0:case 11:case 15:Pl(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:bi(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Nt=u;else e:for(l=e;Nt!==null;){u=Nt;var f=u.sibling,d=u.return;if(r0(u),u===l){Nt=null;break e}if(f!==null){f.return=d,Nt=f;break e}Nt=d}}}var hT={getCacheForType:function(e){var n=Bt(zt),l=n.data.get(e);return l===void 0&&(l=e(),n.data.set(e,l)),l},cacheSignal:function(){return Bt(zt).controller.signal}},mT=typeof WeakMap=="function"?WeakMap:Map,We=0,st=null,qe=null,Ve=0,lt=0,yn=null,$l=!1,Sa=!1,Lf=!1,kl=0,St=0,Wl=0,Br=0,Uf=0,vn=0,wa=0,Ui=null,ln=null,Bf=!1,co=0,p0=0,fo=1/0,ho=null,er=null,Mt=0,tr=null,Ea=null,Cl=0,Hf=0,qf=null,g0=null,Bi=0,Yf=null;function bn(){return(We&2)!==0&&Ve!==0?Ve&-Ve:U.T!==null?Zf():ce()}function y0(){if(vn===0)if((Ve&536870912)===0||Ze){var e=gr;gr<<=1,(gr&3932160)===0&&(gr=262144),vn=e}else vn=536870912;return e=pn.current,e!==null&&(e.flags|=32),vn}function rn(e,n,l){(e===st&&(lt===2||lt===9)||e.cancelPendingCommit!==null)&&(ka(e,0),nr(e,Ve,vn,!1)),ql(e,l),((We&2)===0||e!==st)&&(e===st&&((We&2)===0&&(Br|=l),St===4&&nr(e,Ve,vn,!1)),Wn(e))}function v0(e,n,l){if((We&6)!==0)throw Error(i(327));var u=!l&&(n&127)===0&&(n&e.expiredLanes)===0||vr(e,n),f=u?yT(e,n):Ff(e,n,!0),d=u;do{if(f===0){Sa&&!u&&nr(e,n,0,!1);break}else{if(l=e.current.alternate,d&&!pT(l)){f=Ff(e,n,!1),d=!1;continue}if(f===2){if(d=n,e.errorRecoveryDisabledLanes&d)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;e:{var S=e;f=Ui;var z=S.current.memoizedState.isDehydrated;if(z&&(ka(S,v).flags|=256),v=Ff(S,v,!1),v!==2){if(Lf&&!z){S.errorRecoveryDisabledLanes|=d,Br|=d,f=4;break e}d=ln,ln=f,d!==null&&(ln===null?ln=d:ln.push.apply(ln,d))}f=v}if(d=!1,f!==2)continue}}if(f===1){ka(e,0),nr(e,n,0,!0);break}e:{switch(u=e,d=f,d){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:nr(u,n,vn,!$l);break e;case 2:ln=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(f=co+300-pt(),10<f)){if(nr(u,n,vn,!$l),yr(u,0,!0)!==0)break e;Cl=n,u.timeoutHandle=I0(b0.bind(null,u,l,ln,ho,Bf,n,vn,Br,wa,$l,d,"Throttled",-0,0),f);break e}b0(u,l,ln,ho,Bf,n,vn,Br,wa,$l,d,null,-0,0)}}break}while(!0);Wn(e)}function b0(e,n,l,u,f,d,v,S,z,F,I,W,G,Q){if(e.timeoutHandle=-1,W=n.subtreeFlags,W&8192||(W&16785408)===16785408){W={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cl},f0(n,d,W);var ye=(d&62914560)===d?co-pt():(d&4194048)===d?p0-pt():0;if(ye=WT(W,ye),ye!==null){Cl=d,e.cancelPendingCommit=ye(z0.bind(null,e,n,d,l,u,f,v,S,z,I,W,null,G,Q)),nr(e,d,v,!F);return}}z0(e,n,d,l,u,f,v,S,z)}function pT(e){for(var n=e;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],d=f.getSnapshot;f=f.value;try{if(!hn(d(),f))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function nr(e,n,l,u){n&=~Uf,n&=~Br,e.suspendedLanes|=n,e.pingedLanes&=~n,u&&(e.warmLanes|=n),u=e.expirationTimes;for(var f=n;0<f;){var d=31-tt(f),v=1<<d;u[d]=-1,f&=~v}l!==0&&Eu(e,l,n)}function mo(){return(We&6)===0?(Hi(0),!1):!0}function Vf(){if(qe!==null){if(lt===0)var e=qe.return;else e=qe,ml=Rr=null,lf(e),ma=null,Si=0,e=qe;for(;e!==null;)Jy(e.alternate,e),e=e.return;qe=null}}function ka(e,n){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,jT(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),Cl=0,Vf(),st=e,qe=l=dl(e.current,null),Ve=n,lt=0,yn=null,$l=!1,Sa=vr(e,n),Lf=!1,wa=vn=Uf=Br=Wl=St=0,ln=Ui=null,Bf=!1,(n&8)!==0&&(n|=n&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=n;0<u;){var f=31-tt(u),d=1<<f;n|=e[f],u&=~d}return kl=n,_u(),l}function x0(e,n){Ne=null,U.H=Ri,n===ha||n===Vu?(n=Lg(),lt=3):n===Xc?(n=Lg(),lt=4):lt=n===xf?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,yn=n,qe===null&&(St=1,no(e,An(n,e.current)))}function S0(){var e=pn.current;return e===null?!0:(Ve&4194048)===Ve?On===null:(Ve&62914560)===Ve||(Ve&536870912)!==0?e===On:!1}function w0(){var e=U.H;return U.H=Ri,e===null?Ri:e}function E0(){var e=U.A;return U.A=hT,e}function po(){St=4,$l||(Ve&4194048)!==Ve&&pn.current!==null||(Sa=!0),(Wl&134217727)===0&&(Br&134217727)===0||st===null||nr(st,Ve,vn,!1)}function Ff(e,n,l){var u=We;We|=2;var f=w0(),d=E0();(st!==e||Ve!==n)&&(ho=null,ka(e,n)),n=!1;var v=St;e:do try{if(lt!==0&&qe!==null){var S=qe,z=yn;switch(lt){case 8:Vf(),v=6;break e;case 3:case 2:case 9:case 6:pn.current===null&&(n=!0);var F=lt;if(lt=0,yn=null,Ca(e,S,z,F),l&&Sa){v=0;break e}break;default:F=lt,lt=0,yn=null,Ca(e,S,z,F)}}gT(),v=St;break}catch(I){x0(e,I)}while(!0);return n&&e.shellSuspendCounter++,ml=Rr=null,We=u,U.H=f,U.A=d,qe===null&&(st=null,Ve=0,_u()),v}function gT(){for(;qe!==null;)k0(qe)}function yT(e,n){var l=We;We|=2;var u=w0(),f=E0();st!==e||Ve!==n?(ho=null,fo=pt()+500,ka(e,n)):Sa=vr(e,n);e:do try{if(lt!==0&&qe!==null){n=qe;var d=yn;t:switch(lt){case 1:lt=0,yn=null,Ca(e,n,d,1);break;case 2:case 9:if(_g(d)){lt=0,yn=null,C0(n);break}n=function(){lt!==2&&lt!==9||st!==e||(lt=7),Wn(e)},d.then(n,n);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:_g(d)?(lt=0,yn=null,C0(n)):(lt=0,yn=null,Ca(e,n,d,7));break;case 5:var v=null;switch(qe.tag){case 26:v=qe.memoizedState;case 5:case 27:var S=qe;if(v?cv(v):S.stateNode.complete){lt=0,yn=null;var z=S.sibling;if(z!==null)qe=z;else{var F=S.return;F!==null?(qe=F,go(F)):qe=null}break t}}lt=0,yn=null,Ca(e,n,d,5);break;case 6:lt=0,yn=null,Ca(e,n,d,6);break;case 8:Vf(),St=6;break e;default:throw Error(i(462))}}vT();break}catch(I){x0(e,I)}while(!0);return ml=Rr=null,U.H=u,U.A=f,We=l,qe!==null?0:(st=null,Ve=0,_u(),St)}function vT(){for(;qe!==null&&!ai();)k0(qe)}function k0(e){var n=Ky(e.alternate,e,kl);e.memoizedProps=e.pendingProps,n===null?go(e):qe=n}function C0(e){var n=e,l=n.alternate;switch(n.tag){case 15:case 0:n=Vy(l,n,n.pendingProps,n.type,void 0,Ve);break;case 11:n=Vy(l,n,n.pendingProps,n.type.render,n.ref,Ve);break;case 5:lf(n);default:Jy(l,n),n=qe=Eg(n,kl),n=Ky(l,n,kl)}e.memoizedProps=e.pendingProps,n===null?go(e):qe=n}function Ca(e,n,l,u){ml=Rr=null,lf(n),ma=null,Si=0;var f=n.return;try{if(iT(e,f,n,l,Ve)){St=1,no(e,An(l,e.current)),qe=null;return}}catch(d){if(f!==null)throw qe=f,d;St=1,no(e,An(l,e.current)),qe=null;return}n.flags&32768?(Ze||u===1?e=!0:Sa||(Ve&536870912)!==0?e=!1:($l=e=!0,(u===2||u===9||u===3||u===6)&&(u=pn.current,u!==null&&u.tag===13&&(u.flags|=16384))),T0(n,e)):go(n)}function go(e){var n=e;do{if((n.flags&32768)!==0){T0(n,$l);return}e=n.return;var l=sT(n.alternate,n,kl);if(l!==null){qe=l;return}if(n=n.sibling,n!==null){qe=n;return}qe=n=e}while(n!==null);St===0&&(St=5)}function T0(e,n){do{var l=cT(e.alternate,e);if(l!==null){l.flags&=32767,qe=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(e=e.sibling,e!==null)){qe=e;return}qe=e=l}while(e!==null);St=6,qe=null}function z0(e,n,l,u,f,d,v,S,z){e.cancelPendingCommit=null;do yo();while(Mt!==0);if((We&6)!==0)throw Error(i(327));if(n!==null){if(n===e.current)throw Error(i(177));if(d=n.lanes|n.childLanes,d|=Dc,sc(e,l,d,v,S,z),e===st&&(qe=st=null,Ve=0),Ea=n,tr=e,Cl=l,Hf=d,qf=f,g0=u,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,wT(we,function(){return O0(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||u){u=U.T,U.T=null,f=$.p,$.p=2,v=We,We|=4;try{fT(e,n,l)}finally{We=v,$.p=f,U.T=u}}Mt=1,A0(),R0(),D0()}}function A0(){if(Mt===1){Mt=0;var e=tr,n=Ea,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=U.T,U.T=null;var u=$.p;$.p=2;var f=We;We|=4;try{o0(n,e);var d=td,v=mg(e.containerInfo),S=d.focusedElem,z=d.selectionRange;if(v!==S&&S&&S.ownerDocument&&hg(S.ownerDocument.documentElement,S)){if(z!==null&&Cc(S)){var F=z.start,I=z.end;if(I===void 0&&(I=F),"selectionStart"in S)S.selectionStart=F,S.selectionEnd=Math.min(I,S.value.length);else{var W=S.ownerDocument||document,G=W&&W.defaultView||window;if(G.getSelection){var Q=G.getSelection(),ye=S.textContent.length,ze=Math.min(z.start,ye),ut=z.end===void 0?ze:Math.min(z.end,ye);!Q.extend&&ze>ut&&(v=ut,ut=ze,ze=v);var B=dg(S,ze),O=dg(S,ut);if(B&&O&&(Q.rangeCount!==1||Q.anchorNode!==B.node||Q.anchorOffset!==B.offset||Q.focusNode!==O.node||Q.focusOffset!==O.offset)){var V=W.createRange();V.setStart(B.node,B.offset),Q.removeAllRanges(),ze>ut?(Q.addRange(V),Q.extend(O.node,O.offset)):(V.setEnd(O.node,O.offset),Q.addRange(V))}}}}for(W=[],Q=S;Q=Q.parentNode;)Q.nodeType===1&&W.push({element:Q,left:Q.scrollLeft,top:Q.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<W.length;S++){var P=W[S];P.element.scrollLeft=P.left,P.element.scrollTop=P.top}}Ro=!!ed,td=ed=null}finally{We=f,$.p=u,U.T=l}}e.current=n,Mt=2}}function R0(){if(Mt===2){Mt=0;var e=tr,n=Ea,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=U.T,U.T=null;var u=$.p;$.p=2;var f=We;We|=4;try{l0(e,n.alternate,n)}finally{We=f,$.p=u,U.T=l}}Mt=3}}function D0(){if(Mt===4||Mt===3){Mt=0,ii();var e=tr,n=Ea,l=Cl,u=g0;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Mt=5:(Mt=0,Ea=tr=null,M0(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(er=null),ee(l),n=n.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(_t,n,void 0,(n.current.flags&128)===128)}catch{}if(u!==null){n=U.T,f=$.p,$.p=2,U.T=null;try{for(var d=e.onRecoverableError,v=0;v<u.length;v++){var S=u[v];d(S.value,{componentStack:S.stack})}}finally{U.T=n,$.p=f}}(Cl&3)!==0&&yo(),Wn(e),f=e.pendingLanes,(l&261930)!==0&&(f&42)!==0?e===Yf?Bi++:(Bi=0,Yf=e):Bi=0,Hi(0)}}function M0(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,bi(n)))}function yo(){return A0(),R0(),D0(),O0()}function O0(){if(Mt!==5)return!1;var e=tr,n=Hf;Hf=0;var l=ee(Cl),u=U.T,f=$.p;try{$.p=32>l?32:l,U.T=null,l=qf,qf=null;var d=tr,v=Cl;if(Mt=0,Ea=tr=null,Cl=0,(We&6)!==0)throw Error(i(331));var S=We;if(We|=4,h0(d.current),c0(d,d.current,v,l),We=S,Hi(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(_t,d)}catch{}return!0}finally{$.p=f,U.T=u,M0(e,n)}}function N0(e,n,l){n=An(l,n),n=bf(e.stateNode,n,2),e=Kl(e,n,2),e!==null&&(ql(e,2),Wn(e))}function rt(e,n,l){if(e.tag===3)N0(e,e,l);else for(;n!==null;){if(n.tag===3){N0(n,e,l);break}else if(n.tag===1){var u=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(er===null||!er.has(u))){e=An(l,e),l=_y(2),u=Kl(n,l,2),u!==null&&(jy(l,u,n,e),ql(u,2),Wn(u));break}}n=n.return}}function Gf(e,n,l){var u=e.pingCache;if(u===null){u=e.pingCache=new mT;var f=new Set;u.set(n,f)}else f=u.get(n),f===void 0&&(f=new Set,u.set(n,f));f.has(l)||(Lf=!0,f.add(l),e=bT.bind(null,e,n,l),n.then(e,e))}function bT(e,n,l){var u=e.pingCache;u!==null&&u.delete(n),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,st===e&&(Ve&l)===l&&(St===4||St===3&&(Ve&62914560)===Ve&&300>pt()-co?(We&2)===0&&ka(e,0):Uf|=l,wa===Ve&&(wa=0)),Wn(e)}function _0(e,n){n===0&&(n=br()),e=Tr(e,n),e!==null&&(ql(e,n),Wn(e))}function xT(e){var n=e.memoizedState,l=0;n!==null&&(l=n.retryLane),_0(e,l)}function ST(e,n){var l=0;switch(e.tag){case 31:case 13:var u=e.stateNode,f=e.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(n),_0(e,l)}function wT(e,n){return Ul(e,n)}var vo=null,Ta=null,Xf=!1,bo=!1,Qf=!1,lr=0;function Wn(e){e!==Ta&&e.next===null&&(Ta===null?vo=Ta=e:Ta=Ta.next=e),bo=!0,Xf||(Xf=!0,kT())}function Hi(e,n){if(!Qf&&bo){Qf=!0;do for(var l=!1,u=vo;u!==null;){if(e!==0){var f=u.pendingLanes;if(f===0)var d=0;else{var v=u.suspendedLanes,S=u.pingedLanes;d=(1<<31-tt(42|e)+1)-1,d&=f&~(v&~S),d=d&201326741?d&201326741|1:d?d|2:0}d!==0&&(l=!0,B0(u,d))}else d=Ve,d=yr(u,u===st?d:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(d&3)===0||vr(u,d)||(l=!0,B0(u,d));u=u.next}while(l);Qf=!1}}function ET(){j0()}function j0(){bo=Xf=!1;var e=0;lr!==0&&_T()&&(e=lr);for(var n=pt(),l=null,u=vo;u!==null;){var f=u.next,d=L0(u,n);d===0?(u.next=null,l===null?vo=f:l.next=f,f===null&&(Ta=l)):(l=u,(e!==0||(d&3)!==0)&&(bo=!0)),u=f}Mt!==0&&Mt!==5||Hi(e),lr!==0&&(lr=0)}function L0(e,n){for(var l=e.suspendedLanes,u=e.pingedLanes,f=e.expirationTimes,d=e.pendingLanes&-62914561;0<d;){var v=31-tt(d),S=1<<v,z=f[v];z===-1?((S&l)===0||(S&u)!==0)&&(f[v]=wu(S,n)):z<=n&&(e.expiredLanes|=S),d&=~S}if(n=st,l=Ve,l=yr(e,e===n?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,l===0||e===n&&(lt===2||lt===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&pr(u),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||vr(e,l)){if(n=l&-l,n===e.callbackPriority)return n;switch(u!==null&&pr(u),ee(l)){case 2:case 8:l=se;break;case 32:l=we;break;case 268435456:l=Ie;break;default:l=we}return u=U0.bind(null,e),l=Ul(l,u),e.callbackPriority=n,e.callbackNode=l,n}return u!==null&&u!==null&&pr(u),e.callbackPriority=2,e.callbackNode=null,2}function U0(e,n){if(Mt!==0&&Mt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(yo()&&e.callbackNode!==l)return null;var u=Ve;return u=yr(e,e===st?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(v0(e,u,n),L0(e,pt()),e.callbackNode!=null&&e.callbackNode===l?U0.bind(null,e):null)}function B0(e,n){if(yo())return null;v0(e,n,!0)}function kT(){LT(function(){(We&6)!==0?Ul(J,ET):j0()})}function Zf(){if(lr===0){var e=fa;e===0&&(e=ul,ul<<=1,(ul&261888)===0&&(ul=256)),lr=e}return lr}function H0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Tu(""+e)}function q0(e,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,e.id&&l.setAttribute("form",e.id),n.parentNode.insertBefore(l,n),e=new FormData(e),l.parentNode.removeChild(l),e}function CT(e,n,l,u,f){if(n==="submit"&&l&&l.stateNode===f){var d=H0((f[me]||null).action),v=u.submitter;v&&(n=(n=v[me]||null)?H0(n.formAction):v.getAttribute("formAction"),n!==null&&(d=n,v=null));var S=new Du("action","action",null,u,f);e.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(lr!==0){var z=v?q0(f,v):new FormData(f);hf(l,{pending:!0,data:z,method:f.method,action:d},null,z)}}else typeof d=="function"&&(S.preventDefault(),z=v?q0(f,v):new FormData(f),hf(l,{pending:!0,data:z,method:f.method,action:d},d,z))},currentTarget:f}]})}}for(var Kf=0;Kf<Rc.length;Kf++){var If=Rc[Kf],TT=If.toLowerCase(),zT=If[0].toUpperCase()+If.slice(1);Fn(TT,"on"+zT)}Fn(yg,"onAnimationEnd"),Fn(vg,"onAnimationIteration"),Fn(bg,"onAnimationStart"),Fn("dblclick","onDoubleClick"),Fn("focusin","onFocus"),Fn("focusout","onBlur"),Fn(F4,"onTransitionRun"),Fn(G4,"onTransitionStart"),Fn(X4,"onTransitionCancel"),Fn(xg,"onTransitionEnd"),Cn("onMouseEnter",["mouseout","mouseover"]),Cn("onMouseLeave",["mouseout","mouseover"]),Cn("onPointerEnter",["pointerout","pointerover"]),Cn("onPointerLeave",["pointerout","pointerover"]),Yn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qi));function Y0(e,n){n=(n&4)!==0;for(var l=0;l<e.length;l++){var u=e[l],f=u.event;u=u.listeners;e:{var d=void 0;if(n)for(var v=u.length-1;0<=v;v--){var S=u[v],z=S.instance,F=S.currentTarget;if(S=S.listener,z!==d&&f.isPropagationStopped())break e;d=S,f.currentTarget=F;try{d(f)}catch(I){Nu(I)}f.currentTarget=null,d=z}else for(v=0;v<u.length;v++){if(S=u[v],z=S.instance,F=S.currentTarget,S=S.listener,z!==d&&f.isPropagationStopped())break e;d=S,f.currentTarget=F;try{d(f)}catch(I){Nu(I)}f.currentTarget=null,d=z}}}}function Ye(e,n){var l=n[De];l===void 0&&(l=n[De]=new Set);var u=e+"__bubble";l.has(u)||(V0(n,e,2,!1),l.add(u))}function Jf(e,n,l){var u=0;n&&(u|=4),V0(l,e,u,n)}var xo="_reactListening"+Math.random().toString(36).slice(2);function Pf(e){if(!e[xo]){e[xo]=!0,qn.forEach(function(l){l!=="selectionchange"&&(AT.has(l)||Jf(l,!1,e),Jf(l,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[xo]||(n[xo]=!0,Jf("selectionchange",!1,n))}}function V0(e,n,l,u){switch(yv(n)){case 2:var f=nz;break;case 8:f=lz;break;default:f=dd}l=f.bind(null,n,l,e),f=void 0,!gc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),u?f!==void 0?e.addEventListener(n,l,{capture:!0,passive:f}):e.addEventListener(n,l,!0):f!==void 0?e.addEventListener(n,l,{passive:f}):e.addEventListener(n,l,!1)}function $f(e,n,l,u,f){var d=u;if((n&1)===0&&(n&2)===0&&u!==null)e:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var S=u.stateNode.containerInfo;if(S===f)break;if(v===4)for(v=u.return;v!==null;){var z=v.tag;if((z===3||z===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;S!==null;){if(v=bt(S),v===null)return;if(z=v.tag,z===5||z===6||z===26||z===27){u=d=v;continue e}S=S.parentNode}}u=u.return}Zp(function(){var F=d,I=mc(l),W=[];e:{var G=Sg.get(e);if(G!==void 0){var Q=Du,ye=e;switch(e){case"keypress":if(Au(l)===0)break e;case"keydown":case"keyup":Q=S4;break;case"focusin":ye="focus",Q=xc;break;case"focusout":ye="blur",Q=xc;break;case"beforeblur":case"afterblur":Q=xc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=Jp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=s4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=k4;break;case yg:case vg:case bg:Q=d4;break;case xg:Q=T4;break;case"scroll":case"scrollend":Q=u4;break;case"wheel":Q=A4;break;case"copy":case"cut":case"paste":Q=m4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=$p;break;case"toggle":case"beforetoggle":Q=D4}var ze=(n&4)!==0,ut=!ze&&(e==="scroll"||e==="scrollend"),B=ze?G!==null?G+"Capture":null:G;ze=[];for(var O=F,V;O!==null;){var P=O;if(V=P.stateNode,P=P.tag,P!==5&&P!==26&&P!==27||V===null||B===null||(P=oi(O,B),P!=null&&ze.push(Yi(O,P,V))),ut)break;O=O.return}0<ze.length&&(G=new Q(G,ye,null,l,I),W.push({event:G,listeners:ze}))}}if((n&7)===0){e:{if(G=e==="mouseover"||e==="pointerover",Q=e==="mouseout"||e==="pointerout",G&&l!==hc&&(ye=l.relatedTarget||l.fromElement)&&(bt(ye)||ye[be]))break e;if((Q||G)&&(G=I.window===I?I:(G=I.ownerDocument)?G.defaultView||G.parentWindow:window,Q?(ye=l.relatedTarget||l.toElement,Q=F,ye=ye?bt(ye):null,ye!==null&&(ut=s(ye),ze=ye.tag,ye!==ut||ze!==5&&ze!==27&&ze!==6)&&(ye=null)):(Q=null,ye=F),Q!==ye)){if(ze=Jp,P="onMouseLeave",B="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(ze=$p,P="onPointerLeave",B="onPointerEnter",O="pointer"),ut=Q==null?G:Ot(Q),V=ye==null?G:Ot(ye),G=new ze(P,O+"leave",Q,l,I),G.target=ut,G.relatedTarget=V,P=null,bt(I)===F&&(ze=new ze(B,O+"enter",ye,l,I),ze.target=V,ze.relatedTarget=ut,P=ze),ut=P,Q&&ye)t:{for(ze=RT,B=Q,O=ye,V=0,P=B;P;P=ze(P))V++;P=0;for(var ke=O;ke;ke=ze(ke))P++;for(;0<V-P;)B=ze(B),V--;for(;0<P-V;)O=ze(O),P--;for(;V--;){if(B===O||O!==null&&B===O.alternate){ze=B;break t}B=ze(B),O=ze(O)}ze=null}else ze=null;Q!==null&&F0(W,G,Q,ze,!1),ye!==null&&ut!==null&&F0(W,ut,ye,ze,!0)}}e:{if(G=F?Ot(F):window,Q=G.nodeName&&G.nodeName.toLowerCase(),Q==="select"||Q==="input"&&G.type==="file")var Pe=ig;else if(rg(G))if(ug)Pe=q4;else{Pe=B4;var xe=U4}else Q=G.nodeName,!Q||Q.toLowerCase()!=="input"||G.type!=="checkbox"&&G.type!=="radio"?F&&dc(F.elementType)&&(Pe=ig):Pe=H4;if(Pe&&(Pe=Pe(e,F))){ag(W,Pe,l,I);break e}xe&&xe(e,G,F),e==="focusout"&&F&&G.type==="number"&&F.memoizedProps.value!=null&&fc(G,"number",G.value)}switch(xe=F?Ot(F):window,e){case"focusin":(rg(xe)||xe.contentEditable==="true")&&(la=xe,Tc=F,gi=null);break;case"focusout":gi=Tc=la=null;break;case"mousedown":zc=!0;break;case"contextmenu":case"mouseup":case"dragend":zc=!1,pg(W,l,I);break;case"selectionchange":if(V4)break;case"keydown":case"keyup":pg(W,l,I)}var Le;if(wc)e:{switch(e){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else na?ng(e,l)&&(Fe="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(Fe="onCompositionStart");Fe&&(Wp&&l.locale!=="ko"&&(na||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&na&&(Le=Kp()):(Yl=I,yc="value"in Yl?Yl.value:Yl.textContent,na=!0)),xe=So(F,Fe),0<xe.length&&(Fe=new Pp(Fe,e,null,l,I),W.push({event:Fe,listeners:xe}),Le?Fe.data=Le:(Le=lg(l),Le!==null&&(Fe.data=Le)))),(Le=O4?N4(e,l):_4(e,l))&&(Fe=So(F,"onBeforeInput"),0<Fe.length&&(xe=new Pp("onBeforeInput","beforeinput",null,l,I),W.push({event:xe,listeners:Fe}),xe.data=Le)),CT(W,e,F,l,I)}Y0(W,n)})}function Yi(e,n,l){return{instance:e,listener:n,currentTarget:l}}function So(e,n){for(var l=n+"Capture",u=[];e!==null;){var f=e,d=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||d===null||(f=oi(e,l),f!=null&&u.unshift(Yi(e,f,d)),f=oi(e,n),f!=null&&u.push(Yi(e,f,d))),e.tag===3)return u;e=e.return}return[]}function RT(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function F0(e,n,l,u,f){for(var d=n._reactName,v=[];l!==null&&l!==u;){var S=l,z=S.alternate,F=S.stateNode;if(S=S.tag,z!==null&&z===u)break;S!==5&&S!==26&&S!==27||F===null||(z=F,f?(F=oi(l,d),F!=null&&v.unshift(Yi(l,F,z))):f||(F=oi(l,d),F!=null&&v.push(Yi(l,F,z)))),l=l.return}v.length!==0&&e.push({event:n,listeners:v})}var DT=/\r\n?/g,MT=/\u0000|\uFFFD/g;function G0(e){return(typeof e=="string"?e:""+e).replace(DT,`
`).replace(MT,"")}function X0(e,n){return n=G0(n),G0(e)===n}function it(e,n,l,u,f,d){switch(l){case"children":typeof u=="string"?n==="body"||n==="textarea"&&u===""||Wr(e,u):(typeof u=="number"||typeof u=="bigint")&&n!=="body"&&Wr(e,""+u);break;case"className":Vn(e,"class",u);break;case"tabIndex":Vn(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Vn(e,l,u);break;case"style":Xp(e,u,d);break;case"data":if(n!=="object"){Vn(e,"data",u);break}case"src":case"href":if(u===""&&(n!=="a"||l!=="href")){e.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(l);break}u=Tu(""+u),e.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof d=="function"&&(l==="formAction"?(n!=="input"&&it(e,n,"name",f.name,f,null),it(e,n,"formEncType",f.formEncType,f,null),it(e,n,"formMethod",f.formMethod,f,null),it(e,n,"formTarget",f.formTarget,f,null)):(it(e,n,"encType",f.encType,f,null),it(e,n,"method",f.method,f,null),it(e,n,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(l);break}u=Tu(""+u),e.setAttribute(l,u);break;case"onClick":u!=null&&(e.onclick=cl);break;case"onScroll":u!=null&&Ye("scroll",e);break;case"onScrollEnd":u!=null&&Ye("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}l=Tu(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(l,""+u):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":u===!0?e.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(l,u):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(l,u):e.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(l):e.setAttribute(l,u);break;case"popover":Ye("beforetoggle",e),Ye("toggle",e),Et(e,"popover",u);break;case"xlinkActuate":Lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Lt(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Lt(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Lt(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Lt(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Et(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=a4.get(l)||l,Et(e,l,u))}}function Wf(e,n,l,u,f,d){switch(l){case"style":Xp(e,u,d);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));e.innerHTML=l}}break;case"children":typeof u=="string"?Wr(e,u):(typeof u=="number"||typeof u=="bigint")&&Wr(e,""+u);break;case"onScroll":u!=null&&Ye("scroll",e);break;case"onScrollEnd":u!=null&&Ye("scrollend",e);break;case"onClick":u!=null&&(e.onclick=cl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dn.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),n=l.slice(2,f?l.length-7:void 0),d=e[me]||null,d=d!=null?d[l]:null,typeof d=="function"&&e.removeEventListener(n,d,f),typeof u=="function")){typeof d!="function"&&d!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(n,u,f);break e}l in e?e[l]=u:u===!0?e.setAttribute(l,""):Et(e,l,u)}}}function qt(e,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",e),Ye("load",e);var u=!1,f=!1,d;for(d in l)if(l.hasOwnProperty(d)){var v=l[d];if(v!=null)switch(d){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:it(e,n,d,v,l,null)}}f&&it(e,n,"srcSet",l.srcSet,l,null),u&&it(e,n,"src",l.src,l,null);return;case"input":Ye("invalid",e);var S=d=v=f=null,z=null,F=null;for(u in l)if(l.hasOwnProperty(u)){var I=l[u];if(I!=null)switch(u){case"name":f=I;break;case"type":v=I;break;case"checked":z=I;break;case"defaultChecked":F=I;break;case"value":d=I;break;case"defaultValue":S=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(137,n));break;default:it(e,n,u,I,l,null)}}Yp(e,d,S,z,F,v,f,!1);return;case"select":Ye("invalid",e),u=v=d=null;for(f in l)if(l.hasOwnProperty(f)&&(S=l[f],S!=null))switch(f){case"value":d=S;break;case"defaultValue":v=S;break;case"multiple":u=S;default:it(e,n,f,S,l,null)}n=d,l=v,e.multiple=!!u,n!=null?$r(e,!!u,n,!1):l!=null&&$r(e,!!u,l,!0);return;case"textarea":Ye("invalid",e),d=f=u=null;for(v in l)if(l.hasOwnProperty(v)&&(S=l[v],S!=null))switch(v){case"value":u=S;break;case"defaultValue":f=S;break;case"children":d=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:it(e,n,v,S,l,null)}Fp(e,u,f,d);return;case"option":for(z in l)if(l.hasOwnProperty(z)&&(u=l[z],u!=null))switch(z){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:it(e,n,z,u,l,null)}return;case"dialog":Ye("beforetoggle",e),Ye("toggle",e),Ye("cancel",e),Ye("close",e);break;case"iframe":case"object":Ye("load",e);break;case"video":case"audio":for(u=0;u<qi.length;u++)Ye(qi[u],e);break;case"image":Ye("error",e),Ye("load",e);break;case"details":Ye("toggle",e);break;case"embed":case"source":case"link":Ye("error",e),Ye("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in l)if(l.hasOwnProperty(F)&&(u=l[F],u!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:it(e,n,F,u,l,null)}return;default:if(dc(n)){for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!==void 0&&Wf(e,n,I,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&it(e,n,S,u,l,null))}function OT(e,n,l,u){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,d=null,v=null,S=null,z=null,F=null,I=null;for(Q in l){var W=l[Q];if(l.hasOwnProperty(Q)&&W!=null)switch(Q){case"checked":break;case"value":break;case"defaultValue":z=W;default:u.hasOwnProperty(Q)||it(e,n,Q,null,u,W)}}for(var G in u){var Q=u[G];if(W=l[G],u.hasOwnProperty(G)&&(Q!=null||W!=null))switch(G){case"type":d=Q;break;case"name":f=Q;break;case"checked":F=Q;break;case"defaultChecked":I=Q;break;case"value":v=Q;break;case"defaultValue":S=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(i(137,n));break;default:Q!==W&&it(e,n,G,Q,u,W)}}cc(e,v,S,z,F,I,d,f);return;case"select":Q=v=S=G=null;for(d in l)if(z=l[d],l.hasOwnProperty(d)&&z!=null)switch(d){case"value":break;case"multiple":Q=z;default:u.hasOwnProperty(d)||it(e,n,d,null,u,z)}for(f in u)if(d=u[f],z=l[f],u.hasOwnProperty(f)&&(d!=null||z!=null))switch(f){case"value":G=d;break;case"defaultValue":S=d;break;case"multiple":v=d;default:d!==z&&it(e,n,f,d,u,z)}n=S,l=v,u=Q,G!=null?$r(e,!!l,G,!1):!!u!=!!l&&(n!=null?$r(e,!!l,n,!0):$r(e,!!l,l?[]:"",!1));return;case"textarea":Q=G=null;for(S in l)if(f=l[S],l.hasOwnProperty(S)&&f!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:it(e,n,S,null,u,f)}for(v in u)if(f=u[v],d=l[v],u.hasOwnProperty(v)&&(f!=null||d!=null))switch(v){case"value":G=f;break;case"defaultValue":Q=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==d&&it(e,n,v,f,u,d)}Vp(e,G,Q);return;case"option":for(var ye in l)if(G=l[ye],l.hasOwnProperty(ye)&&G!=null&&!u.hasOwnProperty(ye))switch(ye){case"selected":e.selected=!1;break;default:it(e,n,ye,null,u,G)}for(z in u)if(G=u[z],Q=l[z],u.hasOwnProperty(z)&&G!==Q&&(G!=null||Q!=null))switch(z){case"selected":e.selected=G&&typeof G!="function"&&typeof G!="symbol";break;default:it(e,n,z,G,u,Q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ze in l)G=l[ze],l.hasOwnProperty(ze)&&G!=null&&!u.hasOwnProperty(ze)&&it(e,n,ze,null,u,G);for(F in u)if(G=u[F],Q=l[F],u.hasOwnProperty(F)&&G!==Q&&(G!=null||Q!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,n));break;default:it(e,n,F,G,u,Q)}return;default:if(dc(n)){for(var ut in l)G=l[ut],l.hasOwnProperty(ut)&&G!==void 0&&!u.hasOwnProperty(ut)&&Wf(e,n,ut,void 0,u,G);for(I in u)G=u[I],Q=l[I],!u.hasOwnProperty(I)||G===Q||G===void 0&&Q===void 0||Wf(e,n,I,G,u,Q);return}}for(var B in l)G=l[B],l.hasOwnProperty(B)&&G!=null&&!u.hasOwnProperty(B)&&it(e,n,B,null,u,G);for(W in u)G=u[W],Q=l[W],!u.hasOwnProperty(W)||G===Q||G==null&&Q==null||it(e,n,W,G,u,Q)}function Q0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function NT(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var f=l[u],d=f.transferSize,v=f.initiatorType,S=f.duration;if(d&&S&&Q0(v)){for(v=0,S=f.responseEnd,u+=1;u<l.length;u++){var z=l[u],F=z.startTime;if(F>S)break;var I=z.transferSize,W=z.initiatorType;I&&Q0(W)&&(z=z.responseEnd,v+=I*(z<S?1:(S-F)/(z-F)))}if(--u,n+=8*(d+v)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ed=null,td=null;function wo(e){return e.nodeType===9?e:e.ownerDocument}function Z0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K0(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function nd(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var ld=null;function _T(){var e=window.event;return e&&e.type==="popstate"?e===ld?!1:(ld=e,!0):(ld=null,!1)}var I0=typeof setTimeout=="function"?setTimeout:void 0,jT=typeof clearTimeout=="function"?clearTimeout:void 0,J0=typeof Promise=="function"?Promise:void 0,LT=typeof queueMicrotask=="function"?queueMicrotask:typeof J0<"u"?function(e){return J0.resolve(null).then(e).catch(UT)}:I0;function UT(e){setTimeout(function(){throw e})}function rr(e){return e==="head"}function P0(e,n){var l=n,u=0;do{var f=l.nextSibling;if(e.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(u===0){e.removeChild(f),Da(n);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Vi(e.ownerDocument.documentElement);else if(l==="head"){l=e.ownerDocument.head,Vi(l);for(var d=l.firstChild;d;){var v=d.nextSibling,S=d.nodeName;d[gt]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&d.rel.toLowerCase()==="stylesheet"||l.removeChild(d),d=v}}else l==="body"&&Vi(e.ownerDocument.body);l=f}while(l);Da(n)}function $0(e,n){var l=e;e=0;do{var u=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(e===0)break;e--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||e++;l=u}while(l)}function rd(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":rd(l),vt(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function BT(e,n,l,u){for(;e.nodeType===1;){var f=l;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[gt])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(d=e.getAttribute("rel"),d==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(d!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(d=e.getAttribute("src"),(d!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&d&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var d=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===d)return e}else return e;if(e=Nn(e.nextSibling),e===null)break}return null}function HT(e,n,l){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=Nn(e.nextSibling),e===null))return null;return e}function W0(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Nn(e.nextSibling),e===null))return null;return e}function ad(e){return e.data==="$?"||e.data==="$~"}function id(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function qT(e,n){var l=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||l.readyState!=="loading")n();else{var u=function(){n(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function Nn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var ud=null;function ev(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="/$"||l==="/&"){if(n===0)return Nn(e.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}e=e.nextSibling}return null}function tv(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return e;n--}else l!=="/$"&&l!=="/&"||n++}e=e.previousSibling}return null}function nv(e,n,l){switch(n=wo(l),e){case"html":if(e=n.documentElement,!e)throw Error(i(452));return e;case"head":if(e=n.head,!e)throw Error(i(453));return e;case"body":if(e=n.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Vi(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);vt(e)}var _n=new Map,lv=new Set;function Eo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Tl=$.d;$.d={f:YT,r:VT,D:FT,C:GT,L:XT,m:QT,X:KT,S:ZT,M:IT};function YT(){var e=Tl.f(),n=mo();return e||n}function VT(e){var n=Ge(e);n!==null&&n.tag===5&&n.type==="form"?xy(n):Tl.r(e)}var za=typeof document>"u"?null:document;function rv(e,n,l){var u=za;if(u&&typeof n=="string"&&n){var f=Tn(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),lv.has(f)||(lv.add(f),e={rel:e,crossOrigin:l,href:n},u.querySelector(f)===null&&(n=u.createElement("link"),qt(n,"link",e),ht(n),u.head.appendChild(n)))}}function FT(e){Tl.D(e),rv("dns-prefetch",e,null)}function GT(e,n){Tl.C(e,n),rv("preconnect",e,n)}function XT(e,n,l){Tl.L(e,n,l);var u=za;if(u&&e&&n){var f='link[rel="preload"][as="'+Tn(n)+'"]';n==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+Tn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+Tn(l.imageSizes)+'"]')):f+='[href="'+Tn(e)+'"]';var d=f;switch(n){case"style":d=Aa(e);break;case"script":d=Ra(e)}_n.has(d)||(e=g({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:e,as:n},l),_n.set(d,e),u.querySelector(f)!==null||n==="style"&&u.querySelector(Fi(d))||n==="script"&&u.querySelector(Gi(d))||(n=u.createElement("link"),qt(n,"link",e),ht(n),u.head.appendChild(n)))}}function QT(e,n){Tl.m(e,n);var l=za;if(l&&e){var u=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Tn(u)+'"][href="'+Tn(e)+'"]',d=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":d=Ra(e)}if(!_n.has(d)&&(e=g({rel:"modulepreload",href:e},n),_n.set(d,e),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Gi(d)))return}u=l.createElement("link"),qt(u,"link",e),ht(u),l.head.appendChild(u)}}}function ZT(e,n,l){Tl.S(e,n,l);var u=za;if(u&&e){var f=$t(u).hoistableStyles,d=Aa(e);n=n||"default";var v=f.get(d);if(!v){var S={loading:0,preload:null};if(v=u.querySelector(Fi(d)))S.loading=5;else{e=g({rel:"stylesheet",href:e,"data-precedence":n},l),(l=_n.get(d))&&od(e,l);var z=v=u.createElement("link");ht(z),qt(z,"link",e),z._p=new Promise(function(F,I){z.onload=F,z.onerror=I}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,ko(v,n,u)}v={type:"stylesheet",instance:v,count:1,state:S},f.set(d,v)}}}function KT(e,n){Tl.X(e,n);var l=za;if(l&&e){var u=$t(l).hoistableScripts,f=Ra(e),d=u.get(f);d||(d=l.querySelector(Gi(f)),d||(e=g({src:e,async:!0},n),(n=_n.get(f))&&sd(e,n),d=l.createElement("script"),ht(d),qt(d,"link",e),l.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},u.set(f,d))}}function IT(e,n){Tl.M(e,n);var l=za;if(l&&e){var u=$t(l).hoistableScripts,f=Ra(e),d=u.get(f);d||(d=l.querySelector(Gi(f)),d||(e=g({src:e,async:!0,type:"module"},n),(n=_n.get(f))&&sd(e,n),d=l.createElement("script"),ht(d),qt(d,"link",e),l.head.appendChild(d)),d={type:"script",instance:d,count:1,state:null},u.set(f,d))}}function av(e,n,l,u){var f=(f=ge.current)?Eo(f):null;if(!f)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=Aa(l.href),l=$t(f).hoistableStyles,u=l.get(n),u||(u={type:"style",instance:null,count:0,state:null},l.set(n,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=Aa(l.href);var d=$t(f).hoistableStyles,v=d.get(e);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,v),(d=f.querySelector(Fi(e)))&&!d._p&&(v.instance=d,v.state.loading=5),_n.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},_n.set(e,l),d||JT(f,e,l,v.state))),n&&u===null)throw Error(i(528,""));return v}if(n&&u!==null)throw Error(i(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Ra(l),l=$t(f).hoistableScripts,u=l.get(n),u||(u={type:"script",instance:null,count:0,state:null},l.set(n,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Aa(e){return'href="'+Tn(e)+'"'}function Fi(e){return'link[rel="stylesheet"]['+e+"]"}function iv(e){return g({},e,{"data-precedence":e.precedence,precedence:null})}function JT(e,n,l,u){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?u.loading=1:(n=e.createElement("link"),u.preload=n,n.addEventListener("load",function(){return u.loading|=1}),n.addEventListener("error",function(){return u.loading|=2}),qt(n,"link",l),ht(n),e.head.appendChild(n))}function Ra(e){return'[src="'+Tn(e)+'"]'}function Gi(e){return"script[async]"+e}function uv(e,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var u=e.querySelector('style[data-href~="'+Tn(l.href)+'"]');if(u)return n.instance=u,ht(u),u;var f=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),ht(u),qt(u,"style",f),ko(u,l.precedence,e),n.instance=u;case"stylesheet":f=Aa(l.href);var d=e.querySelector(Fi(f));if(d)return n.state.loading|=4,n.instance=d,ht(d),d;u=iv(l),(f=_n.get(f))&&od(u,f),d=(e.ownerDocument||e).createElement("link"),ht(d);var v=d;return v._p=new Promise(function(S,z){v.onload=S,v.onerror=z}),qt(d,"link",u),n.state.loading|=4,ko(d,l.precedence,e),n.instance=d;case"script":return d=Ra(l.src),(f=e.querySelector(Gi(d)))?(n.instance=f,ht(f),f):(u=l,(f=_n.get(d))&&(u=g({},l),sd(u,f)),e=e.ownerDocument||e,f=e.createElement("script"),ht(f),qt(f,"link",u),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(u=n.instance,n.state.loading|=4,ko(u,l.precedence,e));return n.instance}function ko(e,n,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,d=f,v=0;v<u.length;v++){var S=u[v];if(S.dataset.precedence===n)d=S;else if(d!==f)break}d?d.parentNode.insertBefore(e,d.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(e,n.firstChild))}function od(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function sd(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Co=null;function ov(e,n,l){if(Co===null){var u=new Map,f=Co=new Map;f.set(l,u)}else f=Co,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(e))return u;for(u.set(e,null),l=l.getElementsByTagName(e),f=0;f<l.length;f++){var d=l[f];if(!(d[gt]||d[fe]||e==="link"&&d.getAttribute("rel")==="stylesheet")&&d.namespaceURI!=="http://www.w3.org/2000/svg"){var v=d.getAttribute(n)||"";v=e+v;var S=u.get(v);S?S.push(d):u.set(v,[d])}}return u}function sv(e,n,l){e=e.ownerDocument||e,e.head.insertBefore(l,n==="title"?e.querySelector("head > title"):null)}function PT(e,n,l){if(l===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function cv(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function $T(e,n,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=Aa(u.href),d=n.querySelector(Fi(f));if(d){n=d._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=To.bind(e),n.then(e,e)),l.state.loading|=4,l.instance=d,ht(d);return}d=n.ownerDocument||n,u=iv(u),(f=_n.get(f))&&od(u,f),d=d.createElement("link"),ht(d);var v=d;v._p=new Promise(function(S,z){v.onload=S,v.onerror=z}),qt(d,"link",u),l.instance=d}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(e.count++,l=To.bind(e),n.addEventListener("load",l),n.addEventListener("error",l))}}var cd=0;function WT(e,n){return e.stylesheets&&e.count===0&&Ao(e,e.stylesheets),0<e.count||0<e.imgCount?function(l){var u=setTimeout(function(){if(e.stylesheets&&Ao(e,e.stylesheets),e.unsuspend){var d=e.unsuspend;e.unsuspend=null,d()}},6e4+n);0<e.imgBytes&&cd===0&&(cd=62500*NT());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Ao(e,e.stylesheets),e.unsuspend)){var d=e.unsuspend;e.unsuspend=null,d()}},(e.imgBytes>cd?50:800)+n);return e.unsuspend=l,function(){e.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function To(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ao(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var zo=null;function Ao(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,zo=new Map,n.forEach(ez,e),zo=null,To.call(e))}function ez(e,n){if(!(n.state.loading&4)){var l=zo.get(e);if(l)var u=l.get(null);else{l=new Map,zo.set(e,l);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),d=0;d<f.length;d++){var v=f[d];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),u=v)}u&&l.set(null,u)}f=n.instance,v=f.getAttribute("data-precedence"),d=l.get(v)||u,d===u&&l.set(null,f),l.set(v,f),this.count++,u=To.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),d?d.parentNode.insertBefore(f,d.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var Xi={$$typeof:H,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function tz(e,n,l,u,f,d,v,S,z){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hl(0),this.hiddenUpdates=Hl(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=d,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function fv(e,n,l,u,f,d,v,S,z,F,I,W){return e=new tz(e,n,l,v,z,F,I,W,S),n=1,d===!0&&(n|=24),d=mn(3,null,null,n),e.current=d,d.stateNode=e,n=Vc(),n.refCount++,e.pooledCache=n,n.refCount++,d.memoizedState={element:u,isDehydrated:l,cache:n},Qc(d),e}function dv(e){return e?(e=ia,e):ia}function hv(e,n,l,u,f,d){f=dv(f),u.context===null?u.context=f:u.pendingContext=f,u=Zl(n),u.payload={element:l},d=d===void 0?null:d,d!==null&&(u.callback=d),l=Kl(e,u,n),l!==null&&(rn(l,e,n),Ei(l,e,n))}function mv(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<n?l:n}}function fd(e,n){mv(e,n),(e=e.alternate)&&mv(e,n)}function pv(e){if(e.tag===13||e.tag===31){var n=Tr(e,67108864);n!==null&&rn(n,e,67108864),fd(e,67108864)}}function gv(e){if(e.tag===13||e.tag===31){var n=bn();n=X(n);var l=Tr(e,n);l!==null&&rn(l,e,n),fd(e,n)}}var Ro=!0;function nz(e,n,l,u){var f=U.T;U.T=null;var d=$.p;try{$.p=2,dd(e,n,l,u)}finally{$.p=d,U.T=f}}function lz(e,n,l,u){var f=U.T;U.T=null;var d=$.p;try{$.p=8,dd(e,n,l,u)}finally{$.p=d,U.T=f}}function dd(e,n,l,u){if(Ro){var f=hd(u);if(f===null)$f(e,n,u,Do,l),vv(e,u);else if(az(f,e,n,l,u))u.stopPropagation();else if(vv(e,u),n&4&&-1<rz.indexOf(e)){for(;f!==null;){var d=Ge(f);if(d!==null)switch(d.tag){case 3:if(d=d.stateNode,d.current.memoizedState.isDehydrated){var v=ol(d.pendingLanes);if(v!==0){var S=d;for(S.pendingLanes|=2,S.entangledLanes|=2;v;){var z=1<<31-tt(v);S.entanglements[1]|=z,v&=~z}Wn(d),(We&6)===0&&(fo=pt()+500,Hi(0))}}break;case 31:case 13:S=Tr(d,2),S!==null&&rn(S,d,2),mo(),fd(d,2)}if(d=hd(u),d===null&&$f(e,n,u,Do,l),d===f)break;f=d}f!==null&&u.stopPropagation()}else $f(e,n,u,null,l)}}function hd(e){return e=mc(e),md(e)}var Do=null;function md(e){if(Do=null,e=bt(e),e!==null){var n=s(e);if(n===null)e=null;else{var l=n.tag;if(l===13){if(e=c(n),e!==null)return e;e=null}else if(l===31){if(e=h(n),e!==null)return e;e=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Do=e,null}function yv(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(il()){case J:return 2;case se:return 8;case we:case Re:return 32;case Ie:return 268435456;default:return 32}default:return 32}}var pd=!1,ar=null,ir=null,ur=null,Qi=new Map,Zi=new Map,or=[],rz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vv(e,n){switch(e){case"focusin":case"focusout":ar=null;break;case"dragenter":case"dragleave":ir=null;break;case"mouseover":case"mouseout":ur=null;break;case"pointerover":case"pointerout":Qi.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zi.delete(n.pointerId)}}function Ki(e,n,l,u,f,d){return e===null||e.nativeEvent!==d?(e={blockedOn:n,domEventName:l,eventSystemFlags:u,nativeEvent:d,targetContainers:[f]},n!==null&&(n=Ge(n),n!==null&&pv(n)),e):(e.eventSystemFlags|=u,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function az(e,n,l,u,f){switch(n){case"focusin":return ar=Ki(ar,e,n,l,u,f),!0;case"dragenter":return ir=Ki(ir,e,n,l,u,f),!0;case"mouseover":return ur=Ki(ur,e,n,l,u,f),!0;case"pointerover":var d=f.pointerId;return Qi.set(d,Ki(Qi.get(d)||null,e,n,l,u,f)),!0;case"gotpointercapture":return d=f.pointerId,Zi.set(d,Ki(Zi.get(d)||null,e,n,l,u,f)),!0}return!1}function bv(e){var n=bt(e.target);if(n!==null){var l=s(n);if(l!==null){if(n=l.tag,n===13){if(n=c(l),n!==null){e.blockedOn=n,Se(e.priority,function(){gv(l)});return}}else if(n===31){if(n=h(l),n!==null){e.blockedOn=n,Se(e.priority,function(){gv(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mo(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var l=hd(e.nativeEvent);if(l===null){l=e.nativeEvent;var u=new l.constructor(l.type,l);hc=u,l.target.dispatchEvent(u),hc=null}else return n=Ge(l),n!==null&&pv(n),e.blockedOn=l,!1;n.shift()}return!0}function xv(e,n,l){Mo(e)&&l.delete(n)}function iz(){pd=!1,ar!==null&&Mo(ar)&&(ar=null),ir!==null&&Mo(ir)&&(ir=null),ur!==null&&Mo(ur)&&(ur=null),Qi.forEach(xv),Zi.forEach(xv)}function Oo(e,n){e.blockedOn===n&&(e.blockedOn=null,pd||(pd=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,iz)))}var No=null;function Sv(e){No!==e&&(No=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){No===e&&(No=null);for(var n=0;n<e.length;n+=3){var l=e[n],u=e[n+1],f=e[n+2];if(typeof u!="function"){if(md(u||l)===null)continue;break}var d=Ge(l);d!==null&&(e.splice(n,3),n-=3,hf(d,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function Da(e){function n(z){return Oo(z,e)}ar!==null&&Oo(ar,e),ir!==null&&Oo(ir,e),ur!==null&&Oo(ur,e),Qi.forEach(n),Zi.forEach(n);for(var l=0;l<or.length;l++){var u=or[l];u.blockedOn===e&&(u.blockedOn=null)}for(;0<or.length&&(l=or[0],l.blockedOn===null);)bv(l),l.blockedOn===null&&or.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],d=l[u+1],v=f[me]||null;if(typeof d=="function")v||Sv(l);else if(v){var S=null;if(d&&d.hasAttribute("formAction")){if(f=d,v=d[me]||null)S=v.formAction;else if(md(f)!==null)continue}else S=v.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),Sv(l)}}}function wv(){function e(d){d.canIntercept&&d.info==="react-transition"&&d.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var d=navigation.currentEntry;d&&d.url!=null&&navigation.navigate(d.url,{state:d.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function gd(e){this._internalRoot=e}_o.prototype.render=gd.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(i(409));var l=n.current,u=bn();hv(l,u,e,n,null,null)},_o.prototype.unmount=gd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;hv(e.current,2,null,e,null,null),mo(),n[be]=null}};function _o(e){this._internalRoot=e}_o.prototype.unstable_scheduleHydration=function(e){if(e){var n=ce();e={blockedOn:null,target:e,priority:n};for(var l=0;l<or.length&&n!==0&&n<or[l].priority;l++);or.splice(l,0,e),l===0&&bv(e)}};var Ev=r.version;if(Ev!=="19.2.4")throw Error(i(527,Ev,"19.2.4"));$.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(n),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var uz={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jo.isDisabled&&jo.supportsFiber)try{_t=jo.inject(uz),nt=jo}catch{}}return Oa.createRoot=function(e,n){if(!o(e))throw Error(i(299));var l=!1,u="",f=Dy,d=My,v=Oy;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=fv(e,1,!1,null,null,l,u,null,f,d,v,wv),e[be]=n.current,Pf(e),new gd(n)},Oa.hydrateRoot=function(e,n,l){if(!o(e))throw Error(i(299));var u=!1,f="",d=Dy,v=My,S=Oy,z=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(d=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.formState!==void 0&&(z=l.formState)),n=fv(e,1,!0,n,l??null,u,f,z,d,v,S,wv),n.context=dv(null),l=n.current,u=bn(),u=X(u),f=Zl(u),f.callback=null,Kl(l,f,u),l=u,n.current.lanes=l,ql(n,l),Wn(n),e[be]=n.current,Pf(e),new _o(n)},Oa.version="19.2.4",Oa}var zd;function Nv(){if(zd)return Ho.exports;zd=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Ho.exports=Ov(),Ho.exports}var _v=Nv();/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ad=t=>{throw TypeError(t)},jv=(t,r,a)=>r.has(t)||Ad("Cannot "+a),Fo=(t,r,a)=>(jv(t,r,"read from private field"),a?a.call(t):r.get(t)),Lv=(t,r,a)=>r.has(t)?Ad("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,a),Rd="popstate";function Uv(t={}){function r(o,s){let{pathname:c="/",search:h="",hash:p=""}=tl(o.location.hash.substring(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),Na("",{pathname:c,search:h,hash:p},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){let c=o.document.querySelector("base"),h="";if(c&&c.getAttribute("href")){let p=o.location.href,m=p.indexOf("#");h=m===-1?p:p.slice(0,m)}return h+"#"+(typeof s=="string"?s:Qn(s))}function i(o,s){wt(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return Hv(r,a,i,t)}function Ue(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function wt(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Bv(){return Math.random().toString(36).substring(2,10)}function Dd(t,r){return{usr:t.state,key:t.key,idx:r}}function Na(t,r,a=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?tl(r):r,state:a,key:r&&r.key||i||Bv()}}function Qn({pathname:t="/",search:r="",hash:a=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function tl(t){let r={};if(t){let a=t.indexOf("#");a>=0&&(r.hash=t.substring(a),t=t.substring(0,a));let i=t.indexOf("?");i>=0&&(r.search=t.substring(i),t=t.substring(0,i)),t&&(r.pathname=t)}return r}function Hv(t,r,a,i={}){let{window:o=document.defaultView,v5Compat:s=!1}=i,c=o.history,h="POP",p=null,m=y();m==null&&(m=0,c.replaceState({...c.state,idx:m},""));function y(){return(c.state||{idx:null}).idx}function g(){h="POP";let N=y(),R=N==null?null:N-m;m=N,p&&p({action:h,location:D.location,delta:R})}function x(N,R){h="PUSH";let _=Na(D.location,N,R);a&&a(_,N),m=y()+1;let H=Dd(_,m),ie=D.createHref(_);try{c.pushState(H,"",ie)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;o.location.assign(ie)}s&&p&&p({action:h,location:D.location,delta:1})}function b(N,R){h="REPLACE";let _=Na(D.location,N,R);a&&a(_,N),m=y();let H=Dd(_,m),ie=D.createHref(_);c.replaceState(H,"",ie),s&&p&&p({action:h,location:D.location,delta:0})}function k(N){return Md(N)}let D={get action(){return h},get location(){return t(o,c)},listen(N){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(Rd,g),p=N,()=>{o.removeEventListener(Rd,g),p=null}},createHref(N){return r(o,N)},createURL:k,encodeLocation(N){let R=k(N);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:x,replace:b,go(N){return c.go(N)}};return D}function Md(t,r=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Ue(a,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Qn(t);return i=i.replace(/ $/,"%20"),!r&&i.startsWith("//")&&(i=a+i),new URL(i,a)}var _a,Od=class{constructor(t){if(Lv(this,_a,new Map),t)for(let[r,a]of t)this.set(r,a)}get(t){if(Fo(this,_a).has(t))return Fo(this,_a).get(t);if(t.defaultValue!==void 0)return t.defaultValue;throw new Error("No value found for context")}set(t,r){Fo(this,_a).set(t,r)}};_a=new WeakMap;var qv=new Set(["lazy","caseSensitive","path","id","index","children"]);function Yv(t){return qv.has(t)}var Vv=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function Fv(t){return Vv.has(t)}function Gv(t){return t.index===!0}function ja(t,r,a=[],i={},o=!1){return t.map((s,c)=>{let h=[...a,String(c)],p=typeof s.id=="string"?s.id:h.join("-");if(Ue(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ue(o||!i[p],`Found a route id collision on id "${p}".  Route id's must be globally unique within Data Router usages`),Gv(s)){let m={...s,id:p};return i[p]=Nd(m,r(m)),m}else{let m={...s,id:p,children:void 0};return i[p]=Nd(m,r(m)),s.children&&(m.children=ja(s.children,r,h,i,o)),m}})}function Nd(t,r){return Object.assign(t,{...r,...typeof r.lazy=="object"&&r.lazy!=null?{lazy:{...t.lazy,...r.lazy}}:{}})}function Rl(t,r,a="/"){return La(t,r,a,!1)}function La(t,r,a,i){let o=typeof r=="string"?tl(r):r,s=xn(o.pathname||"/",a);if(s==null)return null;let c=_d(t);Qv(c);let h=null;for(let p=0;h==null&&p<c.length;++p){let m=lb(s);h=tb(c[p],m,i)}return h}function Xv(t,r){let{route:a,pathname:i,params:o}=t;return{id:a.id,pathname:i,params:o,data:r[a.id],loaderData:r[a.id],handle:a.handle}}function _d(t,r=[],a=[],i="",o=!1){let s=(c,h,p=o,m)=>{let y={relativePath:m===void 0?c.path||"":m,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(i)&&p)return;Ue(y.relativePath.startsWith(i),`Absolute route path "${y.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(i.length)}let g=Zn([i,y.relativePath]),x=a.concat(y);c.children&&c.children.length>0&&(Ue(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),_d(c.children,r,x,g,p)),!(c.path==null&&!c.index)&&r.push({path:g,score:Wv(g,c.index),routesMeta:x})};return t.forEach((c,h)=>{var p;if(c.path===""||!((p=c.path)!=null&&p.includes("?")))s(c,h);else for(let m of jd(c.path))s(c,h,!0,m)}),r}function jd(t){let r=t.split("/");if(r.length===0)return[];let[a,...i]=r,o=a.endsWith("?"),s=a.replace(/\?$/,"");if(i.length===0)return o?[s,""]:[s];let c=jd(i.join("/")),h=[];return h.push(...c.map(p=>p===""?s:[s,p].join("/"))),o&&h.push(...c),h.map(p=>t.startsWith("/")&&p===""?"/":p)}function Qv(t){t.sort((r,a)=>r.score!==a.score?a.score-r.score:eb(r.routesMeta.map(i=>i.childrenIndex),a.routesMeta.map(i=>i.childrenIndex)))}var Zv=/^:[\w-]+$/,Kv=3,Iv=2,Jv=1,Pv=10,$v=-2,Ld=t=>t==="*";function Wv(t,r){let a=t.split("/"),i=a.length;return a.some(Ld)&&(i+=$v),r&&(i+=Iv),a.filter(o=>!Ld(o)).reduce((o,s)=>o+(Zv.test(s)?Kv:s===""?Jv:Pv),i)}function eb(t,r){return t.length===r.length&&t.slice(0,-1).every((i,o)=>i===r[o])?t[t.length-1]-r[r.length-1]:0}function tb(t,r,a=!1){let{routesMeta:i}=t,o={},s="/",c=[];for(let h=0;h<i.length;++h){let p=i[h],m=h===i.length-1,y=s==="/"?r:r.slice(s.length)||"/",g=Ii({path:p.relativePath,caseSensitive:p.caseSensitive,end:m},y),x=p.route;if(!g&&m&&a&&!i[i.length-1].route.index&&(g=Ii({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},y)),!g)return null;Object.assign(o,g.params),c.push({params:o,pathname:Zn([s,g.pathname]),pathnameBase:ib(Zn([s,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(s=Zn([s,g.pathnameBase]))}return c}function Ii(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,i]=nb(t.path,t.caseSensitive,t.end),o=r.match(a);if(!o)return null;let s=o[0],c=s.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:i.reduce((m,{paramName:y,isOptional:g},x)=>{if(y==="*"){let k=h[x]||"";c=s.slice(0,s.length-k.length).replace(/(.)\/+$/,"$1")}const b=h[x];return g&&!b?m[y]=void 0:m[y]=(b||"").replace(/%2F/g,"/"),m},{}),pathname:s,pathnameBase:c,pattern:t}}function nb(t,r=!1,a=!0){wt(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,p)=>(i.push({paramName:h,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,r?void 0:"i"),i]}function lb(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return wt(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function xn(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,i=t.charAt(a);return i&&i!=="/"?null:t.slice(a)||"/"}function rb({basename:t,pathname:r}){return r==="/"?t:Zn([t,r])}var Ud=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Go=t=>Ud.test(t);function ab(t,r="/"){let{pathname:a,search:i="",hash:o=""}=typeof t=="string"?tl(t):t,s;return a?(a=a.replace(/\/\/+/g,"/"),a.startsWith("/")?s=Bd(a.substring(1),"/"):s=Bd(a,r)):s=r,{pathname:s,search:ub(i),hash:ob(o)}}function Bd(t,r){let a=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function Xo(t,r,a,i){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Hd(t){return t.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function Qo(t){let r=Hd(t);return r.map((a,i)=>i===r.length-1?a.pathname:a.pathnameBase)}function Zo(t,r,a,i=!1){let o;typeof t=="string"?o=tl(t):(o={...t},Ue(!o.pathname||!o.pathname.includes("?"),Xo("?","pathname","search",o)),Ue(!o.pathname||!o.pathname.includes("#"),Xo("#","pathname","hash",o)),Ue(!o.search||!o.search.includes("#"),Xo("#","search","hash",o)));let s=t===""||o.pathname==="",c=s?"/":o.pathname,h;if(c==null)h=a;else{let g=r.length-1;if(!i&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),g-=1;o.pathname=x.join("/")}h=g>=0?r[g]:"/"}let p=ab(o,h),m=c&&c!=="/"&&c.endsWith("/"),y=(s||c===".")&&a.endsWith("/");return!p.pathname.endsWith("/")&&(m||y)&&(p.pathname+="/"),p}var Zn=t=>t.join("/").replace(/\/\/+/g,"/"),ib=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ub=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ob=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,Ua=class{constructor(t,r,a,i=!1){this.status=t,this.statusText=r||"",this.internal=i,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function Ba(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Ha(t){return t.map(r=>r.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var qd=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Yd(t,r){let a=t;if(typeof a!="string"||!Ud.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let i=a,o=!1;if(qd)try{let s=new URL(window.location.href),c=a.startsWith("//")?new URL(s.protocol+a):new URL(a),h=xn(c.pathname,r);c.origin===s.origin&&h!=null?a=h+c.search+c.hash:o=!0}catch{wt(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:a}}var Dl=Symbol("Uninstrumented");function sb(t,r){let a={lazy:[],"lazy.loader":[],"lazy.action":[],"lazy.middleware":[],middleware:[],loader:[],action:[]};t.forEach(o=>o({id:r.id,index:r.index,path:r.path,instrument(s){let c=Object.keys(a);for(let h of c)s[h]&&a[h].push(s[h])}}));let i={};if(typeof r.lazy=="function"&&a.lazy.length>0){let o=Hr(a.lazy,r.lazy,()=>{});o&&(i.lazy=o)}if(typeof r.lazy=="object"){let o=r.lazy;["middleware","loader","action"].forEach(s=>{let c=o[s],h=a[`lazy.${s}`];if(typeof c=="function"&&h.length>0){let p=Hr(h,c,()=>{});p&&(i.lazy=Object.assign(i.lazy||{},{[s]:p}))}})}return["loader","action"].forEach(o=>{let s=r[o];if(typeof s=="function"&&a[o].length>0){let c=s[Dl]??s,h=Hr(a[o],c,(...p)=>Fd(p[0]));h&&(o==="loader"&&c.hydrate===!0&&(h.hydrate=!0),h[Dl]=c,i[o]=h)}}),r.middleware&&r.middleware.length>0&&a.middleware.length>0&&(i.middleware=r.middleware.map(o=>{let s=o[Dl]??o,c=Hr(a.middleware,s,(...h)=>Fd(h[0]));return c?(c[Dl]=s,c):o})),i}function cb(t,r){let a={navigate:[],fetch:[]};if(r.forEach(i=>i({instrument(o){let s=Object.keys(o);for(let c of s)o[c]&&a[c].push(o[c])}})),a.navigate.length>0){let i=t.navigate[Dl]??t.navigate,o=Hr(a.navigate,i,(...s)=>{let[c,h]=s;return{to:typeof c=="number"||typeof c=="string"?c:c?Qn(c):".",...Gd(t,h??{})}});o&&(o[Dl]=i,t.navigate=o)}if(a.fetch.length>0){let i=t.fetch[Dl]??t.fetch,o=Hr(a.fetch,i,(...s)=>{let[c,,h,p]=s;return{href:h??".",fetcherKey:c,...Gd(t,p??{})}});o&&(o[Dl]=i,t.fetch=o)}return t}function Hr(t,r,a){return t.length===0?null:async(...i)=>{let o=await Vd(t,a(...i),()=>r(...i),t.length-1);if(o.type==="error")throw o.value;return o.value}}async function Vd(t,r,a,i){let o=t[i],s;if(o){let c,h=async()=>(c?console.error("You cannot call instrumented handlers more than once"):c=Vd(t,r,a,i-1),s=await c,Ue(s,"Expected a result"),s.type==="error"&&s.value instanceof Error?{status:"error",error:s.value}:{status:"success",error:void 0});try{await o(h,r)}catch(p){console.error("An instrumentation function threw an error:",p)}c||await h(),await c}else try{s={type:"success",value:await a()}}catch(c){s={type:"error",value:c}}return s||{type:"error",value:new Error("No result assigned in instrumentation chain.")}}function Fd(t){let{request:r,context:a,params:i,unstable_pattern:o}=t;return{request:fb(r),params:{...i},unstable_pattern:o,context:db(a)}}function Gd(t,r){return{currentUrl:Qn(t.state.location),..."formMethod"in r?{formMethod:r.formMethod}:{},..."formEncType"in r?{formEncType:r.formEncType}:{},..."formData"in r?{formData:r.formData}:{},..."body"in r?{body:r.body}:{}}}function fb(t){return{method:t.method,url:t.url,headers:{get:(...r)=>t.headers.get(...r)}}}function db(t){if(mb(t)){let r={...t};return Object.freeze(r),r}else return{get:r=>t.get(r)}}var hb=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function mb(t){if(t===null||typeof t!="object")return!1;const r=Object.getPrototypeOf(t);return r===Object.prototype||r===null||Object.getOwnPropertyNames(r).sort().join("\0")===hb}var Xd=["POST","PUT","PATCH","DELETE"],pb=new Set(Xd),gb=["GET",...Xd],yb=new Set(gb),Qd=new Set([301,302,303,307,308]),vb=new Set([307,308]),Ko={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},bb={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},qa={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},xb=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),Zd="remix-router-transitions",Kd=Symbol("ResetLoaderData");function Sb(t){const r=t.window?t.window:typeof window<"u"?window:void 0,a=typeof r<"u"&&typeof r.document<"u"&&typeof r.document.createElement<"u";Ue(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i=t.hydrationRouteProperties||[],o=t.mapRouteProperties||xb,s=o;if(t.unstable_instrumentations){let T=t.unstable_instrumentations;s=L=>({...o(L),...sb(T.map(X=>X.route).filter(Boolean),L)})}let c={},h=ja(t.routes,s,void 0,c),p,m=t.basename||"/";m.startsWith("/")||(m=`/${m}`);let y=t.dataStrategy||Tb,g={...t.future},x=null,b=new Set,k=null,D=null,N=null,R=t.hydrationData!=null,_=Rl(h,t.history.location,m),H=!1,ie=null,K;if(_==null&&!t.patchRoutesOnNavigation){let T=Sn(404,{pathname:t.history.location.pathname}),{matches:L,route:X}=Ji(h);K=!0,_=L,ie={[X.id]:T}}else if(_&&!t.hydrationData&&br(_,h,t.history.location.pathname).active&&(_=null),_)if(_.some(T=>T.route.lazy))K=!1;else if(!_.some(T=>Jo(T.route)))K=!0;else{let T=t.hydrationData?t.hydrationData.loaderData:null,L=t.hydrationData?t.hydrationData.errors:null;if(L){let X=_.findIndex(ee=>L[ee.route.id]!==void 0);K=_.slice(0,X+1).every(ee=>!Po(ee.route,T,L))}else K=_.every(X=>!Po(X.route,T,L))}else{K=!1,_=[];let T=br(null,h,t.history.location.pathname);T.active&&T.matches&&(H=!0,_=T.matches)}let q,M={historyAction:t.history.action,location:t.history.location,matches:_,initialized:K,navigation:Ko,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||ie,fetchers:new Map,blockers:new Map},le="POP",de=null,Y=!1,ne,ae=!1,Ae=new Map,he=null,te=!1,U=!1,$=new Set,ue=new Map,Ce=0,C=-1,A=new Map,Z=new Set,E=new Map,oe=new Map,pe=new Set,ge=new Map,je,Je=null;function et(){if(x=t.history.listen(({action:T,location:L,delta:X})=>{if(je){je(),je=void 0;return}wt(ge.size===0||X!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ee=gr({currentLocation:M.location,nextLocation:L,historyAction:T});if(ee&&X!=null){let ce=new Promise(Se=>{je=Se});t.history.go(X*-1),ul(ee,{state:"blocked",location:L,proceed(){ul(ee,{state:"proceeding",proceed:void 0,reset:void 0,location:L}),ce.then(()=>t.history.go(X))},reset(){let Se=new Map(M.blockers);Se.set(ee,qa),yt({blockers:Se})}}),de==null||de.resolve(),de=null;return}return Pt(T,L)}),a){Gb(r,Ae);let T=()=>Xb(r,Ae);r.addEventListener("pagehide",T),he=()=>r.removeEventListener("pagehide",T)}return M.initialized||Pt("POP",M.location,{initialHydration:!0}),q}function Jt(){x&&x(),he&&he(),b.clear(),ne&&ne.abort(),M.fetchers.forEach((T,L)=>cn(L)),M.blockers.forEach((T,L)=>Su(L))}function Un(T){return b.add(T),()=>b.delete(T)}function yt(T,L={}){T.matches&&(T.matches=T.matches.map(ce=>{let Se=c[ce.route.id],ve=ce.route;return ve.element!==Se.element||ve.errorElement!==Se.errorElement||ve.hydrateFallbackElement!==Se.hydrateFallbackElement?{...ce,route:Se}:ce})),M={...M,...T};let X=[],ee=[];M.fetchers.forEach((ce,Se)=>{ce.state==="idle"&&(pe.has(Se)?X.push(Se):ee.push(Se))}),pe.forEach(ce=>{!M.fetchers.has(ce)&&!ue.has(ce)&&X.push(ce)}),[...b].forEach(ce=>ce(M,{deletedFetchers:X,newErrors:T.errors??null,viewTransitionOpts:L.viewTransitionOpts,flushSync:L.flushSync===!0})),X.forEach(ce=>cn(ce)),ee.forEach(ce=>M.fetchers.delete(ce))}function Bn(T,L,{flushSync:X}={}){var De,Ee;let ee=M.actionData!=null&&M.navigation.formMethod!=null&&Vt(M.navigation.formMethod)&&M.navigation.state==="loading"&&((De=T.state)==null?void 0:De._isRedirect)!==!0,ce;L.actionData?Object.keys(L.actionData).length>0?ce=L.actionData:ce=null:ee?ce=M.actionData:ce=null;let Se=L.loaderData?sh(M.loaderData,L.loaderData,L.matches||[],L.errors):M.loaderData,ve=M.blockers;ve.size>0&&(ve=new Map(ve),ve.forEach((Oe,He)=>ve.set(He,qa)));let fe=te?!1:wu(T,L.matches||M.matches),me=Y===!0||M.navigation.formMethod!=null&&Vt(M.navigation.formMethod)&&((Ee=T.state)==null?void 0:Ee._isRedirect)!==!0;p&&(h=p,p=void 0),te||le==="POP"||(le==="PUSH"?t.history.push(T,T.state):le==="REPLACE"&&t.history.replace(T,T.state));let be;if(le==="POP"){let Oe=Ae.get(M.location.pathname);Oe&&Oe.has(T.pathname)?be={currentLocation:M.location,nextLocation:T}:Ae.has(T.pathname)&&(be={currentLocation:T,nextLocation:M.location})}else if(ae){let Oe=Ae.get(M.location.pathname);Oe?Oe.add(T.pathname):(Oe=new Set([T.pathname]),Ae.set(M.location.pathname,Oe)),be={currentLocation:M.location,nextLocation:T}}yt({...L,actionData:ce,loaderData:Se,historyAction:le,location:T,initialized:!0,navigation:Ko,revalidation:"idle",restoreScrollPosition:fe,preventScrollReset:me,blockers:ve},{viewTransitionOpts:be,flushSync:X===!0}),le="POP",Y=!1,ae=!1,te=!1,U=!1,de==null||de.resolve(),de=null,Je==null||Je.resolve(),Je=null}async function kn(T,L){if(de==null||de.resolve(),de=null,typeof T=="number"){de||(de=mh());let He=de.promise;return t.history.go(T),He}let X=Io(M.location,M.matches,m,T,L==null?void 0:L.fromRouteId,L==null?void 0:L.relative),{path:ee,submission:ce,error:Se}=Id(!1,X,L),ve=M.location,fe=Na(M.location,ee,L&&L.state);fe={...fe,...t.history.encodeLocation(fe)};let me=L&&L.replace!=null?L.replace:void 0,be="PUSH";me===!0?be="REPLACE":me===!1||ce!=null&&Vt(ce.formMethod)&&ce.formAction===M.location.pathname+M.location.search&&(be="REPLACE");let De=L&&"preventScrollReset"in L?L.preventScrollReset===!0:void 0,Ee=(L&&L.flushSync)===!0,Oe=gr({currentLocation:ve,nextLocation:fe,historyAction:be});if(Oe){ul(Oe,{state:"blocked",location:fe,proceed(){ul(Oe,{state:"proceeding",proceed:void 0,reset:void 0,location:fe}),kn(T,L)},reset(){let He=new Map(M.blockers);He.set(Oe,qa),yt({blockers:He})}});return}await Pt(be,fe,{submission:ce,pendingError:Se,preventScrollReset:De,replace:L&&L.replace,enableViewTransition:L&&L.viewTransition,flushSync:Ee,callSiteDefaultShouldRevalidate:L&&L.unstable_defaultShouldRevalidate})}function Ll(){Je||(Je=mh()),se(),yt({revalidation:"loading"});let T=Je.promise;return M.navigation.state==="submitting"?T:M.navigation.state==="idle"?(Pt(M.historyAction,M.location,{startUninterruptedRevalidation:!0}),T):(Pt(le||M.historyAction,M.navigation.location,{overrideNavigation:M.navigation,enableViewTransition:ae===!0}),T)}async function Pt(T,L,X){ne&&ne.abort(),ne=null,le=T,te=(X&&X.startUninterruptedRevalidation)===!0,vr(M.location,M.matches),Y=(X&&X.preventScrollReset)===!0,ae=(X&&X.enableViewTransition)===!0;let ee=p||h,ce=X&&X.overrideNavigation,Se=X!=null&&X.initialHydration&&M.matches&&M.matches.length>0&&!H?M.matches:Rl(ee,L,m),ve=(X&&X.flushSync)===!0;if(Se&&M.initialized&&!U&&_b(M.location,L)&&!(X&&X.submission&&Vt(X.submission.formMethod))){Bn(L,{matches:Se},{flushSync:ve});return}let fe=br(Se,ee,L.pathname);if(fe.active&&fe.matches&&(Se=fe.matches),!Se){let{error:vt,notFoundMatches:bt,route:Ge}=Bl(L.pathname);Bn(L,{matches:bt,loaderData:{},errors:{[Ge.id]:vt}},{flushSync:ve});return}ne=new AbortController;let me=Yr(t.history,L,ne.signal,X&&X.submission),be=t.getContext?await t.getContext():new Od,De;if(X&&X.pendingError)De=[Ml(Se).route.id,{type:"error",error:X.pendingError}];else if(X&&X.submission&&Vt(X.submission.formMethod)){let vt=await Jr(me,L,X.submission,Se,be,fe.active,X&&X.initialHydration===!0,{replace:X.replace,flushSync:ve});if(vt.shortCircuited)return;if(vt.pendingActionResult){let[bt,Ge]=vt.pendingActionResult;if(an(Ge)&&Ba(Ge.error)&&Ge.error.status===404){ne=null,Bn(L,{matches:vt.matches,loaderData:{},errors:{[bt]:Ge.error}});return}}Se=vt.matches||Se,De=vt.pendingActionResult,ce=ns(L,X.submission),ve=!1,fe.active=!1,me=Yr(t.history,me.url,me.signal)}let{shortCircuited:Ee,matches:Oe,loaderData:He,errors:gt}=await Pr(me,L,Se,be,fe.active,ce,X&&X.submission,X&&X.fetcherSubmission,X&&X.replace,X&&X.initialHydration===!0,ve,De,X&&X.callSiteDefaultShouldRevalidate);Ee||(ne=null,Bn(L,{matches:Oe||Se,...ch(De),loaderData:He,errors:gt}))}async function Jr(T,L,X,ee,ce,Se,ve,fe={}){se();let me=Vb(L,X);if(yt({navigation:me},{flushSync:fe.flushSync===!0}),Se){let Ee=await Hl(ee,L.pathname,T.signal);if(Ee.type==="aborted")return{shortCircuited:!0};if(Ee.type==="error"){if(Ee.partialMatches.length===0){let{matches:He,route:gt}=Ji(h);return{matches:He,pendingActionResult:[gt.id,{type:"error",error:Ee.error}]}}let Oe=Ml(Ee.partialMatches).route.id;return{matches:Ee.partialMatches,pendingActionResult:[Oe,{type:"error",error:Ee.error}]}}else if(Ee.matches)ee=Ee.matches;else{let{notFoundMatches:Oe,error:He,route:gt}=Bl(L.pathname);return{matches:Oe,pendingActionResult:[gt.id,{type:"error",error:He}]}}}let be,De=$i(ee,L);if(!De.route.action&&!De.route.lazy)be={type:"error",error:Sn(405,{method:T.method,pathname:L.pathname,routeId:De.route.id})};else{let Ee=qr(s,c,T,ee,De,ve?[]:i,ce),Oe=await il(T,Ee,ce,null);if(be=Oe[De.route.id],!be){for(let He of ee)if(Oe[He.route.id]){be=Oe[He.route.id];break}}if(T.signal.aborted)return{shortCircuited:!0}}if(cr(be)){let Ee;return fe&&fe.replace!=null?Ee=fe.replace:Ee=ih(be.response.headers.get("Location"),new URL(T.url),m,t.history)===M.location.pathname+M.location.search,await pt(T,be,!0,{submission:X,replace:Ee}),{shortCircuited:!0}}if(an(be)){let Ee=Ml(ee,De.route.id);return(fe&&fe.replace)!==!0&&(le="PUSH"),{matches:ee,pendingActionResult:[Ee.route.id,be,De.route.id]}}return{matches:ee,pendingActionResult:[De.route.id,be]}}async function Pr(T,L,X,ee,ce,Se,ve,fe,me,be,De,Ee,Oe){let He=Se||ns(L,ve),gt=ve||fe||hh(He),vt=!te&&!be;if(ce){if(vt){let Et=al(Ee);yt({navigation:He,...Et!==void 0?{actionData:Et}:{}},{flushSync:De})}let Xe=await Hl(X,L.pathname,T.signal);if(Xe.type==="aborted")return{shortCircuited:!0};if(Xe.type==="error"){if(Xe.partialMatches.length===0){let{matches:Vn,route:Lt}=Ji(h);return{matches:Vn,loaderData:{},errors:{[Lt.id]:Xe.error}}}let Et=Ml(Xe.partialMatches).route.id;return{matches:Xe.partialMatches,loaderData:{},errors:{[Et]:Xe.error}}}else if(Xe.matches)X=Xe.matches;else{let{error:Et,notFoundMatches:Vn,route:Lt}=Bl(L.pathname);return{matches:Vn,loaderData:{},errors:{[Lt.id]:Et}}}}let bt=p||h,{dsMatches:Ge,revalidatingFetchers:Ot}=Jd(T,ee,s,c,t.history,M,X,gt,L,be?[]:i,be===!0,U,$,pe,E,Z,bt,m,t.patchRoutesOnNavigation!=null,Ee,Oe);if(C=++Ce,!t.dataStrategy&&!Ge.some(Xe=>Xe.shouldLoad)&&!Ge.some(Xe=>Xe.route.middleware&&Xe.route.middleware.length>0)&&Ot.length===0){let Xe=tt();return Bn(L,{matches:X,loaderData:{},errors:Ee&&an(Ee[1])?{[Ee[0]]:Ee[1].error}:null,...ch(Ee),...Xe?{fetchers:new Map(M.fetchers)}:{}},{flushSync:De}),{shortCircuited:!0}}if(vt){let Xe={};if(!ce){Xe.navigation=He;let Et=al(Ee);Et!==void 0&&(Xe.actionData=Et)}Ot.length>0&&(Xe.fetchers=Ul(Ot)),yt(Xe,{flushSync:De})}Ot.forEach(Xe=>{nt(Xe.key),Xe.controller&&ue.set(Xe.key,Xe.controller)});let $t=()=>Ot.forEach(Xe=>nt(Xe.key));ne&&ne.signal.addEventListener("abort",$t);let{loaderResults:ht,fetcherResults:qn}=await J(Ge,Ot,T,ee);if(T.signal.aborted)return{shortCircuited:!0};ne&&ne.signal.removeEventListener("abort",$t),Ot.forEach(Xe=>ue.delete(Xe.key));let dn=Pi(ht);if(dn)return await pt(T,dn.result,!0,{replace:me}),{shortCircuited:!0};if(dn=Pi(qn),dn)return Z.add(dn.key),await pt(T,dn.result,!0,{replace:me}),{shortCircuited:!0};let{loaderData:Yn,errors:Cn}=oh(M,X,ht,Ee,Ot,qn);be&&M.errors&&(Cn={...M.errors,...Cn});let sl=tt(),xr=Hn(C),Sr=sl||xr||Ot.length>0;return{matches:X,loaderData:Yn,errors:Cn,...Sr?{fetchers:new Map(M.fetchers)}:{}}}function al(T){if(T&&!an(T[1]))return{[T[0]]:T[1].data};if(M.actionData)return Object.keys(M.actionData).length===0?null:M.actionData}function Ul(T){return T.forEach(L=>{let X=M.fetchers.get(L.key),ee=Va(void 0,X?X.data:void 0);M.fetchers.set(L.key,ee)}),new Map(M.fetchers)}async function pr(T,L,X,ee){nt(T);let ce=(ee&&ee.flushSync)===!0,Se=p||h,ve=Io(M.location,M.matches,m,X,L,ee==null?void 0:ee.relative),fe=Rl(Se,ve,m),me=br(fe,Se,ve);if(me.active&&me.matches&&(fe=me.matches),!fe){Re(T,L,Sn(404,{pathname:ve}),{flushSync:ce});return}let{path:be,submission:De,error:Ee}=Id(!0,ve,ee);if(Ee){Re(T,L,Ee,{flushSync:ce});return}let Oe=t.getContext?await t.getContext():new Od,He=(ee&&ee.preventScrollReset)===!0;if(De&&Vt(De.formMethod)){await ai(T,L,be,fe,Oe,me.active,ce,He,De,ee&&ee.unstable_defaultShouldRevalidate);return}E.set(T,{routeId:L,path:be}),await ii(T,L,be,fe,Oe,me.active,ce,He,De)}async function ai(T,L,X,ee,ce,Se,ve,fe,me,be){se(),E.delete(T);let De=M.fetchers.get(T);we(T,Fb(me,De),{flushSync:ve});let Ee=new AbortController,Oe=Yr(t.history,X,Ee.signal,me);if(Se){let Qe=await Hl(ee,new URL(Oe.url).pathname,Oe.signal,T);if(Qe.type==="aborted")return;if(Qe.type==="error"){Re(T,L,Qe.error,{flushSync:ve});return}else if(Qe.matches)ee=Qe.matches;else{Re(T,L,Sn(404,{pathname:X}),{flushSync:ve});return}}let He=$i(ee,X);if(!He.route.action&&!He.route.lazy){let Qe=Sn(405,{method:me.formMethod,pathname:X,routeId:L});Re(T,L,Qe,{flushSync:ve});return}ue.set(T,Ee);let gt=Ce,vt=qr(s,c,Oe,ee,He,i,ce),bt=await il(Oe,vt,ce,T),Ge=bt[He.route.id];if(!Ge){for(let Qe of vt)if(bt[Qe.route.id]){Ge=bt[Qe.route.id];break}}if(Oe.signal.aborted){ue.get(T)===Ee&&ue.delete(T);return}if(pe.has(T)){if(cr(Ge)||an(Ge)){we(T,nl(void 0));return}}else{if(cr(Ge))if(ue.delete(T),C>gt){we(T,nl(void 0));return}else return Z.add(T),we(T,Va(me)),pt(Oe,Ge,!1,{fetcherSubmission:me,preventScrollReset:fe});if(an(Ge)){Re(T,L,Ge.error);return}}let Ot=M.navigation.location||M.location,$t=Yr(t.history,Ot,Ee.signal),ht=p||h,qn=M.navigation.state!=="idle"?Rl(ht,M.navigation.location,m):M.matches;Ue(qn,"Didn't find any matches after fetcher action");let dn=++Ce;A.set(T,dn);let Yn=Va(me,Ge.data);M.fetchers.set(T,Yn);let{dsMatches:Cn,revalidatingFetchers:sl}=Jd($t,ce,s,c,t.history,M,qn,me,Ot,i,!1,U,$,pe,E,Z,ht,m,t.patchRoutesOnNavigation!=null,[He.route.id,Ge],be);sl.filter(Qe=>Qe.key!==T).forEach(Qe=>{let wr=Qe.key,ku=M.fetchers.get(wr),ui=Va(void 0,ku?ku.data:void 0);M.fetchers.set(wr,ui),nt(wr),Qe.controller&&ue.set(wr,Qe.controller)}),yt({fetchers:new Map(M.fetchers)});let xr=()=>sl.forEach(Qe=>nt(Qe.key));Ee.signal.addEventListener("abort",xr);let{loaderResults:Sr,fetcherResults:Xe}=await J(Cn,sl,$t,ce);if(Ee.signal.aborted)return;if(Ee.signal.removeEventListener("abort",xr),A.delete(T),ue.delete(T),sl.forEach(Qe=>ue.delete(Qe.key)),M.fetchers.has(T)){let Qe=nl(Ge.data);M.fetchers.set(T,Qe)}let Et=Pi(Sr);if(Et)return pt($t,Et.result,!1,{preventScrollReset:fe});if(Et=Pi(Xe),Et)return Z.add(Et.key),pt($t,Et.result,!1,{preventScrollReset:fe});let{loaderData:Vn,errors:Lt}=oh(M,qn,Sr,void 0,sl,Xe);Hn(dn),M.navigation.state==="loading"&&dn>C?(Ue(le,"Expected pending action"),ne&&ne.abort(),Bn(M.navigation.location,{matches:qn,loaderData:Vn,errors:Lt,fetchers:new Map(M.fetchers)})):(yt({errors:Lt,loaderData:sh(M.loaderData,Vn,qn,Lt),fetchers:new Map(M.fetchers)}),U=!1)}async function ii(T,L,X,ee,ce,Se,ve,fe,me){let be=M.fetchers.get(T);we(T,Va(me,be?be.data:void 0),{flushSync:ve});let De=new AbortController,Ee=Yr(t.history,X,De.signal);if(Se){let Ge=await Hl(ee,new URL(Ee.url).pathname,Ee.signal,T);if(Ge.type==="aborted")return;if(Ge.type==="error"){Re(T,L,Ge.error,{flushSync:ve});return}else if(Ge.matches)ee=Ge.matches;else{Re(T,L,Sn(404,{pathname:X}),{flushSync:ve});return}}let Oe=$i(ee,X);ue.set(T,De);let He=Ce,gt=qr(s,c,Ee,ee,Oe,i,ce),bt=(await il(Ee,gt,ce,T))[Oe.route.id];if(ue.get(T)===De&&ue.delete(T),!Ee.signal.aborted){if(pe.has(T)){we(T,nl(void 0));return}if(cr(bt))if(C>He){we(T,nl(void 0));return}else{Z.add(T),await pt(Ee,bt,!1,{preventScrollReset:fe});return}if(an(bt)){Re(T,L,bt.error);return}we(T,nl(bt.data))}}async function pt(T,L,X,{submission:ee,fetcherSubmission:ce,preventScrollReset:Se,replace:ve}={}){X||(de==null||de.resolve(),de=null),L.response.headers.has("X-Remix-Revalidate")&&(U=!0);let fe=L.response.headers.get("Location");Ue(fe,"Expected a Location header on the redirect Response"),fe=ih(fe,new URL(T.url),m,t.history);let me=Na(M.location,fe,{_isRedirect:!0});if(a){let gt=!1;if(L.response.headers.has("X-Remix-Reload-Document"))gt=!0;else if(Go(fe)){const vt=Md(fe,!0);gt=vt.origin!==r.location.origin||xn(vt.pathname,m)==null}if(gt){ve?r.location.replace(fe):r.location.assign(fe);return}}ne=null;let be=ve===!0||L.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:De,formAction:Ee,formEncType:Oe}=M.navigation;!ee&&!ce&&De&&Ee&&Oe&&(ee=hh(M.navigation));let He=ee||ce;if(vb.has(L.response.status)&&He&&Vt(He.formMethod))await Pt(be,me,{submission:{...He,formAction:fe},preventScrollReset:Se||Y,enableViewTransition:X?ae:void 0});else{let gt=ns(me,ee);await Pt(be,me,{overrideNavigation:gt,fetcherSubmission:ce,preventScrollReset:Se||Y,enableViewTransition:X?ae:void 0})}}async function il(T,L,X,ee){var ve;let ce,Se={};try{ce=await Ab(y,T,L,ee,X,!1)}catch(fe){return L.filter(me=>me.shouldLoad).forEach(me=>{Se[me.route.id]={type:"error",error:fe}}),Se}if(T.signal.aborted)return Se;if(!Vt(T.method))for(let fe of L){if(((ve=ce[fe.route.id])==null?void 0:ve.type)==="error")break;!ce.hasOwnProperty(fe.route.id)&&!M.loaderData.hasOwnProperty(fe.route.id)&&(!M.errors||!M.errors.hasOwnProperty(fe.route.id))&&fe.shouldCallHandler()&&(ce[fe.route.id]={type:"error",result:new Error(`No result returned from dataStrategy for route ${fe.route.id}`)})}for(let[fe,me]of Object.entries(ce))if(Bb(me)){let be=me.result;Se[fe]={type:"redirect",response:Ob(be,T,fe,L,m)}}else Se[fe]=await Mb(me);return Se}async function J(T,L,X,ee){let ce=il(X,T,ee,null),Se=Promise.all(L.map(async me=>{if(me.matches&&me.match&&me.request&&me.controller){let De=(await il(me.request,me.matches,ee,me.key))[me.match.route.id];return{[me.key]:De}}else return Promise.resolve({[me.key]:{type:"error",error:Sn(404,{pathname:me.path})}})})),ve=await ce,fe=(await Se).reduce((me,be)=>Object.assign(me,be),{});return{loaderResults:ve,fetcherResults:fe}}function se(){U=!0,E.forEach((T,L)=>{ue.has(L)&&$.add(L),nt(L)})}function we(T,L,X={}){M.fetchers.set(T,L),yt({fetchers:new Map(M.fetchers)},{flushSync:(X&&X.flushSync)===!0})}function Re(T,L,X,ee={}){let ce=Ml(M.matches,L);cn(T),yt({errors:{[ce.route.id]:X},fetchers:new Map(M.fetchers)},{flushSync:(ee&&ee.flushSync)===!0})}function Ie(T){return oe.set(T,(oe.get(T)||0)+1),pe.has(T)&&pe.delete(T),M.fetchers.get(T)||bb}function Qt(T,L){nt(T,L==null?void 0:L.reason),we(T,nl(null))}function cn(T){let L=M.fetchers.get(T);ue.has(T)&&!(L&&L.state==="loading"&&A.has(T))&&nt(T),E.delete(T),A.delete(T),Z.delete(T),pe.delete(T),$.delete(T),M.fetchers.delete(T)}function _t(T){let L=(oe.get(T)||0)-1;L<=0?(oe.delete(T),pe.add(T)):oe.set(T,L),yt({fetchers:new Map(M.fetchers)})}function nt(T,L){let X=ue.get(T);X&&(X.abort(L),ue.delete(T))}function jt(T){for(let L of T){let X=Ie(L),ee=nl(X.data);M.fetchers.set(L,ee)}}function tt(){let T=[],L=!1;for(let X of Z){let ee=M.fetchers.get(X);Ue(ee,`Expected fetcher: ${X}`),ee.state==="loading"&&(Z.delete(X),T.push(X),L=!0)}return jt(T),L}function Hn(T){let L=[];for(let[X,ee]of A)if(ee<T){let ce=M.fetchers.get(X);Ue(ce,`Expected fetcher: ${X}`),ce.state==="loading"&&(nt(X),A.delete(X),L.push(X))}return jt(L),L.length>0}function fn(T,L){let X=M.blockers.get(T)||qa;return ge.get(T)!==L&&ge.set(T,L),X}function Su(T){M.blockers.delete(T),ge.delete(T)}function ul(T,L){let X=M.blockers.get(T)||qa;Ue(X.state==="unblocked"&&L.state==="blocked"||X.state==="blocked"&&L.state==="blocked"||X.state==="blocked"&&L.state==="proceeding"||X.state==="blocked"&&L.state==="unblocked"||X.state==="proceeding"&&L.state==="unblocked",`Invalid blocker state transition: ${X.state} -> ${L.state}`);let ee=new Map(M.blockers);ee.set(T,L),yt({blockers:ee})}function gr({currentLocation:T,nextLocation:L,historyAction:X}){if(ge.size===0)return;ge.size>1&&wt(!1,"A router only supports one blocker at a time");let ee=Array.from(ge.entries()),[ce,Se]=ee[ee.length-1],ve=M.blockers.get(ce);if(!(ve&&ve.state==="proceeding")&&Se({currentLocation:T,nextLocation:L,historyAction:X}))return ce}function Bl(T){let L=Sn(404,{pathname:T}),X=p||h,{matches:ee,route:ce}=Ji(X);return{notFoundMatches:ee,route:ce,error:L}}function ol(T,L,X){if(k=T,N=L,D=X||null,!R&&M.navigation===Ko){R=!0;let ee=wu(M.location,M.matches);ee!=null&&yt({restoreScrollPosition:ee})}return()=>{k=null,N=null,D=null}}function yr(T,L){return D&&D(T,L.map(ee=>Xv(ee,M.loaderData)))||T.key}function vr(T,L){if(k&&N){let X=yr(T,L);k[X]=N()}}function wu(T,L){if(k){let X=yr(T,L),ee=k[X];if(typeof ee=="number")return ee}return null}function br(T,L,X){if(t.patchRoutesOnNavigation)if(T){if(Object.keys(T[0].params).length>0)return{active:!0,matches:La(L,X,m,!0)}}else return{active:!0,matches:La(L,X,m,!0)||[]};return{active:!1,matches:null}}async function Hl(T,L,X,ee){if(!t.patchRoutesOnNavigation)return{type:"success",matches:T};let ce=T;for(;;){let Se=p==null,ve=p||h,fe=c;try{await t.patchRoutesOnNavigation({signal:X,path:L,matches:ce,fetcherKey:ee,patch:(De,Ee)=>{X.aborted||Pd(De,Ee,ve,fe,s,!1)}})}catch(De){return{type:"error",error:De,partialMatches:ce}}finally{Se&&!X.aborted&&(h=[...h])}if(X.aborted)return{type:"aborted"};let me=Rl(ve,L,m),be=null;if(me){if(Object.keys(me[0].params).length===0)return{type:"success",matches:me};if(be=La(ve,L,m,!0),!(be&&ce.length<be.length&&ql(ce,be.slice(0,ce.length))))return{type:"success",matches:me}}if(be||(be=La(ve,L,m,!0)),!be||ql(ce,be))return{type:"success",matches:null};ce=be}}function ql(T,L){return T.length===L.length&&T.every((X,ee)=>X.route.id===L[ee].route.id)}function sc(T){c={},p=ja(T,s,void 0,c)}function Eu(T,L,X=!1){let ee=p==null;Pd(T,L,p||h,c,s,X),ee&&(h=[...h],yt({}))}return q={get basename(){return m},get future(){return g},get state(){return M},get routes(){return h},get window(){return r},initialize:et,subscribe:Un,enableScrollRestoration:ol,navigate:kn,fetch:pr,revalidate:Ll,createHref:T=>t.history.createHref(T),encodeLocation:T=>t.history.encodeLocation(T),getFetcher:Ie,resetFetcher:Qt,deleteFetcher:_t,dispose:Jt,getBlocker:fn,deleteBlocker:Su,patchRoutes:Eu,_internalFetchControllers:ue,_internalSetRoutes:sc,_internalSetStateDoNotUseOrYouWillBreakYourApp(T){yt(T)}},t.unstable_instrumentations&&(q=cb(q,t.unstable_instrumentations.map(T=>T.router).filter(Boolean))),q}function wb(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Io(t,r,a,i,o,s){let c,h;if(o){c=[];for(let m of r)if(c.push(m),m.route.id===o){h=m;break}}else c=r,h=r[r.length-1];let p=Zo(i||".",Qo(c),xn(t.pathname,a)||t.pathname,s==="path");if(i==null&&(p.search=t.search,p.hash=t.hash),(i==null||i===""||i===".")&&h){let m=ts(p.search);if(h.route.index&&!m)p.search=p.search?p.search.replace(/^\?/,"?index&"):"?index";else if(!h.route.index&&m){let y=new URLSearchParams(p.search),g=y.getAll("index");y.delete("index"),g.filter(b=>b).forEach(b=>y.append("index",b));let x=y.toString();p.search=x?`?${x}`:""}}return a!=="/"&&(p.pathname=rb({basename:a,pathname:p.pathname})),Qn(p)}function Id(t,r,a){if(!a||!wb(a))return{path:r};if(a.formMethod&&!Yb(a.formMethod))return{path:r,error:Sn(405,{method:a.formMethod})};let i=()=>({path:r,error:Sn(400,{type:"invalid-body"})}),s=(a.formMethod||"get").toUpperCase(),c=fh(r);if(a.body!==void 0){if(a.formEncType==="text/plain"){if(!Vt(s))return i();let g=typeof a.body=="string"?a.body:a.body instanceof FormData||a.body instanceof URLSearchParams?Array.from(a.body.entries()).reduce((x,[b,k])=>`${x}${b}=${k}
`,""):String(a.body);return{path:r,submission:{formMethod:s,formAction:c,formEncType:a.formEncType,formData:void 0,json:void 0,text:g}}}else if(a.formEncType==="application/json"){if(!Vt(s))return i();try{let g=typeof a.body=="string"?JSON.parse(a.body):a.body;return{path:r,submission:{formMethod:s,formAction:c,formEncType:a.formEncType,formData:void 0,json:g,text:void 0}}}catch{return i()}}}Ue(typeof FormData=="function","FormData is not available in this environment");let h,p;if(a.formData)h=Wo(a.formData),p=a.formData;else if(a.body instanceof FormData)h=Wo(a.body),p=a.body;else if(a.body instanceof URLSearchParams)h=a.body,p=uh(h);else if(a.body==null)h=new URLSearchParams,p=new FormData;else try{h=new URLSearchParams(a.body),p=uh(h)}catch{return i()}let m={formMethod:s,formAction:c,formEncType:a&&a.formEncType||"application/x-www-form-urlencoded",formData:p,json:void 0,text:void 0};if(Vt(m.formMethod))return{path:r,submission:m};let y=tl(r);return t&&y.search&&ts(y.search)&&h.append("index",""),y.search=`?${h}`,{path:Qn(y),submission:m}}function Jd(t,r,a,i,o,s,c,h,p,m,y,g,x,b,k,D,N,R,_,H,ie){var te;let K=H?an(H[1])?H[1].error:H[1].data:void 0,q=o.createURL(s.location),M=o.createURL(p),le;if(y&&s.errors){let U=Object.keys(s.errors)[0];le=c.findIndex($=>$.route.id===U)}else if(H&&an(H[1])){let U=H[0];le=c.findIndex($=>$.route.id===U)-1}let de=H?H[1].statusCode:void 0,Y=de&&de>=400,ne={currentUrl:q,currentParams:((te=s.matches[0])==null?void 0:te.params)||{},nextUrl:M,nextParams:c[0].params,...h,actionResult:K,actionStatus:de},ae=Ha(c),Ae=c.map((U,$)=>{let{route:ue}=U,Ce=null;if(le!=null&&$>le?Ce=!1:ue.lazy?Ce=!0:Jo(ue)?y?Ce=Po(ue,s.loaderData,s.errors):Eb(s.loaderData,s.matches[$],U)&&(Ce=!0):Ce=!1,Ce!==null)return $o(a,i,t,ae,U,m,r,Ce);let C=!1;typeof ie=="boolean"?C=ie:Y?C=!1:(g||q.pathname+q.search===M.pathname+M.search||q.search!==M.search||kb(s.matches[$],U))&&(C=!0);let A={...ne,defaultShouldRevalidate:C},Z=Ya(U,A);return $o(a,i,t,ae,U,m,r,Z,A,ie)}),he=[];return k.forEach((U,$)=>{if(y||!c.some(pe=>pe.route.id===U.routeId)||b.has($))return;let ue=s.fetchers.get($),Ce=ue&&ue.state!=="idle"&&ue.data===void 0,C=Rl(N,U.path,R);if(!C){if(_&&Ce)return;he.push({key:$,routeId:U.routeId,path:U.path,matches:null,match:null,request:null,controller:null});return}if(D.has($))return;let A=$i(C,U.path),Z=new AbortController,E=Yr(o,U.path,Z.signal),oe=null;if(x.has($))x.delete($),oe=qr(a,i,E,C,A,m,r);else if(Ce)g&&(oe=qr(a,i,E,C,A,m,r));else{let pe;typeof ie=="boolean"?pe=ie:Y?pe=!1:pe=g;let ge={...ne,defaultShouldRevalidate:pe};Ya(A,ge)&&(oe=qr(a,i,E,C,A,m,r,ge))}oe&&he.push({key:$,routeId:U.routeId,path:U.path,matches:oe,match:A,request:E,controller:Z})}),{dsMatches:Ae,revalidatingFetchers:he}}function Jo(t){return t.loader!=null||t.middleware!=null&&t.middleware.length>0}function Po(t,r,a){if(t.lazy)return!0;if(!Jo(t))return!1;let i=r!=null&&t.id in r,o=a!=null&&a[t.id]!==void 0;return!i&&o?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!i&&!o}function Eb(t,r,a){let i=!r||a.route.id!==r.route.id,o=!t.hasOwnProperty(a.route.id);return i||o}function kb(t,r){let a=t.route.path;return t.pathname!==r.pathname||a!=null&&a.endsWith("*")&&t.params["*"]!==r.params["*"]}function Ya(t,r){if(t.route.shouldRevalidate){let a=t.route.shouldRevalidate(r);if(typeof a=="boolean")return a}return r.defaultShouldRevalidate}function Pd(t,r,a,i,o,s){let c;if(t){let m=i[t];Ue(m,`No route found to patch children into: routeId = ${t}`),m.children||(m.children=[]),c=m.children}else c=a;let h=[],p=[];if(r.forEach(m=>{let y=c.find(g=>$d(m,g));y?p.push({existingRoute:y,newRoute:m}):h.push(m)}),h.length>0){let m=ja(h,o,[t||"_","patch",String((c==null?void 0:c.length)||"0")],i);c.push(...m)}if(s&&p.length>0)for(let m=0;m<p.length;m++){let{existingRoute:y,newRoute:g}=p[m],x=y,[b]=ja([g],o,[],{},!0);Object.assign(x,{element:b.element?b.element:x.element,errorElement:b.errorElement?b.errorElement:x.errorElement,hydrateFallbackElement:b.hydrateFallbackElement?b.hydrateFallbackElement:x.hydrateFallbackElement})}}function $d(t,r){return"id"in t&&"id"in r&&t.id===r.id?!0:t.index===r.index&&t.path===r.path&&t.caseSensitive===r.caseSensitive?(!t.children||t.children.length===0)&&(!r.children||r.children.length===0)?!0:t.children.every((a,i)=>{var o;return(o=r.children)==null?void 0:o.some(s=>$d(a,s))}):!1}var Wd=new WeakMap,eh=({key:t,route:r,manifest:a,mapRouteProperties:i})=>{let o=a[r.id];if(Ue(o,"No route found in manifest"),!o.lazy||typeof o.lazy!="object")return;let s=o.lazy[t];if(!s)return;let c=Wd.get(o);c||(c={},Wd.set(o,c));let h=c[t];if(h)return h;let p=(async()=>{let m=Yv(t),g=o[t]!==void 0&&t!=="hasErrorBoundary";if(m)wt(!m,"Route property "+t+" is not a supported lazy route property. This property will be ignored."),c[t]=Promise.resolve();else if(g)wt(!1,`Route "${o.id}" has a static property "${t}" defined. The lazy property will be ignored.`);else{let x=await s();x!=null&&(Object.assign(o,{[t]:x}),Object.assign(o,i(o)))}typeof o.lazy=="object"&&(o.lazy[t]=void 0,Object.values(o.lazy).every(x=>x===void 0)&&(o.lazy=void 0))})();return c[t]=p,p},th=new WeakMap;function Cb(t,r,a,i,o){let s=a[t.id];if(Ue(s,"No route found in manifest"),!t.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof t.lazy=="function"){let y=th.get(s);if(y)return{lazyRoutePromise:y,lazyHandlerPromise:y};let g=(async()=>{Ue(typeof t.lazy=="function","No lazy route function found");let x=await t.lazy(),b={};for(let k in x){let D=x[k];if(D===void 0)continue;let N=Fv(k),_=s[k]!==void 0&&k!=="hasErrorBoundary";N?wt(!N,"Route property "+k+" is not a supported property to be returned from a lazy route function. This property will be ignored."):_?wt(!_,`Route "${s.id}" has a static property "${k}" defined but its lazy function is also returning a value for this property. The lazy route property "${k}" will be ignored.`):b[k]=D}Object.assign(s,b),Object.assign(s,{...i(s),lazy:void 0})})();return th.set(s,g),g.catch(()=>{}),{lazyRoutePromise:g,lazyHandlerPromise:g}}let c=Object.keys(t.lazy),h=[],p;for(let y of c){if(o&&o.includes(y))continue;let g=eh({key:y,route:t,manifest:a,mapRouteProperties:i});g&&(h.push(g),y===r&&(p=g))}let m=h.length>0?Promise.all(h).then(()=>{}):void 0;return m==null||m.catch(()=>{}),p==null||p.catch(()=>{}),{lazyRoutePromise:m,lazyHandlerPromise:p}}async function nh(t){let r=t.matches.filter(o=>o.shouldLoad),a={};return(await Promise.all(r.map(o=>o.resolve()))).forEach((o,s)=>{a[r[s].route.id]=o}),a}async function Tb(t){return t.matches.some(r=>r.route.middleware)?lh(t,()=>nh(t)):nh(t)}function lh(t,r){return zb(t,r,i=>{if(qb(i))throw i;return i},Lb,a);function a(i,o,s){if(s)return Promise.resolve(Object.assign(s.value,{[o]:{type:"error",result:i}}));{let{matches:c}=t,h=Math.min(Math.max(c.findIndex(m=>m.route.id===o),0),Math.max(c.findIndex(m=>m.shouldCallHandler()),0)),p=Ml(c,c[h].route.id).route.id;return Promise.resolve({[p]:{type:"error",result:i}})}}}async function zb(t,r,a,i,o){let{matches:s,request:c,params:h,context:p,unstable_pattern:m}=t,y=s.flatMap(x=>x.route.middleware?x.route.middleware.map(b=>[x.route.id,b]):[]);return await rh({request:c,params:h,context:p,unstable_pattern:m},y,r,a,i,o)}async function rh(t,r,a,i,o,s,c=0){let{request:h}=t;if(h.signal.aborted)throw h.signal.reason??new Error(`Request aborted: ${h.method} ${h.url}`);let p=r[c];if(!p)return await a();let[m,y]=p,g,x=async()=>{if(g)throw new Error("You may only call `next()` once per middleware");try{return g={value:await rh(t,r,a,i,o,s,c+1)},g.value}catch(b){return g={value:await s(b,m,g)},g.value}};try{let b=await y(t,x),k=b!=null?i(b):void 0;return o(k)?k:g?k??g.value:(g={value:await x()},g.value)}catch(b){return await s(b,m,g)}}function ah(t,r,a,i,o){let s=eh({key:"middleware",route:i.route,manifest:r,mapRouteProperties:t}),c=Cb(i.route,Vt(a.method)?"action":"loader",r,t,o);return{middleware:s,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function $o(t,r,a,i,o,s,c,h,p=null,m){let y=!1,g=ah(t,r,a,o,s);return{...o,_lazyPromises:g,shouldLoad:h,shouldRevalidateArgs:p,shouldCallHandler(x){return y=!0,p?typeof m=="boolean"?Ya(o,{...p,defaultShouldRevalidate:m}):typeof x=="boolean"?Ya(o,{...p,defaultShouldRevalidate:x}):Ya(o,p):h},resolve(x){let{lazy:b,loader:k,middleware:D}=o.route,N=y||h||x&&!Vt(a.method)&&(b||k),R=D&&D.length>0&&!k&&!b;return N&&(Vt(a.method)||!R)?Rb({request:a,unstable_pattern:i,match:o,lazyHandlerPromise:g==null?void 0:g.handler,lazyRoutePromise:g==null?void 0:g.route,handlerOverride:x,scopedContext:c}):Promise.resolve({type:"data",result:void 0})}}}function qr(t,r,a,i,o,s,c,h=null){return i.map(p=>p.route.id!==o.route.id?{...p,shouldLoad:!1,shouldRevalidateArgs:h,shouldCallHandler:()=>!1,_lazyPromises:ah(t,r,a,p,s),resolve:()=>Promise.resolve({type:"data",result:void 0})}:$o(t,r,a,Ha(i),p,s,c,!0,h))}async function Ab(t,r,a,i,o,s){a.some(m=>{var y;return(y=m._lazyPromises)==null?void 0:y.middleware})&&await Promise.all(a.map(m=>{var y;return(y=m._lazyPromises)==null?void 0:y.middleware}));let c={request:r,unstable_pattern:Ha(a),params:a[0].params,context:o,matches:a},p=await t({...c,fetcherKey:i,runClientMiddleware:m=>{let y=c;return lh(y,()=>m({...y,fetcherKey:i,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))}});try{await Promise.all(a.flatMap(m=>{var y,g;return[(y=m._lazyPromises)==null?void 0:y.handler,(g=m._lazyPromises)==null?void 0:g.route]}))}catch{}return p}async function Rb({request:t,unstable_pattern:r,match:a,lazyHandlerPromise:i,lazyRoutePromise:o,handlerOverride:s,scopedContext:c}){let h,p,m=Vt(t.method),y=m?"action":"loader",g=x=>{let b,k=new Promise((R,_)=>b=_);p=()=>b(),t.signal.addEventListener("abort",p);let D=R=>typeof x!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${y}" [routeId: ${a.route.id}]`)):x({request:t,unstable_pattern:r,params:a.params,context:c},...R!==void 0?[R]:[]),N=(async()=>{try{return{type:"data",result:await(s?s(_=>D(_)):D())}}catch(R){return{type:"error",result:R}}})();return Promise.race([N,k])};try{let x=m?a.route.action:a.route.loader;if(i||o)if(x){let b,[k]=await Promise.all([g(x).catch(D=>{b=D}),i,o]);if(b!==void 0)throw b;h=k}else{await i;let b=m?a.route.action:a.route.loader;if(b)[h]=await Promise.all([g(b),o]);else if(y==="action"){let k=new URL(t.url),D=k.pathname+k.search;throw Sn(405,{method:t.method,pathname:D,routeId:a.route.id})}else return{type:"data",result:void 0}}else if(x)h=await g(x);else{let b=new URL(t.url),k=b.pathname+b.search;throw Sn(404,{pathname:k})}}catch(x){return{type:"error",result:x}}finally{p&&t.signal.removeEventListener("abort",p)}return h}async function Db(t){let r=t.headers.get("Content-Type");return r&&/\bapplication\/json\b/.test(r)?t.body==null?null:t.json():t.text()}async function Mb(t){var i,o,s,c,h;let{result:r,type:a}=t;if(es(r)){let p;try{p=await Db(r)}catch(m){return{type:"error",error:m}}return a==="error"?{type:"error",error:new Ua(r.status,r.statusText,p),statusCode:r.status,headers:r.headers}:{type:"data",data:p,statusCode:r.status,headers:r.headers}}return a==="error"?dh(r)?r.data instanceof Error?{type:"error",error:r.data,statusCode:(i=r.init)==null?void 0:i.status,headers:(o=r.init)!=null&&o.headers?new Headers(r.init.headers):void 0}:{type:"error",error:jb(r),statusCode:Ba(r)?r.status:void 0,headers:(s=r.init)!=null&&s.headers?new Headers(r.init.headers):void 0}:{type:"error",error:r,statusCode:Ba(r)?r.status:void 0}:dh(r)?{type:"data",data:r.data,statusCode:(c=r.init)==null?void 0:c.status,headers:(h=r.init)!=null&&h.headers?new Headers(r.init.headers):void 0}:{type:"data",data:r}}function Ob(t,r,a,i,o){let s=t.headers.get("Location");if(Ue(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!Go(s)){let c=i.slice(0,i.findIndex(h=>h.route.id===a)+1);s=Io(new URL(r.url),c,o,s),t.headers.set("Location",s)}return t}function ih(t,r,a,i){let o=["about:","blob:","chrome:","chrome-untrusted:","content:","data:","devtools:","file:","filesystem:","javascript:"];if(Go(t)){let s=t,c=s.startsWith("//")?new URL(r.protocol+s):new URL(s);if(o.includes(c.protocol))throw new Error("Invalid redirect location");let h=xn(c.pathname,a)!=null;if(c.origin===r.origin&&h)return c.pathname+c.search+c.hash}try{let s=i.createURL(t);if(o.includes(s.protocol))throw new Error("Invalid redirect location")}catch{}return t}function Yr(t,r,a,i){let o=t.createURL(fh(r)).toString(),s={signal:a};if(i&&Vt(i.formMethod)){let{formMethod:c,formEncType:h}=i;s.method=c.toUpperCase(),h==="application/json"?(s.headers=new Headers({"Content-Type":h}),s.body=JSON.stringify(i.json)):h==="text/plain"?s.body=i.text:h==="application/x-www-form-urlencoded"&&i.formData?s.body=Wo(i.formData):s.body=i.formData}return new Request(o,s)}function Wo(t){let r=new URLSearchParams;for(let[a,i]of t.entries())r.append(a,typeof i=="string"?i:i.name);return r}function uh(t){let r=new FormData;for(let[a,i]of t.entries())r.append(a,i);return r}function Nb(t,r,a,i=!1,o=!1){let s={},c=null,h,p=!1,m={},y=a&&an(a[1])?a[1].error:void 0;return t.forEach(g=>{if(!(g.route.id in r))return;let x=g.route.id,b=r[x];if(Ue(!cr(b),"Cannot handle redirect results in processLoaderData"),an(b)){let k=b.error;if(y!==void 0&&(k=y,y=void 0),c=c||{},o)c[x]=k;else{let D=Ml(t,x);c[D.route.id]==null&&(c[D.route.id]=k)}i||(s[x]=Kd),p||(p=!0,h=Ba(b.error)?b.error.status:500),b.headers&&(m[x]=b.headers)}else s[x]=b.data,b.statusCode&&b.statusCode!==200&&!p&&(h=b.statusCode),b.headers&&(m[x]=b.headers)}),y!==void 0&&a&&(c={[a[0]]:y},a[2]&&(s[a[2]]=void 0)),{loaderData:s,errors:c,statusCode:h||200,loaderHeaders:m}}function oh(t,r,a,i,o,s){let{loaderData:c,errors:h}=Nb(r,a,i);return o.filter(p=>!p.matches||p.matches.some(m=>m.shouldLoad)).forEach(p=>{let{key:m,match:y,controller:g}=p;if(g&&g.signal.aborted)return;let x=s[m];if(Ue(x,"Did not find corresponding fetcher result"),an(x)){let b=Ml(t.matches,y==null?void 0:y.route.id);h&&h[b.route.id]||(h={...h,[b.route.id]:x.error}),t.fetchers.delete(m)}else if(cr(x))Ue(!1,"Unhandled fetcher revalidation redirect");else{let b=nl(x.data);t.fetchers.set(m,b)}}),{loaderData:c,errors:h}}function sh(t,r,a,i){let o=Object.entries(r).filter(([,s])=>s!==Kd).reduce((s,[c,h])=>(s[c]=h,s),{});for(let s of a){let c=s.route.id;if(!r.hasOwnProperty(c)&&t.hasOwnProperty(c)&&s.route.loader&&(o[c]=t[c]),i&&i.hasOwnProperty(c))break}return o}function ch(t){return t?an(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Ml(t,r){return(r?t.slice(0,t.findIndex(i=>i.route.id===r)+1):[...t]).reverse().find(i=>i.route.hasErrorBoundary===!0)||t[0]}function Ji(t){let r=t.length===1?t[0]:t.find(a=>a.index||!a.path||a.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:r}],route:r}}function Sn(t,{pathname:r,routeId:a,method:i,type:o,message:s}={}){let c="Unknown Server Error",h="Unknown @remix-run/router error";return t===400?(c="Bad Request",i&&r&&a?h=`You made a ${i} request to "${r}" but did not provide a \`loader\` for route "${a}", so there is no way to handle the request.`:o==="invalid-body"&&(h="Unable to encode submission body")):t===403?(c="Forbidden",h=`Route "${a}" does not match URL "${r}"`):t===404?(c="Not Found",h=`No route matches URL "${r}"`):t===405&&(c="Method Not Allowed",i&&r&&a?h=`You made a ${i.toUpperCase()} request to "${r}" but did not provide an \`action\` for route "${a}", so there is no way to handle the request.`:i&&(h=`Invalid request method "${i.toUpperCase()}"`)),new Ua(t||500,c,new Error(h),!0)}function Pi(t){let r=Object.entries(t);for(let a=r.length-1;a>=0;a--){let[i,o]=r[a];if(cr(o))return{key:i,result:o}}}function fh(t){let r=typeof t=="string"?tl(t):t;return Qn({...r,hash:""})}function _b(t,r){return t.pathname!==r.pathname||t.search!==r.search?!1:t.hash===""?r.hash!=="":t.hash===r.hash?!0:r.hash!==""}function jb(t){var r,a;return new Ua(((r=t.init)==null?void 0:r.status)??500,((a=t.init)==null?void 0:a.statusText)??"Internal Server Error",t.data)}function Lb(t){return t!=null&&typeof t=="object"&&Object.entries(t).every(([r,a])=>typeof r=="string"&&Ub(a))}function Ub(t){return t!=null&&typeof t=="object"&&"type"in t&&"result"in t&&(t.type==="data"||t.type==="error")}function Bb(t){return es(t.result)&&Qd.has(t.result.status)}function an(t){return t.type==="error"}function cr(t){return(t&&t.type)==="redirect"}function dh(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function es(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function Hb(t){return Qd.has(t)}function qb(t){return es(t)&&Hb(t.status)&&t.headers.has("Location")}function Yb(t){return yb.has(t.toUpperCase())}function Vt(t){return pb.has(t.toUpperCase())}function ts(t){return new URLSearchParams(t).getAll("index").some(r=>r==="")}function $i(t,r){let a=typeof r=="string"?tl(r).search:r.search;if(t[t.length-1].route.index&&ts(a||""))return t[t.length-1];let i=Hd(t);return i[i.length-1]}function hh(t){let{formMethod:r,formAction:a,formEncType:i,text:o,formData:s,json:c}=t;if(!(!r||!a||!i)){if(o!=null)return{formMethod:r,formAction:a,formEncType:i,formData:void 0,json:void 0,text:o};if(s!=null)return{formMethod:r,formAction:a,formEncType:i,formData:s,json:void 0,text:void 0};if(c!==void 0)return{formMethod:r,formAction:a,formEncType:i,formData:void 0,json:c,text:void 0}}}function ns(t,r){return r?{state:"loading",location:t,formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Vb(t,r){return{state:"submitting",location:t,formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text}}function Va(t,r){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:r}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:r}}function Fb(t,r){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:r?r.data:void 0}}function nl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Gb(t,r){try{let a=t.sessionStorage.getItem(Zd);if(a){let i=JSON.parse(a);for(let[o,s]of Object.entries(i||{}))s&&Array.isArray(s)&&r.set(o,new Set(s||[]))}}catch{}}function Xb(t,r){if(r.size>0){let a={};for(let[i,o]of r)a[i]=[...o];try{t.sessionStorage.setItem(Zd,JSON.stringify(a))}catch(i){wt(!1,`Failed to save applied view transitions in sessionStorage (${i}).`)}}}function mh(){let t,r,a=new Promise((i,o)=>{t=async s=>{i(s);try{await a}catch{}},r=async s=>{o(s);try{await a}catch{}}});return{promise:a,resolve:t,reject:r}}var fr=j.createContext(null);fr.displayName="DataRouter";var Fa=j.createContext(null);Fa.displayName="DataRouterState";var ph=j.createContext(!1);function Qb(){return j.useContext(ph)}var ls=j.createContext({isTransitioning:!1});ls.displayName="ViewTransition";var gh=j.createContext(new Map);gh.displayName="Fetchers";var Zb=j.createContext(null);Zb.displayName="Await";var wn=j.createContext(null);wn.displayName="Navigation";var Wi=j.createContext(null);Wi.displayName="Location";var jn=j.createContext({outlet:null,matches:[],isDataRoute:!1});jn.displayName="Route";var rs=j.createContext(null);rs.displayName="RouteError";var yh="REACT_ROUTER_ERROR",Kb="REDIRECT",Ib="ROUTE_ERROR_RESPONSE";function Jb(t){if(t.startsWith(`${yh}:${Kb}:{`))try{let r=JSON.parse(t.slice(28));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.location=="string"&&typeof r.reloadDocument=="boolean"&&typeof r.replace=="boolean")return r}catch{}}function Pb(t){if(t.startsWith(`${yh}:${Ib}:{`))try{let r=JSON.parse(t.slice(40));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string")return new Ua(r.status,r.statusText,r.data)}catch{}}function $b(t,{relative:r}={}){Ue(Ga(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:i}=j.useContext(wn),{hash:o,pathname:s,search:c}=Xa(t,{relative:r}),h=s;return a!=="/"&&(h=s==="/"?a:Zn([a,s])),i.createHref({pathname:h,search:c,hash:o})}function Ga(){return j.useContext(Wi)!=null}function Ol(){return Ue(Ga(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Wi).location}var vh="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bh(t){j.useContext(wn).static||j.useLayoutEffect(t)}function as(){let{isDataRoute:t}=j.useContext(jn);return t?hx():Wb()}function Wb(){Ue(Ga(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(fr),{basename:r,navigator:a}=j.useContext(wn),{matches:i}=j.useContext(jn),{pathname:o}=Ol(),s=JSON.stringify(Qo(i)),c=j.useRef(!1);return bh(()=>{c.current=!0}),j.useCallback((p,m={})=>{if(wt(c.current,vh),!c.current)return;if(typeof p=="number"){a.go(p);return}let y=Zo(p,JSON.parse(s),o,m.relative==="path");t==null&&r!=="/"&&(y.pathname=y.pathname==="/"?r:Zn([r,y.pathname])),(m.replace?a.replace:a.push)(y,m.state,m)},[r,a,s,o,t])}var ex=j.createContext(null);function tx(t){let r=j.useContext(jn).outlet;return j.useMemo(()=>r&&j.createElement(ex.Provider,{value:t},r),[r,t])}function xh(){let{matches:t}=j.useContext(jn),r=t[t.length-1];return r?r.params:{}}function Xa(t,{relative:r}={}){let{matches:a}=j.useContext(jn),{pathname:i}=Ol(),o=JSON.stringify(Qo(a));return j.useMemo(()=>Zo(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function nx(t,r,a,i,o){Ue(Ga(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=j.useContext(wn),{matches:c}=j.useContext(jn),h=c[c.length-1],p=h?h.params:{},m=h?h.pathname:"/",y=h?h.pathnameBase:"/",g=h&&h.route;{let _=g&&g.path||"";Eh(m,!g||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let x=Ol(),b;b=x;let k=b.pathname||"/",D=k;if(y!=="/"){let _=y.replace(/^\//,"").split("/");D="/"+k.replace(/^\//,"").split("/").slice(_.length).join("/")}let N=Rl(t,{pathname:D});return wt(g||N!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),wt(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),ux(N&&N.map(_=>Object.assign({},_,{params:Object.assign({},p,_.params),pathname:Zn([y,s.encodeLocation?s.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?y:Zn([y,s.encodeLocation?s.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),c,a,i,o)}function lx(){let t=dx(),r=Ba(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=j.createElement(j.Fragment,null,j.createElement("p",null,"💿 Hey developer 👋"),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:s},"ErrorBoundary")," or"," ",j.createElement("code",{style:s},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},r),a?j.createElement("pre",{style:o},a):null,c)}var rx=j.createElement(lx,null),Sh=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.onError?this.props.onError(t,r):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const a=Pb(t.digest);a&&(t=a)}let r=t!==void 0?j.createElement(jn.Provider,{value:this.props.routeContext},j.createElement(rs.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?j.createElement(ax,{error:t},r):r}};Sh.contextType=ph;var is=new WeakMap;function ax({children:t,error:r}){let{basename:a}=j.useContext(wn);if(typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){let i=Jb(r.digest);if(i){let o=is.get(r);if(o)throw o;let s=Yd(i.location,a);if(qd&&!is.get(r))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw is.set(r,c),c}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return t}function ix({routeContext:t,match:r,children:a}){let i=j.useContext(fr);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),j.createElement(jn.Provider,{value:t},a)}function ux(t,r=[],a=null,i=null,o=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(r.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let s=t,c=a==null?void 0:a.errors;if(c!=null){let y=s.findIndex(g=>g.route.id&&(c==null?void 0:c[g.route.id])!==void 0);Ue(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),s=s.slice(0,Math.min(s.length,y+1))}let h=!1,p=-1;if(a)for(let y=0;y<s.length;y++){let g=s[y];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(p=y),g.route.id){let{loaderData:x,errors:b}=a,k=g.route.loader&&!x.hasOwnProperty(g.route.id)&&(!b||b[g.route.id]===void 0);if(g.route.lazy||k){h=!0,p>=0?s=s.slice(0,p+1):s=[s[0]];break}}}let m=a&&i?(y,g)=>{var x,b;i(y,{location:a.location,params:((b=(x=a.matches)==null?void 0:x[0])==null?void 0:b.params)??{},unstable_pattern:Ha(a.matches),errorInfo:g})}:void 0;return s.reduceRight((y,g,x)=>{let b,k=!1,D=null,N=null;a&&(b=c&&g.route.id?c[g.route.id]:void 0,D=g.route.errorElement||rx,h&&(p<0&&x===0?(Eh("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,N=null):p===x&&(k=!0,N=g.route.hydrateFallbackElement||null)));let R=r.concat(s.slice(0,x+1)),_=()=>{let H;return b?H=D:k?H=N:g.route.Component?H=j.createElement(g.route.Component,null):g.route.element?H=g.route.element:H=y,j.createElement(ix,{match:g,routeContext:{outlet:y,matches:R,isDataRoute:a!=null},children:H})};return a&&(g.route.ErrorBoundary||g.route.errorElement||x===0)?j.createElement(Sh,{location:a.location,revalidation:a.revalidation,component:D,error:b,children:_(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:m}):_()},null)}function us(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ox(t){let r=j.useContext(fr);return Ue(r,us(t)),r}function sx(t){let r=j.useContext(Fa);return Ue(r,us(t)),r}function cx(t){let r=j.useContext(jn);return Ue(r,us(t)),r}function os(t){let r=cx(t),a=r.matches[r.matches.length-1];return Ue(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function fx(){return os("useRouteId")}function dx(){var i;let t=j.useContext(rs),r=sx("useRouteError"),a=os("useRouteError");return t!==void 0?t:(i=r.errors)==null?void 0:i[a]}function hx(){let{router:t}=ox("useNavigate"),r=os("useNavigate"),a=j.useRef(!1);return bh(()=>{a.current=!0}),j.useCallback(async(o,s={})=>{wt(a.current,vh),a.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:r,...s}))},[t,r])}var wh={};function Eh(t,r,a){!r&&!wh[t]&&(wh[t]=!0,wt(!1,a))}var kh={};function Ch(t,r){!t&&!kh[r]&&(kh[r]=!0,console.warn(r))}var mx="useOptimistic",Th=Av[mx],px=()=>{};function gx(t){return Th?Th(t):[t,px]}function yx(t){let r={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&wt(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(r,{element:j.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&wt(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(r,{hydrateFallbackElement:j.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&wt(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(r,{errorElement:j.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),r}var vx=["HydrateFallback","hydrateFallbackElement"],bx=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=a=>{this.status==="pending"&&(this.status="resolved",t(a))},this.reject=a=>{this.status==="pending"&&(this.status="rejected",r(a))}})}};function xx({router:t,flushSync:r,onError:a,unstable_useTransitions:i}){i=Qb()||i;let[s,c]=j.useState(t.state),[h,p]=gx(s),[m,y]=j.useState(),[g,x]=j.useState({isTransitioning:!1}),[b,k]=j.useState(),[D,N]=j.useState(),[R,_]=j.useState(),H=j.useRef(new Map),ie=j.useCallback((le,{deletedFetchers:de,newErrors:Y,flushSync:ne,viewTransitionOpts:ae})=>{Y&&a&&Object.values(Y).forEach(he=>{var te;return a(he,{location:le.location,params:((te=le.matches[0])==null?void 0:te.params)??{},unstable_pattern:Ha(le.matches)})}),le.fetchers.forEach((he,te)=>{he.data!==void 0&&H.current.set(te,he.data)}),de.forEach(he=>H.current.delete(he)),Ch(ne===!1||r!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let Ae=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(Ch(ae==null||Ae,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!ae||!Ae){r&&ne?r(()=>c(le)):i===!1?c(le):j.startTransition(()=>{i===!0&&p(he=>zh(he,le)),c(le)});return}if(r&&ne){r(()=>{D&&(b==null||b.resolve(),D.skipTransition()),x({isTransitioning:!0,flushSync:!0,currentLocation:ae.currentLocation,nextLocation:ae.nextLocation})});let he=t.window.document.startViewTransition(()=>{r(()=>c(le))});he.finished.finally(()=>{r(()=>{k(void 0),N(void 0),y(void 0),x({isTransitioning:!1})})}),r(()=>N(he));return}D?(b==null||b.resolve(),D.skipTransition(),_({state:le,currentLocation:ae.currentLocation,nextLocation:ae.nextLocation})):(y(le),x({isTransitioning:!0,flushSync:!1,currentLocation:ae.currentLocation,nextLocation:ae.nextLocation}))},[t.window,r,D,b,i,p,a]);j.useLayoutEffect(()=>t.subscribe(ie),[t,ie]),j.useEffect(()=>{g.isTransitioning&&!g.flushSync&&k(new bx)},[g]),j.useEffect(()=>{if(b&&m&&t.window){let le=m,de=b.promise,Y=t.window.document.startViewTransition(async()=>{i===!1?c(le):j.startTransition(()=>{i===!0&&p(ne=>zh(ne,le)),c(le)}),await de});Y.finished.finally(()=>{k(void 0),N(void 0),y(void 0),x({isTransitioning:!1})}),N(Y)}},[m,b,t.window,i,p]),j.useEffect(()=>{b&&m&&h.location.key===m.location.key&&b.resolve()},[b,D,h.location,m]),j.useEffect(()=>{!g.isTransitioning&&R&&(y(R.state),x({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}),_(void 0))},[g.isTransitioning,R]);let K=j.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:le=>t.navigate(le),push:(le,de,Y)=>t.navigate(le,{state:de,preventScrollReset:Y==null?void 0:Y.preventScrollReset}),replace:(le,de,Y)=>t.navigate(le,{replace:!0,state:de,preventScrollReset:Y==null?void 0:Y.preventScrollReset})}),[t]),q=t.basename||"/",M=j.useMemo(()=>({router:t,navigator:K,static:!1,basename:q,onError:a}),[t,K,q,a]);return j.createElement(j.Fragment,null,j.createElement(fr.Provider,{value:M},j.createElement(Fa.Provider,{value:h},j.createElement(gh.Provider,{value:H.current},j.createElement(ls.Provider,{value:g},j.createElement(kx,{basename:q,location:h.location,navigationType:h.historyAction,navigator:K,unstable_useTransitions:i},j.createElement(Sx,{routes:t.routes,future:t.future,state:h,onError:a})))))),null)}function zh(t,r){return{...t,navigation:r.navigation.state!=="idle"?r.navigation:t.navigation,revalidation:r.revalidation!=="idle"?r.revalidation:t.revalidation,actionData:r.navigation.state!=="submitting"?r.actionData:t.actionData,fetchers:r.fetchers}}var Sx=j.memo(wx);function wx({routes:t,future:r,state:a,onError:i}){return nx(t,void 0,a,i,r)}function Ex(t){return tx(t.context)}function kx({basename:t="/",children:r=null,location:a,navigationType:i="POP",navigator:o,static:s=!1,unstable_useTransitions:c}){Ue(!Ga(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),p=j.useMemo(()=>({basename:h,navigator:o,static:s,unstable_useTransitions:c,future:{}}),[h,o,s,c]);typeof a=="string"&&(a=tl(a));let{pathname:m="/",search:y="",hash:g="",state:x=null,key:b="default"}=a,k=j.useMemo(()=>{let D=xn(m,h);return D==null?null:{location:{pathname:D,search:y,hash:g,state:x,key:b},navigationType:i}},[h,m,y,g,x,b,i]);return wt(k!=null,`<Router basename="${h}"> is not able to match the URL "${m}${y}${g}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:j.createElement(wn.Provider,{value:p},j.createElement(Wi.Provider,{children:r,value:k}))}var eu="get",tu="application/x-www-form-urlencoded";function nu(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function Cx(t){return nu(t)&&t.tagName.toLowerCase()==="button"}function Tx(t){return nu(t)&&t.tagName.toLowerCase()==="form"}function zx(t){return nu(t)&&t.tagName.toLowerCase()==="input"}function Ax(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Rx(t,r){return t.button===0&&(!r||r==="_self")&&!Ax(t)}var lu=null;function Dx(){if(lu===null)try{new FormData(document.createElement("form"),0),lu=!1}catch{lu=!0}return lu}var Mx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ss(t){return t!=null&&!Mx.has(t)?(wt(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${tu}"`),null):t}function Ox(t,r){let a,i,o,s,c;if(Tx(t)){let h=t.getAttribute("action");i=h?xn(h,r):null,a=t.getAttribute("method")||eu,o=ss(t.getAttribute("enctype"))||tu,s=new FormData(t)}else if(Cx(t)||zx(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||h.getAttribute("action");if(i=p?xn(p,r):null,a=t.getAttribute("formmethod")||h.getAttribute("method")||eu,o=ss(t.getAttribute("formenctype"))||ss(h.getAttribute("enctype"))||tu,s=new FormData(h,t),!Dx()){let{name:m,type:y,value:g}=t;if(y==="image"){let x=m?`${m}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else m&&s.append(m,g)}}else{if(nu(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=eu,i=null,o=tu,c=t}return s&&o==="text/plain"&&(c=s,s=void 0),{action:i,method:a.toLowerCase(),encType:o,formData:s,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cs(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Nx(t,r,a,i){let o=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:r&&xn(o.pathname,r)==="/"?o.pathname=`${r.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function _x(t,r){if(t.id in r)return r[t.id];try{let a=await import(t.module);return r[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jx(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Lx(t,r,a){let i=await Promise.all(t.map(async o=>{let s=r.routes[o.route.id];if(s){let c=await _x(s,a);return c.links?c.links():[]}return[]}));return qx(i.flat(1).filter(jx).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Ah(t,r,a,i,o,s){let c=(p,m)=>a[m]?p.route.id!==a[m].route.id:!0,h=(p,m)=>{var y;return a[m].pathname!==p.pathname||((y=a[m].route.path)==null?void 0:y.endsWith("*"))&&a[m].params["*"]!==p.params["*"]};return s==="assets"?r.filter((p,m)=>c(p,m)||h(p,m)):s==="data"?r.filter((p,m)=>{var g;let y=i.routes[p.route.id];if(!y||!y.hasLoader)return!1;if(c(p,m)||h(p,m))return!0;if(p.route.shouldRevalidate){let x=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((g=a[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function Ux(t,r,{includeHydrateFallback:a}={}){return Bx(t.map(i=>{let o=r.routes[i.route.id];if(!o)return[];let s=[o.module];return o.clientActionModule&&(s=s.concat(o.clientActionModule)),o.clientLoaderModule&&(s=s.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(s=s.concat(o.hydrateFallbackModule)),o.imports&&(s=s.concat(o.imports)),s}).flat(1))}function Bx(t){return[...new Set(t)]}function Hx(t){let r={},a=Object.keys(t).sort();for(let i of a)r[i]=t[i];return r}function qx(t,r){let a=new Set;return new Set(r),t.reduce((i,o)=>{let s=JSON.stringify(Hx(o));return a.has(s)||(a.add(s),i.push({key:s,link:o})),i},[])}function Rh(){let t=j.useContext(fr);return cs(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Yx(){let t=j.useContext(Fa);return cs(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var fs=j.createContext(void 0);fs.displayName="FrameworkContext";function Dh(){let t=j.useContext(fs);return cs(t,"You must render this element inside a <HydratedRouter> element"),t}function Vx(t,r){let a=j.useContext(fs),[i,o]=j.useState(!1),[s,c]=j.useState(!1),{onFocus:h,onBlur:p,onMouseEnter:m,onMouseLeave:y,onTouchStart:g}=r,x=j.useRef(null);j.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let D=R=>{R.forEach(_=>{c(_.isIntersecting)})},N=new IntersectionObserver(D,{threshold:.5});return x.current&&N.observe(x.current),()=>{N.disconnect()}}},[t]),j.useEffect(()=>{if(i){let D=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(D)}}},[i]);let b=()=>{o(!0)},k=()=>{o(!1),c(!1)};return a?t!=="intent"?[s,x,{}]:[s,x,{onFocus:Qa(h,b),onBlur:Qa(p,k),onMouseEnter:Qa(m,b),onMouseLeave:Qa(y,k),onTouchStart:Qa(g,b)}]:[!1,x,{}]}function Qa(t,r){return a=>{t&&t(a),a.defaultPrevented||r(a)}}function Fx({page:t,...r}){let{router:a}=Rh(),i=j.useMemo(()=>Rl(a.routes,t,a.basename),[a.routes,t,a.basename]);return i?j.createElement(Xx,{page:t,matches:i,...r}):null}function Gx(t){let{manifest:r,routeModules:a}=Dh(),[i,o]=j.useState([]);return j.useEffect(()=>{let s=!1;return Lx(t,r,a).then(c=>{s||o(c)}),()=>{s=!0}},[t,r,a]),i}function Xx({page:t,matches:r,...a}){let i=Ol(),{future:o,manifest:s,routeModules:c}=Dh(),{basename:h}=Rh(),{loaderData:p,matches:m}=Yx(),y=j.useMemo(()=>Ah(t,r,m,s,i,"data"),[t,r,m,s,i]),g=j.useMemo(()=>Ah(t,r,m,s,i,"assets"),[t,r,m,s,i]),x=j.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let D=new Set,N=!1;if(r.forEach(_=>{var ie;let H=s.routes[_.route.id];!H||!H.hasLoader||(!y.some(K=>K.route.id===_.route.id)&&_.route.id in p&&((ie=c[_.route.id])!=null&&ie.shouldRevalidate)||H.hasClientLoader?N=!0:D.add(_.route.id))}),D.size===0)return[];let R=Nx(t,h,o.unstable_trailingSlashAwareDataRequests,"data");return N&&D.size>0&&R.searchParams.set("_routes",r.filter(_=>D.has(_.route.id)).map(_=>_.route.id).join(",")),[R.pathname+R.search]},[h,o.unstable_trailingSlashAwareDataRequests,p,i,s,y,r,t,c]),b=j.useMemo(()=>Ux(g,s),[g,s]),k=Gx(g);return j.createElement(j.Fragment,null,x.map(D=>j.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...a})),b.map(D=>j.createElement("link",{key:D,rel:"modulepreload",href:D,...a})),k.map(({key:D,link:N})=>j.createElement("link",{key:D,nonce:a.nonce,...N,crossOrigin:N.crossOrigin??a.crossOrigin})))}function Qx(...t){return r=>{t.forEach(a=>{typeof a=="function"?a(r):a!=null&&(a.current=r)})}}var Zx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Zx&&(window.__reactRouterVersion="7.13.0")}catch{}function Kx(t,r){return Sb({basename:r==null?void 0:r.basename,getContext:r==null?void 0:r.getContext,future:r==null?void 0:r.future,history:Uv({window:r==null?void 0:r.window}),hydrationData:Ix(),routes:t,mapRouteProperties:yx,hydrationRouteProperties:vx,dataStrategy:r==null?void 0:r.dataStrategy,patchRoutesOnNavigation:r==null?void 0:r.patchRoutesOnNavigation,window:r==null?void 0:r.window,unstable_instrumentations:r==null?void 0:r.unstable_instrumentations}).initialize()}function Ix(){let t=window==null?void 0:window.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:Jx(t.errors)}),t}function Jx(t){if(!t)return null;let r=Object.entries(t),a={};for(let[i,o]of r)if(o&&o.__type==="RouteErrorResponse")a[i]=new Ua(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){if(o.__subType){let s=window[o.__subType];if(typeof s=="function")try{let c=new s(o.message);c.stack="",a[i]=c}catch{}}if(a[i]==null){let s=new Error(o.message);s.stack="",a[i]=s}}else a[i]=o;return a}var Mh=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,un=j.forwardRef(function({onClick:r,discover:a="render",prefetch:i="none",relative:o,reloadDocument:s,replace:c,state:h,target:p,to:m,preventScrollReset:y,viewTransition:g,unstable_defaultShouldRevalidate:x,...b},k){let{basename:D,unstable_useTransitions:N}=j.useContext(wn),R=typeof m=="string"&&Mh.test(m),_=Yd(m,D);m=_.to;let H=$b(m,{relative:o}),[ie,K,q]=Vx(i,b),M=Wx(m,{replace:c,state:h,target:p,preventScrollReset:y,relative:o,viewTransition:g,unstable_defaultShouldRevalidate:x,unstable_useTransitions:N});function le(Y){r&&r(Y),Y.defaultPrevented||M(Y)}let de=j.createElement("a",{...b,...q,href:_.absoluteURL||H,onClick:_.isExternal||s?r:le,ref:Qx(k,K),target:p,"data-discover":!R&&a==="render"?"true":void 0});return ie&&!R?j.createElement(j.Fragment,null,de,j.createElement(Fx,{page:H})):de});un.displayName="Link";var ds=j.forwardRef(function({"aria-current":r="page",caseSensitive:a=!1,className:i="",end:o=!1,style:s,to:c,viewTransition:h,children:p,...m},y){let g=Xa(c,{relative:m.relative}),x=Ol(),b=j.useContext(Fa),{navigator:k,basename:D}=j.useContext(wn),N=b!=null&&r1(g)&&h===!0,R=k.encodeLocation?k.encodeLocation(g).pathname:g.pathname,_=x.pathname,H=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;a||(_=_.toLowerCase(),H=H?H.toLowerCase():null,R=R.toLowerCase()),H&&D&&(H=xn(H,D)||H);const ie=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let K=_===R||!o&&_.startsWith(R)&&_.charAt(ie)==="/",q=H!=null&&(H===R||!o&&H.startsWith(R)&&H.charAt(R.length)==="/"),M={isActive:K,isPending:q,isTransitioning:N},le=K?r:void 0,de;typeof i=="function"?de=i(M):de=[i,K?"active":null,q?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let Y=typeof s=="function"?s(M):s;return j.createElement(un,{...m,"aria-current":le,className:de,ref:y,style:Y,to:c,viewTransition:h},typeof p=="function"?p(M):p)});ds.displayName="NavLink";var Px=j.forwardRef(({discover:t="render",fetcherKey:r,navigate:a,reloadDocument:i,replace:o,state:s,method:c=eu,action:h,onSubmit:p,relative:m,preventScrollReset:y,viewTransition:g,unstable_defaultShouldRevalidate:x,...b},k)=>{let{unstable_useTransitions:D}=j.useContext(wn),N=n1(),R=l1(h,{relative:m}),_=c.toLowerCase()==="get"?"get":"post",H=typeof h=="string"&&Mh.test(h),ie=K=>{if(p&&p(K),K.defaultPrevented)return;K.preventDefault();let q=K.nativeEvent.submitter,M=(q==null?void 0:q.getAttribute("formmethod"))||c,le=()=>N(q||K.currentTarget,{fetcherKey:r,method:M,navigate:a,replace:o,state:s,relative:m,preventScrollReset:y,viewTransition:g,unstable_defaultShouldRevalidate:x});D&&a!==!1?j.startTransition(()=>le()):le()};return j.createElement("form",{ref:k,method:_,action:R,onSubmit:i?p:ie,...b,"data-discover":!H&&t==="render"?"true":void 0})});Px.displayName="Form";function $x(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Oh(t){let r=j.useContext(fr);return Ue(r,$x(t)),r}function Wx(t,{target:r,replace:a,state:i,preventScrollReset:o,relative:s,viewTransition:c,unstable_defaultShouldRevalidate:h,unstable_useTransitions:p}={}){let m=as(),y=Ol(),g=Xa(t,{relative:s});return j.useCallback(x=>{if(Rx(x,r)){x.preventDefault();let b=a!==void 0?a:Qn(y)===Qn(g),k=()=>m(t,{replace:b,state:i,preventScrollReset:o,relative:s,viewTransition:c,unstable_defaultShouldRevalidate:h});p?j.startTransition(()=>k()):k()}},[y,m,g,a,i,r,t,o,s,c,h,p])}var e1=0,t1=()=>`__${String(++e1)}__`;function n1(){let{router:t}=Oh("useSubmit"),{basename:r}=j.useContext(wn),a=fx(),i=t.fetch,o=t.navigate;return j.useCallback(async(s,c={})=>{let{action:h,method:p,encType:m,formData:y,body:g}=Ox(s,r);if(c.navigate===!1){let x=c.fetcherKey||t1();await i(x,a,c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:y,body:g,formMethod:c.method||p,formEncType:c.encType||m,flushSync:c.flushSync})}else await o(c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:y,body:g,formMethod:c.method||p,formEncType:c.encType||m,replace:c.replace,state:c.state,fromRouteId:a,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,o,r,a])}function l1(t,{relative:r}={}){let{basename:a}=j.useContext(wn),i=j.useContext(jn);Ue(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),s={...Xa(t||".",{relative:r})},c=Ol();if(t==null){s.search=c.search;let h=new URLSearchParams(s.search),p=h.getAll("index");if(p.some(y=>y==="")){h.delete("index"),p.filter(g=>g).forEach(g=>h.append("index",g));let y=h.toString();s.search=y?`?${y}`:""}}return(!t||t===".")&&o.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(s.pathname=s.pathname==="/"?a:Zn([a,s.pathname])),Qn(s)}function r1(t,{relative:r}={}){let a=j.useContext(ls);Ue(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Oh("useViewTransitionState"),o=Xa(t,{relative:r});if(!a.isTransitioning)return!1;let s=xn(a.currentLocation.pathname,i)||a.currentLocation.pathname,c=xn(a.nextLocation.pathname,i)||a.nextLocation.pathname;return Ii(o.pathname,c)!=null||Ii(o.pathname,s)!=null}var a1=Cd();function i1(t){return j.createElement(xx,{flushSync:a1.flushSync,...t})}const hs="spek:recent-paths",Nh=5,_h=j.createContext(null);function ru(){try{const t=localStorage.getItem(hs);if(!t)return[];const r=JSON.parse(t);return Array.isArray(r)?r.slice(0,Nh):[]}catch{return[]}}function u1(t){const r=ru().filter(a=>a!==t);r.unshift(t),localStorage.setItem(hs,JSON.stringify(r.slice(0,Nh)))}function o1({children:t}){const[r,a]=j.useState(""),[i,o]=j.useState(ru),s=j.useCallback(p=>{a(p),p&&(u1(p),o(ru()))},[]),c=j.useCallback(()=>{a("")},[]),h=j.useCallback(p=>{const m=ru().filter(y=>y!==p);localStorage.setItem(hs,JSON.stringify(m)),o(m)},[]);return w.jsx(_h.Provider,{value:{repoPath:r,setRepoPath:s,recentPaths:i,clearRepoPath:c,removePath:h},children:t})}function ll(){const t=j.useContext(_h);if(!t)throw new Error("useRepo must be used within RepoProvider");return t}const jh="spek:theme",Lh=j.createContext(null);function s1(){try{const t=localStorage.getItem(jh);if(t==="dark"||t==="light")return t}catch{}return window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function c1({children:t}){const[r,a]=j.useState(s1);j.useEffect(()=>{document.documentElement.setAttribute("data-theme",r)},[r]);const i=j.useCallback(()=>{a(o=>{const s=o==="dark"?"light":"dark";try{localStorage.setItem(jh,s)}catch{}return s})},[]);return w.jsx(Lh.Provider,{value:{theme:r,toggleTheme:i},children:w.jsx(d1.Provider,{value:{setTheme:a},children:t})})}function f1(){const t=j.useContext(Lh);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t}const d1=j.createContext(null),Uh=j.createContext(null);function h1({adapter:t,children:r}){return w.jsx(Uh.Provider,{value:t,children:r})}function Nl(){const t=j.useContext(Uh);if(!t)throw new Error("useApiAdapter must be used within ApiAdapterProvider");return t}class m1{constructor(){kv(this,"data");if(this.data=window.__DEMO_DATA__,!this.data)throw new Error("Demo data not found. Ensure __DEMO_DATA__ is set.")}getOverview(){return Promise.resolve(this.data.overview)}getSpecs(){return Promise.resolve(this.data.specs)}getSpec(r){const a=this.data.specDetails[r];return a?Promise.resolve(a):Promise.reject(new Error(`Spec not found: ${r}`))}getSpecAtChange(r,a){var s;const i=(s=this.data.specVersions)==null?void 0:s[r],o=i==null?void 0:i[a];return o===void 0?Promise.reject(new Error(`Spec version not found: ${r}@${a}`)):Promise.resolve({content:o})}getChanges(){return Promise.resolve(this.data.changes)}getChange(r){const a=this.data.changeDetails[r];return a?Promise.resolve(a):Promise.reject(new Error(`Change not found: ${r}`))}search(r){const a=r.toLowerCase(),i=[];for(const[o,s]of Object.entries(this.data.specDetails))if(s.content.toLowerCase().includes(a)||o.toLowerCase().includes(a)){const c=s.content.toLowerCase().indexOf(a),h=Math.max(0,c-60),p=Math.min(s.content.length,c+r.length+60),m=(h>0?"...":"")+s.content.slice(h,p)+(p<s.content.length?"...":"");i.push({type:"spec",title:o,topic:o,context:m})}for(const[o,s]of Object.entries(this.data.changeDetails)){const h=[s.proposal,s.design].filter(Boolean).join(`
`);if(h.toLowerCase().includes(a)||o.toLowerCase().includes(a)){const p=h.toLowerCase().indexOf(a),m=Math.max(0,p-60),y=Math.min(h.length,p+r.length+60),g=p>=0?(m>0?"...":"")+h.slice(m,y)+(y<h.length?"...":""):o;i.push({type:"change",title:o,slug:o,context:g})}}return Promise.resolve(i)}browse(){return Promise.resolve({path:"/",entries:[]})}detect(){return Promise.resolve({hasOpenSpec:!0})}async resync(){}}function Vr(t,r){const[a,i]=j.useState({data:null,loading:!!t,error:null});return j.useEffect(()=>{if(!t){i({data:null,loading:!1,error:null});return}let o=!1;return i({data:null,loading:!0,error:null}),t().then(s=>{o||i({data:s,loading:!1,error:null})}).catch(s=>{o||i({data:null,loading:!1,error:s.message})}),()=>{o=!0}},r),a}function p1(){const{repoPath:t}=ll(),r=Nl();return Vr(t?()=>r.getOverview():null,[t])}function Bh(){const{repoPath:t}=ll(),r=Nl();return Vr(t?()=>r.getSpecs():null,[t])}function g1(t){const{repoPath:r}=ll(),a=Nl();return Vr(r&&t?()=>a.getSpec(t):null,[r,t])}function y1(t,r){const{repoPath:a}=ll(),i=Nl();return Vr(a&&t&&r?()=>i.getSpecAtChange(t,r):null,[a,t,r])}function Hh(){const{repoPath:t}=ll(),r=Nl();return Vr(t?()=>r.getChanges():null,[t])}function v1(t){const{repoPath:r}=ll(),a=Nl();return Vr(r&&t?()=>a.getChange(t):null,[r,t])}function b1(){const{repoPath:t}=ll(),r=Nl(),[a,i]=j.useState(!1);return{resync:j.useCallback(async()=>{if(!(!t||a)){i(!0);try{await r.resync()}finally{i(!1)}}},[t,a,r]),loading:a}}const qh=[{to:"/dashboard",label:"Overview",icon:w.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h4a1 1 0 011 1v5a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm10 0a1 1 0 011-1h4a1 1 0 011 1v3a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zm-10 9a1 1 0 011-1h4a1 1 0 011 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-3zm10-2a1 1 0 011-1h4a1 1 0 011 1v5a1 1 0 01-1 1h-4a1 1 0 01-1-1v-5z"})})},{to:"/specs",label:"Specs",icon:w.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{to:"/changes",label:"Changes",icon:w.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}];function Yh({collapsed:t}){const{resync:r,loading:a}=b1();return w.jsxs("button",{onClick:r,disabled:a,className:`w-full flex items-center gap-2 rounded text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-colors disabled:opacity-50 cursor-pointer disabled:cursor-not-allowed ${t?"justify-center px-2 py-2":"px-3 py-2"}`,title:"Resync git timestamps",children:[w.jsx("svg",{className:`w-4 h-4 shrink-0 ${a?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),!t&&(a?"Syncing...":"Resync")]})}function x1({collapsed:t,onToggle:r}){return w.jsxs("button",{onClick:r,className:`w-full flex items-center gap-2 rounded text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-colors cursor-pointer ${t?"justify-center px-2 py-2":"px-3 py-2"}`,title:t?"Expand sidebar":"Collapse sidebar",children:[w.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"}):w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7M19 19l-7-7 7-7"})}),!t&&(t?"Expand":"Collapse")]})}function S1({open:t,isMobile:r,collapsed:a,onClose:i,onToggle:o}){const s=Ol();return j.useEffect(()=>{r&&i()},[s.pathname]),r?t?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 bg-black/50 z-20",onClick:i}),w.jsxs("aside",{className:"fixed top-14 left-0 bottom-0 w-60 bg-bg-secondary border-r border-border overflow-y-auto z-30 flex flex-col",children:[w.jsx("nav",{className:"p-4 space-y-1 flex-1",children:qh.map(c=>w.jsxs(ds,{to:c.to,className:({isActive:h})=>`flex items-center gap-2 px-3 py-2 rounded text-sm transition-colors ${h?"bg-accent/10 text-accent font-medium":"text-text-secondary hover:text-text-primary hover:bg-bg-tertiary"}`,children:[c.icon,c.label]},c.to))}),w.jsx("div",{className:"p-4 border-t border-border",children:w.jsx(Yh,{collapsed:!1})})]})]}):null:w.jsxs("aside",{className:`fixed top-14 left-0 bottom-0 bg-bg-secondary border-r border-border overflow-y-auto flex flex-col transition-all duration-200 ${a?"w-14":"w-60"}`,children:[w.jsx("nav",{className:`flex-1 space-y-1 ${a?"p-2":"p-4"}`,children:qh.map(c=>w.jsxs(ds,{to:c.to,title:a?c.label:void 0,className:({isActive:h})=>`flex items-center gap-2 rounded text-sm transition-colors ${a?"justify-center px-2 py-2":"px-3 py-2"} ${h?"bg-accent/10 text-accent font-medium":"text-text-secondary hover:text-text-primary hover:bg-bg-tertiary"}`,children:[c.icon,!a&&c.label]},c.to))}),w.jsxs("div",{className:`border-t border-border space-y-1 ${a?"p-2":"p-4"}`,children:[w.jsx(x1,{collapsed:a,onToggle:o}),w.jsx(Yh,{collapsed:a})]})]})}function w1(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Vh({text:t,query:r}){if(!t||!r.trim())return w.jsx(w.Fragment,{children:t??""});const a=w1(r.trim()),i=t.split(new RegExp(`(${a})`,"gi"));return w.jsx(w.Fragment,{children:i.map((o,s)=>o.toLowerCase()===r.trim().toLowerCase()?w.jsx("mark",{className:"bg-accent/20 text-accent rounded px-0.5",children:o},s):w.jsx("span",{children:o},s))})}function E1(t){const r=Nl(),[a,i]=j.useState([]),[o,s]=j.useState(!1);return j.useEffect(()=>{if(!t.trim()){i([]),s(!1);return}s(!0);const c=setTimeout(()=>{r.search(t.trim()).then(h=>{i(h),s(!1)}).catch(()=>{i([]),s(!1)})},300);return()=>clearTimeout(c)},[t,r]),{results:a,loading:o}}function k1({open:t,onClose:r}){const[a,i]=j.useState(""),[o,s]=j.useState(0),[c,h]=j.useState("all"),p=j.useRef(null),m=as(),{results:y,loading:g}=E1(a),x=y.filter(K=>K.type==="spec"),b=y.filter(K=>K.type==="change"),k=c==="change"?[]:x,D=c==="spec"?[]:b,N=j.useMemo(()=>[...k,...D],[k,D]);j.useEffect(()=>{t&&(i(""),s(0),h("all"),setTimeout(()=>{var K;return(K=p.current)==null?void 0:K.focus()},0))},[t]),j.useEffect(()=>{s(0)},[y,c]);const R=j.useCallback(K=>{const q=K.type==="spec"?`/specs/${encodeURIComponent(K.topic??K.title)}`:`/changes/${encodeURIComponent(K.slug??K.title)}`;m(q),r()},[m,r]),_=j.useCallback(K=>{K.key==="ArrowDown"?(K.preventDefault(),s(q=>Math.min(q+1,N.length-1))):K.key==="ArrowUp"?(K.preventDefault(),s(q=>Math.max(q-1,0))):K.key==="Enter"?(K.preventDefault(),N[o]&&R(N[o])):K.key==="Escape"&&(K.preventDefault(),r())},[N,o,R,r]);if(!t)return null;let H=0;const ie=[{label:"All",value:"all"},{label:"Specs",value:"spec"},{label:"Changes",value:"change"}];return w.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh]",children:[w.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:r}),w.jsxs("div",{className:"relative w-full max-w-xl bg-bg-secondary border border-border rounded-lg shadow-2xl overflow-hidden",children:[w.jsxs("div",{className:"flex items-center border-b border-border px-4",children:[w.jsx("svg",{className:"w-5 h-5 text-text-muted shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),w.jsx("input",{ref:p,type:"text",value:a,onChange:K=>i(K.target.value),onKeyDown:_,placeholder:"Search specs and changes...",className:"flex-1 bg-transparent text-text-primary px-3 py-3 text-sm outline-none placeholder:text-text-muted"}),w.jsx("kbd",{className:"text-xs text-text-muted bg-bg-tertiary px-1.5 py-0.5 rounded border border-border",children:"ESC"})]}),a.trim()&&!g&&y.length>0&&w.jsx("div",{className:"flex gap-1 px-4 pt-2",children:ie.map(K=>w.jsx("button",{onClick:()=>h(K.value),className:`px-2.5 py-0.5 text-xs rounded-full transition-colors cursor-pointer ${c===K.value?"bg-accent/20 text-accent":"bg-bg-tertiary text-text-muted hover:text-text-secondary"}`,children:K.label},K.value))}),w.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[!a.trim()&&w.jsx("p",{className:"text-text-muted text-sm p-4 text-center",children:"Type to search across specs and changes..."}),a.trim()&&g&&w.jsx("p",{className:"text-text-muted text-sm p-4 text-center",children:"Searching..."}),a.trim()&&!g&&N.length===0&&w.jsxs("div",{className:"text-center p-4",children:[w.jsx("p",{className:"text-text-muted text-sm",children:"No results found"}),w.jsx("p",{className:"text-text-muted text-xs mt-1",children:"Try different keywords or check the spelling"})]}),!g&&k.length>0&&w.jsxs("div",{children:[w.jsx("div",{className:"px-4 pt-3 pb-1 text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Specs"}),k.map(K=>{const q=H++;return w.jsx(Fh,{result:K,query:a,selected:q===o,onClick:()=>R(K)},`spec-${K.title}`)})]}),!g&&D.length>0&&w.jsxs("div",{children:[w.jsx("div",{className:"px-4 pt-3 pb-1 text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Changes"}),D.map(K=>{const q=H++;return w.jsx(Fh,{result:K,query:a,selected:q===o,onClick:()=>R(K)},`change-${K.title}`)})]})]})]})]})}function Fh({result:t,query:r,selected:a,onClick:i}){return w.jsxs("button",{onClick:i,className:`w-full text-left px-4 py-2 cursor-pointer transition-colors ${a?"bg-bg-tertiary":"hover:bg-bg-tertiary/50"}`,children:[w.jsx("div",{className:"text-sm font-medium text-text-primary",children:w.jsx(Vh,{text:t.title,query:r})}),t.context&&w.jsx("div",{className:"text-xs text-text-muted mt-0.5 truncate",children:w.jsx(Vh,{text:t.context,query:r})})]})}function C1(){const{repoPath:t}=ll(),{theme:r,toggleTheme:a}=f1(),i=as(),[o,s]=j.useState(!1),[c,h]=j.useState(!1),[p,m]=j.useState(!1),[y,g]=j.useState(()=>{try{return localStorage.getItem("spek-sidebar-collapsed")==="true"}catch{return!1}}),x=j.useCallback(()=>{g(k=>{const D=!k;try{localStorage.setItem("spek-sidebar-collapsed",String(D))}catch{}return D})},[]);j.useEffect(()=>{const k=window.matchMedia("(max-width: 767px)");m(k.matches);const D=N=>{m(N.matches),N.matches||h(!1)};return k.addEventListener("change",D),()=>k.removeEventListener("change",D)},[]),j.useEffect(()=>{t||i("/",{replace:!0})},[t,i]),j.useEffect(()=>{const k=D=>{(D.metaKey||D.ctrlKey)&&D.key==="k"&&(D.preventDefault(),s(!0))};return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[]);const b=j.useCallback(()=>s(!1),[]);return t?w.jsxs("div",{className:"min-h-screen bg-bg-primary",children:[w.jsxs("header",{className:"fixed top-0 left-0 right-0 h-14 bg-bg-secondary border-b border-border flex items-center px-4 z-10",children:[p&&w.jsx("button",{onClick:()=>h(!c),"aria-label":"Open navigation menu",className:"p-2 mr-2 rounded text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-colors cursor-pointer",children:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),w.jsxs("span",{className:"text-accent font-bold text-lg flex items-center gap-1.5",children:[w.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 32 32",fill:"none",children:[w.jsx("path",{d:"M 20 8.5 C 20 8.5, 23 8.5, 23 11.5 C 23 14.5, 20 16, 16 16 C 12 16, 9 17.5, 9 20.5 C 9 23.5, 12 23.5, 12 23.5",stroke:"currentColor",strokeWidth:"3.5",strokeLinecap:"round"}),w.jsx("path",{d:"M 12.8 8.5 L 14.3 7 L 15.8 8.5 L 14.3 10 Z",fill:"currentColor",opacity:"0.9"}),w.jsx("path",{d:"M 16.2 23.5 L 17.7 22 L 19.2 23.5 L 17.7 25 Z",fill:"currentColor",opacity:"0.7"})]}),"spek"]}),w.jsx("div",{className:"flex-1 flex justify-center",children:w.jsxs("button",{onClick:()=>s(!0),className:"px-4 py-1.5 rounded bg-bg-tertiary text-text-muted text-sm hover:text-text-secondary hover:bg-bg-tertiary/80 transition-colors flex items-center gap-2 cursor-pointer",children:[w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search...",w.jsx("kbd",{className:"text-xs bg-bg-primary/50 px-1.5 py-0.5 rounded border border-border ml-2",children:"⌘K"})]})}),w.jsx("button",{onClick:a,className:"p-2 rounded text-text-secondary hover:text-text-primary hover:bg-bg-tertiary transition-colors cursor-pointer",title:r==="dark"?"Switch to light theme":"Switch to dark theme",children:r==="dark"?w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),!p&&w.jsx("span",{className:"text-text-muted text-sm font-mono truncate max-w-80",title:t,children:t})]}),w.jsx(S1,{open:c,isMobile:p,collapsed:y,onClose:()=>h(!1),onToggle:x}),w.jsx("main",{className:`pt-18 p-6 transition-all duration-200 ${p?"":y?"ml-14":"ml-60"}`,children:w.jsx(Ex,{})}),w.jsx(k1,{open:o,onClose:b})]}):null}function ms({completed:t,total:r}){if(r===0)return w.jsx("span",{className:"text-text-muted text-sm",children:"No tasks"});const a=Math.round(t/r*100);return w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"flex-1 h-2 bg-bg-tertiary rounded-full overflow-hidden",children:w.jsx("div",{className:`h-full rounded-full transition-all ${t===r?"bg-green-500":"bg-accent"}`,style:{width:`${a}%`}})}),w.jsxs("span",{className:"text-text-secondary text-sm whitespace-nowrap",children:[t," / ",r]})]})}function Gh(){var c,h;const t=p1(),r=Hh();if(t.loading)return w.jsx("p",{className:"text-text-muted",children:"Loading..."});if(t.error)return w.jsxs("p",{className:"text-red-400",children:["Error: ",t.error]});const a=t.data,i=a.taskStats.total>0?Math.round(a.taskStats.completed/a.taskStats.total*100):0,o=((c=r.data)==null?void 0:c.active)??[],s=(((h=r.data)==null?void 0:h.archived)??[]).slice(0,10);return w.jsxs("div",{className:"space-y-8",children:[w.jsx("h1",{className:"text-2xl font-bold",children:"Overview"}),w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[w.jsx(au,{label:"Specs",value:a.specsCount,delay:0}),w.jsx(au,{label:"Active Changes",value:a.changesCount.active,delay:80}),w.jsx(au,{label:"Archived Changes",value:a.changesCount.archived,delay:160}),w.jsx(au,{label:"Task Completion",value:`${i}%`,delay:240})]}),w.jsxs("section",{children:[w.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Active Changes"}),o.length===0?w.jsx("p",{className:"text-text-muted text-sm",children:"No active changes"}):w.jsx("div",{className:"space-y-2",children:o.map(p=>w.jsxs(un,{to:`/changes/${p.slug}`,className:"block bg-bg-secondary border border-border rounded p-4 hover:border-accent transition-colors",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-text-primary font-medium",children:p.description}),p.date&&w.jsx("span",{className:"text-text-muted text-xs",children:p.date})]}),p.taskStats&&w.jsx(ms,{completed:p.taskStats.completed,total:p.taskStats.total})]},p.slug))})]}),w.jsxs("section",{children:[w.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Recently Archived"}),s.length===0?w.jsx("p",{className:"text-text-muted text-sm",children:"No archived changes"}):w.jsx("div",{className:"space-y-1",children:s.map(p=>w.jsxs(un,{to:`/changes/${p.slug}`,className:"flex items-center justify-between px-3 py-2 rounded hover:bg-bg-secondary transition-colors",children:[w.jsx("span",{className:"text-text-primary text-sm",children:p.description}),p.date&&w.jsx("span",{className:"text-text-muted text-xs",children:p.date})]},p.slug))})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.jsxs(un,{to:"/specs",className:"bg-bg-secondary border border-border rounded p-6 hover:border-accent transition-colors",children:[w.jsx("h3",{className:"font-semibold mb-1",children:"Specs"}),w.jsx("p",{className:"text-text-secondary text-sm",children:"Browse all spec topics"})]}),w.jsxs(un,{to:"/changes",className:"bg-bg-secondary border border-border rounded p-6 hover:border-accent transition-colors",children:[w.jsx("h3",{className:"font-semibold mb-1",children:"Changes"}),w.jsx("p",{className:"text-text-secondary text-sm",children:"View change timeline"})]})]})]})}function au({label:t,value:r,delay:a=0}){return w.jsxs("div",{className:"bg-bg-secondary border border-border rounded p-4 animate-fade-in-up",style:{animationDelay:`${a}ms`},children:[w.jsx("div",{className:"text-4xl font-bold text-accent",children:r}),w.jsx("div",{className:"text-text-secondary text-sm",children:t})]})}function T1(){const{data:t,loading:r,error:a}=Bh(),[i,o]=j.useState("");if(r)return w.jsx("p",{className:"text-text-muted",children:"Loading..."});if(a)return w.jsxs("p",{className:"text-red-400",children:["Error: ",a]});const s=t??[],c=i?s.filter(h=>h.topic.toLowerCase().includes(i.toLowerCase())):s;return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h1",{className:"text-2xl font-bold",children:"Specs"}),w.jsxs("span",{className:"text-text-muted text-sm",children:[s.length," topics"]})]}),w.jsx("input",{type:"text",value:i,onChange:h=>o(h.target.value),placeholder:"Filter specs...",className:"w-full bg-bg-tertiary border border-border rounded px-3 py-2 text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent"}),w.jsx("div",{className:"space-y-1",children:c.length===0?w.jsx("p",{className:"text-text-muted text-sm",children:"No specs found"}):c.map(h=>w.jsx(un,{to:`/specs/${h.topic}`,className:"block px-4 py-3 bg-bg-secondary border border-border rounded hover:border-accent transition-colors",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-text-primary font-medium",children:h.topic}),h.historyCount>0&&w.jsxs("span",{className:"text-text-muted text-xs",children:[h.historyCount," ",h.historyCount===1?"change":"changes"]})]})},h.topic))})]})}function dz(){}function hz(){}function z1(t,r){const a={};return(t[t.length-1]===""?[...t,""]:t).join((a.padRight?" ":"")+","+(a.padLeft===!1?"":" ")).trim()}const A1=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,R1=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,D1={};function Xh(t,r){return(D1.jsx?R1:A1).test(t)}const M1=/[ \t\n\f\r]/g;function O1(t){return typeof t=="object"?t.type==="text"?Qh(t.value):!1:Qh(t)}function Qh(t){return t.replace(M1,"")===""}class Za{constructor(r,a,i){this.normal=a,this.property=r,i&&(this.space=i)}}Za.prototype.normal={},Za.prototype.property={},Za.prototype.space=void 0;function Zh(t,r){const a={},i={};for(const o of t)Object.assign(a,o.property),Object.assign(i,o.normal);return new Za(a,i,r)}function ps(t){return t.toLowerCase()}class Kt{constructor(r,a){this.attribute=a,this.property=r}}Kt.prototype.attribute="",Kt.prototype.booleanish=!1,Kt.prototype.boolean=!1,Kt.prototype.commaOrSpaceSeparated=!1,Kt.prototype.commaSeparated=!1,Kt.prototype.defined=!1,Kt.prototype.mustUseProperty=!1,Kt.prototype.number=!1,Kt.prototype.overloadedBoolean=!1,Kt.prototype.property="",Kt.prototype.spaceSeparated=!1,Kt.prototype.space=void 0;let N1=0;const _e=dr(),Tt=dr(),gs=dr(),re=dr(),ct=dr(),Fr=dr(),on=dr();function dr(){return 2**++N1}const ys=Object.freeze(Object.defineProperty({__proto__:null,boolean:_e,booleanish:Tt,commaOrSpaceSeparated:on,commaSeparated:Fr,number:re,overloadedBoolean:gs,spaceSeparated:ct},Symbol.toStringTag,{value:"Module"})),vs=Object.keys(ys);class bs extends Kt{constructor(r,a,i,o){let s=-1;if(super(r,a),Kh(this,"space",o),typeof i=="number")for(;++s<vs.length;){const c=vs[s];Kh(this,vs[s],(i&ys[c])===ys[c])}}}bs.prototype.defined=!0;function Kh(t,r,a){a&&(t[r]=a)}function Gr(t){const r={},a={};for(const[i,o]of Object.entries(t.properties)){const s=new bs(i,t.transform(t.attributes||{},i),o,t.space);t.mustUseProperty&&t.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),r[i]=s,a[ps(i)]=i,a[ps(s.attribute)]=i}return new Za(r,a,t.space)}const Ih=Gr({properties:{ariaActiveDescendant:null,ariaAtomic:Tt,ariaAutoComplete:null,ariaBusy:Tt,ariaChecked:Tt,ariaColCount:re,ariaColIndex:re,ariaColSpan:re,ariaControls:ct,ariaCurrent:null,ariaDescribedBy:ct,ariaDetails:null,ariaDisabled:Tt,ariaDropEffect:ct,ariaErrorMessage:null,ariaExpanded:Tt,ariaFlowTo:ct,ariaGrabbed:Tt,ariaHasPopup:null,ariaHidden:Tt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ct,ariaLevel:re,ariaLive:null,ariaModal:Tt,ariaMultiLine:Tt,ariaMultiSelectable:Tt,ariaOrientation:null,ariaOwns:ct,ariaPlaceholder:null,ariaPosInSet:re,ariaPressed:Tt,ariaReadOnly:Tt,ariaRelevant:null,ariaRequired:Tt,ariaRoleDescription:ct,ariaRowCount:re,ariaRowIndex:re,ariaRowSpan:re,ariaSelected:Tt,ariaSetSize:re,ariaSort:null,ariaValueMax:re,ariaValueMin:re,ariaValueNow:re,ariaValueText:null,role:null},transform(t,r){return r==="role"?r:"aria-"+r.slice(4).toLowerCase()}});function Jh(t,r){return r in t?t[r]:r}function Ph(t,r){return Jh(t,r.toLowerCase())}const _1=Gr({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Fr,acceptCharset:ct,accessKey:ct,action:null,allow:null,allowFullScreen:_e,allowPaymentRequest:_e,allowUserMedia:_e,alt:null,as:null,async:_e,autoCapitalize:null,autoComplete:ct,autoFocus:_e,autoPlay:_e,blocking:ct,capture:null,charSet:null,checked:_e,cite:null,className:ct,cols:re,colSpan:null,content:null,contentEditable:Tt,controls:_e,controlsList:ct,coords:re|Fr,crossOrigin:null,data:null,dateTime:null,decoding:null,default:_e,defer:_e,dir:null,dirName:null,disabled:_e,download:gs,draggable:Tt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:_e,formTarget:null,headers:ct,height:re,hidden:gs,high:re,href:null,hrefLang:null,htmlFor:ct,httpEquiv:ct,id:null,imageSizes:null,imageSrcSet:null,inert:_e,inputMode:null,integrity:null,is:null,isMap:_e,itemId:null,itemProp:ct,itemRef:ct,itemScope:_e,itemType:ct,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:_e,low:re,manifest:null,max:null,maxLength:re,media:null,method:null,min:null,minLength:re,multiple:_e,muted:_e,name:null,nonce:null,noModule:_e,noValidate:_e,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:_e,optimum:re,pattern:null,ping:ct,placeholder:null,playsInline:_e,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:_e,referrerPolicy:null,rel:ct,required:_e,reversed:_e,rows:re,rowSpan:re,sandbox:ct,scope:null,scoped:_e,seamless:_e,selected:_e,shadowRootClonable:_e,shadowRootDelegatesFocus:_e,shadowRootMode:null,shape:null,size:re,sizes:null,slot:null,span:re,spellCheck:Tt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:re,step:null,style:null,tabIndex:re,target:null,title:null,translate:null,type:null,typeMustMatch:_e,useMap:null,value:Tt,width:re,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ct,axis:null,background:null,bgColor:null,border:re,borderColor:null,bottomMargin:re,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:_e,declare:_e,event:null,face:null,frame:null,frameBorder:null,hSpace:re,leftMargin:re,link:null,longDesc:null,lowSrc:null,marginHeight:re,marginWidth:re,noResize:_e,noHref:_e,noShade:_e,noWrap:_e,object:null,profile:null,prompt:null,rev:null,rightMargin:re,rules:null,scheme:null,scrolling:Tt,standby:null,summary:null,text:null,topMargin:re,valueType:null,version:null,vAlign:null,vLink:null,vSpace:re,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:_e,disableRemotePlayback:_e,prefix:null,property:null,results:re,security:null,unselectable:null},space:"html",transform:Ph}),j1=Gr({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:on,accentHeight:re,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:re,amplitude:re,arabicForm:null,ascent:re,attributeName:null,attributeType:null,azimuth:re,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:re,by:null,calcMode:null,capHeight:re,className:ct,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:re,diffuseConstant:re,direction:null,display:null,dur:null,divisor:re,dominantBaseline:null,download:_e,dx:null,dy:null,edgeMode:null,editable:null,elevation:re,enableBackground:null,end:null,event:null,exponent:re,externalResourcesRequired:null,fill:null,fillOpacity:re,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Fr,g2:Fr,glyphName:Fr,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:re,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:re,horizOriginX:re,horizOriginY:re,id:null,ideographic:re,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:re,k:re,k1:re,k2:re,k3:re,k4:re,kernelMatrix:on,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:re,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:re,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:re,overlineThickness:re,paintOrder:null,panose1:null,path:null,pathLength:re,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ct,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:re,pointsAtY:re,pointsAtZ:re,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:on,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:on,rev:on,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:on,requiredFeatures:on,requiredFonts:on,requiredFormats:on,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:re,specularExponent:re,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:re,strikethroughThickness:re,string:null,stroke:null,strokeDashArray:on,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:re,strokeOpacity:re,strokeWidth:null,style:null,surfaceScale:re,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:on,tabIndex:re,tableValues:null,target:null,targetX:re,targetY:re,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:on,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:re,underlineThickness:re,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:re,values:null,vAlphabetic:re,vMathematical:re,vectorEffect:null,vHanging:re,vIdeographic:re,version:null,vertAdvY:re,vertOriginX:re,vertOriginY:re,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:re,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Jh}),$h=Gr({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,r){return"xlink:"+r.slice(5).toLowerCase()}}),Wh=Gr({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Ph}),em=Gr({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,r){return"xml:"+r.slice(3).toLowerCase()}}),L1={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},U1=/[A-Z]/g,tm=/-[a-z]/g,B1=/^data[-\w.:]+$/i;function H1(t,r){const a=ps(r);let i=r,o=Kt;if(a in t.normal)return t.property[t.normal[a]];if(a.length>4&&a.slice(0,4)==="data"&&B1.test(r)){if(r.charAt(4)==="-"){const s=r.slice(5).replace(tm,Y1);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=r.slice(4);if(!tm.test(s)){let c=s.replace(U1,q1);c.charAt(0)!=="-"&&(c="-"+c),r="data"+c}}o=bs}return new o(i,r)}function q1(t){return"-"+t.toLowerCase()}function Y1(t){return t.charAt(1).toUpperCase()}const V1=Zh([Ih,_1,$h,Wh,em],"html"),xs=Zh([Ih,j1,$h,Wh,em],"svg");function F1(t){return t.join(" ").trim()}var Xr={},Ss,nm;function G1(){if(nm)return Ss;nm=1;var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,r=/\n/g,a=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,o=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,c=/^[;\s]*/,h=/^\s+|\s+$/g,p=`
`,m="/",y="*",g="",x="comment",b="declaration";function k(N,R){if(typeof N!="string")throw new TypeError("First argument must be a string");if(!N)return[];R=R||{};var _=1,H=1;function ie(he){var te=he.match(r);te&&(_+=te.length);var U=he.lastIndexOf(p);H=~U?he.length-U:H+he.length}function K(){var he={line:_,column:H};return function(te){return te.position=new q(he),de(),te}}function q(he){this.start=he,this.end={line:_,column:H},this.source=R.source}q.prototype.content=N;function M(he){var te=new Error(R.source+":"+_+":"+H+": "+he);if(te.reason=he,te.filename=R.source,te.line=_,te.column=H,te.source=N,!R.silent)throw te}function le(he){var te=he.exec(N);if(te){var U=te[0];return ie(U),N=N.slice(U.length),te}}function de(){le(a)}function Y(he){var te;for(he=he||[];te=ne();)te!==!1&&he.push(te);return he}function ne(){var he=K();if(!(m!=N.charAt(0)||y!=N.charAt(1))){for(var te=2;g!=N.charAt(te)&&(y!=N.charAt(te)||m!=N.charAt(te+1));)++te;if(te+=2,g===N.charAt(te-1))return M("End of comment missing");var U=N.slice(2,te-2);return H+=2,ie(U),N=N.slice(te),H+=2,he({type:x,comment:U})}}function ae(){var he=K(),te=le(i);if(te){if(ne(),!le(o))return M("property missing ':'");var U=le(s),$=he({type:b,property:D(te[0].replace(t,g)),value:U?D(U[0].replace(t,g)):g});return le(c),$}}function Ae(){var he=[];Y(he);for(var te;te=ae();)te!==!1&&(he.push(te),Y(he));return he}return de(),Ae()}function D(N){return N?N.replace(h,g):g}return Ss=k,Ss}var lm;function X1(){if(lm)return Xr;lm=1;var t=Xr&&Xr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.default=a;const r=t(G1());function a(i,o){let s=null;if(!i||typeof i!="string")return s;const c=(0,r.default)(i),h=typeof o=="function";return c.forEach(p=>{if(p.type!=="declaration")return;const{property:m,value:y}=p;h?o(m,y,p):y&&(s=s||{},s[m]=y)}),s}return Xr}var Ka={},rm;function Q1(){if(rm)return Ka;rm=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.camelCase=void 0;var t=/^--[a-zA-Z0-9_-]+$/,r=/-([a-z])/g,a=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,o=/^-(ms)-/,s=function(m){return!m||a.test(m)||t.test(m)},c=function(m,y){return y.toUpperCase()},h=function(m,y){return"".concat(y,"-")},p=function(m,y){return y===void 0&&(y={}),s(m)?m:(m=m.toLowerCase(),y.reactCompat?m=m.replace(o,h):m=m.replace(i,h),m.replace(r,c))};return Ka.camelCase=p,Ka}var Ia,am;function Z1(){if(am)return Ia;am=1;var t=Ia&&Ia.__importDefault||function(o){return o&&o.__esModule?o:{default:o}},r=t(X1()),a=Q1();function i(o,s){var c={};return!o||typeof o!="string"||(0,r.default)(o,function(h,p){h&&p&&(c[(0,a.camelCase)(h,s)]=p)}),c}return i.default=i,Ia=i,Ia}var K1=Z1();const I1=Al(K1),im=um("end"),ws=um("start");function um(t){return r;function r(a){const i=a&&a.position&&a.position[t]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function J1(t){const r=ws(t),a=im(t);if(r&&a)return{start:r,end:a}}function Ja(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?om(t.position):"start"in t||"end"in t?om(t):"line"in t||"column"in t?Es(t):""}function Es(t){return sm(t&&t.line)+":"+sm(t&&t.column)}function om(t){return Es(t&&t.start)+"-"+Es(t&&t.end)}function sm(t){return t&&typeof t=="number"?t:1}class Ft extends Error{constructor(r,a,i){super(),typeof a=="string"&&(i=a,a=void 0);let o="",s={},c=!1;if(a&&("line"in a&&"column"in a?s={place:a}:"start"in a&&"end"in a?s={place:a}:"type"in a?s={ancestors:[a],place:a.position}:s={...a}),typeof r=="string"?o=r:!s.cause&&r&&(c=!0,o=r.message,s.cause=r),!s.ruleId&&!s.source&&typeof i=="string"){const p=i.indexOf(":");p===-1?s.ruleId=i:(s.source=i.slice(0,p),s.ruleId=i.slice(p+1))}if(!s.place&&s.ancestors&&s.ancestors){const p=s.ancestors[s.ancestors.length-1];p&&(s.place=p.position)}const h=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=h?h.column:void 0,this.fatal=void 0,this.file="",this.message=o,this.line=h?h.line:void 0,this.name=Ja(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=c&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ft.prototype.file="",Ft.prototype.name="",Ft.prototype.reason="",Ft.prototype.message="",Ft.prototype.stack="",Ft.prototype.column=void 0,Ft.prototype.line=void 0,Ft.prototype.ancestors=void 0,Ft.prototype.cause=void 0,Ft.prototype.fatal=void 0,Ft.prototype.place=void 0,Ft.prototype.ruleId=void 0,Ft.prototype.source=void 0;const ks={}.hasOwnProperty,P1=new Map,$1=/[A-Z]/g,W1=new Set(["table","tbody","thead","tfoot","tr"]),eS=new Set(["td","th"]),cm="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function tS(t,r){if(!r||r.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const a=r.filePath||void 0;let i;if(r.development){if(typeof r.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=sS(a,r.jsxDEV)}else{if(typeof r.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof r.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=oS(a,r.jsx,r.jsxs)}const o={Fragment:r.Fragment,ancestors:[],components:r.components||{},create:i,elementAttributeNameCase:r.elementAttributeNameCase||"react",evaluater:r.createEvaluater?r.createEvaluater():void 0,filePath:a,ignoreInvalidStyle:r.ignoreInvalidStyle||!1,passKeys:r.passKeys!==!1,passNode:r.passNode||!1,schema:r.space==="svg"?xs:V1,stylePropertyNameCase:r.stylePropertyNameCase||"dom",tableCellAlignToStyle:r.tableCellAlignToStyle!==!1},s=fm(o,t,void 0);return s&&typeof s!="string"?s:o.create(t,o.Fragment,{children:s||void 0},void 0)}function fm(t,r,a){if(r.type==="element")return nS(t,r,a);if(r.type==="mdxFlowExpression"||r.type==="mdxTextExpression")return lS(t,r);if(r.type==="mdxJsxFlowElement"||r.type==="mdxJsxTextElement")return aS(t,r,a);if(r.type==="mdxjsEsm")return rS(t,r);if(r.type==="root")return iS(t,r,a);if(r.type==="text")return uS(t,r)}function nS(t,r,a){const i=t.schema;let o=i;r.tagName.toLowerCase()==="svg"&&i.space==="html"&&(o=xs,t.schema=o),t.ancestors.push(r);const s=hm(t,r.tagName,!1),c=cS(t,r);let h=Ts(t,r);return W1.has(r.tagName)&&(h=h.filter(function(p){return typeof p=="string"?!O1(p):!0})),dm(t,c,s,r),Cs(c,h),t.ancestors.pop(),t.schema=i,t.create(r,s,c,a)}function lS(t,r){if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];return i.type,t.evaluater.evaluateExpression(i.expression)}Pa(t,r.position)}function rS(t,r){if(r.data&&r.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(r.data.estree);Pa(t,r.position)}function aS(t,r,a){const i=t.schema;let o=i;r.name==="svg"&&i.space==="html"&&(o=xs,t.schema=o),t.ancestors.push(r);const s=r.name===null?t.Fragment:hm(t,r.name,!0),c=fS(t,r),h=Ts(t,r);return dm(t,c,s,r),Cs(c,h),t.ancestors.pop(),t.schema=i,t.create(r,s,c,a)}function iS(t,r,a){const i={};return Cs(i,Ts(t,r)),t.create(r,t.Fragment,i,a)}function uS(t,r){return r.value}function dm(t,r,a,i){typeof a!="string"&&a!==t.Fragment&&t.passNode&&(r.node=i)}function Cs(t,r){if(r.length>0){const a=r.length>1?r:r[0];a&&(t.children=a)}}function oS(t,r,a){return i;function i(o,s,c,h){const m=Array.isArray(c.children)?a:r;return h?m(s,c,h):m(s,c)}}function sS(t,r){return a;function a(i,o,s,c){const h=Array.isArray(s.children),p=ws(i);return r(o,s,c,h,{columnNumber:p?p.column-1:void 0,fileName:t,lineNumber:p?p.line:void 0},void 0)}}function cS(t,r){const a={};let i,o;for(o in r.properties)if(o!=="children"&&ks.call(r.properties,o)){const s=dS(t,o,r.properties[o]);if(s){const[c,h]=s;t.tableCellAlignToStyle&&c==="align"&&typeof h=="string"&&eS.has(r.tagName)?i=h:a[c]=h}}if(i){const s=a.style||(a.style={});s[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return a}function fS(t,r){const a={};for(const i of r.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&t.evaluater){const s=i.data.estree.body[0];s.type;const c=s.expression;c.type;const h=c.properties[0];h.type,Object.assign(a,t.evaluater.evaluateExpression(h.argument))}else Pa(t,r.position);else{const o=i.name;let s;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&t.evaluater){const h=i.value.data.estree.body[0];h.type,s=t.evaluater.evaluateExpression(h.expression)}else Pa(t,r.position);else s=i.value===null?!0:i.value;a[o]=s}return a}function Ts(t,r){const a=[];let i=-1;const o=t.passKeys?new Map:P1;for(;++i<r.children.length;){const s=r.children[i];let c;if(t.passKeys){const p=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(p){const m=o.get(p)||0;c=p+"-"+m,o.set(p,m+1)}}const h=fm(t,s,c);h!==void 0&&a.push(h)}return a}function dS(t,r,a){const i=H1(t.schema,r);if(!(a==null||typeof a=="number"&&Number.isNaN(a))){if(Array.isArray(a)&&(a=i.commaSeparated?z1(a):F1(a)),i.property==="style"){let o=typeof a=="object"?a:hS(t,String(a));return t.stylePropertyNameCase==="css"&&(o=mS(o)),["style",o]}return[t.elementAttributeNameCase==="react"&&i.space?L1[i.property]||i.property:i.attribute,a]}}function hS(t,r){try{return I1(r,{reactCompat:!0})}catch(a){if(t.ignoreInvalidStyle)return{};const i=a,o=new Ft("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw o.file=t.filePath||void 0,o.url=cm+"#cannot-parse-style-attribute",o}}function hm(t,r,a){let i;if(!a)i={type:"Literal",value:r};else if(r.includes(".")){const o=r.split(".");let s=-1,c;for(;++s<o.length;){const h=Xh(o[s])?{type:"Identifier",name:o[s]}:{type:"Literal",value:o[s]};c=c?{type:"MemberExpression",object:c,property:h,computed:!!(s&&h.type==="Literal"),optional:!1}:h}i=c}else i=Xh(r)&&!/^[a-z]/.test(r)?{type:"Identifier",name:r}:{type:"Literal",value:r};if(i.type==="Literal"){const o=i.value;return ks.call(t.components,o)?t.components[o]:o}if(t.evaluater)return t.evaluater.evaluateExpression(i);Pa(t)}function Pa(t,r){const a=new Ft("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:r,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw a.file=t.filePath||void 0,a.url=cm+"#cannot-handle-mdx-estrees-without-createevaluater",a}function mS(t){const r={};let a;for(a in t)ks.call(t,a)&&(r[pS(a)]=t[a]);return r}function pS(t){let r=t.replace($1,gS);return r.slice(0,3)==="ms-"&&(r="-"+r),r}function gS(t){return"-"+t.toLowerCase()}const zs={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},yS={};function As(t,r){const a=yS,i=typeof a.includeImageAlt=="boolean"?a.includeImageAlt:!0,o=typeof a.includeHtml=="boolean"?a.includeHtml:!0;return mm(t,i,o)}function mm(t,r,a){if(vS(t)){if("value"in t)return t.type==="html"&&!a?"":t.value;if(r&&"alt"in t&&t.alt)return t.alt;if("children"in t)return pm(t.children,r,a)}return Array.isArray(t)?pm(t,r,a):""}function pm(t,r,a){const i=[];let o=-1;for(;++o<t.length;)i[o]=mm(t[o],r,a);return i.join("")}function vS(t){return!!(t&&typeof t=="object")}const gm=document.createElement("i");function Rs(t){const r="&"+t+";";gm.innerHTML=r;const a=gm.textContent;return a.charCodeAt(a.length-1)===59&&t!=="semi"||a===r?!1:a}function sn(t,r,a,i){const o=t.length;let s=0,c;if(r<0?r=-r>o?0:o+r:r=r>o?o:r,a=a>0?a:0,i.length<1e4)c=Array.from(i),c.unshift(r,a),t.splice(...c);else for(a&&t.splice(r,a);s<i.length;)c=i.slice(s,s+1e4),c.unshift(r,0),t.splice(...c),s+=1e4,r+=1e4}function En(t,r){return t.length>0?(sn(t,t.length,0,r),t):r}const ym={}.hasOwnProperty;function vm(t){const r={};let a=-1;for(;++a<t.length;)bS(r,t[a]);return r}function bS(t,r){let a;for(a in r){const o=(ym.call(t,a)?t[a]:void 0)||(t[a]={}),s=r[a];let c;if(s)for(c in s){ym.call(o,c)||(o[c]=[]);const h=s[c];xS(o[c],Array.isArray(h)?h:h?[h]:[])}}}function xS(t,r){let a=-1;const i=[];for(;++a<r.length;)(r[a].add==="after"?t:i).push(r[a]);sn(t,0,0,i)}function bm(t,r){const a=Number.parseInt(t,r);return a<9||a===11||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||(a&65535)===65535||(a&65535)===65534||a>1114111?"�":String.fromCodePoint(a)}function Ln(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Xt=_l(/[A-Za-z]/),Gt=_l(/[\dA-Za-z]/),SS=_l(/[#-'*+\--9=?A-Z^-~]/);function iu(t){return t!==null&&(t<32||t===127)}const Ds=_l(/\d/),wS=_l(/[\dA-Fa-f]/),ES=_l(/[!-/:-@[-`{-~]/);function Te(t){return t!==null&&t<-2}function ot(t){return t!==null&&(t<0||t===32)}function Be(t){return t===-2||t===-1||t===32}const uu=_l(new RegExp("\\p{P}|\\p{S}","u")),hr=_l(/\s/);function _l(t){return r;function r(a){return a!==null&&a>-1&&t.test(String.fromCharCode(a))}}function Qr(t){const r=[];let a=-1,i=0,o=0;for(;++a<t.length;){const s=t.charCodeAt(a);let c="";if(s===37&&Gt(t.charCodeAt(a+1))&&Gt(t.charCodeAt(a+2)))o=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(c=String.fromCharCode(s));else if(s>55295&&s<57344){const h=t.charCodeAt(a+1);s<56320&&h>56319&&h<57344?(c=String.fromCharCode(s,h),o=1):c="�"}else c=String.fromCharCode(s);c&&(r.push(t.slice(i,a),encodeURIComponent(c)),i=a+o+1,c=""),o&&(a+=o,o=0)}return r.join("")+t.slice(i)}function Ke(t,r,a,i){const o=i?i-1:Number.POSITIVE_INFINITY;let s=0;return c;function c(p){return Be(p)?(t.enter(a),h(p)):r(p)}function h(p){return Be(p)&&s++<o?(t.consume(p),h):(t.exit(a),r(p))}}const kS={tokenize:CS};function CS(t){const r=t.attempt(this.parser.constructs.contentInitial,i,o);let a;return r;function i(h){if(h===null){t.consume(h);return}return t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),Ke(t,r,"linePrefix")}function o(h){return t.enter("paragraph"),s(h)}function s(h){const p=t.enter("chunkText",{contentType:"text",previous:a});return a&&(a.next=p),a=p,c(h)}function c(h){if(h===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(h);return}return Te(h)?(t.consume(h),t.exit("chunkText"),s):(t.consume(h),c)}}const TS={tokenize:zS},xm={tokenize:AS};function zS(t){const r=this,a=[];let i=0,o,s,c;return h;function h(H){if(i<a.length){const ie=a[i];return r.containerState=ie[1],t.attempt(ie[0].continuation,p,m)(H)}return m(H)}function p(H){if(i++,r.containerState._closeFlow){r.containerState._closeFlow=void 0,o&&_();const ie=r.events.length;let K=ie,q;for(;K--;)if(r.events[K][0]==="exit"&&r.events[K][1].type==="chunkFlow"){q=r.events[K][1].end;break}R(i);let M=ie;for(;M<r.events.length;)r.events[M][1].end={...q},M++;return sn(r.events,K+1,0,r.events.slice(ie)),r.events.length=M,m(H)}return h(H)}function m(H){if(i===a.length){if(!o)return x(H);if(o.currentConstruct&&o.currentConstruct.concrete)return k(H);r.interrupt=!!(o.currentConstruct&&!o._gfmTableDynamicInterruptHack)}return r.containerState={},t.check(xm,y,g)(H)}function y(H){return o&&_(),R(i),x(H)}function g(H){return r.parser.lazy[r.now().line]=i!==a.length,c=r.now().offset,k(H)}function x(H){return r.containerState={},t.attempt(xm,b,k)(H)}function b(H){return i++,a.push([r.currentConstruct,r.containerState]),x(H)}function k(H){if(H===null){o&&_(),R(0),t.consume(H);return}return o=o||r.parser.flow(r.now()),t.enter("chunkFlow",{_tokenizer:o,contentType:"flow",previous:s}),D(H)}function D(H){if(H===null){N(t.exit("chunkFlow"),!0),R(0),t.consume(H);return}return Te(H)?(t.consume(H),N(t.exit("chunkFlow")),i=0,r.interrupt=void 0,h):(t.consume(H),D)}function N(H,ie){const K=r.sliceStream(H);if(ie&&K.push(null),H.previous=s,s&&(s.next=H),s=H,o.defineSkip(H.start),o.write(K),r.parser.lazy[H.start.line]){let q=o.events.length;for(;q--;)if(o.events[q][1].start.offset<c&&(!o.events[q][1].end||o.events[q][1].end.offset>c))return;const M=r.events.length;let le=M,de,Y;for(;le--;)if(r.events[le][0]==="exit"&&r.events[le][1].type==="chunkFlow"){if(de){Y=r.events[le][1].end;break}de=!0}for(R(i),q=M;q<r.events.length;)r.events[q][1].end={...Y},q++;sn(r.events,le+1,0,r.events.slice(M)),r.events.length=q}}function R(H){let ie=a.length;for(;ie-- >H;){const K=a[ie];r.containerState=K[1],K[0].exit.call(r,t)}a.length=H}function _(){o.write([null]),s=void 0,o=void 0,r.containerState._closeFlow=void 0}}function AS(t,r,a){return Ke(t,t.attempt(this.parser.constructs.document,r,a),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Zr(t){if(t===null||ot(t)||hr(t))return 1;if(uu(t))return 2}function ou(t,r,a){const i=[];let o=-1;for(;++o<t.length;){const s=t[o].resolveAll;s&&!i.includes(s)&&(r=s(r,a),i.push(s))}return r}const Ms={name:"attention",resolveAll:RS,tokenize:DS};function RS(t,r){let a=-1,i,o,s,c,h,p,m,y;for(;++a<t.length;)if(t[a][0]==="enter"&&t[a][1].type==="attentionSequence"&&t[a][1]._close){for(i=a;i--;)if(t[i][0]==="exit"&&t[i][1].type==="attentionSequence"&&t[i][1]._open&&r.sliceSerialize(t[i][1]).charCodeAt(0)===r.sliceSerialize(t[a][1]).charCodeAt(0)){if((t[i][1]._close||t[a][1]._open)&&(t[a][1].end.offset-t[a][1].start.offset)%3&&!((t[i][1].end.offset-t[i][1].start.offset+t[a][1].end.offset-t[a][1].start.offset)%3))continue;p=t[i][1].end.offset-t[i][1].start.offset>1&&t[a][1].end.offset-t[a][1].start.offset>1?2:1;const g={...t[i][1].end},x={...t[a][1].start};Sm(g,-p),Sm(x,p),c={type:p>1?"strongSequence":"emphasisSequence",start:g,end:{...t[i][1].end}},h={type:p>1?"strongSequence":"emphasisSequence",start:{...t[a][1].start},end:x},s={type:p>1?"strongText":"emphasisText",start:{...t[i][1].end},end:{...t[a][1].start}},o={type:p>1?"strong":"emphasis",start:{...c.start},end:{...h.end}},t[i][1].end={...c.start},t[a][1].start={...h.end},m=[],t[i][1].end.offset-t[i][1].start.offset&&(m=En(m,[["enter",t[i][1],r],["exit",t[i][1],r]])),m=En(m,[["enter",o,r],["enter",c,r],["exit",c,r],["enter",s,r]]),m=En(m,ou(r.parser.constructs.insideSpan.null,t.slice(i+1,a),r)),m=En(m,[["exit",s,r],["enter",h,r],["exit",h,r],["exit",o,r]]),t[a][1].end.offset-t[a][1].start.offset?(y=2,m=En(m,[["enter",t[a][1],r],["exit",t[a][1],r]])):y=0,sn(t,i-1,a-i+3,m),a=i+m.length-y-2;break}}for(a=-1;++a<t.length;)t[a][1].type==="attentionSequence"&&(t[a][1].type="data");return t}function DS(t,r){const a=this.parser.constructs.attentionMarkers.null,i=this.previous,o=Zr(i);let s;return c;function c(p){return s=p,t.enter("attentionSequence"),h(p)}function h(p){if(p===s)return t.consume(p),h;const m=t.exit("attentionSequence"),y=Zr(p),g=!y||y===2&&o||a.includes(p),x=!o||o===2&&y||a.includes(i);return m._open=!!(s===42?g:g&&(o||!x)),m._close=!!(s===42?x:x&&(y||!g)),r(p)}}function Sm(t,r){t.column+=r,t.offset+=r,t._bufferIndex+=r}const MS={name:"autolink",tokenize:OS};function OS(t,r,a){let i=0;return o;function o(b){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(b),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(b){return Xt(b)?(t.consume(b),c):b===64?a(b):m(b)}function c(b){return b===43||b===45||b===46||Gt(b)?(i=1,h(b)):m(b)}function h(b){return b===58?(t.consume(b),i=0,p):(b===43||b===45||b===46||Gt(b))&&i++<32?(t.consume(b),h):(i=0,m(b))}function p(b){return b===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(b),t.exit("autolinkMarker"),t.exit("autolink"),r):b===null||b===32||b===60||iu(b)?a(b):(t.consume(b),p)}function m(b){return b===64?(t.consume(b),y):SS(b)?(t.consume(b),m):a(b)}function y(b){return Gt(b)?g(b):a(b)}function g(b){return b===46?(t.consume(b),i=0,y):b===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(b),t.exit("autolinkMarker"),t.exit("autolink"),r):x(b)}function x(b){if((b===45||Gt(b))&&i++<63){const k=b===45?x:g;return t.consume(b),k}return a(b)}}const $a={partial:!0,tokenize:NS};function NS(t,r,a){return i;function i(s){return Be(s)?Ke(t,o,"linePrefix")(s):o(s)}function o(s){return s===null||Te(s)?r(s):a(s)}}const wm={continuation:{tokenize:jS},exit:LS,name:"blockQuote",tokenize:_S};function _S(t,r,a){const i=this;return o;function o(c){if(c===62){const h=i.containerState;return h.open||(t.enter("blockQuote",{_container:!0}),h.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(c),t.exit("blockQuoteMarker"),s}return a(c)}function s(c){return Be(c)?(t.enter("blockQuotePrefixWhitespace"),t.consume(c),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),r):(t.exit("blockQuotePrefix"),r(c))}}function jS(t,r,a){const i=this;return o;function o(c){return Be(c)?Ke(t,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c):s(c)}function s(c){return t.attempt(wm,r,a)(c)}}function LS(t){t.exit("blockQuote")}const Em={name:"characterEscape",tokenize:US};function US(t,r,a){return i;function i(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),o}function o(s){return ES(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),r):a(s)}}const km={name:"characterReference",tokenize:BS};function BS(t,r,a){const i=this;let o=0,s,c;return h;function h(g){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),p}function p(g){return g===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(g),t.exit("characterReferenceMarkerNumeric"),m):(t.enter("characterReferenceValue"),s=31,c=Gt,y(g))}function m(g){return g===88||g===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(g),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,c=wS,y):(t.enter("characterReferenceValue"),s=7,c=Ds,y(g))}function y(g){if(g===59&&o){const x=t.exit("characterReferenceValue");return c===Gt&&!Rs(i.sliceSerialize(x))?a(g):(t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),t.exit("characterReference"),r)}return c(g)&&o++<s?(t.consume(g),y):a(g)}}const Cm={partial:!0,tokenize:qS},Tm={concrete:!0,name:"codeFenced",tokenize:HS};function HS(t,r,a){const i=this,o={partial:!0,tokenize:K};let s=0,c=0,h;return p;function p(q){return m(q)}function m(q){const M=i.events[i.events.length-1];return s=M&&M[1].type==="linePrefix"?M[2].sliceSerialize(M[1],!0).length:0,h=q,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),y(q)}function y(q){return q===h?(c++,t.consume(q),y):c<3?a(q):(t.exit("codeFencedFenceSequence"),Be(q)?Ke(t,g,"whitespace")(q):g(q))}function g(q){return q===null||Te(q)?(t.exit("codeFencedFence"),i.interrupt?r(q):t.check(Cm,D,ie)(q)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),x(q))}function x(q){return q===null||Te(q)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),g(q)):Be(q)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Ke(t,b,"whitespace")(q)):q===96&&q===h?a(q):(t.consume(q),x)}function b(q){return q===null||Te(q)?g(q):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),k(q))}function k(q){return q===null||Te(q)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),g(q)):q===96&&q===h?a(q):(t.consume(q),k)}function D(q){return t.attempt(o,ie,N)(q)}function N(q){return t.enter("lineEnding"),t.consume(q),t.exit("lineEnding"),R}function R(q){return s>0&&Be(q)?Ke(t,_,"linePrefix",s+1)(q):_(q)}function _(q){return q===null||Te(q)?t.check(Cm,D,ie)(q):(t.enter("codeFlowValue"),H(q))}function H(q){return q===null||Te(q)?(t.exit("codeFlowValue"),_(q)):(t.consume(q),H)}function ie(q){return t.exit("codeFenced"),r(q)}function K(q,M,le){let de=0;return Y;function Y(te){return q.enter("lineEnding"),q.consume(te),q.exit("lineEnding"),ne}function ne(te){return q.enter("codeFencedFence"),Be(te)?Ke(q,ae,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(te):ae(te)}function ae(te){return te===h?(q.enter("codeFencedFenceSequence"),Ae(te)):le(te)}function Ae(te){return te===h?(de++,q.consume(te),Ae):de>=c?(q.exit("codeFencedFenceSequence"),Be(te)?Ke(q,he,"whitespace")(te):he(te)):le(te)}function he(te){return te===null||Te(te)?(q.exit("codeFencedFence"),M(te)):le(te)}}}function qS(t,r,a){const i=this;return o;function o(c){return c===null?a(c):(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),s)}function s(c){return i.parser.lazy[i.now().line]?a(c):r(c)}}const Os={name:"codeIndented",tokenize:VS},YS={partial:!0,tokenize:FS};function VS(t,r,a){const i=this;return o;function o(m){return t.enter("codeIndented"),Ke(t,s,"linePrefix",5)(m)}function s(m){const y=i.events[i.events.length-1];return y&&y[1].type==="linePrefix"&&y[2].sliceSerialize(y[1],!0).length>=4?c(m):a(m)}function c(m){return m===null?p(m):Te(m)?t.attempt(YS,c,p)(m):(t.enter("codeFlowValue"),h(m))}function h(m){return m===null||Te(m)?(t.exit("codeFlowValue"),c(m)):(t.consume(m),h)}function p(m){return t.exit("codeIndented"),r(m)}}function FS(t,r,a){const i=this;return o;function o(c){return i.parser.lazy[i.now().line]?a(c):Te(c)?(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),o):Ke(t,s,"linePrefix",5)(c)}function s(c){const h=i.events[i.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?r(c):Te(c)?o(c):a(c)}}const GS={name:"codeText",previous:QS,resolve:XS,tokenize:ZS};function XS(t){let r=t.length-4,a=3,i,o;if((t[a][1].type==="lineEnding"||t[a][1].type==="space")&&(t[r][1].type==="lineEnding"||t[r][1].type==="space")){for(i=a;++i<r;)if(t[i][1].type==="codeTextData"){t[a][1].type="codeTextPadding",t[r][1].type="codeTextPadding",a+=2,r-=2;break}}for(i=a-1,r++;++i<=r;)o===void 0?i!==r&&t[i][1].type!=="lineEnding"&&(o=i):(i===r||t[i][1].type==="lineEnding")&&(t[o][1].type="codeTextData",i!==o+2&&(t[o][1].end=t[i-1][1].end,t.splice(o+2,i-o-2),r-=i-o-2,i=o+2),o=void 0);return t}function QS(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function ZS(t,r,a){let i=0,o,s;return c;function c(g){return t.enter("codeText"),t.enter("codeTextSequence"),h(g)}function h(g){return g===96?(t.consume(g),i++,h):(t.exit("codeTextSequence"),p(g))}function p(g){return g===null?a(g):g===32?(t.enter("space"),t.consume(g),t.exit("space"),p):g===96?(s=t.enter("codeTextSequence"),o=0,y(g)):Te(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),p):(t.enter("codeTextData"),m(g))}function m(g){return g===null||g===32||g===96||Te(g)?(t.exit("codeTextData"),p(g)):(t.consume(g),m)}function y(g){return g===96?(t.consume(g),o++,y):o===i?(t.exit("codeTextSequence"),t.exit("codeText"),r(g)):(s.type="codeTextData",m(g))}}class KS{constructor(r){this.left=r?[...r]:[],this.right=[]}get(r){if(r<0||r>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+r+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return r<this.left.length?this.left[r]:this.right[this.right.length-r+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(r,a){const i=a??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(r,i):r>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-r+this.left.length).reverse():this.left.slice(r).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(r,a,i){const o=a||0;this.setCursor(Math.trunc(r));const s=this.right.splice(this.right.length-o,Number.POSITIVE_INFINITY);return i&&Wa(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(r){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(r)}pushMany(r){this.setCursor(Number.POSITIVE_INFINITY),Wa(this.left,r)}unshift(r){this.setCursor(0),this.right.push(r)}unshiftMany(r){this.setCursor(0),Wa(this.right,r.reverse())}setCursor(r){if(!(r===this.left.length||r>this.left.length&&this.right.length===0||r<0&&this.left.length===0))if(r<this.left.length){const a=this.left.splice(r,Number.POSITIVE_INFINITY);Wa(this.right,a.reverse())}else{const a=this.right.splice(this.left.length+this.right.length-r,Number.POSITIVE_INFINITY);Wa(this.left,a.reverse())}}}function Wa(t,r){let a=0;if(r.length<1e4)t.push(...r);else for(;a<r.length;)t.push(...r.slice(a,a+1e4)),a+=1e4}function zm(t){const r={};let a=-1,i,o,s,c,h,p,m;const y=new KS(t);for(;++a<y.length;){for(;a in r;)a=r[a];if(i=y.get(a),a&&i[1].type==="chunkFlow"&&y.get(a-1)[1].type==="listItemPrefix"&&(p=i[1]._tokenizer.events,s=0,s<p.length&&p[s][1].type==="lineEndingBlank"&&(s+=2),s<p.length&&p[s][1].type==="content"))for(;++s<p.length&&p[s][1].type!=="content";)p[s][1].type==="chunkText"&&(p[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(r,IS(y,a)),a=r[a],m=!0);else if(i[1]._container){for(s=a,o=void 0;s--;)if(c=y.get(s),c[1].type==="lineEnding"||c[1].type==="lineEndingBlank")c[0]==="enter"&&(o&&(y.get(o)[1].type="lineEndingBlank"),c[1].type="lineEnding",o=s);else if(!(c[1].type==="linePrefix"||c[1].type==="listItemIndent"))break;o&&(i[1].end={...y.get(o)[1].start},h=y.slice(o,a),h.unshift(i),y.splice(o,a-o+1,h))}}return sn(t,0,Number.POSITIVE_INFINITY,y.slice(0)),!m}function IS(t,r){const a=t.get(r)[1],i=t.get(r)[2];let o=r-1;const s=[];let c=a._tokenizer;c||(c=i.parser[a.contentType](a.start),a._contentTypeTextTrailing&&(c._contentTypeTextTrailing=!0));const h=c.events,p=[],m={};let y,g,x=-1,b=a,k=0,D=0;const N=[D];for(;b;){for(;t.get(++o)[1]!==b;);s.push(o),b._tokenizer||(y=i.sliceStream(b),b.next||y.push(null),g&&c.defineSkip(b.start),b._isInFirstContentOfListItem&&(c._gfmTasklistFirstContentOfListItem=!0),c.write(y),b._isInFirstContentOfListItem&&(c._gfmTasklistFirstContentOfListItem=void 0)),g=b,b=b.next}for(b=a;++x<h.length;)h[x][0]==="exit"&&h[x-1][0]==="enter"&&h[x][1].type===h[x-1][1].type&&h[x][1].start.line!==h[x][1].end.line&&(D=x+1,N.push(D),b._tokenizer=void 0,b.previous=void 0,b=b.next);for(c.events=[],b?(b._tokenizer=void 0,b.previous=void 0):N.pop(),x=N.length;x--;){const R=h.slice(N[x],N[x+1]),_=s.pop();p.push([_,_+R.length-1]),t.splice(_,2,R)}for(p.reverse(),x=-1;++x<p.length;)m[k+p[x][0]]=k+p[x][1],k+=p[x][1]-p[x][0]-1;return m}const JS={resolve:$S,tokenize:WS},PS={partial:!0,tokenize:ew};function $S(t){return zm(t),t}function WS(t,r){let a;return i;function i(h){return t.enter("content"),a=t.enter("chunkContent",{contentType:"content"}),o(h)}function o(h){return h===null?s(h):Te(h)?t.check(PS,c,s)(h):(t.consume(h),o)}function s(h){return t.exit("chunkContent"),t.exit("content"),r(h)}function c(h){return t.consume(h),t.exit("chunkContent"),a.next=t.enter("chunkContent",{contentType:"content",previous:a}),a=a.next,o}}function ew(t,r,a){const i=this;return o;function o(c){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),Ke(t,s,"linePrefix")}function s(c){if(c===null||Te(c))return a(c);const h=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?r(c):t.interrupt(i.parser.constructs.flow,a,r)(c)}}function Am(t,r,a,i,o,s,c,h,p){const m=p||Number.POSITIVE_INFINITY;let y=0;return g;function g(R){return R===60?(t.enter(i),t.enter(o),t.enter(s),t.consume(R),t.exit(s),x):R===null||R===32||R===41||iu(R)?a(R):(t.enter(i),t.enter(c),t.enter(h),t.enter("chunkString",{contentType:"string"}),D(R))}function x(R){return R===62?(t.enter(s),t.consume(R),t.exit(s),t.exit(o),t.exit(i),r):(t.enter(h),t.enter("chunkString",{contentType:"string"}),b(R))}function b(R){return R===62?(t.exit("chunkString"),t.exit(h),x(R)):R===null||R===60||Te(R)?a(R):(t.consume(R),R===92?k:b)}function k(R){return R===60||R===62||R===92?(t.consume(R),b):b(R)}function D(R){return!y&&(R===null||R===41||ot(R))?(t.exit("chunkString"),t.exit(h),t.exit(c),t.exit(i),r(R)):y<m&&R===40?(t.consume(R),y++,D):R===41?(t.consume(R),y--,D):R===null||R===32||R===40||iu(R)?a(R):(t.consume(R),R===92?N:D)}function N(R){return R===40||R===41||R===92?(t.consume(R),D):D(R)}}function Rm(t,r,a,i,o,s){const c=this;let h=0,p;return m;function m(b){return t.enter(i),t.enter(o),t.consume(b),t.exit(o),t.enter(s),y}function y(b){return h>999||b===null||b===91||b===93&&!p||b===94&&!h&&"_hiddenFootnoteSupport"in c.parser.constructs?a(b):b===93?(t.exit(s),t.enter(o),t.consume(b),t.exit(o),t.exit(i),r):Te(b)?(t.enter("lineEnding"),t.consume(b),t.exit("lineEnding"),y):(t.enter("chunkString",{contentType:"string"}),g(b))}function g(b){return b===null||b===91||b===93||Te(b)||h++>999?(t.exit("chunkString"),y(b)):(t.consume(b),p||(p=!Be(b)),b===92?x:g)}function x(b){return b===91||b===92||b===93?(t.consume(b),h++,g):g(b)}}function Dm(t,r,a,i,o,s){let c;return h;function h(x){return x===34||x===39||x===40?(t.enter(i),t.enter(o),t.consume(x),t.exit(o),c=x===40?41:x,p):a(x)}function p(x){return x===c?(t.enter(o),t.consume(x),t.exit(o),t.exit(i),r):(t.enter(s),m(x))}function m(x){return x===c?(t.exit(s),p(c)):x===null?a(x):Te(x)?(t.enter("lineEnding"),t.consume(x),t.exit("lineEnding"),Ke(t,m,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),y(x))}function y(x){return x===c||x===null||Te(x)?(t.exit("chunkString"),m(x)):(t.consume(x),x===92?g:y)}function g(x){return x===c||x===92?(t.consume(x),y):y(x)}}function ei(t,r){let a;return i;function i(o){return Te(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),a=!0,i):Be(o)?Ke(t,i,a?"linePrefix":"lineSuffix")(o):r(o)}}const tw={name:"definition",tokenize:lw},nw={partial:!0,tokenize:rw};function lw(t,r,a){const i=this;let o;return s;function s(b){return t.enter("definition"),c(b)}function c(b){return Rm.call(i,t,h,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(b)}function h(b){return o=Ln(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),b===58?(t.enter("definitionMarker"),t.consume(b),t.exit("definitionMarker"),p):a(b)}function p(b){return ot(b)?ei(t,m)(b):m(b)}function m(b){return Am(t,y,a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(b)}function y(b){return t.attempt(nw,g,g)(b)}function g(b){return Be(b)?Ke(t,x,"whitespace")(b):x(b)}function x(b){return b===null||Te(b)?(t.exit("definition"),i.parser.defined.push(o),r(b)):a(b)}}function rw(t,r,a){return i;function i(h){return ot(h)?ei(t,o)(h):a(h)}function o(h){return Dm(t,s,a,"definitionTitle","definitionTitleMarker","definitionTitleString")(h)}function s(h){return Be(h)?Ke(t,c,"whitespace")(h):c(h)}function c(h){return h===null||Te(h)?r(h):a(h)}}const aw={name:"hardBreakEscape",tokenize:iw};function iw(t,r,a){return i;function i(s){return t.enter("hardBreakEscape"),t.consume(s),o}function o(s){return Te(s)?(t.exit("hardBreakEscape"),r(s)):a(s)}}const uw={name:"headingAtx",resolve:ow,tokenize:sw};function ow(t,r){let a=t.length-2,i=3,o,s;return t[i][1].type==="whitespace"&&(i+=2),a-2>i&&t[a][1].type==="whitespace"&&(a-=2),t[a][1].type==="atxHeadingSequence"&&(i===a-1||a-4>i&&t[a-2][1].type==="whitespace")&&(a-=i+1===a?2:4),a>i&&(o={type:"atxHeadingText",start:t[i][1].start,end:t[a][1].end},s={type:"chunkText",start:t[i][1].start,end:t[a][1].end,contentType:"text"},sn(t,i,a-i+1,[["enter",o,r],["enter",s,r],["exit",s,r],["exit",o,r]])),t}function sw(t,r,a){let i=0;return o;function o(y){return t.enter("atxHeading"),s(y)}function s(y){return t.enter("atxHeadingSequence"),c(y)}function c(y){return y===35&&i++<6?(t.consume(y),c):y===null||ot(y)?(t.exit("atxHeadingSequence"),h(y)):a(y)}function h(y){return y===35?(t.enter("atxHeadingSequence"),p(y)):y===null||Te(y)?(t.exit("atxHeading"),r(y)):Be(y)?Ke(t,h,"whitespace")(y):(t.enter("atxHeadingText"),m(y))}function p(y){return y===35?(t.consume(y),p):(t.exit("atxHeadingSequence"),h(y))}function m(y){return y===null||y===35||ot(y)?(t.exit("atxHeadingText"),h(y)):(t.consume(y),m)}}const cw=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Mm=["pre","script","style","textarea"],fw={concrete:!0,name:"htmlFlow",resolveTo:mw,tokenize:pw},dw={partial:!0,tokenize:yw},hw={partial:!0,tokenize:gw};function mw(t){let r=t.length;for(;r--&&!(t[r][0]==="enter"&&t[r][1].type==="htmlFlow"););return r>1&&t[r-2][1].type==="linePrefix"&&(t[r][1].start=t[r-2][1].start,t[r+1][1].start=t[r-2][1].start,t.splice(r-2,2)),t}function pw(t,r,a){const i=this;let o,s,c,h,p;return m;function m(E){return y(E)}function y(E){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(E),g}function g(E){return E===33?(t.consume(E),x):E===47?(t.consume(E),s=!0,D):E===63?(t.consume(E),o=3,i.interrupt?r:C):Xt(E)?(t.consume(E),c=String.fromCharCode(E),N):a(E)}function x(E){return E===45?(t.consume(E),o=2,b):E===91?(t.consume(E),o=5,h=0,k):Xt(E)?(t.consume(E),o=4,i.interrupt?r:C):a(E)}function b(E){return E===45?(t.consume(E),i.interrupt?r:C):a(E)}function k(E){const oe="CDATA[";return E===oe.charCodeAt(h++)?(t.consume(E),h===oe.length?i.interrupt?r:ae:k):a(E)}function D(E){return Xt(E)?(t.consume(E),c=String.fromCharCode(E),N):a(E)}function N(E){if(E===null||E===47||E===62||ot(E)){const oe=E===47,pe=c.toLowerCase();return!oe&&!s&&Mm.includes(pe)?(o=1,i.interrupt?r(E):ae(E)):cw.includes(c.toLowerCase())?(o=6,oe?(t.consume(E),R):i.interrupt?r(E):ae(E)):(o=7,i.interrupt&&!i.parser.lazy[i.now().line]?a(E):s?_(E):H(E))}return E===45||Gt(E)?(t.consume(E),c+=String.fromCharCode(E),N):a(E)}function R(E){return E===62?(t.consume(E),i.interrupt?r:ae):a(E)}function _(E){return Be(E)?(t.consume(E),_):Y(E)}function H(E){return E===47?(t.consume(E),Y):E===58||E===95||Xt(E)?(t.consume(E),ie):Be(E)?(t.consume(E),H):Y(E)}function ie(E){return E===45||E===46||E===58||E===95||Gt(E)?(t.consume(E),ie):K(E)}function K(E){return E===61?(t.consume(E),q):Be(E)?(t.consume(E),K):H(E)}function q(E){return E===null||E===60||E===61||E===62||E===96?a(E):E===34||E===39?(t.consume(E),p=E,M):Be(E)?(t.consume(E),q):le(E)}function M(E){return E===p?(t.consume(E),p=null,de):E===null||Te(E)?a(E):(t.consume(E),M)}function le(E){return E===null||E===34||E===39||E===47||E===60||E===61||E===62||E===96||ot(E)?K(E):(t.consume(E),le)}function de(E){return E===47||E===62||Be(E)?H(E):a(E)}function Y(E){return E===62?(t.consume(E),ne):a(E)}function ne(E){return E===null||Te(E)?ae(E):Be(E)?(t.consume(E),ne):a(E)}function ae(E){return E===45&&o===2?(t.consume(E),U):E===60&&o===1?(t.consume(E),$):E===62&&o===4?(t.consume(E),A):E===63&&o===3?(t.consume(E),C):E===93&&o===5?(t.consume(E),Ce):Te(E)&&(o===6||o===7)?(t.exit("htmlFlowData"),t.check(dw,Z,Ae)(E)):E===null||Te(E)?(t.exit("htmlFlowData"),Ae(E)):(t.consume(E),ae)}function Ae(E){return t.check(hw,he,Z)(E)}function he(E){return t.enter("lineEnding"),t.consume(E),t.exit("lineEnding"),te}function te(E){return E===null||Te(E)?Ae(E):(t.enter("htmlFlowData"),ae(E))}function U(E){return E===45?(t.consume(E),C):ae(E)}function $(E){return E===47?(t.consume(E),c="",ue):ae(E)}function ue(E){if(E===62){const oe=c.toLowerCase();return Mm.includes(oe)?(t.consume(E),A):ae(E)}return Xt(E)&&c.length<8?(t.consume(E),c+=String.fromCharCode(E),ue):ae(E)}function Ce(E){return E===93?(t.consume(E),C):ae(E)}function C(E){return E===62?(t.consume(E),A):E===45&&o===2?(t.consume(E),C):ae(E)}function A(E){return E===null||Te(E)?(t.exit("htmlFlowData"),Z(E)):(t.consume(E),A)}function Z(E){return t.exit("htmlFlow"),r(E)}}function gw(t,r,a){const i=this;return o;function o(c){return Te(c)?(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),s):a(c)}function s(c){return i.parser.lazy[i.now().line]?a(c):r(c)}}function yw(t,r,a){return i;function i(o){return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),t.attempt($a,r,a)}}const vw={name:"htmlText",tokenize:bw};function bw(t,r,a){const i=this;let o,s,c;return h;function h(C){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(C),p}function p(C){return C===33?(t.consume(C),m):C===47?(t.consume(C),K):C===63?(t.consume(C),H):Xt(C)?(t.consume(C),le):a(C)}function m(C){return C===45?(t.consume(C),y):C===91?(t.consume(C),s=0,k):Xt(C)?(t.consume(C),_):a(C)}function y(C){return C===45?(t.consume(C),b):a(C)}function g(C){return C===null?a(C):C===45?(t.consume(C),x):Te(C)?(c=g,$(C)):(t.consume(C),g)}function x(C){return C===45?(t.consume(C),b):g(C)}function b(C){return C===62?U(C):C===45?x(C):g(C)}function k(C){const A="CDATA[";return C===A.charCodeAt(s++)?(t.consume(C),s===A.length?D:k):a(C)}function D(C){return C===null?a(C):C===93?(t.consume(C),N):Te(C)?(c=D,$(C)):(t.consume(C),D)}function N(C){return C===93?(t.consume(C),R):D(C)}function R(C){return C===62?U(C):C===93?(t.consume(C),R):D(C)}function _(C){return C===null||C===62?U(C):Te(C)?(c=_,$(C)):(t.consume(C),_)}function H(C){return C===null?a(C):C===63?(t.consume(C),ie):Te(C)?(c=H,$(C)):(t.consume(C),H)}function ie(C){return C===62?U(C):H(C)}function K(C){return Xt(C)?(t.consume(C),q):a(C)}function q(C){return C===45||Gt(C)?(t.consume(C),q):M(C)}function M(C){return Te(C)?(c=M,$(C)):Be(C)?(t.consume(C),M):U(C)}function le(C){return C===45||Gt(C)?(t.consume(C),le):C===47||C===62||ot(C)?de(C):a(C)}function de(C){return C===47?(t.consume(C),U):C===58||C===95||Xt(C)?(t.consume(C),Y):Te(C)?(c=de,$(C)):Be(C)?(t.consume(C),de):U(C)}function Y(C){return C===45||C===46||C===58||C===95||Gt(C)?(t.consume(C),Y):ne(C)}function ne(C){return C===61?(t.consume(C),ae):Te(C)?(c=ne,$(C)):Be(C)?(t.consume(C),ne):de(C)}function ae(C){return C===null||C===60||C===61||C===62||C===96?a(C):C===34||C===39?(t.consume(C),o=C,Ae):Te(C)?(c=ae,$(C)):Be(C)?(t.consume(C),ae):(t.consume(C),he)}function Ae(C){return C===o?(t.consume(C),o=void 0,te):C===null?a(C):Te(C)?(c=Ae,$(C)):(t.consume(C),Ae)}function he(C){return C===null||C===34||C===39||C===60||C===61||C===96?a(C):C===47||C===62||ot(C)?de(C):(t.consume(C),he)}function te(C){return C===47||C===62||ot(C)?de(C):a(C)}function U(C){return C===62?(t.consume(C),t.exit("htmlTextData"),t.exit("htmlText"),r):a(C)}function $(C){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(C),t.exit("lineEnding"),ue}function ue(C){return Be(C)?Ke(t,Ce,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(C):Ce(C)}function Ce(C){return t.enter("htmlTextData"),c(C)}}const Ns={name:"labelEnd",resolveAll:Ew,resolveTo:kw,tokenize:Cw},xw={tokenize:Tw},Sw={tokenize:zw},ww={tokenize:Aw};function Ew(t){let r=-1;const a=[];for(;++r<t.length;){const i=t[r][1];if(a.push(t[r]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const o=i.type==="labelImage"?4:2;i.type="data",r+=o}}return t.length!==a.length&&sn(t,0,t.length,a),t}function kw(t,r){let a=t.length,i=0,o,s,c,h;for(;a--;)if(o=t[a][1],s){if(o.type==="link"||o.type==="labelLink"&&o._inactive)break;t[a][0]==="enter"&&o.type==="labelLink"&&(o._inactive=!0)}else if(c){if(t[a][0]==="enter"&&(o.type==="labelImage"||o.type==="labelLink")&&!o._balanced&&(s=a,o.type!=="labelLink")){i=2;break}}else o.type==="labelEnd"&&(c=a);const p={type:t[s][1].type==="labelLink"?"link":"image",start:{...t[s][1].start},end:{...t[t.length-1][1].end}},m={type:"label",start:{...t[s][1].start},end:{...t[c][1].end}},y={type:"labelText",start:{...t[s+i+2][1].end},end:{...t[c-2][1].start}};return h=[["enter",p,r],["enter",m,r]],h=En(h,t.slice(s+1,s+i+3)),h=En(h,[["enter",y,r]]),h=En(h,ou(r.parser.constructs.insideSpan.null,t.slice(s+i+4,c-3),r)),h=En(h,[["exit",y,r],t[c-2],t[c-1],["exit",m,r]]),h=En(h,t.slice(c+1)),h=En(h,[["exit",p,r]]),sn(t,s,t.length,h),t}function Cw(t,r,a){const i=this;let o=i.events.length,s,c;for(;o--;)if((i.events[o][1].type==="labelImage"||i.events[o][1].type==="labelLink")&&!i.events[o][1]._balanced){s=i.events[o][1];break}return h;function h(x){return s?s._inactive?g(x):(c=i.parser.defined.includes(Ln(i.sliceSerialize({start:s.end,end:i.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(x),t.exit("labelMarker"),t.exit("labelEnd"),p):a(x)}function p(x){return x===40?t.attempt(xw,y,c?y:g)(x):x===91?t.attempt(Sw,y,c?m:g)(x):c?y(x):g(x)}function m(x){return t.attempt(ww,y,g)(x)}function y(x){return r(x)}function g(x){return s._balanced=!0,a(x)}}function Tw(t,r,a){return i;function i(g){return t.enter("resource"),t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),o}function o(g){return ot(g)?ei(t,s)(g):s(g)}function s(g){return g===41?y(g):Am(t,c,h,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function c(g){return ot(g)?ei(t,p)(g):y(g)}function h(g){return a(g)}function p(g){return g===34||g===39||g===40?Dm(t,m,a,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):y(g)}function m(g){return ot(g)?ei(t,y)(g):y(g)}function y(g){return g===41?(t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),t.exit("resource"),r):a(g)}}function zw(t,r,a){const i=this;return o;function o(h){return Rm.call(i,t,s,c,"reference","referenceMarker","referenceString")(h)}function s(h){return i.parser.defined.includes(Ln(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?r(h):a(h)}function c(h){return a(h)}}function Aw(t,r,a){return i;function i(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),o}function o(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),r):a(s)}}const Rw={name:"labelStartImage",resolveAll:Ns.resolveAll,tokenize:Dw};function Dw(t,r,a){const i=this;return o;function o(h){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(h),t.exit("labelImageMarker"),s}function s(h){return h===91?(t.enter("labelMarker"),t.consume(h),t.exit("labelMarker"),t.exit("labelImage"),c):a(h)}function c(h){return h===94&&"_hiddenFootnoteSupport"in i.parser.constructs?a(h):r(h)}}const Mw={name:"labelStartLink",resolveAll:Ns.resolveAll,tokenize:Ow};function Ow(t,r,a){const i=this;return o;function o(c){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(c),t.exit("labelMarker"),t.exit("labelLink"),s}function s(c){return c===94&&"_hiddenFootnoteSupport"in i.parser.constructs?a(c):r(c)}}const _s={name:"lineEnding",tokenize:Nw};function Nw(t,r){return a;function a(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),Ke(t,r,"linePrefix")}}const su={name:"thematicBreak",tokenize:_w};function _w(t,r,a){let i=0,o;return s;function s(m){return t.enter("thematicBreak"),c(m)}function c(m){return o=m,h(m)}function h(m){return m===o?(t.enter("thematicBreakSequence"),p(m)):i>=3&&(m===null||Te(m))?(t.exit("thematicBreak"),r(m)):a(m)}function p(m){return m===o?(t.consume(m),i++,p):(t.exit("thematicBreakSequence"),Be(m)?Ke(t,h,"whitespace")(m):h(m))}}const It={continuation:{tokenize:Bw},exit:qw,name:"list",tokenize:Uw},jw={partial:!0,tokenize:Yw},Lw={partial:!0,tokenize:Hw};function Uw(t,r,a){const i=this,o=i.events[i.events.length-1];let s=o&&o[1].type==="linePrefix"?o[2].sliceSerialize(o[1],!0).length:0,c=0;return h;function h(b){const k=i.containerState.type||(b===42||b===43||b===45?"listUnordered":"listOrdered");if(k==="listUnordered"?!i.containerState.marker||b===i.containerState.marker:Ds(b)){if(i.containerState.type||(i.containerState.type=k,t.enter(k,{_container:!0})),k==="listUnordered")return t.enter("listItemPrefix"),b===42||b===45?t.check(su,a,m)(b):m(b);if(!i.interrupt||b===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),p(b)}return a(b)}function p(b){return Ds(b)&&++c<10?(t.consume(b),p):(!i.interrupt||c<2)&&(i.containerState.marker?b===i.containerState.marker:b===41||b===46)?(t.exit("listItemValue"),m(b)):a(b)}function m(b){return t.enter("listItemMarker"),t.consume(b),t.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||b,t.check($a,i.interrupt?a:y,t.attempt(jw,x,g))}function y(b){return i.containerState.initialBlankLine=!0,s++,x(b)}function g(b){return Be(b)?(t.enter("listItemPrefixWhitespace"),t.consume(b),t.exit("listItemPrefixWhitespace"),x):a(b)}function x(b){return i.containerState.size=s+i.sliceSerialize(t.exit("listItemPrefix"),!0).length,r(b)}}function Bw(t,r,a){const i=this;return i.containerState._closeFlow=void 0,t.check($a,o,s);function o(h){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,Ke(t,r,"listItemIndent",i.containerState.size+1)(h)}function s(h){return i.containerState.furtherBlankLines||!Be(h)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,c(h)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,t.attempt(Lw,r,c)(h))}function c(h){return i.containerState._closeFlow=!0,i.interrupt=void 0,Ke(t,t.attempt(It,r,a),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(h)}}function Hw(t,r,a){const i=this;return Ke(t,o,"listItemIndent",i.containerState.size+1);function o(s){const c=i.events[i.events.length-1];return c&&c[1].type==="listItemIndent"&&c[2].sliceSerialize(c[1],!0).length===i.containerState.size?r(s):a(s)}}function qw(t){t.exit(this.containerState.type)}function Yw(t,r,a){const i=this;return Ke(t,o,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function o(s){const c=i.events[i.events.length-1];return!Be(s)&&c&&c[1].type==="listItemPrefixWhitespace"?r(s):a(s)}}const Om={name:"setextUnderline",resolveTo:Vw,tokenize:Fw};function Vw(t,r){let a=t.length,i,o,s;for(;a--;)if(t[a][0]==="enter"){if(t[a][1].type==="content"){i=a;break}t[a][1].type==="paragraph"&&(o=a)}else t[a][1].type==="content"&&t.splice(a,1),!s&&t[a][1].type==="definition"&&(s=a);const c={type:"setextHeading",start:{...t[i][1].start},end:{...t[t.length-1][1].end}};return t[o][1].type="setextHeadingText",s?(t.splice(o,0,["enter",c,r]),t.splice(s+1,0,["exit",t[i][1],r]),t[i][1].end={...t[s][1].end}):t[i][1]=c,t.push(["exit",c,r]),t}function Fw(t,r,a){const i=this;let o;return s;function s(m){let y=i.events.length,g;for(;y--;)if(i.events[y][1].type!=="lineEnding"&&i.events[y][1].type!=="linePrefix"&&i.events[y][1].type!=="content"){g=i.events[y][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(t.enter("setextHeadingLine"),o=m,c(m)):a(m)}function c(m){return t.enter("setextHeadingLineSequence"),h(m)}function h(m){return m===o?(t.consume(m),h):(t.exit("setextHeadingLineSequence"),Be(m)?Ke(t,p,"lineSuffix")(m):p(m))}function p(m){return m===null||Te(m)?(t.exit("setextHeadingLine"),r(m)):a(m)}}const Gw={tokenize:Xw};function Xw(t){const r=this,a=t.attempt($a,i,t.attempt(this.parser.constructs.flowInitial,o,Ke(t,t.attempt(this.parser.constructs.flow,o,t.attempt(JS,o)),"linePrefix")));return a;function i(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),r.currentConstruct=void 0,a}function o(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),r.currentConstruct=void 0,a}}const Qw={resolveAll:_m()},Zw=Nm("string"),Kw=Nm("text");function Nm(t){return{resolveAll:_m(t==="text"?Iw:void 0),tokenize:r};function r(a){const i=this,o=this.parser.constructs[t],s=a.attempt(o,c,h);return c;function c(y){return m(y)?s(y):h(y)}function h(y){if(y===null){a.consume(y);return}return a.enter("data"),a.consume(y),p}function p(y){return m(y)?(a.exit("data"),s(y)):(a.consume(y),p)}function m(y){if(y===null)return!0;const g=o[y];let x=-1;if(g)for(;++x<g.length;){const b=g[x];if(!b.previous||b.previous.call(i,i.previous))return!0}return!1}}}function _m(t){return r;function r(a,i){let o=-1,s;for(;++o<=a.length;)s===void 0?a[o]&&a[o][1].type==="data"&&(s=o,o++):(!a[o]||a[o][1].type!=="data")&&(o!==s+2&&(a[s][1].end=a[o-1][1].end,a.splice(s+2,o-s-2),o=s+2),s=void 0);return t?t(a,i):a}}function Iw(t,r){let a=0;for(;++a<=t.length;)if((a===t.length||t[a][1].type==="lineEnding")&&t[a-1][1].type==="data"){const i=t[a-1][1],o=r.sliceStream(i);let s=o.length,c=-1,h=0,p;for(;s--;){const m=o[s];if(typeof m=="string"){for(c=m.length;m.charCodeAt(c-1)===32;)h++,c--;if(c)break;c=-1}else if(m===-2)p=!0,h++;else if(m!==-1){s++;break}}if(r._contentTypeTextTrailing&&a===t.length&&(h=0),h){const m={type:a===t.length||p||h<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?c:i.start._bufferIndex+c,_index:i.start._index+s,line:i.end.line,column:i.end.column-h,offset:i.end.offset-h},end:{...i.end}};i.end={...m.start},i.start.offset===i.end.offset?Object.assign(i,m):(t.splice(a,0,["enter",m,r],["exit",m,r]),a+=2)}a++}return t}const Jw=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:{null:[42,95]},contentInitial:{91:tw},disable:{null:[]},document:{42:It,43:It,45:It,48:It,49:It,50:It,51:It,52:It,53:It,54:It,55:It,56:It,57:It,62:wm},flow:{35:uw,42:su,45:[Om,su],60:fw,61:Om,95:su,96:Tm,126:Tm},flowInitial:{[-2]:Os,[-1]:Os,32:Os},insideSpan:{null:[Ms,Qw]},string:{38:km,92:Em},text:{[-5]:_s,[-4]:_s,[-3]:_s,33:Rw,38:km,42:Ms,60:[MS,vw],91:Mw,92:[aw,Em],93:Ns,95:Ms,96:GS}},Symbol.toStringTag,{value:"Module"}));function Pw(t,r,a){let i={_bufferIndex:-1,_index:0,line:a&&a.line||1,column:a&&a.column||1,offset:a&&a.offset||0};const o={},s=[];let c=[],h=[];const p={attempt:M(K),check:M(q),consume:_,enter:H,exit:ie,interrupt:M(q,{interrupt:!0})},m={code:null,containerState:{},defineSkip:D,events:[],now:k,parser:t,previous:null,sliceSerialize:x,sliceStream:b,write:g};let y=r.tokenize.call(m,p);return r.resolveAll&&s.push(r),m;function g(ne){return c=En(c,ne),N(),c[c.length-1]!==null?[]:(le(r,0),m.events=ou(s,m.events,m),m.events)}function x(ne,ae){return Ww(b(ne),ae)}function b(ne){return $w(c,ne)}function k(){const{_bufferIndex:ne,_index:ae,line:Ae,column:he,offset:te}=i;return{_bufferIndex:ne,_index:ae,line:Ae,column:he,offset:te}}function D(ne){o[ne.line]=ne.column,Y()}function N(){let ne;for(;i._index<c.length;){const ae=c[i._index];if(typeof ae=="string")for(ne=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===ne&&i._bufferIndex<ae.length;)R(ae.charCodeAt(i._bufferIndex));else R(ae)}}function R(ne){y=y(ne)}function _(ne){Te(ne)?(i.line++,i.column=1,i.offset+=ne===-3?2:1,Y()):ne!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===c[i._index].length&&(i._bufferIndex=-1,i._index++)),m.previous=ne}function H(ne,ae){const Ae=ae||{};return Ae.type=ne,Ae.start=k(),m.events.push(["enter",Ae,m]),h.push(Ae),Ae}function ie(ne){const ae=h.pop();return ae.end=k(),m.events.push(["exit",ae,m]),ae}function K(ne,ae){le(ne,ae.from)}function q(ne,ae){ae.restore()}function M(ne,ae){return Ae;function Ae(he,te,U){let $,ue,Ce,C;return Array.isArray(he)?Z(he):"tokenize"in he?Z([he]):A(he);function A(ge){return je;function je(Je){const et=Je!==null&&ge[Je],Jt=Je!==null&&ge.null,Un=[...Array.isArray(et)?et:et?[et]:[],...Array.isArray(Jt)?Jt:Jt?[Jt]:[]];return Z(Un)(Je)}}function Z(ge){return $=ge,ue=0,ge.length===0?U:E(ge[ue])}function E(ge){return je;function je(Je){return C=de(),Ce=ge,ge.partial||(m.currentConstruct=ge),ge.name&&m.parser.constructs.disable.null.includes(ge.name)?pe():ge.tokenize.call(ae?Object.assign(Object.create(m),ae):m,p,oe,pe)(Je)}}function oe(ge){return ne(Ce,C),te}function pe(ge){return C.restore(),++ue<$.length?E($[ue]):U}}}function le(ne,ae){ne.resolveAll&&!s.includes(ne)&&s.push(ne),ne.resolve&&sn(m.events,ae,m.events.length-ae,ne.resolve(m.events.slice(ae),m)),ne.resolveTo&&(m.events=ne.resolveTo(m.events,m))}function de(){const ne=k(),ae=m.previous,Ae=m.currentConstruct,he=m.events.length,te=Array.from(h);return{from:he,restore:U};function U(){i=ne,m.previous=ae,m.currentConstruct=Ae,m.events.length=he,h=te,Y()}}function Y(){i.line in o&&i.column<2&&(i.column=o[i.line],i.offset+=o[i.line]-1)}}function $w(t,r){const a=r.start._index,i=r.start._bufferIndex,o=r.end._index,s=r.end._bufferIndex;let c;if(a===o)c=[t[a].slice(i,s)];else{if(c=t.slice(a,o),i>-1){const h=c[0];typeof h=="string"?c[0]=h.slice(i):c.shift()}s>0&&c.push(t[o].slice(0,s))}return c}function Ww(t,r){let a=-1;const i=[];let o;for(;++a<t.length;){const s=t[a];let c;if(typeof s=="string")c=s;else switch(s){case-5:{c="\r";break}case-4:{c=`
`;break}case-3:{c=`\r
`;break}case-2:{c=r?" ":"	";break}case-1:{if(!r&&o)continue;c=" ";break}default:c=String.fromCharCode(s)}o=s===-2,i.push(c)}return i.join("")}function e2(t){const i={constructs:vm([Jw,...(t||{}).extensions||[]]),content:o(kS),defined:[],document:o(TS),flow:o(Gw),lazy:{},string:o(Zw),text:o(Kw)};return i;function o(s){return c;function c(h){return Pw(i,s,h)}}}function t2(t){for(;!zm(t););return t}const jm=/[\0\t\n\r]/g;function n2(){let t=1,r="",a=!0,i;return o;function o(s,c,h){const p=[];let m,y,g,x,b;for(s=r+(typeof s=="string"?s.toString():new TextDecoder(c||void 0).decode(s)),g=0,r="",a&&(s.charCodeAt(0)===65279&&g++,a=void 0);g<s.length;){if(jm.lastIndex=g,m=jm.exec(s),x=m&&m.index!==void 0?m.index:s.length,b=s.charCodeAt(x),!m){r=s.slice(g);break}if(b===10&&g===x&&i)p.push(-3),i=void 0;else switch(i&&(p.push(-5),i=void 0),g<x&&(p.push(s.slice(g,x)),t+=x-g),b){case 0:{p.push(65533),t++;break}case 9:{for(y=Math.ceil(t/4)*4,p.push(-2);t++<y;)p.push(-1);break}case 10:{p.push(-4),t=1;break}default:i=!0,t=1}g=x+1}return h&&(i&&p.push(-5),r&&p.push(r),p.push(null)),p}}const l2=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function r2(t){return t.replace(l2,a2)}function a2(t,r,a){if(r)return r;if(a.charCodeAt(0)===35){const o=a.charCodeAt(1),s=o===120||o===88;return bm(a.slice(s?2:1),s?16:10)}return Rs(a)||t}const Lm={}.hasOwnProperty;function i2(t,r,a){return typeof r!="string"&&(a=r,r=void 0),u2(a)(t2(e2(a).document().write(n2()(t,r,!0))))}function u2(t){const r={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(al),autolinkProtocol:de,autolinkEmail:de,atxHeading:s(Ll),blockQuote:s(Jt),characterEscape:de,characterReference:de,codeFenced:s(Un),codeFencedFenceInfo:c,codeFencedFenceMeta:c,codeIndented:s(Un,c),codeText:s(yt,c),codeTextData:de,data:de,codeFlowValue:de,definition:s(Bn),definitionDestinationString:c,definitionLabelString:c,definitionTitleString:c,emphasis:s(kn),hardBreakEscape:s(Pt),hardBreakTrailing:s(Pt),htmlFlow:s(Jr,c),htmlFlowData:de,htmlText:s(Jr,c),htmlTextData:de,image:s(Pr),label:c,link:s(al),listItem:s(pr),listItemValue:x,listOrdered:s(Ul,g),listUnordered:s(Ul),paragraph:s(ai),reference:E,referenceString:c,resourceDestinationString:c,resourceTitleString:c,setextHeading:s(Ll),strong:s(ii),thematicBreak:s(il)},exit:{atxHeading:p(),atxHeadingSequence:K,autolink:p(),autolinkEmail:et,autolinkProtocol:Je,blockQuote:p(),characterEscapeValue:Y,characterReferenceMarkerHexadecimal:pe,characterReferenceMarkerNumeric:pe,characterReferenceValue:ge,characterReference:je,codeFenced:p(N),codeFencedFence:D,codeFencedFenceInfo:b,codeFencedFenceMeta:k,codeFlowValue:Y,codeIndented:p(R),codeText:p(te),codeTextData:Y,data:Y,definition:p(),definitionDestinationString:ie,definitionLabelString:_,definitionTitleString:H,emphasis:p(),hardBreakEscape:p(ae),hardBreakTrailing:p(ae),htmlFlow:p(Ae),htmlFlowData:Y,htmlText:p(he),htmlTextData:Y,image:p($),label:Ce,labelText:ue,lineEnding:ne,link:p(U),listItem:p(),listOrdered:p(),listUnordered:p(),paragraph:p(),referenceString:oe,resourceDestinationString:C,resourceTitleString:A,resource:Z,setextHeading:p(le),setextHeadingLineSequence:M,setextHeadingText:q,strong:p(),thematicBreak:p()}};Um(r,(t||{}).mdastExtensions||[]);const a={};return i;function i(J){let se={type:"root",children:[]};const we={stack:[se],tokenStack:[],config:r,enter:h,exit:m,buffer:c,resume:y,data:a},Re=[];let Ie=-1;for(;++Ie<J.length;)if(J[Ie][1].type==="listOrdered"||J[Ie][1].type==="listUnordered")if(J[Ie][0]==="enter")Re.push(Ie);else{const Qt=Re.pop();Ie=o(J,Qt,Ie)}for(Ie=-1;++Ie<J.length;){const Qt=r[J[Ie][0]];Lm.call(Qt,J[Ie][1].type)&&Qt[J[Ie][1].type].call(Object.assign({sliceSerialize:J[Ie][2].sliceSerialize},we),J[Ie][1])}if(we.tokenStack.length>0){const Qt=we.tokenStack[we.tokenStack.length-1];(Qt[1]||Bm).call(we,void 0,Qt[0])}for(se.position={start:jl(J.length>0?J[0][1].start:{line:1,column:1,offset:0}),end:jl(J.length>0?J[J.length-2][1].end:{line:1,column:1,offset:0})},Ie=-1;++Ie<r.transforms.length;)se=r.transforms[Ie](se)||se;return se}function o(J,se,we){let Re=se-1,Ie=-1,Qt=!1,cn,_t,nt,jt;for(;++Re<=we;){const tt=J[Re];switch(tt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{tt[0]==="enter"?Ie++:Ie--,jt=void 0;break}case"lineEndingBlank":{tt[0]==="enter"&&(cn&&!jt&&!Ie&&!nt&&(nt=Re),jt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:jt=void 0}if(!Ie&&tt[0]==="enter"&&tt[1].type==="listItemPrefix"||Ie===-1&&tt[0]==="exit"&&(tt[1].type==="listUnordered"||tt[1].type==="listOrdered")){if(cn){let Hn=Re;for(_t=void 0;Hn--;){const fn=J[Hn];if(fn[1].type==="lineEnding"||fn[1].type==="lineEndingBlank"){if(fn[0]==="exit")continue;_t&&(J[_t][1].type="lineEndingBlank",Qt=!0),fn[1].type="lineEnding",_t=Hn}else if(!(fn[1].type==="linePrefix"||fn[1].type==="blockQuotePrefix"||fn[1].type==="blockQuotePrefixWhitespace"||fn[1].type==="blockQuoteMarker"||fn[1].type==="listItemIndent"))break}nt&&(!_t||nt<_t)&&(cn._spread=!0),cn.end=Object.assign({},_t?J[_t][1].start:tt[1].end),J.splice(_t||Re,0,["exit",cn,tt[2]]),Re++,we++}if(tt[1].type==="listItemPrefix"){const Hn={type:"listItem",_spread:!1,start:Object.assign({},tt[1].start),end:void 0};cn=Hn,J.splice(Re,0,["enter",Hn,tt[2]]),Re++,we++,nt=void 0,jt=!0}}}return J[se][1]._spread=Qt,we}function s(J,se){return we;function we(Re){h.call(this,J(Re),Re),se&&se.call(this,Re)}}function c(){this.stack.push({type:"fragment",children:[]})}function h(J,se,we){this.stack[this.stack.length-1].children.push(J),this.stack.push(J),this.tokenStack.push([se,we||void 0]),J.position={start:jl(se.start),end:void 0}}function p(J){return se;function se(we){J&&J.call(this,we),m.call(this,we)}}function m(J,se){const we=this.stack.pop(),Re=this.tokenStack.pop();if(Re)Re[0].type!==J.type&&(se?se.call(this,J,Re[0]):(Re[1]||Bm).call(this,J,Re[0]));else throw new Error("Cannot close `"+J.type+"` ("+Ja({start:J.start,end:J.end})+"): it’s not open");we.position.end=jl(J.end)}function y(){return As(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function x(J){if(this.data.expectingFirstListItemValue){const se=this.stack[this.stack.length-2];se.start=Number.parseInt(this.sliceSerialize(J),10),this.data.expectingFirstListItemValue=void 0}}function b(){const J=this.resume(),se=this.stack[this.stack.length-1];se.lang=J}function k(){const J=this.resume(),se=this.stack[this.stack.length-1];se.meta=J}function D(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function N(){const J=this.resume(),se=this.stack[this.stack.length-1];se.value=J.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function R(){const J=this.resume(),se=this.stack[this.stack.length-1];se.value=J.replace(/(\r?\n|\r)$/g,"")}function _(J){const se=this.resume(),we=this.stack[this.stack.length-1];we.label=se,we.identifier=Ln(this.sliceSerialize(J)).toLowerCase()}function H(){const J=this.resume(),se=this.stack[this.stack.length-1];se.title=J}function ie(){const J=this.resume(),se=this.stack[this.stack.length-1];se.url=J}function K(J){const se=this.stack[this.stack.length-1];if(!se.depth){const we=this.sliceSerialize(J).length;se.depth=we}}function q(){this.data.setextHeadingSlurpLineEnding=!0}function M(J){const se=this.stack[this.stack.length-1];se.depth=this.sliceSerialize(J).codePointAt(0)===61?1:2}function le(){this.data.setextHeadingSlurpLineEnding=void 0}function de(J){const we=this.stack[this.stack.length-1].children;let Re=we[we.length-1];(!Re||Re.type!=="text")&&(Re=pt(),Re.position={start:jl(J.start),end:void 0},we.push(Re)),this.stack.push(Re)}function Y(J){const se=this.stack.pop();se.value+=this.sliceSerialize(J),se.position.end=jl(J.end)}function ne(J){const se=this.stack[this.stack.length-1];if(this.data.atHardBreak){const we=se.children[se.children.length-1];we.position.end=jl(J.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&r.canContainEols.includes(se.type)&&(de.call(this,J),Y.call(this,J))}function ae(){this.data.atHardBreak=!0}function Ae(){const J=this.resume(),se=this.stack[this.stack.length-1];se.value=J}function he(){const J=this.resume(),se=this.stack[this.stack.length-1];se.value=J}function te(){const J=this.resume(),se=this.stack[this.stack.length-1];se.value=J}function U(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const se=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=se,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function $(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const se=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=se,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function ue(J){const se=this.sliceSerialize(J),we=this.stack[this.stack.length-2];we.label=r2(se),we.identifier=Ln(se).toLowerCase()}function Ce(){const J=this.stack[this.stack.length-1],se=this.resume(),we=this.stack[this.stack.length-1];if(this.data.inReference=!0,we.type==="link"){const Re=J.children;we.children=Re}else we.alt=se}function C(){const J=this.resume(),se=this.stack[this.stack.length-1];se.url=J}function A(){const J=this.resume(),se=this.stack[this.stack.length-1];se.title=J}function Z(){this.data.inReference=void 0}function E(){this.data.referenceType="collapsed"}function oe(J){const se=this.resume(),we=this.stack[this.stack.length-1];we.label=se,we.identifier=Ln(this.sliceSerialize(J)).toLowerCase(),this.data.referenceType="full"}function pe(J){this.data.characterReferenceType=J.type}function ge(J){const se=this.sliceSerialize(J),we=this.data.characterReferenceType;let Re;we?(Re=bm(se,we==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Re=Rs(se);const Ie=this.stack[this.stack.length-1];Ie.value+=Re}function je(J){const se=this.stack.pop();se.position.end=jl(J.end)}function Je(J){Y.call(this,J);const se=this.stack[this.stack.length-1];se.url=this.sliceSerialize(J)}function et(J){Y.call(this,J);const se=this.stack[this.stack.length-1];se.url="mailto:"+this.sliceSerialize(J)}function Jt(){return{type:"blockquote",children:[]}}function Un(){return{type:"code",lang:null,meta:null,value:""}}function yt(){return{type:"inlineCode",value:""}}function Bn(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function kn(){return{type:"emphasis",children:[]}}function Ll(){return{type:"heading",depth:0,children:[]}}function Pt(){return{type:"break"}}function Jr(){return{type:"html",value:""}}function Pr(){return{type:"image",title:null,url:"",alt:null}}function al(){return{type:"link",title:null,url:"",children:[]}}function Ul(J){return{type:"list",ordered:J.type==="listOrdered",start:null,spread:J._spread,children:[]}}function pr(J){return{type:"listItem",spread:J._spread,checked:null,children:[]}}function ai(){return{type:"paragraph",children:[]}}function ii(){return{type:"strong",children:[]}}function pt(){return{type:"text",value:""}}function il(){return{type:"thematicBreak"}}}function jl(t){return{line:t.line,column:t.column,offset:t.offset}}function Um(t,r){let a=-1;for(;++a<r.length;){const i=r[a];Array.isArray(i)?Um(t,i):o2(t,i)}}function o2(t,r){let a;for(a in r)if(Lm.call(r,a))switch(a){case"canContainEols":{const i=r[a];i&&t[a].push(...i);break}case"transforms":{const i=r[a];i&&t[a].push(...i);break}case"enter":case"exit":{const i=r[a];i&&Object.assign(t[a],i);break}}}function Bm(t,r){throw t?new Error("Cannot close `"+t.type+"` ("+Ja({start:t.start,end:t.end})+"): a different token (`"+r.type+"`, "+Ja({start:r.start,end:r.end})+") is open"):new Error("Cannot close document, a token (`"+r.type+"`, "+Ja({start:r.start,end:r.end})+") is still open")}function s2(t){const r=this;r.parser=a;function a(i){return i2(i,{...r.data("settings"),...t,extensions:r.data("micromarkExtensions")||[],mdastExtensions:r.data("fromMarkdownExtensions")||[]})}}function c2(t,r){const a={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(r),!0)};return t.patch(r,a),t.applyData(r,a)}function f2(t,r){const a={type:"element",tagName:"br",properties:{},children:[]};return t.patch(r,a),[t.applyData(r,a),{type:"text",value:`
`}]}function d2(t,r){const a=r.value?r.value+`
`:"",i={},o=r.lang?r.lang.split(/\s+/):[];o.length>0&&(i.className=["language-"+o[0]]);let s={type:"element",tagName:"code",properties:i,children:[{type:"text",value:a}]};return r.meta&&(s.data={meta:r.meta}),t.patch(r,s),s=t.applyData(r,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(r,s),s}function h2(t,r){const a={type:"element",tagName:"del",properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}function m2(t,r){const a={type:"element",tagName:"em",properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}function p2(t,r){const a=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",i=String(r.identifier).toUpperCase(),o=Qr(i.toLowerCase()),s=t.footnoteOrder.indexOf(i);let c,h=t.footnoteCounts.get(i);h===void 0?(h=0,t.footnoteOrder.push(i),c=t.footnoteOrder.length):c=s+1,h+=1,t.footnoteCounts.set(i,h);const p={type:"element",tagName:"a",properties:{href:"#"+a+"fn-"+o,id:a+"fnref-"+o+(h>1?"-"+h:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(c)}]};t.patch(r,p);const m={type:"element",tagName:"sup",properties:{},children:[p]};return t.patch(r,m),t.applyData(r,m)}function g2(t,r){const a={type:"element",tagName:"h"+r.depth,properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}function y2(t,r){if(t.options.allowDangerousHtml){const a={type:"raw",value:r.value};return t.patch(r,a),t.applyData(r,a)}}function Hm(t,r){const a=r.referenceType;let i="]";if(a==="collapsed"?i+="[]":a==="full"&&(i+="["+(r.label||r.identifier)+"]"),r.type==="imageReference")return[{type:"text",value:"!["+r.alt+i}];const o=t.all(r),s=o[0];s&&s.type==="text"?s.value="["+s.value:o.unshift({type:"text",value:"["});const c=o[o.length-1];return c&&c.type==="text"?c.value+=i:o.push({type:"text",value:i}),o}function v2(t,r){const a=String(r.identifier).toUpperCase(),i=t.definitionById.get(a);if(!i)return Hm(t,r);const o={src:Qr(i.url||""),alt:r.alt};i.title!==null&&i.title!==void 0&&(o.title=i.title);const s={type:"element",tagName:"img",properties:o,children:[]};return t.patch(r,s),t.applyData(r,s)}function b2(t,r){const a={src:Qr(r.url)};r.alt!==null&&r.alt!==void 0&&(a.alt=r.alt),r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"img",properties:a,children:[]};return t.patch(r,i),t.applyData(r,i)}function x2(t,r){const a={type:"text",value:r.value.replace(/\r?\n|\r/g," ")};t.patch(r,a);const i={type:"element",tagName:"code",properties:{},children:[a]};return t.patch(r,i),t.applyData(r,i)}function S2(t,r){const a=String(r.identifier).toUpperCase(),i=t.definitionById.get(a);if(!i)return Hm(t,r);const o={href:Qr(i.url||"")};i.title!==null&&i.title!==void 0&&(o.title=i.title);const s={type:"element",tagName:"a",properties:o,children:t.all(r)};return t.patch(r,s),t.applyData(r,s)}function w2(t,r){const a={href:Qr(r.url)};r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"a",properties:a,children:t.all(r)};return t.patch(r,i),t.applyData(r,i)}function E2(t,r,a){const i=t.all(r),o=a?k2(a):qm(r),s={},c=[];if(typeof r.checked=="boolean"){const y=i[0];let g;y&&y.type==="element"&&y.tagName==="p"?g=y:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:r.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let h=-1;for(;++h<i.length;){const y=i[h];(o||h!==0||y.type!=="element"||y.tagName!=="p")&&c.push({type:"text",value:`
`}),y.type==="element"&&y.tagName==="p"&&!o?c.push(...y.children):c.push(y)}const p=i[i.length-1];p&&(o||p.type!=="element"||p.tagName!=="p")&&c.push({type:"text",value:`
`});const m={type:"element",tagName:"li",properties:s,children:c};return t.patch(r,m),t.applyData(r,m)}function k2(t){let r=!1;if(t.type==="list"){r=t.spread||!1;const a=t.children;let i=-1;for(;!r&&++i<a.length;)r=qm(a[i])}return r}function qm(t){const r=t.spread;return r??t.children.length>1}function C2(t,r){const a={},i=t.all(r);let o=-1;for(typeof r.start=="number"&&r.start!==1&&(a.start=r.start);++o<i.length;){const c=i[o];if(c.type==="element"&&c.tagName==="li"&&c.properties&&Array.isArray(c.properties.className)&&c.properties.className.includes("task-list-item")){a.className=["contains-task-list"];break}}const s={type:"element",tagName:r.ordered?"ol":"ul",properties:a,children:t.wrap(i,!0)};return t.patch(r,s),t.applyData(r,s)}function T2(t,r){const a={type:"element",tagName:"p",properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}function z2(t,r){const a={type:"root",children:t.wrap(t.all(r))};return t.patch(r,a),t.applyData(r,a)}function A2(t,r){const a={type:"element",tagName:"strong",properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}function R2(t,r){const a=t.all(r),i=a.shift(),o=[];if(i){const c={type:"element",tagName:"thead",properties:{},children:t.wrap([i],!0)};t.patch(r.children[0],c),o.push(c)}if(a.length>0){const c={type:"element",tagName:"tbody",properties:{},children:t.wrap(a,!0)},h=ws(r.children[1]),p=im(r.children[r.children.length-1]);h&&p&&(c.position={start:h,end:p}),o.push(c)}const s={type:"element",tagName:"table",properties:{},children:t.wrap(o,!0)};return t.patch(r,s),t.applyData(r,s)}function D2(t,r,a){const i=a?a.children:void 0,s=(i?i.indexOf(r):1)===0?"th":"td",c=a&&a.type==="table"?a.align:void 0,h=c?c.length:r.children.length;let p=-1;const m=[];for(;++p<h;){const g=r.children[p],x={},b=c?c[p]:void 0;b&&(x.align=b);let k={type:"element",tagName:s,properties:x,children:[]};g&&(k.children=t.all(g),t.patch(g,k),k=t.applyData(g,k)),m.push(k)}const y={type:"element",tagName:"tr",properties:{},children:t.wrap(m,!0)};return t.patch(r,y),t.applyData(r,y)}function M2(t,r){const a={type:"element",tagName:"td",properties:{},children:t.all(r)};return t.patch(r,a),t.applyData(r,a)}const Ym=9,Vm=32;function O2(t){const r=String(t),a=/\r?\n|\r/g;let i=a.exec(r),o=0;const s=[];for(;i;)s.push(Fm(r.slice(o,i.index),o>0,!0),i[0]),o=i.index+i[0].length,i=a.exec(r);return s.push(Fm(r.slice(o),o>0,!1)),s.join("")}function Fm(t,r,a){let i=0,o=t.length;if(r){let s=t.codePointAt(i);for(;s===Ym||s===Vm;)i++,s=t.codePointAt(i)}if(a){let s=t.codePointAt(o-1);for(;s===Ym||s===Vm;)o--,s=t.codePointAt(o-1)}return o>i?t.slice(i,o):""}function N2(t,r){const a={type:"text",value:O2(String(r.value))};return t.patch(r,a),t.applyData(r,a)}function _2(t,r){const a={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(r,a),t.applyData(r,a)}const j2={blockquote:c2,break:f2,code:d2,delete:h2,emphasis:m2,footnoteReference:p2,heading:g2,html:y2,imageReference:v2,image:b2,inlineCode:x2,linkReference:S2,link:w2,listItem:E2,list:C2,paragraph:T2,root:z2,strong:A2,table:R2,tableCell:M2,tableRow:D2,text:N2,thematicBreak:_2,toml:cu,yaml:cu,definition:cu,footnoteDefinition:cu};function cu(){}const Gm=-1,fu=0,ti=1,du=2,js=3,Ls=4,Us=5,Bs=6,Xm=7,Qm=8,Zm=typeof self=="object"?self:globalThis,L2=(t,r)=>{const a=(o,s)=>(t.set(s,o),o),i=o=>{if(t.has(o))return t.get(o);const[s,c]=r[o];switch(s){case fu:case Gm:return a(c,o);case ti:{const h=a([],o);for(const p of c)h.push(i(p));return h}case du:{const h=a({},o);for(const[p,m]of c)h[i(p)]=i(m);return h}case js:return a(new Date(c),o);case Ls:{const{source:h,flags:p}=c;return a(new RegExp(h,p),o)}case Us:{const h=a(new Map,o);for(const[p,m]of c)h.set(i(p),i(m));return h}case Bs:{const h=a(new Set,o);for(const p of c)h.add(i(p));return h}case Xm:{const{name:h,message:p}=c;return a(new Zm[h](p),o)}case Qm:return a(BigInt(c),o);case"BigInt":return a(Object(BigInt(c)),o);case"ArrayBuffer":return a(new Uint8Array(c).buffer,c);case"DataView":{const{buffer:h}=new Uint8Array(c);return a(new DataView(h),c)}}return a(new Zm[s](c),o)};return i},Km=t=>L2(new Map,t)(0),Kr="",{toString:U2}={},{keys:B2}=Object,ni=t=>{const r=typeof t;if(r!=="object"||!t)return[fu,r];const a=U2.call(t).slice(8,-1);switch(a){case"Array":return[ti,Kr];case"Object":return[du,Kr];case"Date":return[js,Kr];case"RegExp":return[Ls,Kr];case"Map":return[Us,Kr];case"Set":return[Bs,Kr];case"DataView":return[ti,a]}return a.includes("Array")?[ti,a]:a.includes("Error")?[Xm,a]:[du,a]},hu=([t,r])=>t===fu&&(r==="function"||r==="symbol"),H2=(t,r,a,i)=>{const o=(c,h)=>{const p=i.push(c)-1;return a.set(h,p),p},s=c=>{if(a.has(c))return a.get(c);let[h,p]=ni(c);switch(h){case fu:{let y=c;switch(p){case"bigint":h=Qm,y=c.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+p);y=null;break;case"undefined":return o([Gm],c)}return o([h,y],c)}case ti:{if(p){let x=c;return p==="DataView"?x=new Uint8Array(c.buffer):p==="ArrayBuffer"&&(x=new Uint8Array(c)),o([p,[...x]],c)}const y=[],g=o([h,y],c);for(const x of c)y.push(s(x));return g}case du:{if(p)switch(p){case"BigInt":return o([p,c.toString()],c);case"Boolean":case"Number":case"String":return o([p,c.valueOf()],c)}if(r&&"toJSON"in c)return s(c.toJSON());const y=[],g=o([h,y],c);for(const x of B2(c))(t||!hu(ni(c[x])))&&y.push([s(x),s(c[x])]);return g}case js:return o([h,c.toISOString()],c);case Ls:{const{source:y,flags:g}=c;return o([h,{source:y,flags:g}],c)}case Us:{const y=[],g=o([h,y],c);for(const[x,b]of c)(t||!(hu(ni(x))||hu(ni(b))))&&y.push([s(x),s(b)]);return g}case Bs:{const y=[],g=o([h,y],c);for(const x of c)(t||!hu(ni(x)))&&y.push(s(x));return g}}const{message:m}=c;return o([h,{name:p,message:m}],c)};return s},Im=(t,{json:r,lossy:a}={})=>{const i=[];return H2(!(r||a),!!r,new Map,i)(t),i},mu=typeof structuredClone=="function"?(t,r)=>r&&("json"in r||"lossy"in r)?Km(Im(t,r)):structuredClone(t):(t,r)=>Km(Im(t,r));function q2(t,r){const a=[{type:"text",value:"↩"}];return r>1&&a.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(r)}]}),a}function Y2(t,r){return"Back to reference "+(t+1)+(r>1?"-"+r:"")}function V2(t){const r=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",a=t.options.footnoteBackContent||q2,i=t.options.footnoteBackLabel||Y2,o=t.options.footnoteLabel||"Footnotes",s=t.options.footnoteLabelTagName||"h2",c=t.options.footnoteLabelProperties||{className:["sr-only"]},h=[];let p=-1;for(;++p<t.footnoteOrder.length;){const m=t.footnoteById.get(t.footnoteOrder[p]);if(!m)continue;const y=t.all(m),g=String(m.identifier).toUpperCase(),x=Qr(g.toLowerCase());let b=0;const k=[],D=t.footnoteCounts.get(g);for(;D!==void 0&&++b<=D;){k.length>0&&k.push({type:"text",value:" "});let _=typeof a=="string"?a:a(p,b);typeof _=="string"&&(_={type:"text",value:_}),k.push({type:"element",tagName:"a",properties:{href:"#"+r+"fnref-"+x+(b>1?"-"+b:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(p,b),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const N=y[y.length-1];if(N&&N.type==="element"&&N.tagName==="p"){const _=N.children[N.children.length-1];_&&_.type==="text"?_.value+=" ":N.children.push({type:"text",value:" "}),N.children.push(...k)}else y.push(...k);const R={type:"element",tagName:"li",properties:{id:r+"fn-"+x},children:t.wrap(y,!0)};t.patch(m,R),h.push(R)}if(h.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...mu(c),id:"footnote-label"},children:[{type:"text",value:o}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(h,!0)},{type:"text",value:`
`}]}}const pu=(function(t){if(t==null)return Q2;if(typeof t=="function")return gu(t);if(typeof t=="object")return Array.isArray(t)?F2(t):G2(t);if(typeof t=="string")return X2(t);throw new Error("Expected function, string, or object as test")});function F2(t){const r=[];let a=-1;for(;++a<t.length;)r[a]=pu(t[a]);return gu(i);function i(...o){let s=-1;for(;++s<r.length;)if(r[s].apply(this,o))return!0;return!1}}function G2(t){const r=t;return gu(a);function a(i){const o=i;let s;for(s in t)if(o[s]!==r[s])return!1;return!0}}function X2(t){return gu(r);function r(a){return a&&a.type===t}}function gu(t){return r;function r(a,i,o){return!!(Z2(a)&&t.call(this,a,typeof i=="number"?i:void 0,o||void 0))}}function Q2(){return!0}function Z2(t){return t!==null&&typeof t=="object"&&"type"in t}function Ez(t){return t}const Jm=[],K2=!0,Hs=!1,I2="skip";function Pm(t,r,a,i){let o;typeof r=="function"&&typeof a!="function"?(i=a,a=r):o=r;const s=pu(o),c=i?-1:1;h(t,void 0,[])();function h(p,m,y){const g=p&&typeof p=="object"?p:{};if(typeof g.type=="string"){const b=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(x,"name",{value:"node ("+(p.type+(b?"<"+b+">":""))+")"})}return x;function x(){let b=Jm,k,D,N;if((!r||s(p,m,y[y.length-1]||void 0))&&(b=J2(a(p,y)),b[0]===Hs))return b;if("children"in p&&p.children){const R=p;if(R.children&&b[0]!==I2)for(D=(i?R.children.length:-1)+c,N=y.concat(R);D>-1&&D<R.children.length;){const _=R.children[D];if(k=h(_,D,N)(),k[0]===Hs)return k;D=typeof k[1]=="number"?k[1]:D+c}}return b}}}function J2(t){return Array.isArray(t)?t:typeof t=="number"?[K2,t]:t==null?Jm:[t]}function qs(t,r,a,i){let o,s,c;typeof r=="function"&&typeof a!="function"?(s=void 0,c=r,o=a):(s=r,c=a,o=i),Pm(t,s,h,o);function h(p,m){const y=m[m.length-1],g=y?y.children.indexOf(p):void 0;return c(p,g,y)}}const Ys={}.hasOwnProperty,P2={};function $2(t,r){const a=r||P2,i=new Map,o=new Map,s=new Map,c={...j2,...a.handlers},h={all:m,applyData:eE,definitionById:i,footnoteById:o,footnoteCounts:s,footnoteOrder:[],handlers:c,one:p,options:a,patch:W2,wrap:nE};return qs(t,function(y){if(y.type==="definition"||y.type==="footnoteDefinition"){const g=y.type==="definition"?i:o,x=String(y.identifier).toUpperCase();g.has(x)||g.set(x,y)}}),h;function p(y,g){const x=y.type,b=h.handlers[x];if(Ys.call(h.handlers,x)&&b)return b(h,y,g);if(h.options.passThrough&&h.options.passThrough.includes(x)){if("children"in y){const{children:D,...N}=y,R=mu(N);return R.children=h.all(y),R}return mu(y)}return(h.options.unknownHandler||tE)(h,y,g)}function m(y){const g=[];if("children"in y){const x=y.children;let b=-1;for(;++b<x.length;){const k=h.one(x[b],y);if(k){if(b&&x[b-1].type==="break"&&(!Array.isArray(k)&&k.type==="text"&&(k.value=$m(k.value)),!Array.isArray(k)&&k.type==="element")){const D=k.children[0];D&&D.type==="text"&&(D.value=$m(D.value))}Array.isArray(k)?g.push(...k):g.push(k)}}}return g}}function W2(t,r){t.position&&(r.position=J1(t))}function eE(t,r){let a=r;if(t&&t.data){const i=t.data.hName,o=t.data.hChildren,s=t.data.hProperties;if(typeof i=="string")if(a.type==="element")a.tagName=i;else{const c="children"in a?a.children:[a];a={type:"element",tagName:i,properties:{},children:c}}a.type==="element"&&s&&Object.assign(a.properties,mu(s)),"children"in a&&a.children&&o!==null&&o!==void 0&&(a.children=o)}return a}function tE(t,r){const a=r.data||{},i="value"in r&&!(Ys.call(a,"hProperties")||Ys.call(a,"hChildren"))?{type:"text",value:r.value}:{type:"element",tagName:"div",properties:{},children:t.all(r)};return t.patch(r,i),t.applyData(r,i)}function nE(t,r){const a=[];let i=-1;for(r&&a.push({type:"text",value:`
`});++i<t.length;)i&&a.push({type:"text",value:`
`}),a.push(t[i]);return r&&t.length>0&&a.push({type:"text",value:`
`}),a}function $m(t){let r=0,a=t.charCodeAt(r);for(;a===9||a===32;)r++,a=t.charCodeAt(r);return t.slice(r)}function Wm(t,r){const a=$2(t,r),i=a.one(t,void 0),o=V2(a),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return o&&s.children.push({type:"text",value:`
`},o),s}function lE(t,r){return t&&"run"in t?async function(a,i){const o=Wm(a,{file:i,...r});await t.run(o,i)}:function(a,i){return Wm(a,{file:i,...t||r})}}function ep(t){if(t)throw t}var Vs,tp;function rE(){if(tp)return Vs;tp=1;var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,a=Object.defineProperty,i=Object.getOwnPropertyDescriptor,o=function(m){return typeof Array.isArray=="function"?Array.isArray(m):r.call(m)==="[object Array]"},s=function(m){if(!m||r.call(m)!=="[object Object]")return!1;var y=t.call(m,"constructor"),g=m.constructor&&m.constructor.prototype&&t.call(m.constructor.prototype,"isPrototypeOf");if(m.constructor&&!y&&!g)return!1;var x;for(x in m);return typeof x>"u"||t.call(m,x)},c=function(m,y){a&&y.name==="__proto__"?a(m,y.name,{enumerable:!0,configurable:!0,value:y.newValue,writable:!0}):m[y.name]=y.newValue},h=function(m,y){if(y==="__proto__")if(t.call(m,y)){if(i)return i(m,y).value}else return;return m[y]};return Vs=function p(){var m,y,g,x,b,k,D=arguments[0],N=1,R=arguments.length,_=!1;for(typeof D=="boolean"&&(_=D,D=arguments[1]||{},N=2),(D==null||typeof D!="object"&&typeof D!="function")&&(D={});N<R;++N)if(m=arguments[N],m!=null)for(y in m)g=h(D,y),x=h(m,y),D!==x&&(_&&x&&(s(x)||(b=o(x)))?(b?(b=!1,k=g&&o(g)?g:[]):k=g&&s(g)?g:{},c(D,{name:y,newValue:p(_,k,x)})):typeof x<"u"&&c(D,{name:y,newValue:x}));return D},Vs}var aE=rE();const Fs=Al(aE);function Gs(t){if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function iE(){const t=[],r={run:a,use:i};return r;function a(...o){let s=-1;const c=o.pop();if(typeof c!="function")throw new TypeError("Expected function as last argument, not "+c);h(null,...o);function h(p,...m){const y=t[++s];let g=-1;if(p){c(p);return}for(;++g<o.length;)(m[g]===null||m[g]===void 0)&&(m[g]=o[g]);o=m,y?uE(y,h)(...m):c(null,...m)}}function i(o){if(typeof o!="function")throw new TypeError("Expected `middelware` to be a function, not "+o);return t.push(o),r}}function uE(t,r){let a;return i;function i(...c){const h=t.length>c.length;let p;h&&c.push(o);try{p=t.apply(this,c)}catch(m){const y=m;if(h&&a)throw y;return o(y)}h||(p&&p.then&&typeof p.then=="function"?p.then(s,o):p instanceof Error?o(p):s(p))}function o(c,...h){a||(a=!0,r(c,...h))}function s(c){o(null,c)}}const Kn={basename:oE,dirname:sE,extname:cE,join:fE,sep:"/"};function oE(t,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');li(t);let a=0,i=-1,o=t.length,s;if(r===void 0||r.length===0||r.length>t.length){for(;o--;)if(t.codePointAt(o)===47){if(s){a=o+1;break}}else i<0&&(s=!0,i=o+1);return i<0?"":t.slice(a,i)}if(r===t)return"";let c=-1,h=r.length-1;for(;o--;)if(t.codePointAt(o)===47){if(s){a=o+1;break}}else c<0&&(s=!0,c=o+1),h>-1&&(t.codePointAt(o)===r.codePointAt(h--)?h<0&&(i=o):(h=-1,i=c));return a===i?i=c:i<0&&(i=t.length),t.slice(a,i)}function sE(t){if(li(t),t.length===0)return".";let r=-1,a=t.length,i;for(;--a;)if(t.codePointAt(a)===47){if(i){r=a;break}}else i||(i=!0);return r<0?t.codePointAt(0)===47?"/":".":r===1&&t.codePointAt(0)===47?"//":t.slice(0,r)}function cE(t){li(t);let r=t.length,a=-1,i=0,o=-1,s=0,c;for(;r--;){const h=t.codePointAt(r);if(h===47){if(c){i=r+1;break}continue}a<0&&(c=!0,a=r+1),h===46?o<0?o=r:s!==1&&(s=1):o>-1&&(s=-1)}return o<0||a<0||s===0||s===1&&o===a-1&&o===i+1?"":t.slice(o,a)}function fE(...t){let r=-1,a;for(;++r<t.length;)li(t[r]),t[r]&&(a=a===void 0?t[r]:a+"/"+t[r]);return a===void 0?".":dE(a)}function dE(t){li(t);const r=t.codePointAt(0)===47;let a=hE(t,!r);return a.length===0&&!r&&(a="."),a.length>0&&t.codePointAt(t.length-1)===47&&(a+="/"),r?"/"+a:a}function hE(t,r){let a="",i=0,o=-1,s=0,c=-1,h,p;for(;++c<=t.length;){if(c<t.length)h=t.codePointAt(c);else{if(h===47)break;h=47}if(h===47){if(!(o===c-1||s===1))if(o!==c-1&&s===2){if(a.length<2||i!==2||a.codePointAt(a.length-1)!==46||a.codePointAt(a.length-2)!==46){if(a.length>2){if(p=a.lastIndexOf("/"),p!==a.length-1){p<0?(a="",i=0):(a=a.slice(0,p),i=a.length-1-a.lastIndexOf("/")),o=c,s=0;continue}}else if(a.length>0){a="",i=0,o=c,s=0;continue}}r&&(a=a.length>0?a+"/..":"..",i=2)}else a.length>0?a+="/"+t.slice(o+1,c):a=t.slice(o+1,c),i=c-o-1;o=c,s=0}else h===46&&s>-1?s++:s=-1}return a}function li(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const mE={cwd:pE};function pE(){return"/"}function Xs(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function gE(t){if(typeof t=="string")t=new URL(t);else if(!Xs(t)){const r=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw r.code="ERR_INVALID_ARG_TYPE",r}if(t.protocol!=="file:"){const r=new TypeError("The URL must be of scheme file");throw r.code="ERR_INVALID_URL_SCHEME",r}return yE(t)}function yE(t){if(t.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const r=t.pathname;let a=-1;for(;++a<r.length;)if(r.codePointAt(a)===37&&r.codePointAt(a+1)===50){const i=r.codePointAt(a+2);if(i===70||i===102){const o=new TypeError("File URL path must not include encoded / characters");throw o.code="ERR_INVALID_FILE_URL_PATH",o}}return decodeURIComponent(r)}const Qs=["history","path","basename","stem","extname","dirname"];class np{constructor(r){let a;r?Xs(r)?a={path:r}:typeof r=="string"||vE(r)?a={value:r}:a=r:a={},this.cwd="cwd"in a?"":mE.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<Qs.length;){const s=Qs[i];s in a&&a[s]!==void 0&&a[s]!==null&&(this[s]=s==="history"?[...a[s]]:a[s])}let o;for(o in a)Qs.includes(o)||(this[o]=a[o])}get basename(){return typeof this.path=="string"?Kn.basename(this.path):void 0}set basename(r){Ks(r,"basename"),Zs(r,"basename"),this.path=Kn.join(this.dirname||"",r)}get dirname(){return typeof this.path=="string"?Kn.dirname(this.path):void 0}set dirname(r){lp(this.basename,"dirname"),this.path=Kn.join(r||"",this.basename)}get extname(){return typeof this.path=="string"?Kn.extname(this.path):void 0}set extname(r){if(Zs(r,"extname"),lp(this.dirname,"extname"),r){if(r.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(r.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Kn.join(this.dirname,this.stem+(r||""))}get path(){return this.history[this.history.length-1]}set path(r){Xs(r)&&(r=gE(r)),Ks(r,"path"),this.path!==r&&this.history.push(r)}get stem(){return typeof this.path=="string"?Kn.basename(this.path,this.extname):void 0}set stem(r){Ks(r,"stem"),Zs(r,"stem"),this.path=Kn.join(this.dirname||"",r+(this.extname||""))}fail(r,a,i){const o=this.message(r,a,i);throw o.fatal=!0,o}info(r,a,i){const o=this.message(r,a,i);return o.fatal=void 0,o}message(r,a,i){const o=new Ft(r,a,i);return this.path&&(o.name=this.path+":"+o.name,o.file=this.path),o.fatal=!1,this.messages.push(o),o}toString(r){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(r||void 0).decode(this.value)}}function Zs(t,r){if(t&&t.includes(Kn.sep))throw new Error("`"+r+"` cannot be a path: did not expect `"+Kn.sep+"`")}function Ks(t,r){if(!t)throw new Error("`"+r+"` cannot be empty")}function lp(t,r){if(!t)throw new Error("Setting `"+r+"` requires `path` to be set too")}function vE(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const bE=(function(t){const i=this.constructor.prototype,o=i[t],s=function(){return o.apply(s,arguments)};return Object.setPrototypeOf(s,i),s}),xE={}.hasOwnProperty;class Is extends bE{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=iE()}copy(){const r=new Is;let a=-1;for(;++a<this.attachers.length;){const i=this.attachers[a];r.use(...i)}return r.data(Fs(!0,{},this.namespace)),r}data(r,a){return typeof r=="string"?arguments.length===2?($s("data",this.frozen),this.namespace[r]=a,this):xE.call(this.namespace,r)&&this.namespace[r]||void 0:r?($s("data",this.frozen),this.namespace=r,this):this.namespace}freeze(){if(this.frozen)return this;const r=this;for(;++this.freezeIndex<this.attachers.length;){const[a,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const o=a.call(r,...i);typeof o=="function"&&this.transformers.use(o)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(r){this.freeze();const a=yu(r),i=this.parser||this.Parser;return Js("parse",i),i(String(a),a)}process(r,a){const i=this;return this.freeze(),Js("process",this.parser||this.Parser),Ps("process",this.compiler||this.Compiler),a?o(void 0,a):new Promise(o);function o(s,c){const h=yu(r),p=i.parse(h);i.run(p,h,function(y,g,x){if(y||!g||!x)return m(y);const b=g,k=i.stringify(b,x);EE(k)?x.value=k:x.result=k,m(y,x)});function m(y,g){y||!g?c(y):s?s(g):a(void 0,g)}}}processSync(r){let a=!1,i;return this.freeze(),Js("processSync",this.parser||this.Parser),Ps("processSync",this.compiler||this.Compiler),this.process(r,o),ap("processSync","process",a),i;function o(s,c){a=!0,ep(s),i=c}}run(r,a,i){rp(r),this.freeze();const o=this.transformers;return!i&&typeof a=="function"&&(i=a,a=void 0),i?s(void 0,i):new Promise(s);function s(c,h){const p=yu(a);o.run(r,p,m);function m(y,g,x){const b=g||r;y?h(y):c?c(b):i(void 0,b,x)}}}runSync(r,a){let i=!1,o;return this.run(r,a,s),ap("runSync","run",i),o;function s(c,h){ep(c),o=h,i=!0}}stringify(r,a){this.freeze();const i=yu(a),o=this.compiler||this.Compiler;return Ps("stringify",o),rp(r),o(r,i)}use(r,...a){const i=this.attachers,o=this.namespace;if($s("use",this.frozen),r!=null)if(typeof r=="function")p(r,a);else if(typeof r=="object")Array.isArray(r)?h(r):c(r);else throw new TypeError("Expected usable value, not `"+r+"`");return this;function s(m){if(typeof m=="function")p(m,[]);else if(typeof m=="object")if(Array.isArray(m)){const[y,...g]=m;p(y,g)}else c(m);else throw new TypeError("Expected usable value, not `"+m+"`")}function c(m){if(!("plugins"in m)&&!("settings"in m))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");h(m.plugins),m.settings&&(o.settings=Fs(!0,o.settings,m.settings))}function h(m){let y=-1;if(m!=null)if(Array.isArray(m))for(;++y<m.length;){const g=m[y];s(g)}else throw new TypeError("Expected a list of plugins, not `"+m+"`")}function p(m,y){let g=-1,x=-1;for(;++g<i.length;)if(i[g][0]===m){x=g;break}if(x===-1)i.push([m,...y]);else if(y.length>0){let[b,...k]=y;const D=i[x][1];Gs(D)&&Gs(b)&&(b=Fs(!0,D,b)),i[x]=[m,b,...k]}}}}const SE=new Is().freeze();function Js(t,r){if(typeof r!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Ps(t,r){if(typeof r!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function $s(t,r){if(r)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function rp(t){if(!Gs(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function ap(t,r,a){if(!a)throw new Error("`"+t+"` finished async. Use `"+r+"` instead")}function yu(t){return wE(t)?t:new np(t)}function wE(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function EE(t){return typeof t=="string"||kE(t)}function kE(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const CE="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",ip=[],up={allowDangerousHtml:!0},TE=/^(https?|ircs?|mailto|xmpp)$/i,zE=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function AE(t){const r=RE(t),a=DE(t);return ME(r.runSync(r.parse(a),a),t)}function RE(t){const r=t.rehypePlugins||ip,a=t.remarkPlugins||ip,i=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...up}:up;return SE().use(s2).use(a).use(lE,i).use(r)}function DE(t){const r=t.children||"",a=new np;return typeof r=="string"&&(a.value=r),a}function ME(t,r){const a=r.allowedElements,i=r.allowElement,o=r.components,s=r.disallowedElements,c=r.skipHtml,h=r.unwrapDisallowed,p=r.urlTransform||OE;for(const y of zE)Object.hasOwn(r,y.from)&&(""+y.from+(y.to?"use `"+y.to+"` instead":"remove it")+CE+y.id,void 0);return qs(t,m),tS(t,{Fragment:w.Fragment,components:o,ignoreInvalidStyle:!0,jsx:w.jsx,jsxs:w.jsxs,passKeys:!0,passNode:!0});function m(y,g,x){if(y.type==="raw"&&x&&typeof g=="number")return c?x.children.splice(g,1):x.children[g]={type:"text",value:y.value},g;if(y.type==="element"){let b;for(b in zs)if(Object.hasOwn(zs,b)&&Object.hasOwn(y.properties,b)){const k=y.properties[b],D=zs[b];(D===null||D.includes(y.tagName))&&(y.properties[b]=p(String(k||""),b,y))}}if(y.type==="element"){let b=a?!a.includes(y.tagName):s?s.includes(y.tagName):!1;if(!b&&i&&typeof g=="number"&&(b=!i(y,g,x)),b&&x&&typeof g=="number")return h&&y.children?x.children.splice(g,1,...y.children):x.children.splice(g,1),g}}}function OE(t){const r=t.indexOf(":"),a=t.indexOf("?"),i=t.indexOf("#"),o=t.indexOf("/");return r===-1||o!==-1&&r>o||a!==-1&&r>a||i!==-1&&r>i||TE.test(t.slice(0,r))?t:""}function op(t,r){const a=String(t);if(typeof r!="string")throw new TypeError("Expected character");let i=0,o=a.indexOf(r);for(;o!==-1;)i++,o=a.indexOf(r,o+r.length);return i}function NE(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function _E(t,r,a){const o=pu((a||{}).ignore||[]),s=jE(r);let c=-1;for(;++c<s.length;)Pm(t,"text",h);function h(m,y){let g=-1,x;for(;++g<y.length;){const b=y[g],k=x?x.children:void 0;if(o(b,k?k.indexOf(b):void 0,x))return;x=b}if(x)return p(m,y)}function p(m,y){const g=y[y.length-1],x=s[c][0],b=s[c][1];let k=0;const N=g.children.indexOf(m);let R=!1,_=[];x.lastIndex=0;let H=x.exec(m.value);for(;H;){const ie=H.index,K={index:H.index,input:H.input,stack:[...y,m]};let q=b(...H,K);if(typeof q=="string"&&(q=q.length>0?{type:"text",value:q}:void 0),q===!1?x.lastIndex=ie+1:(k!==ie&&_.push({type:"text",value:m.value.slice(k,ie)}),Array.isArray(q)?_.push(...q):q&&_.push(q),k=ie+H[0].length,R=!0),!x.global)break;H=x.exec(m.value)}return R?(k<m.value.length&&_.push({type:"text",value:m.value.slice(k)}),g.children.splice(N,1,..._)):_=[m],N+_.length}}function jE(t){const r=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const a=!t[0]||Array.isArray(t[0])?t:[t];let i=-1;for(;++i<a.length;){const o=a[i];r.push([LE(o[0]),UE(o[1])])}return r}function LE(t){return typeof t=="string"?new RegExp(NE(t),"g"):t}function UE(t){return typeof t=="function"?t:function(){return t}}const Ws="phrasing",ec=["autolink","link","image","label"];function BE(){return{transforms:[XE],enter:{literalAutolink:qE,literalAutolinkEmail:tc,literalAutolinkHttp:tc,literalAutolinkWww:tc},exit:{literalAutolink:GE,literalAutolinkEmail:FE,literalAutolinkHttp:YE,literalAutolinkWww:VE}}}function HE(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Ws,notInConstruct:ec},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Ws,notInConstruct:ec},{character:":",before:"[ps]",after:"\\/",inConstruct:Ws,notInConstruct:ec}]}}function qE(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function tc(t){this.config.enter.autolinkProtocol.call(this,t)}function YE(t){this.config.exit.autolinkProtocol.call(this,t)}function VE(t){this.config.exit.data.call(this,t);const r=this.stack[this.stack.length-1];r.type,r.url="http://"+this.sliceSerialize(t)}function FE(t){this.config.exit.autolinkEmail.call(this,t)}function GE(t){this.exit(t)}function XE(t){_E(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,QE],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),ZE]],{ignore:["link","linkReference"]})}function QE(t,r,a,i,o){let s="";if(!sp(o)||(/^w/i.test(r)&&(a=r+a,r="",s="http://"),!KE(a)))return!1;const c=IE(a+i);if(!c[0])return!1;const h={type:"link",title:null,url:s+r+c[0],children:[{type:"text",value:r+c[0]}]};return c[1]?[h,{type:"text",value:c[1]}]:h}function ZE(t,r,a,i){return!sp(i,!0)||/[-\d_]$/.test(a)?!1:{type:"link",title:null,url:"mailto:"+r+"@"+a,children:[{type:"text",value:r+"@"+a}]}}function KE(t){const r=t.split(".");return!(r.length<2||r[r.length-1]&&(/_/.test(r[r.length-1])||!/[a-zA-Z\d]/.test(r[r.length-1]))||r[r.length-2]&&(/_/.test(r[r.length-2])||!/[a-zA-Z\d]/.test(r[r.length-2])))}function IE(t){const r=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!r)return[t,void 0];t=t.slice(0,r.index);let a=r[0],i=a.indexOf(")");const o=op(t,"(");let s=op(t,")");for(;i!==-1&&o>s;)t+=a.slice(0,i+1),a=a.slice(i+1),i=a.indexOf(")"),s++;return[t,a]}function sp(t,r){const a=t.input.charCodeAt(t.index-1);return(t.index===0||hr(a)||uu(a))&&(!r||a!==47)}cp.peek=rk;function JE(){this.buffer()}function PE(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function $E(){this.buffer()}function WE(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function ek(t){const r=this.resume(),a=this.stack[this.stack.length-1];a.type,a.identifier=Ln(this.sliceSerialize(t)).toLowerCase(),a.label=r}function tk(t){this.exit(t)}function nk(t){const r=this.resume(),a=this.stack[this.stack.length-1];a.type,a.identifier=Ln(this.sliceSerialize(t)).toLowerCase(),a.label=r}function lk(t){this.exit(t)}function rk(){return"["}function cp(t,r,a,i){const o=a.createTracker(i);let s=o.move("[^");const c=a.enter("footnoteReference"),h=a.enter("reference");return s+=o.move(a.safe(a.associationId(t),{after:"]",before:s})),h(),c(),s+=o.move("]"),s}function ak(){return{enter:{gfmFootnoteCallString:JE,gfmFootnoteCall:PE,gfmFootnoteDefinitionLabelString:$E,gfmFootnoteDefinition:WE},exit:{gfmFootnoteCallString:ek,gfmFootnoteCall:tk,gfmFootnoteDefinitionLabelString:nk,gfmFootnoteDefinition:lk}}}function ik(t){let r=!1;return t&&t.firstLineBlank&&(r=!0),{handlers:{footnoteDefinition:a,footnoteReference:cp},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function a(i,o,s,c){const h=s.createTracker(c);let p=h.move("[^");const m=s.enter("footnoteDefinition"),y=s.enter("label");return p+=h.move(s.safe(s.associationId(i),{before:p,after:"]"})),y(),p+=h.move("]:"),i.children&&i.children.length>0&&(h.shift(4),p+=h.move((r?`
`:" ")+s.indentLines(s.containerFlow(i,h.current()),r?fp:uk))),m(),p}}function uk(t,r,a){return r===0?t:fp(t,r,a)}function fp(t,r,a){return(a?"":"    ")+t}const ok=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];dp.peek=hk;function sk(){return{canContainEols:["delete"],enter:{strikethrough:fk},exit:{strikethrough:dk}}}function ck(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:ok}],handlers:{delete:dp}}}function fk(t){this.enter({type:"delete",children:[]},t)}function dk(t){this.exit(t)}function dp(t,r,a,i){const o=a.createTracker(i),s=a.enter("strikethrough");let c=o.move("~~");return c+=a.containerPhrasing(t,{...o.current(),before:c,after:"~"}),c+=o.move("~~"),s(),c}function hk(){return"~"}function mk(t){return t.length}function pk(t,r){const a=r||{},i=(a.align||[]).concat(),o=a.stringLength||mk,s=[],c=[],h=[],p=[];let m=0,y=-1;for(;++y<t.length;){const D=[],N=[];let R=-1;for(t[y].length>m&&(m=t[y].length);++R<t[y].length;){const _=gk(t[y][R]);if(a.alignDelimiters!==!1){const H=o(_);N[R]=H,(p[R]===void 0||H>p[R])&&(p[R]=H)}D.push(_)}c[y]=D,h[y]=N}let g=-1;if(typeof i=="object"&&"length"in i)for(;++g<m;)s[g]=hp(i[g]);else{const D=hp(i);for(;++g<m;)s[g]=D}g=-1;const x=[],b=[];for(;++g<m;){const D=s[g];let N="",R="";D===99?(N=":",R=":"):D===108?N=":":D===114&&(R=":");let _=a.alignDelimiters===!1?1:Math.max(1,p[g]-N.length-R.length);const H=N+"-".repeat(_)+R;a.alignDelimiters!==!1&&(_=N.length+_+R.length,_>p[g]&&(p[g]=_),b[g]=_),x[g]=H}c.splice(1,0,x),h.splice(1,0,b),y=-1;const k=[];for(;++y<c.length;){const D=c[y],N=h[y];g=-1;const R=[];for(;++g<m;){const _=D[g]||"";let H="",ie="";if(a.alignDelimiters!==!1){const K=p[g]-(N[g]||0),q=s[g];q===114?H=" ".repeat(K):q===99?K%2?(H=" ".repeat(K/2+.5),ie=" ".repeat(K/2-.5)):(H=" ".repeat(K/2),ie=H):ie=" ".repeat(K)}a.delimiterStart!==!1&&!g&&R.push("|"),a.padding!==!1&&!(a.alignDelimiters===!1&&_==="")&&(a.delimiterStart!==!1||g)&&R.push(" "),a.alignDelimiters!==!1&&R.push(H),R.push(_),a.alignDelimiters!==!1&&R.push(ie),a.padding!==!1&&R.push(" "),(a.delimiterEnd!==!1||g!==m-1)&&R.push("|")}k.push(a.delimiterEnd===!1?R.join("").replace(/ +$/,""):R.join(""))}return k.join(`
`)}function gk(t){return t==null?"":String(t)}function hp(t){const r=typeof t=="string"?t.codePointAt(0):0;return r===67||r===99?99:r===76||r===108?108:r===82||r===114?114:0}function yk(t,r,a,i){const o=a.enter("blockquote"),s=a.createTracker(i);s.move("> "),s.shift(2);const c=a.indentLines(a.containerFlow(t,s.current()),vk);return o(),c}function vk(t,r,a){return">"+(a?"":" ")+t}function bk(t,r){return mp(t,r.inConstruct,!0)&&!mp(t,r.notInConstruct,!1)}function mp(t,r,a){if(typeof r=="string"&&(r=[r]),!r||r.length===0)return a;let i=-1;for(;++i<r.length;)if(t.includes(r[i]))return!0;return!1}function pp(t,r,a,i){let o=-1;for(;++o<a.unsafe.length;)if(a.unsafe[o].character===`
`&&bk(a.stack,a.unsafe[o]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function xk(t,r){const a=String(t);let i=a.indexOf(r),o=i,s=0,c=0;if(typeof r!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===o?++s>c&&(c=s):s=1,o=i+r.length,i=a.indexOf(r,o);return c}function Sk(t,r){return!!(r.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function wk(t){const r=t.options.fence||"`";if(r!=="`"&&r!=="~")throw new Error("Cannot serialize code with `"+r+"` for `options.fence`, expected `` ` `` or `~`");return r}function Ek(t,r,a,i){const o=wk(a),s=t.value||"",c=o==="`"?"GraveAccent":"Tilde";if(Sk(t,a)){const g=a.enter("codeIndented"),x=a.indentLines(s,kk);return g(),x}const h=a.createTracker(i),p=o.repeat(Math.max(xk(s,o)+1,3)),m=a.enter("codeFenced");let y=h.move(p);if(t.lang){const g=a.enter(`codeFencedLang${c}`);y+=h.move(a.safe(t.lang,{before:y,after:" ",encode:["`"],...h.current()})),g()}if(t.lang&&t.meta){const g=a.enter(`codeFencedMeta${c}`);y+=h.move(" "),y+=h.move(a.safe(t.meta,{before:y,after:`
`,encode:["`"],...h.current()})),g()}return y+=h.move(`
`),s&&(y+=h.move(s+`
`)),y+=h.move(p),m(),y}function kk(t,r,a){return(a?"":"    ")+t}function nc(t){const r=t.options.quote||'"';if(r!=='"'&&r!=="'")throw new Error("Cannot serialize title with `"+r+"` for `options.quote`, expected `\"`, or `'`");return r}function Ck(t,r,a,i){const o=nc(a),s=o==='"'?"Quote":"Apostrophe",c=a.enter("definition");let h=a.enter("label");const p=a.createTracker(i);let m=p.move("[");return m+=p.move(a.safe(a.associationId(t),{before:m,after:"]",...p.current()})),m+=p.move("]: "),h(),!t.url||/[\0- \u007F]/.test(t.url)?(h=a.enter("destinationLiteral"),m+=p.move("<"),m+=p.move(a.safe(t.url,{before:m,after:">",...p.current()})),m+=p.move(">")):(h=a.enter("destinationRaw"),m+=p.move(a.safe(t.url,{before:m,after:t.title?" ":`
`,...p.current()}))),h(),t.title&&(h=a.enter(`title${s}`),m+=p.move(" "+o),m+=p.move(a.safe(t.title,{before:m,after:o,...p.current()})),m+=p.move(o),h()),c(),m}function Tk(t){const r=t.options.emphasis||"*";if(r!=="*"&&r!=="_")throw new Error("Cannot serialize emphasis with `"+r+"` for `options.emphasis`, expected `*`, or `_`");return r}function ri(t){return"&#x"+t.toString(16).toUpperCase()+";"}function vu(t,r,a){const i=Zr(t),o=Zr(r);return i===void 0?o===void 0?a==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:o===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?o===void 0?{inside:!1,outside:!1}:o===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:o===void 0?{inside:!1,outside:!1}:o===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}gp.peek=zk;function gp(t,r,a,i){const o=Tk(a),s=a.enter("emphasis"),c=a.createTracker(i),h=c.move(o);let p=c.move(a.containerPhrasing(t,{after:o,before:h,...c.current()}));const m=p.charCodeAt(0),y=vu(i.before.charCodeAt(i.before.length-1),m,o);y.inside&&(p=ri(m)+p.slice(1));const g=p.charCodeAt(p.length-1),x=vu(i.after.charCodeAt(0),g,o);x.inside&&(p=p.slice(0,-1)+ri(g));const b=c.move(o);return s(),a.attentionEncodeSurroundingInfo={after:x.outside,before:y.outside},h+p+b}function zk(t,r,a){return a.options.emphasis||"*"}function Ak(t,r){let a=!1;return qs(t,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return a=!0,Hs}),!!((!t.depth||t.depth<3)&&As(t)&&(r.options.setext||a))}function Rk(t,r,a,i){const o=Math.max(Math.min(6,t.depth||1),1),s=a.createTracker(i);if(Ak(t,a)){const y=a.enter("headingSetext"),g=a.enter("phrasing"),x=a.containerPhrasing(t,{...s.current(),before:`
`,after:`
`});return g(),y(),x+`
`+(o===1?"=":"-").repeat(x.length-(Math.max(x.lastIndexOf("\r"),x.lastIndexOf(`
`))+1))}const c="#".repeat(o),h=a.enter("headingAtx"),p=a.enter("phrasing");s.move(c+" ");let m=a.containerPhrasing(t,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(m)&&(m=ri(m.charCodeAt(0))+m.slice(1)),m=m?c+" "+m:c,a.options.closeAtx&&(m+=" "+c),p(),h(),m}yp.peek=Dk;function yp(t){return t.value||""}function Dk(){return"<"}vp.peek=Mk;function vp(t,r,a,i){const o=nc(a),s=o==='"'?"Quote":"Apostrophe",c=a.enter("image");let h=a.enter("label");const p=a.createTracker(i);let m=p.move("![");return m+=p.move(a.safe(t.alt,{before:m,after:"]",...p.current()})),m+=p.move("]("),h(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(h=a.enter("destinationLiteral"),m+=p.move("<"),m+=p.move(a.safe(t.url,{before:m,after:">",...p.current()})),m+=p.move(">")):(h=a.enter("destinationRaw"),m+=p.move(a.safe(t.url,{before:m,after:t.title?" ":")",...p.current()}))),h(),t.title&&(h=a.enter(`title${s}`),m+=p.move(" "+o),m+=p.move(a.safe(t.title,{before:m,after:o,...p.current()})),m+=p.move(o),h()),m+=p.move(")"),c(),m}function Mk(){return"!"}bp.peek=Ok;function bp(t,r,a,i){const o=t.referenceType,s=a.enter("imageReference");let c=a.enter("label");const h=a.createTracker(i);let p=h.move("![");const m=a.safe(t.alt,{before:p,after:"]",...h.current()});p+=h.move(m+"]["),c();const y=a.stack;a.stack=[],c=a.enter("reference");const g=a.safe(a.associationId(t),{before:p,after:"]",...h.current()});return c(),a.stack=y,s(),o==="full"||!m||m!==g?p+=h.move(g+"]"):o==="shortcut"?p=p.slice(0,-1):p+=h.move("]"),p}function Ok(){return"!"}xp.peek=Nk;function xp(t,r,a){let i=t.value||"",o="`",s=-1;for(;new RegExp("(^|[^`])"+o+"([^`]|$)").test(i);)o+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++s<a.unsafe.length;){const c=a.unsafe[s],h=a.compilePattern(c);let p;if(c.atBreak)for(;p=h.exec(i);){let m=p.index;i.charCodeAt(m)===10&&i.charCodeAt(m-1)===13&&m--,i=i.slice(0,m)+" "+i.slice(p.index+1)}}return o+i+o}function Nk(){return"`"}function Sp(t,r){const a=As(t);return!!(!r.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(a===t.url||"mailto:"+a===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}wp.peek=_k;function wp(t,r,a,i){const o=nc(a),s=o==='"'?"Quote":"Apostrophe",c=a.createTracker(i);let h,p;if(Sp(t,a)){const y=a.stack;a.stack=[],h=a.enter("autolink");let g=c.move("<");return g+=c.move(a.containerPhrasing(t,{before:g,after:">",...c.current()})),g+=c.move(">"),h(),a.stack=y,g}h=a.enter("link"),p=a.enter("label");let m=c.move("[");return m+=c.move(a.containerPhrasing(t,{before:m,after:"](",...c.current()})),m+=c.move("]("),p(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(p=a.enter("destinationLiteral"),m+=c.move("<"),m+=c.move(a.safe(t.url,{before:m,after:">",...c.current()})),m+=c.move(">")):(p=a.enter("destinationRaw"),m+=c.move(a.safe(t.url,{before:m,after:t.title?" ":")",...c.current()}))),p(),t.title&&(p=a.enter(`title${s}`),m+=c.move(" "+o),m+=c.move(a.safe(t.title,{before:m,after:o,...c.current()})),m+=c.move(o),p()),m+=c.move(")"),h(),m}function _k(t,r,a){return Sp(t,a)?"<":"["}Ep.peek=jk;function Ep(t,r,a,i){const o=t.referenceType,s=a.enter("linkReference");let c=a.enter("label");const h=a.createTracker(i);let p=h.move("[");const m=a.containerPhrasing(t,{before:p,after:"]",...h.current()});p+=h.move(m+"]["),c();const y=a.stack;a.stack=[],c=a.enter("reference");const g=a.safe(a.associationId(t),{before:p,after:"]",...h.current()});return c(),a.stack=y,s(),o==="full"||!m||m!==g?p+=h.move(g+"]"):o==="shortcut"?p=p.slice(0,-1):p+=h.move("]"),p}function jk(){return"["}function lc(t){const r=t.options.bullet||"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bullet`, expected `*`, `+`, or `-`");return r}function Lk(t){const r=lc(t),a=t.options.bulletOther;if(!a)return r==="*"?"-":"*";if(a!=="*"&&a!=="+"&&a!=="-")throw new Error("Cannot serialize items with `"+a+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(a===r)throw new Error("Expected `bullet` (`"+r+"`) and `bulletOther` (`"+a+"`) to be different");return a}function Uk(t){const r=t.options.bulletOrdered||".";if(r!=="."&&r!==")")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOrdered`, expected `.` or `)`");return r}function kp(t){const r=t.options.rule||"*";if(r!=="*"&&r!=="-"&&r!=="_")throw new Error("Cannot serialize rules with `"+r+"` for `options.rule`, expected `*`, `-`, or `_`");return r}function Bk(t,r,a,i){const o=a.enter("list"),s=a.bulletCurrent;let c=t.ordered?Uk(a):lc(a);const h=t.ordered?c==="."?")":".":Lk(a);let p=r&&a.bulletLastUsed?c===a.bulletLastUsed:!1;if(!t.ordered){const y=t.children?t.children[0]:void 0;if((c==="*"||c==="-")&&y&&(!y.children||!y.children[0])&&a.stack[a.stack.length-1]==="list"&&a.stack[a.stack.length-2]==="listItem"&&a.stack[a.stack.length-3]==="list"&&a.stack[a.stack.length-4]==="listItem"&&a.indexStack[a.indexStack.length-1]===0&&a.indexStack[a.indexStack.length-2]===0&&a.indexStack[a.indexStack.length-3]===0&&(p=!0),kp(a)===c&&y){let g=-1;for(;++g<t.children.length;){const x=t.children[g];if(x&&x.type==="listItem"&&x.children&&x.children[0]&&x.children[0].type==="thematicBreak"){p=!0;break}}}}p&&(c=h),a.bulletCurrent=c;const m=a.containerFlow(t,i);return a.bulletLastUsed=c,a.bulletCurrent=s,o(),m}function Hk(t){const r=t.options.listItemIndent||"one";if(r!=="tab"&&r!=="one"&&r!=="mixed")throw new Error("Cannot serialize items with `"+r+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return r}function qk(t,r,a,i){const o=Hk(a);let s=a.bulletCurrent||lc(a);r&&r.type==="list"&&r.ordered&&(s=(typeof r.start=="number"&&r.start>-1?r.start:1)+(a.options.incrementListMarker===!1?0:r.children.indexOf(t))+s);let c=s.length+1;(o==="tab"||o==="mixed"&&(r&&r.type==="list"&&r.spread||t.spread))&&(c=Math.ceil(c/4)*4);const h=a.createTracker(i);h.move(s+" ".repeat(c-s.length)),h.shift(c);const p=a.enter("listItem"),m=a.indentLines(a.containerFlow(t,h.current()),y);return p(),m;function y(g,x,b){return x?(b?"":" ".repeat(c))+g:(b?s:s+" ".repeat(c-s.length))+g}}function Yk(t,r,a,i){const o=a.enter("paragraph"),s=a.enter("phrasing"),c=a.containerPhrasing(t,i);return s(),o(),c}const Vk=pu(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Fk(t,r,a,i){return(t.children.some(function(c){return Vk(c)})?a.containerPhrasing:a.containerFlow).call(a,t,i)}function Gk(t){const r=t.options.strong||"*";if(r!=="*"&&r!=="_")throw new Error("Cannot serialize strong with `"+r+"` for `options.strong`, expected `*`, or `_`");return r}Cp.peek=Xk;function Cp(t,r,a,i){const o=Gk(a),s=a.enter("strong"),c=a.createTracker(i),h=c.move(o+o);let p=c.move(a.containerPhrasing(t,{after:o,before:h,...c.current()}));const m=p.charCodeAt(0),y=vu(i.before.charCodeAt(i.before.length-1),m,o);y.inside&&(p=ri(m)+p.slice(1));const g=p.charCodeAt(p.length-1),x=vu(i.after.charCodeAt(0),g,o);x.inside&&(p=p.slice(0,-1)+ri(g));const b=c.move(o+o);return s(),a.attentionEncodeSurroundingInfo={after:x.outside,before:y.outside},h+p+b}function Xk(t,r,a){return a.options.strong||"*"}function Qk(t,r,a,i){return a.safe(t.value,i)}function Zk(t){const r=t.options.ruleRepetition||3;if(r<3)throw new Error("Cannot serialize rules with repetition `"+r+"` for `options.ruleRepetition`, expected `3` or more");return r}function Kk(t,r,a){const i=(kp(a)+(a.options.ruleSpaces?" ":"")).repeat(Zk(a));return a.options.ruleSpaces?i.slice(0,-1):i}const Tp={blockquote:yk,break:pp,code:Ek,definition:Ck,emphasis:gp,hardBreak:pp,heading:Rk,html:yp,image:vp,imageReference:bp,inlineCode:xp,link:wp,linkReference:Ep,list:Bk,listItem:qk,paragraph:Yk,root:Fk,strong:Cp,text:Qk,thematicBreak:Kk};function Ik(){return{enter:{table:Jk,tableData:zp,tableHeader:zp,tableRow:$k},exit:{codeText:Wk,table:Pk,tableData:rc,tableHeader:rc,tableRow:rc}}}function Jk(t){const r=t._align;this.enter({type:"table",align:r.map(function(a){return a==="none"?null:a}),children:[]},t),this.data.inTable=!0}function Pk(t){this.exit(t),this.data.inTable=void 0}function $k(t){this.enter({type:"tableRow",children:[]},t)}function rc(t){this.exit(t)}function zp(t){this.enter({type:"tableCell",children:[]},t)}function Wk(t){let r=this.resume();this.data.inTable&&(r=r.replace(/\\([\\|])/g,eC));const a=this.stack[this.stack.length-1];a.type,a.value=r,this.exit(t)}function eC(t,r){return r==="|"?r:t}function tC(t){const r=t||{},a=r.tableCellPadding,i=r.tablePipeAlign,o=r.stringLength,s=a?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:x,table:c,tableCell:p,tableRow:h}};function c(b,k,D,N){return m(y(b,D,N),b.align)}function h(b,k,D,N){const R=g(b,D,N),_=m([R]);return _.slice(0,_.indexOf(`
`))}function p(b,k,D,N){const R=D.enter("tableCell"),_=D.enter("phrasing"),H=D.containerPhrasing(b,{...N,before:s,after:s});return _(),R(),H}function m(b,k){return pk(b,{align:k,alignDelimiters:i,padding:a,stringLength:o})}function y(b,k,D){const N=b.children;let R=-1;const _=[],H=k.enter("table");for(;++R<N.length;)_[R]=g(N[R],k,D);return H(),_}function g(b,k,D){const N=b.children;let R=-1;const _=[],H=k.enter("tableRow");for(;++R<N.length;)_[R]=p(N[R],b,k,D);return H(),_}function x(b,k,D){let N=Tp.inlineCode(b,k,D);return D.stack.includes("tableCell")&&(N=N.replace(/\|/g,"\\$&")),N}}function nC(){return{exit:{taskListCheckValueChecked:Ap,taskListCheckValueUnchecked:Ap,paragraph:rC}}}function lC(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:aC}}}function Ap(t){const r=this.stack[this.stack.length-2];r.type,r.checked=t.type==="taskListCheckValueChecked"}function rC(t){const r=this.stack[this.stack.length-2];if(r&&r.type==="listItem"&&typeof r.checked=="boolean"){const a=this.stack[this.stack.length-1];a.type;const i=a.children[0];if(i&&i.type==="text"){const o=r.children;let s=-1,c;for(;++s<o.length;){const h=o[s];if(h.type==="paragraph"){c=h;break}}c===a&&(i.value=i.value.slice(1),i.value.length===0?a.children.shift():a.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,a.position.start=Object.assign({},i.position.start)))}}this.exit(t)}function aC(t,r,a,i){const o=t.children[0],s=typeof t.checked=="boolean"&&o&&o.type==="paragraph",c="["+(t.checked?"x":" ")+"] ",h=a.createTracker(i);s&&h.move(c);let p=Tp.listItem(t,r,a,{...i,...h.current()});return s&&(p=p.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,m)),p;function m(y){return y+c}}function iC(){return[BE(),ak(),sk(),Ik(),nC()]}function uC(t){return{extensions:[HE(),ik(t),ck(),tC(t),lC()]}}const oC={tokenize:mC,partial:!0},Rp={tokenize:pC,partial:!0},Dp={tokenize:gC,partial:!0},Mp={tokenize:yC,partial:!0},sC={tokenize:vC,partial:!0},Op={name:"wwwAutolink",tokenize:dC,previous:_p},Np={name:"protocolAutolink",tokenize:hC,previous:jp},rl={name:"emailAutolink",tokenize:fC,previous:Lp},In={};function cC(){return{text:In}}let mr=48;for(;mr<123;)In[mr]=rl,mr++,mr===58?mr=65:mr===91&&(mr=97);In[43]=rl,In[45]=rl,In[46]=rl,In[95]=rl,In[72]=[rl,Np],In[104]=[rl,Np],In[87]=[rl,Op],In[119]=[rl,Op];function fC(t,r,a){const i=this;let o,s;return c;function c(g){return!ac(g)||!Lp.call(i,i.previous)||ic(i.events)?a(g):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),h(g))}function h(g){return ac(g)?(t.consume(g),h):g===64?(t.consume(g),p):a(g)}function p(g){return g===46?t.check(sC,y,m)(g):g===45||g===95||Gt(g)?(s=!0,t.consume(g),p):y(g)}function m(g){return t.consume(g),o=!0,p}function y(g){return s&&o&&Xt(i.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),r(g)):a(g)}}function dC(t,r,a){const i=this;return o;function o(c){return c!==87&&c!==119||!_p.call(i,i.previous)||ic(i.events)?a(c):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(oC,t.attempt(Rp,t.attempt(Dp,s),a),a)(c))}function s(c){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),r(c)}}function hC(t,r,a){const i=this;let o="",s=!1;return c;function c(g){return(g===72||g===104)&&jp.call(i,i.previous)&&!ic(i.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),o+=String.fromCodePoint(g),t.consume(g),h):a(g)}function h(g){if(Xt(g)&&o.length<5)return o+=String.fromCodePoint(g),t.consume(g),h;if(g===58){const x=o.toLowerCase();if(x==="http"||x==="https")return t.consume(g),p}return a(g)}function p(g){return g===47?(t.consume(g),s?m:(s=!0,p)):a(g)}function m(g){return g===null||iu(g)||ot(g)||hr(g)||uu(g)?a(g):t.attempt(Rp,t.attempt(Dp,y),a)(g)}function y(g){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),r(g)}}function mC(t,r,a){let i=0;return o;function o(c){return(c===87||c===119)&&i<3?(i++,t.consume(c),o):c===46&&i===3?(t.consume(c),s):a(c)}function s(c){return c===null?a(c):r(c)}}function pC(t,r,a){let i,o,s;return c;function c(m){return m===46||m===95?t.check(Mp,p,h)(m):m===null||ot(m)||hr(m)||m!==45&&uu(m)?p(m):(s=!0,t.consume(m),c)}function h(m){return m===95?i=!0:(o=i,i=void 0),t.consume(m),c}function p(m){return o||i||!s?a(m):r(m)}}function gC(t,r){let a=0,i=0;return o;function o(c){return c===40?(a++,t.consume(c),o):c===41&&i<a?s(c):c===33||c===34||c===38||c===39||c===41||c===42||c===44||c===46||c===58||c===59||c===60||c===63||c===93||c===95||c===126?t.check(Mp,r,s)(c):c===null||ot(c)||hr(c)?r(c):(t.consume(c),o)}function s(c){return c===41&&i++,t.consume(c),o}}function yC(t,r,a){return i;function i(h){return h===33||h===34||h===39||h===41||h===42||h===44||h===46||h===58||h===59||h===63||h===95||h===126?(t.consume(h),i):h===38?(t.consume(h),s):h===93?(t.consume(h),o):h===60||h===null||ot(h)||hr(h)?r(h):a(h)}function o(h){return h===null||h===40||h===91||ot(h)||hr(h)?r(h):i(h)}function s(h){return Xt(h)?c(h):a(h)}function c(h){return h===59?(t.consume(h),i):Xt(h)?(t.consume(h),c):a(h)}}function vC(t,r,a){return i;function i(s){return t.consume(s),o}function o(s){return Gt(s)?a(s):r(s)}}function _p(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||ot(t)}function jp(t){return!Xt(t)}function Lp(t){return!(t===47||ac(t))}function ac(t){return t===43||t===45||t===46||t===95||Gt(t)}function ic(t){let r=t.length,a=!1;for(;r--;){const i=t[r][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){a=!0;break}if(i._gfmAutolinkLiteralWalkedInto){a=!1;break}}return t.length>0&&!a&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),a}const bC={tokenize:zC,partial:!0};function xC(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:kC,continuation:{tokenize:CC},exit:TC}},text:{91:{name:"gfmFootnoteCall",tokenize:EC},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:SC,resolveTo:wC}}}}function SC(t,r,a){const i=this;let o=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let c;for(;o--;){const p=i.events[o][1];if(p.type==="labelImage"){c=p;break}if(p.type==="gfmFootnoteCall"||p.type==="labelLink"||p.type==="label"||p.type==="image"||p.type==="link")break}return h;function h(p){if(!c||!c._balanced)return a(p);const m=Ln(i.sliceSerialize({start:c.end,end:i.now()}));return m.codePointAt(0)!==94||!s.includes(m.slice(1))?a(p):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(p),t.exit("gfmFootnoteCallLabelMarker"),r(p))}}function wC(t,r){let a=t.length;for(;a--;)if(t[a][1].type==="labelImage"&&t[a][0]==="enter"){t[a][1];break}t[a+1][1].type="data",t[a+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},t[a+3][1].start),end:Object.assign({},t[t.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},t[a+3][1].end),end:Object.assign({},t[a+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},t[t.length-1][1].start)},c={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},h=[t[a+1],t[a+2],["enter",i,r],t[a+3],t[a+4],["enter",o,r],["exit",o,r],["enter",s,r],["enter",c,r],["exit",c,r],["exit",s,r],t[t.length-2],t[t.length-1],["exit",i,r]];return t.splice(a,t.length-a+1,...h),t}function EC(t,r,a){const i=this,o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,c;return h;function h(g){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(g),t.exit("gfmFootnoteCallLabelMarker"),p}function p(g){return g!==94?a(g):(t.enter("gfmFootnoteCallMarker"),t.consume(g),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",m)}function m(g){if(s>999||g===93&&!c||g===null||g===91||ot(g))return a(g);if(g===93){t.exit("chunkString");const x=t.exit("gfmFootnoteCallString");return o.includes(Ln(i.sliceSerialize(x)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(g),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),r):a(g)}return ot(g)||(c=!0),s++,t.consume(g),g===92?y:m}function y(g){return g===91||g===92||g===93?(t.consume(g),s++,m):m(g)}}function kC(t,r,a){const i=this,o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,c=0,h;return p;function p(k){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(k),t.exit("gfmFootnoteDefinitionLabelMarker"),m}function m(k){return k===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(k),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",y):a(k)}function y(k){if(c>999||k===93&&!h||k===null||k===91||ot(k))return a(k);if(k===93){t.exit("chunkString");const D=t.exit("gfmFootnoteDefinitionLabelString");return s=Ln(i.sliceSerialize(D)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(k),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),x}return ot(k)||(h=!0),c++,t.consume(k),k===92?g:y}function g(k){return k===91||k===92||k===93?(t.consume(k),c++,y):y(k)}function x(k){return k===58?(t.enter("definitionMarker"),t.consume(k),t.exit("definitionMarker"),o.includes(s)||o.push(s),Ke(t,b,"gfmFootnoteDefinitionWhitespace")):a(k)}function b(k){return r(k)}}function CC(t,r,a){return t.check($a,r,t.attempt(bC,r,a))}function TC(t){t.exit("gfmFootnoteDefinition")}function zC(t,r,a){const i=this;return Ke(t,o,"gfmFootnoteDefinitionIndent",5);function o(s){const c=i.events[i.events.length-1];return c&&c[1].type==="gfmFootnoteDefinitionIndent"&&c[2].sliceSerialize(c[1],!0).length===4?r(s):a(s)}}function AC(t){let a=(t||{}).singleTilde;const i={name:"strikethrough",tokenize:s,resolveAll:o};return a==null&&(a=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function o(c,h){let p=-1;for(;++p<c.length;)if(c[p][0]==="enter"&&c[p][1].type==="strikethroughSequenceTemporary"&&c[p][1]._close){let m=p;for(;m--;)if(c[m][0]==="exit"&&c[m][1].type==="strikethroughSequenceTemporary"&&c[m][1]._open&&c[p][1].end.offset-c[p][1].start.offset===c[m][1].end.offset-c[m][1].start.offset){c[p][1].type="strikethroughSequence",c[m][1].type="strikethroughSequence";const y={type:"strikethrough",start:Object.assign({},c[m][1].start),end:Object.assign({},c[p][1].end)},g={type:"strikethroughText",start:Object.assign({},c[m][1].end),end:Object.assign({},c[p][1].start)},x=[["enter",y,h],["enter",c[m][1],h],["exit",c[m][1],h],["enter",g,h]],b=h.parser.constructs.insideSpan.null;b&&sn(x,x.length,0,ou(b,c.slice(m+1,p),h)),sn(x,x.length,0,[["exit",g,h],["enter",c[p][1],h],["exit",c[p][1],h],["exit",y,h]]),sn(c,m-1,p-m+3,x),p=m+x.length-2;break}}for(p=-1;++p<c.length;)c[p][1].type==="strikethroughSequenceTemporary"&&(c[p][1].type="data");return c}function s(c,h,p){const m=this.previous,y=this.events;let g=0;return x;function x(k){return m===126&&y[y.length-1][1].type!=="characterEscape"?p(k):(c.enter("strikethroughSequenceTemporary"),b(k))}function b(k){const D=Zr(m);if(k===126)return g>1?p(k):(c.consume(k),g++,b);if(g<2&&!a)return p(k);const N=c.exit("strikethroughSequenceTemporary"),R=Zr(k);return N._open=!R||R===2&&!!D,N._close=!D||D===2&&!!R,h(k)}}}class RC{constructor(){this.map=[]}add(r,a,i){DC(this,r,a,i)}consume(r){if(this.map.sort(function(s,c){return s[0]-c[0]}),this.map.length===0)return;let a=this.map.length;const i=[];for(;a>0;)a-=1,i.push(r.slice(this.map[a][0]+this.map[a][1]),this.map[a][2]),r.length=this.map[a][0];i.push(r.slice()),r.length=0;let o=i.pop();for(;o;){for(const s of o)r.push(s);o=i.pop()}this.map.length=0}}function DC(t,r,a,i){let o=0;if(!(a===0&&i.length===0)){for(;o<t.map.length;){if(t.map[o][0]===r){t.map[o][1]+=a,t.map[o][2].push(...i);return}o+=1}t.map.push([r,a,i])}}function MC(t,r){let a=!1;const i=[];for(;r<t.length;){const o=t[r];if(a){if(o[0]==="enter")o[1].type==="tableContent"&&i.push(t[r+1][1].type==="tableDelimiterMarker"?"left":"none");else if(o[1].type==="tableContent"){if(t[r-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(o[1].type==="tableDelimiterRow")break}else o[0]==="enter"&&o[1].type==="tableDelimiterRow"&&(a=!0);r+=1}return i}function OC(){return{flow:{null:{name:"table",tokenize:NC,resolveAll:_C}}}}function NC(t,r,a){const i=this;let o=0,s=0,c;return h;function h(Y){let ne=i.events.length-1;for(;ne>-1;){const he=i.events[ne][1].type;if(he==="lineEnding"||he==="linePrefix")ne--;else break}const ae=ne>-1?i.events[ne][1].type:null,Ae=ae==="tableHead"||ae==="tableRow"?q:p;return Ae===q&&i.parser.lazy[i.now().line]?a(Y):Ae(Y)}function p(Y){return t.enter("tableHead"),t.enter("tableRow"),m(Y)}function m(Y){return Y===124||(c=!0,s+=1),y(Y)}function y(Y){return Y===null?a(Y):Te(Y)?s>1?(s=0,i.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(Y),t.exit("lineEnding"),b):a(Y):Be(Y)?Ke(t,y,"whitespace")(Y):(s+=1,c&&(c=!1,o+=1),Y===124?(t.enter("tableCellDivider"),t.consume(Y),t.exit("tableCellDivider"),c=!0,y):(t.enter("data"),g(Y)))}function g(Y){return Y===null||Y===124||ot(Y)?(t.exit("data"),y(Y)):(t.consume(Y),Y===92?x:g)}function x(Y){return Y===92||Y===124?(t.consume(Y),g):g(Y)}function b(Y){return i.interrupt=!1,i.parser.lazy[i.now().line]?a(Y):(t.enter("tableDelimiterRow"),c=!1,Be(Y)?Ke(t,k,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):k(Y))}function k(Y){return Y===45||Y===58?N(Y):Y===124?(c=!0,t.enter("tableCellDivider"),t.consume(Y),t.exit("tableCellDivider"),D):K(Y)}function D(Y){return Be(Y)?Ke(t,N,"whitespace")(Y):N(Y)}function N(Y){return Y===58?(s+=1,c=!0,t.enter("tableDelimiterMarker"),t.consume(Y),t.exit("tableDelimiterMarker"),R):Y===45?(s+=1,R(Y)):Y===null||Te(Y)?ie(Y):K(Y)}function R(Y){return Y===45?(t.enter("tableDelimiterFiller"),_(Y)):K(Y)}function _(Y){return Y===45?(t.consume(Y),_):Y===58?(c=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(Y),t.exit("tableDelimiterMarker"),H):(t.exit("tableDelimiterFiller"),H(Y))}function H(Y){return Be(Y)?Ke(t,ie,"whitespace")(Y):ie(Y)}function ie(Y){return Y===124?k(Y):Y===null||Te(Y)?!c||o!==s?K(Y):(t.exit("tableDelimiterRow"),t.exit("tableHead"),r(Y)):K(Y)}function K(Y){return a(Y)}function q(Y){return t.enter("tableRow"),M(Y)}function M(Y){return Y===124?(t.enter("tableCellDivider"),t.consume(Y),t.exit("tableCellDivider"),M):Y===null||Te(Y)?(t.exit("tableRow"),r(Y)):Be(Y)?Ke(t,M,"whitespace")(Y):(t.enter("data"),le(Y))}function le(Y){return Y===null||Y===124||ot(Y)?(t.exit("data"),M(Y)):(t.consume(Y),Y===92?de:le)}function de(Y){return Y===92||Y===124?(t.consume(Y),le):le(Y)}}function _C(t,r){let a=-1,i=!0,o=0,s=[0,0,0,0],c=[0,0,0,0],h=!1,p=0,m,y,g;const x=new RC;for(;++a<t.length;){const b=t[a],k=b[1];b[0]==="enter"?k.type==="tableHead"?(h=!1,p!==0&&(Up(x,r,p,m,y),y=void 0,p=0),m={type:"table",start:Object.assign({},k.start),end:Object.assign({},k.end)},x.add(a,0,[["enter",m,r]])):k.type==="tableRow"||k.type==="tableDelimiterRow"?(i=!0,g=void 0,s=[0,0,0,0],c=[0,a+1,0,0],h&&(h=!1,y={type:"tableBody",start:Object.assign({},k.start),end:Object.assign({},k.end)},x.add(a,0,[["enter",y,r]])),o=k.type==="tableDelimiterRow"?2:y?3:1):o&&(k.type==="data"||k.type==="tableDelimiterMarker"||k.type==="tableDelimiterFiller")?(i=!1,c[2]===0&&(s[1]!==0&&(c[0]=c[1],g=bu(x,r,s,o,void 0,g),s=[0,0,0,0]),c[2]=a)):k.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(c[0]=c[1],g=bu(x,r,s,o,void 0,g)),s=c,c=[s[1],a,0,0])):k.type==="tableHead"?(h=!0,p=a):k.type==="tableRow"||k.type==="tableDelimiterRow"?(p=a,s[1]!==0?(c[0]=c[1],g=bu(x,r,s,o,a,g)):c[1]!==0&&(g=bu(x,r,c,o,a,g)),o=0):o&&(k.type==="data"||k.type==="tableDelimiterMarker"||k.type==="tableDelimiterFiller")&&(c[3]=a)}for(p!==0&&Up(x,r,p,m,y),x.consume(r.events),a=-1;++a<r.events.length;){const b=r.events[a];b[0]==="enter"&&b[1].type==="table"&&(b[1]._align=MC(r.events,a))}return t}function bu(t,r,a,i,o,s){const c=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",h="tableContent";a[0]!==0&&(s.end=Object.assign({},Ir(r.events,a[0])),t.add(a[0],0,[["exit",s,r]]));const p=Ir(r.events,a[1]);if(s={type:c,start:Object.assign({},p),end:Object.assign({},p)},t.add(a[1],0,[["enter",s,r]]),a[2]!==0){const m=Ir(r.events,a[2]),y=Ir(r.events,a[3]),g={type:h,start:Object.assign({},m),end:Object.assign({},y)};if(t.add(a[2],0,[["enter",g,r]]),i!==2){const x=r.events[a[2]],b=r.events[a[3]];if(x[1].end=Object.assign({},b[1].end),x[1].type="chunkText",x[1].contentType="text",a[3]>a[2]+1){const k=a[2]+1,D=a[3]-a[2]-1;t.add(k,D,[])}}t.add(a[3]+1,0,[["exit",g,r]])}return o!==void 0&&(s.end=Object.assign({},Ir(r.events,o)),t.add(o,0,[["exit",s,r]]),s=void 0),s}function Up(t,r,a,i,o){const s=[],c=Ir(r.events,a);o&&(o.end=Object.assign({},c),s.push(["exit",o,r])),i.end=Object.assign({},c),s.push(["exit",i,r]),t.add(a+1,0,s)}function Ir(t,r){const a=t[r],i=a[0]==="enter"?"start":"end";return a[1][i]}const jC={name:"tasklistCheck",tokenize:UC};function LC(){return{text:{91:jC}}}function UC(t,r,a){const i=this;return o;function o(p){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?a(p):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(p),t.exit("taskListCheckMarker"),s)}function s(p){return ot(p)?(t.enter("taskListCheckValueUnchecked"),t.consume(p),t.exit("taskListCheckValueUnchecked"),c):p===88||p===120?(t.enter("taskListCheckValueChecked"),t.consume(p),t.exit("taskListCheckValueChecked"),c):a(p)}function c(p){return p===93?(t.enter("taskListCheckMarker"),t.consume(p),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),h):a(p)}function h(p){return Te(p)?r(p):Be(p)?t.check({tokenize:BC},r,a)(p):a(p)}}function BC(t,r,a){return Ke(t,i,"whitespace");function i(o){return o===null?a(o):r(o)}}function HC(t){return vm([cC(),xC(),AC(t),OC(),LC()])}const qC={};function YC(t){const r=this,a=t||qC,i=r.data(),o=i.micromarkExtensions||(i.micromarkExtensions=[]),s=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),c=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);o.push(HC(a)),s.push(iC()),c.push(uC(a))}const Bp={WHEN:"bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded text-sm font-semibold",GIVEN:"bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded text-sm font-semibold",THEN:"bg-green-500/20 text-green-400 px-1.5 py-0.5 rounded text-sm font-semibold",AND:"bg-gray-500/20 text-gray-400 px-1.5 py-0.5 rounded text-sm font-semibold",MUST:"text-red-400 font-bold",SHALL:"text-red-400 font-bold",ADDED:"bg-orange-500/20 text-orange-400 px-1.5 py-0.5 rounded text-xs font-semibold",MODIFIED:"bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded text-xs font-semibold"},uc=new RegExp(`\\b(${Object.keys(Bp).join("|")})\\b`,"g");function Hp(t){const r=[];let a=0,i;for(uc.lastIndex=0;(i=uc.exec(t))!==null;){i.index>a&&r.push(t.slice(a,i.index));const o=i[1];r.push(w.jsx("span",{className:Bp[o],children:o},i.index)),a=uc.lastIndex}return a<t.length&&r.push(t.slice(a)),r}function oc(t){return typeof t=="string"?Hp(t):Array.isArray(t)?t.map((r,a)=>typeof r=="string"?w.jsx("span",{children:Hp(r)},a):r):t}function xu({content:t,specTopics:r}){return w.jsx("div",{className:"markdown-body",children:w.jsx(AE,{remarkPlugins:[YC],components:{p({children:a}){return w.jsx("p",{className:"mb-4 leading-relaxed",children:oc(a)})},li({children:a}){return w.jsx("li",{className:"mb-1",children:oc(a)})},h1({children:a}){return w.jsx("h1",{className:"text-2xl font-bold mt-6 mb-4 text-text-primary",children:a})},h2({children:a}){return w.jsx("h2",{className:"text-xl font-bold mt-6 mb-3 text-text-primary border-b border-border pb-2",children:a})},h3({children:a}){return w.jsx("h3",{className:"text-lg font-semibold mt-5 mb-2 text-text-primary",children:a})},h4({children:a}){return w.jsx("h4",{className:"text-base font-semibold mt-4 mb-2 text-text-secondary",children:a})},h5({children:a}){return w.jsx("h5",{className:"text-sm font-semibold mt-3 mb-1 text-text-secondary",children:a})},h6({children:a}){return w.jsx("h6",{className:"text-sm font-medium mt-3 mb-1 text-text-muted",children:a})},strong({children:a}){return w.jsx("strong",{className:"font-bold text-text-primary",children:oc(a)})},em({children:a}){return w.jsx("em",{className:"italic text-text-secondary",children:a})},a({href:a,children:i}){return w.jsx("a",{href:a,className:"text-accent hover:text-accent-hover underline transition-colors",target:"_blank",rel:"noopener noreferrer",children:i})},code({className:a,children:i}){if(a==null?void 0:a.startsWith("language-"))return w.jsx("code",{className:`${a} block`,children:i});const s=typeof i=="string"?i:String(i??"");return r!=null&&r.includes(s)?w.jsx(un,{to:`/specs/${s}`,className:"bg-bg-tertiary text-accent hover:text-accent-hover px-1.5 py-0.5 rounded text-sm underline decoration-dotted transition-colors",children:s}):w.jsx("code",{className:"bg-bg-tertiary text-accent px-1.5 py-0.5 rounded text-sm",children:i})},pre({children:a}){return w.jsx("pre",{className:"bg-bg-tertiary border border-border rounded-lg p-4 text-sm overflow-x-auto mb-4 leading-relaxed",children:a})},table({children:a}){return w.jsx("div",{className:"overflow-x-auto mb-4",children:w.jsx("table",{className:"min-w-full border-collapse border border-border text-sm",children:a})})},thead({children:a}){return w.jsx("thead",{className:"bg-bg-tertiary",children:a})},th({children:a}){return w.jsx("th",{className:"border border-border px-3 py-2 text-left font-semibold text-text-secondary",children:a})},td({children:a}){return w.jsx("td",{className:"border border-border px-3 py-2 text-text-primary",children:a})},ul({children:a}){return w.jsx("ul",{className:"list-disc list-inside mb-4 space-y-1",children:a})},ol({children:a}){return w.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-1",children:a})},hr(){return w.jsx("hr",{className:"border-border my-6"})},blockquote({children:a}){return w.jsx("blockquote",{className:"border-l-4 border-accent pl-4 my-4 text-text-secondary italic",children:a})},input({checked:a,type:i}){return i==="checkbox"?w.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-2 accent-accent"}):w.jsx("input",{type:i})}},children:t})})}class VC{diff(r,a,i={}){let o;typeof i=="function"?(o=i,i={}):"callback"in i&&(o=i.callback);const s=this.castInput(r,i),c=this.castInput(a,i),h=this.removeEmpty(this.tokenize(s,i)),p=this.removeEmpty(this.tokenize(c,i));return this.diffWithOptionsObj(h,p,i,o)}diffWithOptionsObj(r,a,i,o){var s;const c=_=>{if(_=this.postProcess(_,i),o){setTimeout(function(){o(_)},0);return}else return _},h=a.length,p=r.length;let m=1,y=h+p;i.maxEditLength!=null&&(y=Math.min(y,i.maxEditLength));const g=(s=i.timeout)!==null&&s!==void 0?s:1/0,x=Date.now()+g,b=[{oldPos:-1,lastComponent:void 0}];let k=this.extractCommon(b[0],a,r,0,i);if(b[0].oldPos+1>=p&&k+1>=h)return c(this.buildValues(b[0].lastComponent,a,r));let D=-1/0,N=1/0;const R=()=>{for(let _=Math.max(D,-m);_<=Math.min(N,m);_+=2){let H;const ie=b[_-1],K=b[_+1];ie&&(b[_-1]=void 0);let q=!1;if(K){const le=K.oldPos-_;q=K&&0<=le&&le<h}const M=ie&&ie.oldPos+1<p;if(!q&&!M){b[_]=void 0;continue}if(!M||q&&ie.oldPos<K.oldPos?H=this.addToPath(K,!0,!1,0,i):H=this.addToPath(ie,!1,!0,1,i),k=this.extractCommon(H,a,r,_,i),H.oldPos+1>=p&&k+1>=h)return c(this.buildValues(H.lastComponent,a,r))||!0;b[_]=H,H.oldPos+1>=p&&(N=Math.min(N,_-1)),k+1>=h&&(D=Math.max(D,_+1))}m++};if(o)(function _(){setTimeout(function(){if(m>y||Date.now()>x)return o(void 0);R()||_()},0)})();else for(;m<=y&&Date.now()<=x;){const _=R();if(_)return _}}addToPath(r,a,i,o,s){const c=r.lastComponent;return c&&!s.oneChangePerToken&&c.added===a&&c.removed===i?{oldPos:r.oldPos+o,lastComponent:{count:c.count+1,added:a,removed:i,previousComponent:c.previousComponent}}:{oldPos:r.oldPos+o,lastComponent:{count:1,added:a,removed:i,previousComponent:c}}}extractCommon(r,a,i,o,s){const c=a.length,h=i.length;let p=r.oldPos,m=p-o,y=0;for(;m+1<c&&p+1<h&&this.equals(i[p+1],a[m+1],s);)m++,p++,y++,s.oneChangePerToken&&(r.lastComponent={count:1,previousComponent:r.lastComponent,added:!1,removed:!1});return y&&!s.oneChangePerToken&&(r.lastComponent={count:y,previousComponent:r.lastComponent,added:!1,removed:!1}),r.oldPos=p,m}equals(r,a,i){return i.comparator?i.comparator(r,a):r===a||!!i.ignoreCase&&r.toLowerCase()===a.toLowerCase()}removeEmpty(r){const a=[];for(let i=0;i<r.length;i++)r[i]&&a.push(r[i]);return a}castInput(r,a){return r}tokenize(r,a){return Array.from(r)}join(r){return r.join("")}postProcess(r,a){return r}get useLongestToken(){return!1}buildValues(r,a,i){const o=[];let s;for(;r;)o.push(r),s=r.previousComponent,delete r.previousComponent,r=s;o.reverse();const c=o.length;let h=0,p=0,m=0;for(;h<c;h++){const y=o[h];if(y.removed)y.value=this.join(i.slice(m,m+y.count)),m+=y.count;else{if(!y.added&&this.useLongestToken){let g=a.slice(p,p+y.count);g=g.map(function(x,b){const k=i[m+b];return k.length>x.length?k:x}),y.value=this.join(g)}else y.value=this.join(a.slice(p,p+y.count));p+=y.count,y.added||(m+=y.count)}}return o}}class FC extends VC{constructor(){super(...arguments),this.tokenize=QC}equals(r,a,i){return i.ignoreWhitespace?((!i.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!i.newlineIsToken||!a.includes(`
`))&&(a=a.trim())):i.ignoreNewlineAtEof&&!i.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),a.endsWith(`
`)&&(a=a.slice(0,-1))),super.equals(r,a,i)}}const GC=new FC;function XC(t,r,a){return GC.diff(t,r,a)}function QC(t,r){r.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const a=[],i=t.split(/(\n|\r\n)/);i[i.length-1]||i.pop();for(let o=0;o<i.length;o++){const s=i[o];o%2&&!r.newlineIsToken?a[a.length-1]+=s:a.push(s)}return a}function ZC({oldContent:t,newContent:r,oldLabel:a,newLabel:i}){const o=j.useMemo(()=>XC(t,r),[t,r]);return o.some(c=>c.added||c.removed)?w.jsxs("div",{className:"rounded-lg border border-border overflow-hidden",children:[(a||i)&&w.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 bg-bg-secondary border-b border-border text-xs text-text-muted",children:[a&&w.jsxs("span",{className:"text-red-400",children:["--- ",a]}),i&&w.jsxs("span",{className:"text-green-400",children:["+++ ",i]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsx("pre",{className:"text-sm leading-relaxed",children:o.map((c,h)=>w.jsx(KC,{change:c},h))})})]}):w.jsx("div",{className:"rounded-lg border border-border bg-bg-secondary p-6 text-center",children:w.jsx("p",{className:"text-text-muted",children:"No differences found"})})}function KC({change:t}){const r=t.value.replace(/\n$/,"").split(`
`);if(!t.added&&!t.removed){if(r.length<=6)return w.jsx(w.Fragment,{children:r.map((h,p)=>w.jsxs("div",{className:"px-4 py-0.5",children:[w.jsx("span",{className:"text-text-muted select-none inline-block w-5 mr-2",children:" "}),h]},p))});const s=r.slice(0,3),c=r.slice(-3);return w.jsxs(w.Fragment,{children:[s.map((h,p)=>w.jsxs("div",{className:"px-4 py-0.5",children:[w.jsx("span",{className:"text-text-muted select-none inline-block w-5 mr-2",children:" "}),h]},`b-${p}`)),w.jsxs("div",{className:"px-4 py-1 bg-bg-secondary text-text-muted text-xs text-center border-y border-border",children:["··· ",r.length-6," lines hidden ···"]}),c.map((h,p)=>w.jsxs("div",{className:"px-4 py-0.5",children:[w.jsx("span",{className:"text-text-muted select-none inline-block w-5 mr-2",children:" "}),h]},`a-${p}`))]})}const a=t.added?"bg-green-400/10":"bg-red-400/10",i=t.added?"text-green-400":"text-red-400",o=t.added?"+":"-";return w.jsx(w.Fragment,{children:r.map((s,c)=>w.jsxs("div",{className:`px-4 py-0.5 ${a}`,children:[w.jsx("span",{className:`${i} select-none inline-block w-5 mr-2`,children:o}),w.jsx("span",{className:i,children:s})]},c))})}function IC({topic:t,entry:r,currentContent:a,onClose:i}){const{data:o,loading:s,error:c}=y1(t,r.slug);return s?w.jsx("p",{className:"text-text-muted",children:"Loading diff..."}):c?w.jsxs("p",{className:"text-red-400",children:["Error: ",c]}):o?w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("h2",{className:"text-lg font-semibold",children:["Diff: ",r.description]}),w.jsx("button",{onClick:i,className:"text-sm text-text-muted hover:text-accent transition-colors px-3 py-1 rounded border border-border hover:border-accent",children:"Close diff"})]}),w.jsx(ZC,{oldContent:o.content,newContent:a,oldLabel:r.slug,newLabel:"current"})]}):null}function JC(){const{topic:t}=xh(),{data:r,loading:a,error:i}=g1(t??""),[o,s]=j.useState(null);return a?w.jsx("p",{className:"text-text-muted",children:"Loading..."}):i?w.jsxs("p",{className:"text-red-400",children:["Error: ",i]}):r?w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{children:[w.jsx(un,{to:"/specs",className:"text-text-muted text-base font-medium hover:text-accent transition-colors",children:"← Back to Specs"}),w.jsx("h1",{className:"text-2xl font-bold mt-2",children:r.topic})]}),o?w.jsx(IC,{topic:r.topic,entry:o,currentContent:r.content,onClose:()=>s(null)}):w.jsx(xu,{content:r.content}),w.jsxs("section",{children:[w.jsx("h2",{className:"text-lg font-semibold mb-3",children:"History"}),r.history.length===0?w.jsx("p",{className:"text-text-muted text-sm",children:"No changes have affected this spec"}):w.jsxs("div",{className:"relative pl-6",children:[w.jsx("div",{className:"absolute left-2 top-1 bottom-1 w-px bg-border"}),w.jsx("div",{className:"space-y-4",children:r.history.map(c=>w.jsxs("div",{className:"relative hover:bg-bg-secondary rounded p-2 transition-colors",children:[w.jsx("div",{className:"absolute -left-4 top-3.5 w-2.5 h-2.5 rounded-full border-2 border-accent bg-bg-primary"}),w.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[(c.timestamp||c.date)&&w.jsx("span",{className:"text-text-muted text-xs font-mono",title:c.timestamp||void 0,children:c.timestamp?new Date(c.timestamp).toLocaleString():c.date}),w.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${c.status==="active"?"bg-green-400/10 text-green-400":"bg-text-muted/10 text-text-muted"}`,children:c.status})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx(un,{to:`/changes/${c.slug}`,className:"text-sm text-accent hover:underline",children:c.description}),w.jsx("button",{onClick:()=>s((o==null?void 0:o.slug)===c.slug?null:c),className:`text-xs px-2 py-0.5 rounded border transition-colors ${(o==null?void 0:o.slug)===c.slug?"border-accent text-accent bg-accent/10":"border-border text-text-muted hover:text-accent hover:border-accent"}`,children:(o==null?void 0:o.slug)===c.slug?"Comparing":"Compare"})]})]},c.slug))})]})]})]}):w.jsx("p",{className:"text-text-muted",children:"Spec not found"})}function PC(){const{data:t,loading:r,error:a}=Hh();if(r)return w.jsx("p",{className:"text-text-muted",children:"Loading..."});if(a)return w.jsxs("p",{className:"text-red-400",children:["Error: ",a]});const i=(t==null?void 0:t.active)??[],o=(t==null?void 0:t.archived)??[];return i.length===0&&o.length===0?w.jsxs("div",{children:[w.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Changes"}),w.jsx("p",{className:"text-text-muted",children:"No changes found"})]}):w.jsxs("div",{className:"space-y-8",children:[w.jsx("h1",{className:"text-2xl font-bold",children:"Changes"}),i.length>0&&w.jsxs("section",{children:[w.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Active"}),w.jsx("div",{className:"space-y-2",children:i.map(s=>w.jsxs(un,{to:`/changes/${s.slug}`,className:"block bg-bg-secondary border border-border border-l-4 border-l-accent rounded p-4 hover:border-accent transition-colors",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-text-primary font-medium",children:s.description}),s.date&&w.jsx("span",{className:"text-text-muted text-xs",children:s.date})]}),s.taskStats&&w.jsx(ms,{completed:s.taskStats.completed,total:s.taskStats.total})]},s.slug))})]}),o.length>0&&w.jsxs("section",{children:[w.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Archived"}),w.jsx("div",{className:"space-y-2",children:o.map(s=>w.jsx(un,{to:`/changes/${s.slug}`,className:"block bg-bg-secondary border border-border rounded p-4 hover:border-accent transition-colors",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("span",{className:"text-text-primary",children:s.description}),s.date&&w.jsx("span",{className:"text-text-muted text-xs",children:s.date})]})},s.slug))})]})]})}function $C({tabs:t}){var o;const[r,a]=j.useState(((o=t[0])==null?void 0:o.id)??""),i=t.find(s=>s.id===r);return w.jsxs("div",{children:[w.jsx("div",{className:"flex border-b border-border mb-4",children:t.map(s=>w.jsx("button",{onClick:()=>a(s.id),className:`px-4 py-2 text-sm transition-colors border-b-2 -mb-px ${s.id===r?"border-accent text-accent":"border-transparent text-text-secondary hover:text-text-primary"}`,children:s.label},s.id))}),w.jsx("div",{className:"animate-fade-in",children:i==null?void 0:i.content},r)]})}function WC(){const{slug:t}=xh(),{data:r,loading:a,error:i}=v1(t??""),{data:o}=Bh(),s=(o==null?void 0:o.map(h=>h.topic))??[];if(a)return w.jsx("p",{className:"text-text-muted",children:"Loading..."});if(i)return w.jsxs("p",{className:"text-red-400",children:["Error: ",i]});if(!r)return w.jsx("p",{className:"text-text-muted",children:"Change not found"});const c=[{id:"proposal",label:"Proposal",content:r.proposal?w.jsx(xu,{content:r.proposal,specTopics:s}):w.jsx("p",{className:"text-text-muted text-sm",children:"No content"})},{id:"design",label:"Design",content:r.design?w.jsx(xu,{content:r.design}):w.jsx("p",{className:"text-text-muted text-sm",children:"No content"})},{id:"specs",label:"Specs",content:r.specs.length>0?w.jsx("div",{className:"space-y-6",children:r.specs.map(h=>w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-semibold text-accent mb-2",children:h.topic}),w.jsx(xu,{content:h.content})]},h.topic))}):w.jsx("p",{className:"text-text-muted text-sm",children:"No delta specs"})},{id:"tasks",label:"Tasks",content:r.tasks?w.jsxs("div",{className:"space-y-4",children:[w.jsx(ms,{completed:r.tasks.completed,total:r.tasks.total}),w.jsx("div",{className:"space-y-4",children:r.tasks.sections.map(h=>w.jsxs("div",{children:[w.jsx("h3",{className:"text-sm font-semibold text-text-secondary mb-2",children:h.title}),w.jsx("div",{className:"space-y-1",children:h.tasks.map((p,m)=>w.jsxs("div",{className:`flex items-start gap-2 text-sm ${p.completed?"opacity-60":""}`,children:[p.completed?w.jsxs("svg",{className:"w-4 h-4 mt-0.5 shrink-0 text-green-400",viewBox:"0 0 16 16",fill:"none",children:[w.jsx("circle",{cx:"8",cy:"8",r:"7",fill:"currentColor",opacity:"0.2"}),w.jsx("path",{d:"M5 8l2 2 4-4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}):w.jsx("svg",{className:"w-4 h-4 mt-0.5 shrink-0 text-text-muted",viewBox:"0 0 16 16",fill:"none",children:w.jsx("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor",strokeWidth:"1.5"})}),w.jsx("span",{className:p.completed?"text-text-secondary line-through":"text-text-primary",children:p.text})]},m))})]},h.title))})]}):w.jsx("p",{className:"text-text-muted text-sm",children:"No content"})}];return w.jsxs("div",{className:"space-y-6",children:[w.jsxs("div",{children:[w.jsx(un,{to:"/changes",className:"text-text-muted text-base font-medium hover:text-accent transition-colors",children:"← Back to Changes"}),w.jsx("h1",{className:"text-2xl font-bold mt-2",children:t})]}),w.jsx($C,{tabs:c})]})}const e4=Kx([{element:w.jsx(C1,{}),children:[{path:"/",element:w.jsx(Gh,{})},{path:"/dashboard",element:w.jsx(Gh,{})},{path:"/specs",element:w.jsx(T1,{})},{path:"/specs/:topic",element:w.jsx(JC,{})},{path:"/changes",element:w.jsx(PC,{})},{path:"/changes/:slug",element:w.jsx(WC,{})}]}]);function t4(){const{setRepoPath:t}=ll(),r=j.useMemo(()=>new m1,[]);return j.useEffect(()=>{t("demo")},[t]),w.jsx(h1,{adapter:r,children:w.jsx(i1,{router:e4})})}function n4(){return w.jsx(c1,{children:w.jsx(o1,{children:w.jsx(t4,{})})})}_v.createRoot(document.getElementById("root")).render(w.jsx(j.StrictMode,{children:w.jsx(n4,{})}))})();
</script>
  </body>
</html>